import { __awaiter, __extends, __generator, __spread, __values, __read } from 'tslib';
import { HttpClient, HttpClientModule } from '@angular/common/http';
import { Injectable, ChangeDetectionStrategy, Component, ViewEncapsulation, ContentChild, EventEmitter, HostListener, ElementRef, Input, Output, TemplateRef, Inject, Directive, NgModule, InjectionToken, Optional, Pipe, ChangeDetectorRef, HostBinding, ContentChildren, ViewChild, IterableDiffers, Renderer2, Renderer, Host, NgZone, ViewContainerRef, ComponentFactoryResolver, forwardRef, Compiler, APP_INITIALIZER } from '@angular/core';
import { BehaviorSubject } from 'rxjs/BehaviorSubject';
import * as alfrescoApi from 'alfresco-js-api';
import { Subject } from 'rxjs/Subject';
import { Location, CommonModule, DatePipe } from '@angular/common';
import { TranslateService, TranslateModule, TranslateLoader } from '@ngx-translate/core';
import 'rxjs/add/operator/distinctUntilChanged';
import { Observable } from 'rxjs/Observable';
import 'rxjs/add/observable/fromPromise';
import 'rxjs/add/operator/catch';
import 'rxjs/add/observable/throw';
import { DomSanitizer, Title } from '@angular/platform-browser';
import 'rxjs/add/operator/do';
import { MatDialogRef, MAT_DIALOG_DATA, MatDialog, MatAutocompleteModule, MatButtonModule, MatCardModule, MatCheckboxModule, MatChipsModule, MatDatepickerModule, MatDialogModule, MatGridListModule, MatIconModule, MatInputModule, MatListModule, MatNativeDateModule, MatOptionModule, MatProgressSpinnerModule, MatRadioModule, MatRippleModule, MatSelectModule, MatSlideToggleModule, MatTableModule, MatTabsModule, MatMenuModule, MatProgressBarModule, MatSidenavModule, MatSnackBarModule, MatToolbarModule, MatTooltipModule, MatIconRegistry, DateAdapter, MatMenuTrigger, MatSnackBar, MAT_DATE_FORMATS, MatSidenav } from '@angular/material';
import { FormControl, Validators, FormsModule, ReactiveFormsModule, FormBuilder, NG_VALUE_ACCESSOR } from '@angular/forms';
import 'rxjs/add/operator/toPromise';
import { MatDatetimepickerModule, MatNativeDatetimeModule, DatetimeAdapter, MAT_DATETIME_FORMATS } from '@mat-datetimepicker/core';
import 'rxjs/add/observable/of';
import 'rxjs/add/operator/concat';
import 'rxjs/add/operator/share';
import 'rxjs/add/operator/map';
import 'rxjs/add/operator/merge';
import 'rxjs/add/operator/switchMap';
import 'rxjs/add/operator/toArray';
import 'rxjs/add/operator/take';
import moment from 'moment-es6';
import { FlexLayoutModule } from '@angular/flex-layout';
import { Router, RouterModule } from '@angular/router';
import { isMoment } from 'moment';
import 'rxjs/add/operator/debounceTime';
import 'rxjs/add/operator/buffer';
import 'rxjs/add/operator/filter';
import { OverlayContainer } from '@angular/cdk/overlay';
import { ViewportRuler } from '@angular/cdk/scrolling';
import 'rxjs/observable/forkJoin';
import 'rxjs/add/observable/from';
import 'rxjs/add/observable/zip';
import 'rxjs/add/operator/mergeMap';
import { MomentDatetimeAdapter, MAT_MOMENT_DATETIME_FORMATS } from '@mat-datetimepicker/moment';
import 'rxjs/add/operator/defaultIfEmpty';
import { animate, state, style, transition, trigger } from '@angular/animations';
import { ENTER, ESCAPE } from '@angular/cdk/keycodes';
import { HttpModule } from '@angular/http';
import { MediaMatcher } from '@angular/cdk/layout';
import 'rxjs/add/operator/concatMap';
import 'rxjs/add/operator/combineAll';
import 'rxjs/add/observable/interval';
import 'rxjs/add/operator/takeWhile';
import { map } from 'rxjs/operators';
import 'rxjs/add/observable/forkJoin';
import * as minimatch___default from 'minimatch';
import minimatch___default__default, {  } from 'minimatch';

/**
 * @license
 * Copyright 2018 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var BaseEvent = /** @class */ (function () {
    function BaseEvent() {
        this.isDefaultPrevented = false;
    }
    Object.defineProperty(BaseEvent.prototype, "defaultPrevented", {
        get: function () {
            return this.isDefaultPrevented;
        },
        enumerable: true,
        configurable: true
    });
    BaseEvent.prototype.preventDefault = function () {
        this.isDefaultPrevented = true;
    };
    return BaseEvent;
}());
var BaseUIEvent = /** @class */ (function (_super) {
    __extends(BaseUIEvent, _super);
    function BaseUIEvent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return BaseUIEvent;
}(BaseEvent));
var FileUploadStatus = {
    Pending: 0,
    Complete: 1,
    Starting: 2,
    Progress: 3,
    Cancelled: 4,
    Aborted: 5,
    Error: 6,
    Deleted: 7,
};
FileUploadStatus[FileUploadStatus.Pending] = "Pending";
FileUploadStatus[FileUploadStatus.Complete] = "Complete";
FileUploadStatus[FileUploadStatus.Starting] = "Starting";
FileUploadStatus[FileUploadStatus.Progress] = "Progress";
FileUploadStatus[FileUploadStatus.Cancelled] = "Cancelled";
FileUploadStatus[FileUploadStatus.Aborted] = "Aborted";
FileUploadStatus[FileUploadStatus.Error] = "Error";
FileUploadStatus[FileUploadStatus.Deleted] = "Deleted";
var FileModel = /** @class */ (function () {
    function FileModel(file, options) {
        this.status = FileUploadStatus.Pending;
        this.file = file;
        this.id = this.generateId();
        this.name = file.name;
        this.size = file.size;
        this.data = null;
        this.progress = {
            loaded: 0,
            total: 0,
            percent: 0
        };
        this.options = Object.assign({}, {
            newVersion: false
        }, options);
    }
    FileModel.prototype.generateId = function () {
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
            var r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
        });
    };
    Object.defineProperty(FileModel.prototype, "extension", {
        get: function () {
            return this.name.slice((Math.max(0, this.name.lastIndexOf('.')) || Infinity) + 1);
        },
        enumerable: true,
        configurable: true
    });
    return FileModel;
}());
var FileUploadEvent = /** @class */ (function () {
    function FileUploadEvent(file, status, error) {
        if (status === void 0) { status = FileUploadStatus.Pending; }
        if (error === void 0) { error = null; }
        this.file = file;
        this.status = status;
        this.error = error;
    }
    return FileUploadEvent;
}());
var FileUploadCompleteEvent = /** @class */ (function (_super) {
    __extends(FileUploadCompleteEvent, _super);
    function FileUploadCompleteEvent(file, totalComplete, data, totalAborted) {
        if (totalComplete === void 0) { totalComplete = 0; }
        if (totalAborted === void 0) { totalAborted = 0; }
        var _this = _super.call(this, file, FileUploadStatus.Complete) || this;
        _this.totalComplete = totalComplete;
        _this.data = data;
        _this.totalAborted = totalAborted;
        return _this;
    }
    return FileUploadCompleteEvent;
}(FileUploadEvent));
var FileUploadDeleteEvent = /** @class */ (function (_super) {
    __extends(FileUploadDeleteEvent, _super);
    function FileUploadDeleteEvent(file, totalComplete) {
        if (totalComplete === void 0) { totalComplete = 0; }
        var _this = _super.call(this, file, FileUploadStatus.Deleted) || this;
        _this.totalComplete = totalComplete;
        return _this;
    }
    return FileUploadDeleteEvent;
}(FileUploadEvent));
var FileUploadErrorEvent = /** @class */ (function (_super) {
    __extends(FileUploadErrorEvent, _super);
    function FileUploadErrorEvent(file, error, totalError) {
        if (totalError === void 0) { totalError = 0; }
        var _this = _super.call(this, file, FileUploadStatus.Error) || this;
        _this.error = error;
        _this.totalError = totalError;
        return _this;
    }
    return FileUploadErrorEvent;
}(FileUploadEvent));
var ObjectUtils = /** @class */ (function () {
    function ObjectUtils() {
    }
    ObjectUtils.getValue = function (target, key) {
        if (!target) {
            return undefined;
        }
        var keys = key.split('.');
        key = '';
        do {
            key += keys.shift();
            var value = target[key];
            if (value !== undefined && (typeof value === 'object' || !keys.length)) {
                target = value;
                key = '';
            }
            else if (!keys.length) {
                target = undefined;
            }
            else {
                key += '.';
            }
        } while (keys.length);
        return target;
    };
    ObjectUtils.merge = function () {
        var objects = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            objects[_i] = arguments[_i];
        }
        var result = {};
        objects.forEach(function (source) {
            Object.keys(source).forEach(function (prop) {
                if (prop in result && Array.isArray(result[prop])) {
                    result[prop] = result[prop].concat(source[prop]);
                }
                else if (prop in result && typeof result[prop] === 'object') {
                    result[prop] = ObjectUtils.merge(result[prop], source[prop]);
                }
                else {
                    result[prop] = source[prop];
                }
            });
        });
        return result;
    };
    return ObjectUtils;
}());
var AppConfigService = /** @class */ (function () {
    function AppConfigService(http) {
        this.http = http;
        this.config = {
            application: {
                name: 'Alfresco ADF Application'
            },
            ecmHost: 'http://{hostname}{:port}/ecm',
            bpmHost: 'http://{hostname}{:port}/bpm',
            logLevel: 'silent',
            alfrescoRepositoryName: 'alfresco-1'
        };
        this.onLoadSubject = new BehaviorSubject(this.config);
        this.onLoad = this.onLoadSubject.asObservable();
    }
    AppConfigService.prototype.select = function (property) {
        return this.onLoadSubject.map(function (config) { return config[property]; }).distinctUntilChanged();
    };
    AppConfigService.prototype.get = function (key, defaultValue) {
        var result = ObjectUtils.getValue(this.config, key);
        if (typeof result === 'string') {
            var map$$1 = new Map();
            map$$1.set('hostname', this.getLocationHostname());
            map$$1.set(':port', this.getLocationPort(':'));
            map$$1.set('port', this.getLocationPort());
            result = this.formatString(result, map$$1);
        }
        if (result === undefined) {
            return defaultValue;
        }
        return (result);
    };
    AppConfigService.prototype.getLocationHostname = function () {
        return location.hostname;
    };
    AppConfigService.prototype.getLocationPort = function (prefix) {
        if (prefix === void 0) { prefix = ''; }
        return location.port ? prefix + location.port : '';
    };
    AppConfigService.prototype.load = function () {
        var _this = this;
        return new Promise(function (resolve) {
            _this.http.get('app.config.json').subscribe(function (data) {
                _this.config = Object.assign({}, _this.config, data || {});
                _this.onLoadSubject.next(_this.config);
                resolve(_this.config);
            }, function () {
                resolve(_this.config);
            });
        });
    };
    AppConfigService.prototype.formatString = function (str, map$$1) {
        var result = str;
        map$$1.forEach(function (value, key) {
            var expr = new RegExp('{' + key + '}', 'gm');
            result = result.replace(expr, value);
        });
        return result;
    };
    return AppConfigService;
}());
AppConfigService.APP_CONFIG_LANGUAGES_KEY = 'languages';
AppConfigService.decorators = [
    { type: Injectable },
];
AppConfigService.ctorParameters = function () { return [
    { type: HttpClient, },
]; };
var StorageService = /** @class */ (function () {
    function StorageService() {
        this.memoryStore = {};
        this.useLocalStorage = false;
        this.useLocalStorage = this.storageAvailable('localStorage');
    }
    StorageService.prototype.getItem = function (key) {
        if (this.useLocalStorage) {
            return localStorage.getItem(key);
        }
        else {
            return this.memoryStore.hasOwnProperty(key) ? this.memoryStore[key] : null;
        }
    };
    StorageService.prototype.setItem = function (key, data) {
        if (this.useLocalStorage) {
            localStorage.setItem(key, data);
        }
        else {
            this.memoryStore[key] = data.toString();
        }
    };
    StorageService.prototype.clear = function () {
        if (this.useLocalStorage) {
            localStorage.clear();
        }
        else {
            this.memoryStore = {};
        }
    };
    StorageService.prototype.removeItem = function (key) {
        if (this.useLocalStorage) {
            localStorage.removeItem(key);
        }
        else {
            delete this.memoryStore[key];
        }
    };
    StorageService.prototype.hasItem = function (key) {
        if (this.useLocalStorage) {
            return localStorage.getItem(key) ? true : false;
        }
        else {
            return this.memoryStore.hasOwnProperty(key);
        }
    };
    StorageService.prototype.storageAvailable = function (type) {
        try {
            var storage = window[type];
            var key = '__storage_test__';
            storage.setItem(key, key);
            storage.removeItem(key, key);
            return true;
        }
        catch (e) {
            return false;
        }
    };
    return StorageService;
}());
StorageService.decorators = [
    { type: Injectable },
];
StorageService.ctorParameters = function () { return []; };
var AlfrescoApiService = /** @class */ (function () {
    function AlfrescoApiService(appConfig, storage) {
        this.appConfig = appConfig;
        this.storage = storage;
        this.nodeUpdated = new Subject();
    }
    AlfrescoApiService.prototype.getInstance = function () {
        return this.alfrescoApi;
    };
    Object.defineProperty(AlfrescoApiService.prototype, "contentApi", {
        get: function () {
            return this.getInstance().content;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AlfrescoApiService.prototype, "nodesApi", {
        get: function () {
            return this.getInstance().nodes;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AlfrescoApiService.prototype, "renditionsApi", {
        get: function () {
            return this.getInstance().core.renditionsApi;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AlfrescoApiService.prototype, "sharedLinksApi", {
        get: function () {
            return this.getInstance().core.sharedlinksApi;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AlfrescoApiService.prototype, "sitesApi", {
        get: function () {
            return this.getInstance().core.sitesApi;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AlfrescoApiService.prototype, "favoritesApi", {
        get: function () {
            return this.getInstance().core.favoritesApi;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AlfrescoApiService.prototype, "peopleApi", {
        get: function () {
            return this.getInstance().core.peopleApi;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AlfrescoApiService.prototype, "searchApi", {
        get: function () {
            return this.getInstance().search.searchApi;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AlfrescoApiService.prototype, "versionsApi", {
        get: function () {
            return this.getInstance().core.versionsApi;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AlfrescoApiService.prototype, "classesApi", {
        get: function () {
            return this.getInstance().core.classesApi;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AlfrescoApiService.prototype, "groupsApi", {
        get: function () {
            return this.getInstance().core.groupsApi;
        },
        enumerable: true,
        configurable: true
    });
    AlfrescoApiService.prototype.load = function () {
        return __awaiter(this, void 0, void 0, function () {
            var _this = this;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.appConfig.load().then(function () {
                            _this.initAlfrescoApi();
                        })];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    AlfrescoApiService.prototype.reset = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                this.initAlfrescoApi();
                return [2 /*return*/];
            });
        });
    };
    AlfrescoApiService.prototype.initAlfrescoApi = function () {
        this.alfrescoApi = (new alfrescoApi({
            provider: this.storage.getItem('AUTH_TYPE'),
            ticketEcm: this.storage.getItem('ticket-ECM'),
            ticketBpm: this.storage.getItem('ticket-BPM'),
            hostEcm: this.appConfig.get('ecmHost'),
            hostBpm: this.appConfig.get('bpmHost'),
            contextRootBpm: this.appConfig.get('contextRootBpm'),
            contextRoot: this.appConfig.get('contextRootEcm'),
            disableCsrf: this.storage.getItem('DISABLE_CSRF') === 'true',
            oauth2: this.appConfig.get('oauth2')
        }));
    };
    return AlfrescoApiService;
}());
AlfrescoApiService.decorators = [
    { type: Injectable },
];
AlfrescoApiService.ctorParameters = function () { return [
    { type: AppConfigService, },
    { type: StorageService, },
]; };
var LogLevelsEnum = /** @class */ (function (_super) {
    __extends(LogLevelsEnum, _super);
    function LogLevelsEnum() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return LogLevelsEnum;
}(Number));
LogLevelsEnum.TRACE = 5;
LogLevelsEnum.DEBUG = 4;
LogLevelsEnum.INFO = 3;
LogLevelsEnum.WARN = 2;
LogLevelsEnum.ERROR = 1;
LogLevelsEnum.SILENT = 0;
var logLevels = [
    { level: LogLevelsEnum.TRACE, name: 'TRACE' },
    { level: LogLevelsEnum.DEBUG, name: 'DEBUG' },
    { level: LogLevelsEnum.INFO, name: 'INFO' },
    { level: LogLevelsEnum.WARN, name: 'WARN' },
    { level: LogLevelsEnum.ERROR, name: 'ERROR' },
    { level: LogLevelsEnum.SILENT, name: 'SILENT' }
];
var LogService = /** @class */ (function () {
    function LogService(appConfig) {
        this.appConfig = appConfig;
        this.onMessage = new Subject();
    }
    Object.defineProperty(LogService.prototype, "currentLogLevel", {
        get: function () {
            var configLevel = this.appConfig.get('logLevel');
            if (configLevel) {
                return this.getLogLevel(configLevel);
            }
            return LogLevelsEnum.TRACE;
        },
        enumerable: true,
        configurable: true
    });
    LogService.prototype.error = function (message) {
        var optionalParams = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            optionalParams[_i - 1] = arguments[_i];
        }
        if (this.currentLogLevel >= LogLevelsEnum.ERROR) {
            this.messageBus(message, 'ERROR');
            console.error.apply(console, __spread([message], optionalParams));
        }
    };
    LogService.prototype.debug = function (message) {
        var optionalParams = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            optionalParams[_i - 1] = arguments[_i];
        }
        if (this.currentLogLevel >= LogLevelsEnum.DEBUG) {
            this.messageBus(message, 'DEBUG');
            console.debug.apply(console, __spread([message], optionalParams));
        }
    };
    LogService.prototype.info = function (message) {
        var optionalParams = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            optionalParams[_i - 1] = arguments[_i];
        }
        if (this.currentLogLevel >= LogLevelsEnum.INFO) {
            this.messageBus(message, 'INFO');
            console.info.apply(console, __spread([message], optionalParams));
        }
    };
    LogService.prototype.log = function (message) {
        var optionalParams = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            optionalParams[_i - 1] = arguments[_i];
        }
        if (this.currentLogLevel >= LogLevelsEnum.TRACE) {
            this.messageBus(message, 'LOG');
            console.log.apply(console, __spread([message], optionalParams));
        }
    };
    LogService.prototype.trace = function (message) {
        var optionalParams = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            optionalParams[_i - 1] = arguments[_i];
        }
        if (this.currentLogLevel >= LogLevelsEnum.TRACE) {
            this.messageBus(message, 'TRACE');
            console.trace.apply(console, __spread([message], optionalParams));
        }
    };
    LogService.prototype.warn = function (message) {
        var optionalParams = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            optionalParams[_i - 1] = arguments[_i];
        }
        if (this.currentLogLevel >= LogLevelsEnum.WARN) {
            this.messageBus(message, 'WARN');
            console.warn.apply(console, __spread([message], optionalParams));
        }
    };
    LogService.prototype.assert = function (test, message) {
        var optionalParams = [];
        for (var _i = 2; _i < arguments.length; _i++) {
            optionalParams[_i - 2] = arguments[_i];
        }
        if (this.currentLogLevel !== LogLevelsEnum.SILENT) {
            this.messageBus(message, 'ASSERT');
            console.assert.apply(console, __spread([test, message], optionalParams));
        }
    };
    LogService.prototype.group = function (groupTitle) {
        var optionalParams = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            optionalParams[_i - 1] = arguments[_i];
        }
        if (this.currentLogLevel !== LogLevelsEnum.SILENT) {
            console.group.apply(console, __spread([groupTitle], optionalParams));
        }
    };
    LogService.prototype.groupEnd = function () {
        if (this.currentLogLevel !== LogLevelsEnum.SILENT) {
            console.groupEnd();
        }
    };
    LogService.prototype.getLogLevel = function (level) {
        var referencedLevel = logLevels.find(function (currentLevel) {
            return currentLevel.name.toLocaleLowerCase() === level.toLocaleLowerCase();
        });
        return referencedLevel ? referencedLevel.level : 5;
    };
    LogService.prototype.messageBus = function (text, logLevel) {
        this.onMessage.next({ text: text, type: logLevel });
    };
    return LogService;
}());
LogService.decorators = [
    { type: Injectable },
];
LogService.ctorParameters = function () { return [
    { type: AppConfigService, },
]; };
var ViewerMoreActionsComponent = /** @class */ (function () {
    function ViewerMoreActionsComponent() {
    }
    return ViewerMoreActionsComponent;
}());
ViewerMoreActionsComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-viewer-more-actions',
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush,
                host: { class: 'adf-viewer-more-actions' },
                template: "<ng-content></ng-content>"
            },] },
];
ViewerMoreActionsComponent.ctorParameters = function () { return []; };
var ViewerOpenWithComponent = /** @class */ (function () {
    function ViewerOpenWithComponent() {
    }
    return ViewerOpenWithComponent;
}());
ViewerOpenWithComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-viewer-open-with',
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush,
                host: { class: 'adf-viewer-open-with' },
                template: "<ng-content></ng-content>"
            },] },
];
ViewerOpenWithComponent.ctorParameters = function () { return []; };
var ViewerSidebarComponent = /** @class */ (function () {
    function ViewerSidebarComponent() {
    }
    return ViewerSidebarComponent;
}());
ViewerSidebarComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-viewer-sidebar',
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush,
                host: { class: 'adf-viewer-sidebar' },
                template: "<ng-content></ng-content>"
            },] },
];
ViewerSidebarComponent.ctorParameters = function () { return []; };
var ViewerToolbarComponent = /** @class */ (function () {
    function ViewerToolbarComponent() {
    }
    return ViewerToolbarComponent;
}());
ViewerToolbarComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-viewer-toolbar',
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush,
                host: { class: 'adf-viewer-toolbar' },
                template: "<ng-content></ng-content>"
            },] },
];
ViewerToolbarComponent.ctorParameters = function () { return []; };
var ViewerComponent = /** @class */ (function () {
    function ViewerComponent(apiService, logService, location, el) {
        this.apiService = apiService;
        this.logService = logService;
        this.location = location;
        this.el = el;
        this.urlFile = '';
        this.urlFileViewer = null;
        this.fileNodeId = null;
        this.sharedLinkId = null;
        this.overlayMode = false;
        this.showViewer = true;
        this.showToolbar = true;
        this.allowGoBack = true;
        this.allowDownload = true;
        this.allowPrint = false;
        this.allowShare = false;
        this.allowFullScreen = true;
        this.allowNavigate = false;
        this.canNavigateBefore = true;
        this.canNavigateNext = true;
        this.allowSidebar = false;
        this.allowThumbnails = true;
        this.showSidebar = false;
        this.sidebarPosition = 'right';
        this.sidebarTemplate = null;
        this.thumbnailsTemplate = null;
        this.downloadUrl = null;
        this.maxRetries = 5;
        this.goBack = new EventEmitter();
        this.download = new EventEmitter();
        this.print = new EventEmitter();
        this.share = new EventEmitter();
        this.showViewerChange = new EventEmitter();
        this.extensionChange = new EventEmitter();
        this.navigateBefore = new EventEmitter();
        this.navigateNext = new EventEmitter();
        this.showPdfThumbnails = false;
        this.viewerType = 'unknown';
        this.isLoading = false;
        this.extensionTemplates = [];
        this.externalExtensions = [];
        this.sidebarTemplateContext = { node: null };
        this.subscriptions = [];
        this.extensions = {
            image: ['png', 'jpg', 'jpeg', 'gif', 'bpm', 'svg'],
            media: ['wav', 'mp4', 'mp3', 'webm', 'ogg'],
            text: ['txt', 'xml', 'js', 'html', 'json', 'ts'],
            pdf: ['pdf']
        };
        this.mimeTypes = {
            text: ['text/plain', 'text/csv', 'text/xml', 'text/html', 'application/x-javascript'],
            pdf: ['application/pdf'],
            image: ['image/png', 'image/jpeg', 'image/gif', 'image/bmp', 'image/svg+xml'],
            media: ['video/mp4', 'video/webm', 'video/ogg', 'audio/mpeg', 'audio/ogg', 'audio/wav']
        };
    }
    ViewerComponent.prototype.isSourceDefined = function () {
        return (this.urlFile || this.blobFile || this.fileNodeId || this.sharedLinkId) ? true : false;
    };
    ViewerComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.subscriptions = this.subscriptions.concat([
            this.apiService.nodeUpdated.subscribe(function (node) { return _this.onNodeUpdated(node); })
        ]);
    };
    ViewerComponent.prototype.ngOnDestroy = function () {
        this.subscriptions.forEach(function (subscription) { return subscription.unsubscribe(); });
        this.subscriptions = [];
    };
    ViewerComponent.prototype.onNodeUpdated = function (node) {
        if (node && node.id === this.fileNodeId) {
            this.setUpNodeFile(node);
        }
    };
    ViewerComponent.prototype.ngOnChanges = function (changes) {
        var _this = this;
        if (this.showViewer) {
            if (!this.isSourceDefined()) {
                throw new Error('A content source attribute value is missing.');
            }
            if (this.blobFile) {
                this.setUpBlobData();
            }
            else if (this.urlFile) {
                this.setUpUrlFile();
            }
            else if (this.fileNodeId) {
                this.isLoading = true;
                this.apiService.nodesApi.getNodeInfo(this.fileNodeId).then(function (data) {
                    _this.setUpNodeFile(data);
                }, function (error) {
                    _this.isLoading = false;
                    _this.logService.error('This node does not exist');
                });
            }
            else if (this.sharedLinkId) {
                this.isLoading = true;
                this.apiService.sharedLinksApi.getSharedLink(this.sharedLinkId).then(function (details) {
                    _this.setUpSharedLinkFile(details);
                });
            }
        }
    };
    ViewerComponent.prototype.setUpBlobData = function () {
        this.displayName = this.getDisplayName('Unknown');
        this.isLoading = true;
        this.mimeType = this.blobFile.type;
        this.viewerType = this.getViewerTypeByMimeType(this.mimeType);
        this.allowDownload = false;
        this.extensionChange.emit(this.mimeType);
        this.isLoading = false;
        this.scrollTop();
    };
    ViewerComponent.prototype.setUpUrlFile = function () {
        this.isLoading = true;
        var filenameFromUrl = this.getFilenameFromUrl(this.urlFile);
        this.displayName = this.getDisplayName(filenameFromUrl);
        this.extension = this.getFileExtension(filenameFromUrl);
        this.urlFileContent = this.urlFile;
        this.downloadUrl = this.urlFile;
        this.fileName = this.displayName;
        this.viewerType = this.urlFileViewer || this.getViewerTypeByExtension(this.extension);
        if (this.viewerType === 'unknown') {
            this.viewerType = this.getViewerTypeByMimeType(this.mimeType);
        }
        this.extensionChange.emit(this.extension);
        this.isLoading = false;
        this.scrollTop();
    };
    ViewerComponent.prototype.setUpNodeFile = function (data) {
        this.mimeType = data.content.mimeType;
        this.displayName = data.name;
        this.urlFileContent = this.apiService.contentApi.getContentUrl(data.id);
        this.extension = this.getFileExtension(data.name);
        this.fileName = data.name;
        this.downloadUrl = this.apiService.contentApi.getContentUrl(data.id, true);
        this.viewerType = this.getViewerTypeByExtension(this.extension);
        if (this.viewerType === 'unknown') {
            this.viewerType = this.getViewerTypeByMimeType(this.mimeType);
        }
        if (this.viewerType === 'unknown') {
            this.displayNodeRendition(data.id);
        }
        else {
            this.isLoading = false;
        }
        this.extensionChange.emit(this.extension);
        this.sidebarTemplateContext.node = data;
        this.scrollTop();
    };
    ViewerComponent.prototype.setUpSharedLinkFile = function (details) {
        this.mimeType = details.entry.content.mimeType;
        this.displayName = this.getDisplayName(details.entry.name);
        this.extension = this.getFileExtension(details.entry.name);
        this.fileName = details.entry.name;
        this.urlFileContent = this.apiService.contentApi.getSharedLinkContentUrl(this.sharedLinkId, false);
        this.downloadUrl = this.apiService.contentApi.getSharedLinkContentUrl(this.sharedLinkId, true);
        this.viewerType = this.getViewerTypeByMimeType(this.mimeType);
        if (this.viewerType === 'unknown') {
            this.viewerType = this.getViewerTypeByExtension(this.extension);
        }
        if (this.viewerType === 'unknown') {
            this.displaySharedLinkRendition(this.sharedLinkId);
        }
        else {
            this.isLoading = false;
        }
        this.extensionChange.emit(this.extension);
        this.isLoading = false;
    };
    ViewerComponent.prototype.toggleSidebar = function () {
        var _this = this;
        this.showSidebar = !this.showSidebar;
        if (this.showSidebar && this.fileNodeId) {
            this.apiService.getInstance().nodes.getNodeInfo(this.fileNodeId)
                .then(function (data) {
                _this.sidebarTemplateContext.node = data;
            });
        }
    };
    ViewerComponent.prototype.getDisplayName = function (name) {
        return this.displayName || name;
    };
    ViewerComponent.prototype.scrollTop = function () {
        window.scrollTo(0, 1);
    };
    ViewerComponent.prototype.getViewerTypeByMimeType = function (mimeType) {
        if (mimeType) {
            mimeType = mimeType.toLowerCase();
            var editorTypes = Object.keys(this.mimeTypes);
            try {
                for (var editorTypes_1 = __values(editorTypes), editorTypes_1_1 = editorTypes_1.next(); !editorTypes_1_1.done; editorTypes_1_1 = editorTypes_1.next()) {
                    var type = editorTypes_1_1.value;
                    if (this.mimeTypes[type].indexOf(mimeType) >= 0) {
                        return type;
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (editorTypes_1_1 && !editorTypes_1_1.done && (_a = editorTypes_1.return)) _a.call(editorTypes_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        return 'unknown';
        var e_1, _a;
    };
    ViewerComponent.prototype.getViewerTypeByExtension = function (extension) {
        if (extension) {
            extension = extension.toLowerCase();
        }
        if (this.isCustomViewerExtension(extension)) {
            return 'custom';
        }
        if (this.extensions.image.indexOf(extension) >= 0) {
            return 'image';
        }
        if (this.extensions.media.indexOf(extension) >= 0) {
            return 'media';
        }
        if (this.extensions.text.indexOf(extension) >= 0) {
            return 'text';
        }
        if (this.extensions.pdf.indexOf(extension) >= 0) {
            return 'pdf';
        }
        return 'unknown';
    };
    ViewerComponent.prototype.onBackButtonClick = function () {
        if (this.overlayMode) {
            this.close();
        }
        else {
            var event = new BaseEvent();
            this.goBack.next(event);
            if (!event.defaultPrevented) {
                this.location.back();
            }
        }
    };
    ViewerComponent.prototype.onNavigateBeforeClick = function () {
        this.navigateBefore.next();
    };
    ViewerComponent.prototype.onNavigateNextClick = function () {
        this.navigateNext.next();
    };
    ViewerComponent.prototype.close = function () {
        if (this.otherMenu) {
            this.otherMenu.hidden = false;
        }
        this.showViewer = false;
        this.showViewerChange.emit(this.showViewer);
    };
    ViewerComponent.prototype.getFilenameFromUrl = function (url) {
        var anchor = url.indexOf('#');
        var query = url.indexOf('?');
        var end = Math.min(anchor > 0 ? anchor : url.length, query > 0 ? query : url.length);
        return url.substring(url.lastIndexOf('/', end) + 1, end);
    };
    ViewerComponent.prototype.getFileExtension = function (fileName) {
        if (fileName) {
            var match = fileName.match(/\.([^\./\?\#]+)($|\?|\#)/);
            return match ? match[1] : null;
        }
        return null;
    };
    ViewerComponent.prototype.isCustomViewerExtension = function (extension) {
        var extensions = this.externalExtensions || [];
        if (extension && extensions.length > 0) {
            extension = extension.toLowerCase();
            return extensions.indexOf(extension) >= 0;
        }
        return false;
    };
    ViewerComponent.prototype.handleKeyboardEvent = function (event) {
        var key = event.keyCode;
        if (key === 27 && this.overlayMode) {
            this.close();
        }
        if (key === 37 && this.canNavigateBefore) {
            event.preventDefault();
            this.onNavigateBeforeClick();
        }
        if (key === 39 && this.canNavigateNext) {
            event.preventDefault();
            this.onNavigateNextClick();
        }
        if (key === 70 && event.ctrlKey) {
            event.preventDefault();
            this.enterFullScreen();
        }
    };
    ViewerComponent.prototype.downloadContent = function () {
        if (this.allowDownload && this.downloadUrl && this.fileName) {
            var args = new BaseEvent();
            this.download.next(args);
            if (!args.defaultPrevented) {
                var link = document.createElement('a');
                link.style.display = 'none';
                link.download = this.fileName;
                link.href = this.downloadUrl;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        }
    };
    ViewerComponent.prototype.printContent = function () {
        if (this.allowPrint) {
            var args = new BaseEvent();
            this.print.next(args);
        }
    };
    ViewerComponent.prototype.shareContent = function () {
        if (this.allowShare) {
            var args = new BaseEvent();
            this.share.next(args);
        }
    };
    ViewerComponent.prototype.enterFullScreen = function () {
        if (this.allowFullScreen) {
            var container = this.el.nativeElement.querySelector('.adf-viewer__fullscreen-container');
            if (container) {
                if (container.requestFullscreen) {
                    container.requestFullscreen();
                }
                else if (container.webkitRequestFullscreen) {
                    container.webkitRequestFullscreen();
                }
                else if (container.mozRequestFullScreen) {
                    container.mozRequestFullScreen();
                }
                else if (container.msRequestFullscreen) {
                    container.msRequestFullscreen();
                }
            }
        }
    };
    ViewerComponent.prototype.displayNodeRendition = function (nodeId) {
        return __awaiter(this, void 0, void 0, function () {
            var rendition, renditionId, err_1;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.isLoading = true;
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        return [4 /*yield*/, this.resolveRendition(nodeId, 'pdf')];
                    case 2:
                        rendition = _a.sent();
                        if (rendition) {
                            renditionId = rendition.entry.id;
                            if (renditionId === 'pdf') {
                                this.viewerType = 'pdf';
                            }
                            else if (renditionId === 'imgpreview') {
                                this.viewerType = 'image';
                            }
                            this.urlFileContent = this.apiService.contentApi.getRenditionUrl(nodeId, renditionId);
                        }
                        return [3 /*break*/, 4];
                    case 3:
                        err_1 = _a.sent();
                        this.logService.error(err_1);
                        return [3 /*break*/, 4];
                    case 4:
                        this.isLoading = false;
                        return [2 /*return*/];
                }
            });
        });
    };
    ViewerComponent.prototype.displaySharedLinkRendition = function (sharedId) {
        return __awaiter(this, void 0, void 0, function () {
            var rendition, error_1, rendition, error_2;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.isLoading = true;
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 8]);
                        return [4 /*yield*/, this.apiService.renditionsApi.getSharedLinkRendition(sharedId, 'pdf')];
                    case 2:
                        rendition = _a.sent();
                        if (rendition.entry.status.toString() === 'CREATED') {
                            this.viewerType = 'pdf';
                            this.urlFileContent = this.apiService.contentApi.getSharedLinkRenditionUrl(sharedId, 'pdf');
                        }
                        return [3 /*break*/, 8];
                    case 3:
                        error_1 = _a.sent();
                        this.logService.error(error_1);
                        _a.label = 4;
                    case 4:
                        _a.trys.push([4, 6, , 7]);
                        return [4 /*yield*/, this.apiService.renditionsApi.getSharedLinkRendition(sharedId, 'imgpreview')];
                    case 5:
                        rendition = _a.sent();
                        if (rendition.entry.status.toString() === 'CREATED') {
                            this.viewerType = 'image';
                            this.urlFileContent = this.apiService.contentApi.getSharedLinkRenditionUrl(sharedId, 'imgpreview');
                        }
                        return [3 /*break*/, 7];
                    case 6:
                        error_2 = _a.sent();
                        this.logService.error(error_2);
                        return [3 /*break*/, 7];
                    case 7: return [3 /*break*/, 8];
                    case 8:
                        this.isLoading = false;
                        return [2 /*return*/];
                }
            });
        });
    };
    ViewerComponent.prototype.resolveRendition = function (nodeId, renditionId) {
        return __awaiter(this, void 0, void 0, function () {
            var supported, rendition, status, err_2;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        renditionId = renditionId.toLowerCase();
                        return [4 /*yield*/, this.apiService.renditionsApi.getRenditions(nodeId)];
                    case 1:
                        supported = _a.sent();
                        rendition = supported.list.entries.find(function (obj) { return obj.entry.id.toLowerCase() === renditionId; });
                        if (!rendition) {
                            renditionId = 'imgpreview';
                            rendition = supported.list.entries.find(function (obj) { return obj.entry.id.toLowerCase() === renditionId; });
                            if (!rendition) {
                                return [2 /*return*/, null];
                            }
                        }
                        status = rendition.entry.status.toString();
                        if (!(status === 'CREATED')) return [3 /*break*/, 2];
                        return [2 /*return*/, rendition];
                    case 2:
                        if (!(status === 'NOT_CREATED')) return [3 /*break*/, 7];
                        _a.label = 3;
                    case 3:
                        _a.trys.push([3, 6, , 7]);
                        return [4 /*yield*/, this.apiService.renditionsApi.createRendition(nodeId, { id: renditionId })];
                    case 4:
                        _a.sent();
                        return [4 /*yield*/, this.waitRendition(nodeId, renditionId, 0)];
                    case 5: return [2 /*return*/, _a.sent()];
                    case 6:
                        err_2 = _a.sent();
                        this.logService.error(err_2);
                        return [2 /*return*/, null];
                    case 7: return [2 /*return*/];
                }
            });
        });
    };
    ViewerComponent.prototype.waitRendition = function (nodeId, renditionId, retries) {
        return __awaiter(this, void 0, void 0, function () {
            var rendition, status;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.apiService.renditionsApi.getRendition(nodeId, renditionId)];
                    case 1:
                        rendition = _a.sent();
                        if (retries > this.maxRetries) {
                            return [2 /*return*/, null];
                        }
                        status = rendition.entry.status.toString();
                        if (!(status === 'CREATED')) return [3 /*break*/, 2];
                        return [2 /*return*/, rendition];
                    case 2:
                        retries += 1;
                        return [4 /*yield*/, this.wait(1000)];
                    case 3:
                        _a.sent();
                        return [4 /*yield*/, this.waitRendition(nodeId, renditionId, retries)];
                    case 4: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    ViewerComponent.prototype.wait = function (ms) {
        return new Promise(function (resolve) { return setTimeout(resolve, ms); });
    };
    return ViewerComponent;
}());
ViewerComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-viewer',
                template: "<div *ngIf=\"showViewer\"\n    class=\"adf-viewer-container\"\n    [class.adf-viewer-overlay-container]=\"overlayMode\"\n    [class.adf-viewer-inline-container]=\"!overlayMode\">\n\n    <div class=\"adf-viewer-content\" fxLayout=\"column\">\n        <ng-content select=\"adf-viewer-toolbar\"></ng-content>\n        <ng-container *ngIf=\"showToolbar && !toolbar\">\n            <adf-toolbar color=\"default\" class=\"adf-viewer-toolbar\">\n\n                <adf-toolbar-title>\n                    <button *ngIf=\"allowGoBack\"\n                        class=\"adf-viewer-close-button\"\n                        data-automation-id=\"toolbar-back\"\n                        mat-icon-button\n                        title=\"{{ 'ADF_VIEWER.ACTIONS.CLOSE' | translate }}\"\n                        (click)=\"onBackButtonClick()\">\n                        <mat-icon>close</mat-icon>\n                    </button>\n                </adf-toolbar-title>\n\n                <div fxFlex=\"1 1 auto\">\n                    <button\n                        *ngIf=\"allowNavigate && canNavigateBefore\"\n                        data-automation-id=\"toolbar-pref-file\"\n                        mat-icon-button\n                        title=\"{{ 'ADF_VIEWER.ACTIONS.PREV_FILE' | translate }}\"\n                        (click)=\"onNavigateBeforeClick()\">\n                        <mat-icon>navigate_before</mat-icon>\n                    </button>\n                    <img class=\"adf-viewer__mimeicon\" [src]=\"mimeType | adfMimeTypeIcon\">\n                    <span class=\"adf-viewer__display-name\" id=\"adf-viewer-display-name\">{{ displayName }}</span>\n                    <button\n                        *ngIf=\"allowNavigate && canNavigateNext\"\n                        data-automation-id=\"toolbar-next-file\"\n                        mat-icon-button\n                        title=\"{{ 'ADF_VIEWER.ACTIONS.NEXT_FILE' | translate }}\"\n                        (click)=\"onNavigateNextClick()\">\n                        <mat-icon>navigate_next</mat-icon>\n                    </button>\n                </div>\n\n                <ng-content select=\"adf-viewer-toolbar-actions\"></ng-content>\n\n                <ng-container *ngIf=\"mnuOpenWith\">\n                    <button\n                        mat-button\n                        [matMenuTriggerFor]=\"mnuOpenWith\"\n                        data-automation-id=\"toolbar-open-with\">\n                        <span>{{ 'ADF_VIEWER.ACTIONS.OPEN_WITH' | translate }}</span>\n                        <mat-icon>arrow_drop_down</mat-icon>\n                    </button>\n                    <mat-menu #mnuOpenWith=\"matMenu\" [overlapTrigger]=\"false\">\n                        <ng-content select=\"adf-viewer-open-with\"></ng-content>\n                    </mat-menu>\n                </ng-container>\n\n                <adf-toolbar-divider></adf-toolbar-divider>\n\n                <button\n                    *ngIf=\"allowDownload\"\n                    mat-icon-button\n                    title=\"{{ 'ADF_VIEWER.ACTIONS.DOWNLOAD' | translate }}\"\n                    data-automation-id=\"toolbar-download\"\n                    (click)=\"downloadContent()\">\n                    <mat-icon>file_download</mat-icon>\n                </button>\n\n                <button\n                    *ngIf=\"allowPrint\"\n                    mat-icon-button\n                    title=\"{{ 'ADF_VIEWER.ACTIONS.PRINT' | translate }}\"\n                    data-automation-id=\"toolbar-print\"\n                    (click)=\"printContent()\">\n                    <mat-icon>print</mat-icon>\n                </button>\n\n                <button\n                    *ngIf=\"allowShare\"\n                    mat-icon-button\n                    title=\"{{ 'ADF_VIEWER.ACTIONS.SHARE' | translate }}\"\n                    data-automation-id=\"toolbar-share\"\n                    (click)=\"shareContent()\">\n                    <mat-icon>share</mat-icon>\n                </button>\n\n                <button\n                    *ngIf=\"viewerType !== 'media' && allowFullScreen\"\n                    mat-icon-button\n                    title=\"{{ 'ADF_VIEWER.ACTIONS.FULLSCREEN' | translate }}\"\n                    data-automation-id=\"toolbar-fullscreen\"\n                    (click)=\"enterFullScreen()\">\n                    <mat-icon>fullscreen</mat-icon>\n                </button>\n\n                <ng-container *ngIf=\"mnuMoreActions\">\n                    <button\n                        mat-icon-button\n                        [matMenuTriggerFor]=\"mnuMoreActions\"\n                        title=\"{{ 'ADF_VIEWER.ACTIONS.MORE_ACTIONS' | translate }}\"\n                        data-automation-id=\"toolbar-more-actions\">\n                        <mat-icon>more_vert</mat-icon>\n                    </button>\n                    <mat-menu #mnuMoreActions=\"matMenu\" [overlapTrigger]=\"false\">\n                        <ng-content select=\"adf-viewer-more-actions\"></ng-content>\n                    </mat-menu>\n                </ng-container>\n\n                <ng-container *ngIf=\"allowSidebar\">\n                    <adf-toolbar-divider></adf-toolbar-divider>\n\n                    <button\n                        mat-icon-button\n                        title=\"{{ 'ADF_VIEWER.ACTIONS.INFO' | translate }}\"\n                        data-automation-id=\"toolbar-sidebar\"\n                        [color]=\"showSidebar ? 'accent' : 'default'\"\n                        (click)=\"toggleSidebar($event)\">\n                        <mat-icon>info_outline</mat-icon>\n                    </button>\n                </ng-container>\n\n            </adf-toolbar>\n        </ng-container>\n\n        <ng-container *ngIf=\"isLoading\">\n            <div class=\"adf-viewer__loading-screen\" fxFlex=\"1 1 auto\">\n                <h2>{{ 'ADF_VIEWER.LOADING' | translate }}</h2>\n                <div>\n                    <mat-spinner></mat-spinner>\n                </div>\n            </div>\n        </ng-container>\n\n        <div *ngIf=\"!isLoading\" fxLayout=\"row\" fxFlex=\"1 1 auto\">\n\n            <ng-container *ngIf=\"allowSidebar && showSidebar\">\n                <div class=\"adf-viewer__sidebar adf-viewer__sidebar__{{sidebarPosition}}\" fxFlexOrder=\"{{sidebarPosition === 'left'? 1 : 4 }}\">\n                    <ng-container *ngIf=\"sidebarTemplate\">\n                        <ng-container *ngTemplateOutlet=\"sidebarTemplate;context:sidebarTemplateContext\"></ng-container>\n                    </ng-container>\n                    <ng-content *ngIf=\"!sidebarTemplate\" select=\"adf-viewer-sidebar\"></ng-content>\n                </div>\n            </ng-container>\n\n            <div class=\"adf-viewer-main\" fxFlexOrder=\"{{sidebarPosition !== 'left'? 1 : 4}}\" fxFlex=\"1 1 auto\">\n                <div class=\"adf-viewer-layout-content adf-viewer__fullscreen-container\">\n                    <div class=\"adf-viewer-content-container\" [ngSwitch]=\"viewerType\">\n                        <ng-container *ngSwitchCase=\"'pdf'\">\n                            <adf-pdf-viewer [thumbnailsTemplate]=\"thumbnailsTemplate\" [allowThumbnails]=\"allowThumbnails\" [blobFile]=\"blobFile\" [urlFile]=\"urlFileContent\" [nameFile]=\"displayName\"></adf-pdf-viewer>\n                        </ng-container>\n\n                        <ng-container *ngSwitchCase=\"'image'\">\n                            <adf-img-viewer [urlFile]=\"urlFileContent\" [nameFile]=\"displayName\" [blobFile]=\"blobFile\"></adf-img-viewer>\n                        </ng-container>\n\n                        <ng-container *ngSwitchCase=\"'media'\">\n                            <adf-media-player [urlFile]=\"urlFileContent\" [mimeType]=\"mimeType\" [blobFile]=\"blobFile\" [nameFile]=\"displayName\"></adf-media-player>\n                        </ng-container>\n\n                        <ng-container *ngSwitchCase=\"'text'\">\n                            <adf-txt-viewer [urlFile]=\"urlFileContent\" [blobFile]=\"blobFile\"></adf-txt-viewer>\n                        </ng-container>\n\n                        <ng-container *ngSwitchCase=\"'custom'\">\n                            <span class=\"adf-viewer-custom-content\" *ngFor=\"let extensionTemplate of extensionTemplates\">\n                                <ng-template *ngIf=\"extensionTemplate.isVisible\" [ngTemplateOutlet]=\"extensionTemplate.template\" [ngTemplateOutletContext]=\"{ urlFileContent: urlFileContent, extension:extension }\">\n                                </ng-template>\n                            </span>\n                        </ng-container>\n\n                        <ng-container *ngSwitchDefault>\n                            <adf-viewer-unknown-format></adf-viewer-unknown-format>\n                        </ng-container>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n    </div>\n</div>\n",
                styles: [""],
                host: { 'class': 'adf-viewer' },
                encapsulation: ViewEncapsulation.None
            },] },
];
ViewerComponent.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: LogService, },
    { type: Location, },
    { type: ElementRef, },
]; };
ViewerComponent.propDecorators = {
    "toolbar": [{ type: ContentChild, args: [ViewerToolbarComponent,] },],
    "sidebar": [{ type: ContentChild, args: [ViewerSidebarComponent,] },],
    "mnuOpenWith": [{ type: ContentChild, args: [ViewerOpenWithComponent,] },],
    "mnuMoreActions": [{ type: ContentChild, args: [ViewerMoreActionsComponent,] },],
    "urlFile": [{ type: Input },],
    "urlFileViewer": [{ type: Input },],
    "blobFile": [{ type: Input },],
    "fileNodeId": [{ type: Input },],
    "sharedLinkId": [{ type: Input },],
    "overlayMode": [{ type: Input },],
    "showViewer": [{ type: Input },],
    "showToolbar": [{ type: Input },],
    "displayName": [{ type: Input },],
    "allowGoBack": [{ type: Input },],
    "allowDownload": [{ type: Input },],
    "allowPrint": [{ type: Input },],
    "allowShare": [{ type: Input },],
    "allowFullScreen": [{ type: Input },],
    "allowNavigate": [{ type: Input },],
    "canNavigateBefore": [{ type: Input },],
    "canNavigateNext": [{ type: Input },],
    "allowSidebar": [{ type: Input },],
    "allowThumbnails": [{ type: Input },],
    "showSidebar": [{ type: Input },],
    "sidebarPosition": [{ type: Input },],
    "sidebarTemplate": [{ type: Input },],
    "thumbnailsTemplate": [{ type: Input },],
    "mimeType": [{ type: Input },],
    "fileName": [{ type: Input },],
    "downloadUrl": [{ type: Input },],
    "maxRetries": [{ type: Input },],
    "goBack": [{ type: Output },],
    "download": [{ type: Output },],
    "print": [{ type: Output },],
    "share": [{ type: Output },],
    "showViewerChange": [{ type: Output },],
    "extensionChange": [{ type: Output },],
    "navigateBefore": [{ type: Output },],
    "navigateNext": [{ type: Output },],
    "handleKeyboardEvent": [{ type: HostListener, args: ['document:keyup', ['$event'],] },],
};
var PermissionsEnum = /** @class */ (function (_super) {
    __extends(PermissionsEnum, _super);
    function PermissionsEnum() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return PermissionsEnum;
}(String));
PermissionsEnum.DELETE = 'delete';
PermissionsEnum.UPDATE = 'update';
PermissionsEnum.CREATE = 'create';
PermissionsEnum.COPY = 'copy';
PermissionsEnum.LOCK = 'lock';
PermissionsEnum.UPDATEPERMISSIONS = 'updatePermissions';
PermissionsEnum.NOT_DELETE = '!delete';
PermissionsEnum.NOT_UPDATE = '!update';
PermissionsEnum.NOT_CREATE = '!create';
PermissionsEnum.NOT_UPDATEPERMISSIONS = '!updatePermissions';
var CookieService = /** @class */ (function () {
    function CookieService() {
    }
    CookieService.prototype.isEnabled = function () {
        if (navigator.cookieEnabled === false) {
            return false;
        }
        document.cookie = 'test-cookie';
        return document.cookie.indexOf('test-cookie') > 0;
    };
    CookieService.prototype.getItem = function (key) {
        var regexp = new RegExp('(?:' + key + '|;\s*' + key + ')=(.*?)(?:;|$)', 'g');
        var result = regexp.exec(document.cookie);
        return (result === null) ? null : result[1];
    };
    CookieService.prototype.setItem = function (key, data, expiration, path) {
        document.cookie = key + "=" + data +
            (expiration ? ';expires=' + expiration.toUTCString() : '') +
            (path ? ";path=" + path : ';path=/');
    };
    return CookieService;
}());
CookieService.decorators = [
    { type: Injectable },
];
CookieService.ctorParameters = function () { return []; };
var UserPreferenceValues = {
    PaginationSize: 'PAGINATION_SIZE',
    DisableCSRF: 'DISABLE_CSRF',
    Locale: 'LOCALE',
    SupportedPageSizes: 'supportedPageSizes',
};
var UserPreferencesService = /** @class */ (function () {
    function UserPreferencesService(translate, appConfig, storage, apiService) {
        this.translate = translate;
        this.appConfig = appConfig;
        this.storage = storage;
        this.apiService = apiService;
        this.defaults = {
            paginationSize: 25,
            supportedPageSizes: [5, 10, 15, 20],
            locale: 'en'
        };
        this.userPreferenceStatus = {
            paginationSize: 25,
            supportedPageSizes: [5, 10, 15, 20],
            LOCALE: 'en'
        };
        this.appConfig.onLoad.subscribe(this.initUserPreferenceStatus.bind(this));
        this.localeSubject = new BehaviorSubject(this.defaults.locale);
        this.locale$ = this.localeSubject.asObservable();
        this.onChangeSubject = new BehaviorSubject(this.userPreferenceStatus);
        this.onChange = this.onChangeSubject.asObservable();
    }
    UserPreferencesService.prototype.initUserPreferenceStatus = function () {
        this.userPreferenceStatus[UserPreferenceValues.Locale] = this.locale || this.getDefaultLocale();
        this.userPreferenceStatus[UserPreferenceValues.PaginationSize] = this.appConfig.get('pagination.size', this.defaults.paginationSize);
        this.userPreferenceStatus[UserPreferenceValues.SupportedPageSizes] = this.appConfig.get('pagination.supportedPageSizes', this.defaults.supportedPageSizes);
        this.userPreferenceStatus[UserPreferenceValues.DisableCSRF] = this.disableCSRF;
    };
    UserPreferencesService.prototype.select = function (property) {
        return this.onChange.map(function (userPreferenceStatus) { return userPreferenceStatus[property]; }).distinctUntilChanged();
    };
    UserPreferencesService.prototype.get = function (property, defaultValue) {
        var key = this.getPropertyKey(property);
        var value = this.storage.getItem(key);
        if (value === undefined || value === null) {
            return defaultValue;
        }
        return value;
    };
    UserPreferencesService.prototype.set = function (property, value) {
        if (!property) {
            return;
        }
        this.storage.setItem(this.getPropertyKey(property), value);
        this.userPreferenceStatus[property] = value;
        this.onChangeSubject.next(this.userPreferenceStatus);
    };
    UserPreferencesService.prototype.getStoragePrefix = function () {
        return this.storage.getItem('USER_PROFILE') || 'GUEST';
    };
    UserPreferencesService.prototype.setStoragePrefix = function (value) {
        this.storage.setItem('USER_PROFILE', value || 'GUEST');
    };
    UserPreferencesService.prototype.getPropertyKey = function (property) {
        return this.getStoragePrefix() + "__" + property;
    };
    UserPreferencesService.prototype.getDefaultPageSizes = function () {
        return this.defaults.supportedPageSizes;
    };
    Object.defineProperty(UserPreferencesService.prototype, "authType", {
        get: function () {
            return this.storage.getItem('AUTH_TYPE') || 'ALL';
        },
        set: function (value) {
            this.storage.setItem('AUTH_TYPE', value);
            this.apiService.reset();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(UserPreferencesService.prototype, "disableCSRF", {
        get: function () {
            return this.get('DISABLE_CSRF') === 'true';
        },
        set: function (value) {
            this.set('DISABLE_CSRF', value);
            this.apiService.reset();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(UserPreferencesService.prototype, "paginationSize", {
        get: function () {
            return Number(this.get('PAGINATION_SIZE')) || this.defaults.paginationSize;
        },
        set: function (value) {
            this.set('PAGINATION_SIZE', value);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(UserPreferencesService.prototype, "locale", {
        get: function () {
            var locale = this.get('LOCALE');
            return locale;
        },
        set: function (value) {
            this.localeSubject.next(value);
            this.set('LOCALE', value);
        },
        enumerable: true,
        configurable: true
    });
    UserPreferencesService.prototype.getDefaultLocale = function () {
        return this.appConfig.get('locale') || this.translate.getBrowserLang() || 'en';
    };
    return UserPreferencesService;
}());
UserPreferencesService.decorators = [
    { type: Injectable },
];
UserPreferencesService.ctorParameters = function () { return [
    { type: TranslateService, },
    { type: AppConfigService, },
    { type: StorageService, },
    { type: AlfrescoApiService, },
]; };
var REMEMBER_ME_COOKIE_KEY = 'ALFRESCO_REMEMBER_ME';
var REMEMBER_ME_UNTIL = 1000 * 60 * 60 * 24 * 30;
var AuthenticationService = /** @class */ (function () {
    function AuthenticationService(preferences, alfrescoApi$$1, storage, cookie, logService) {
        this.preferences = preferences;
        this.alfrescoApi = alfrescoApi$$1;
        this.storage = storage;
        this.cookie = cookie;
        this.logService = logService;
        this.redirectUrl = null;
        this.onLogin = new Subject();
        this.onLogout = new Subject();
    }
    AuthenticationService.prototype.isLoggedIn = function () {
        return !!this.alfrescoApi.getInstance().isLoggedIn();
    };
    AuthenticationService.prototype.login = function (username, password, rememberMe) {
        var _this = this;
        if (rememberMe === void 0) { rememberMe = false; }
        this.removeTicket();
        return Observable.fromPromise(this.callApiLogin(username, password))
            .map(function (response) {
            _this.saveRememberMeCookie(rememberMe);
            _this.saveTickets();
            _this.onLogin.next(response);
            return {
                type: _this.preferences.authType,
                ticket: response
            };
        })
            .catch(function (err) { return _this.handleError(err); });
    };
    AuthenticationService.prototype.saveRememberMeCookie = function (rememberMe) {
        var expiration = null;
        if (rememberMe) {
            expiration = new Date();
            var time = expiration.getTime();
            var expireTime = time + REMEMBER_ME_UNTIL;
            expiration.setTime(expireTime);
        }
        this.cookie.setItem(REMEMBER_ME_COOKIE_KEY, '1', expiration, null);
    };
    AuthenticationService.prototype.isRememberMeSet = function () {
        return (this.cookie.getItem(REMEMBER_ME_COOKIE_KEY) === null) ? false : true;
    };
    AuthenticationService.prototype.callApiLogin = function (username, password) {
        return this.alfrescoApi.getInstance().login(username, password);
    };
    AuthenticationService.prototype.logout = function () {
        var _this = this;
        return Observable.fromPromise(this.callApiLogout())
            .do(function (response) {
            _this.removeTicket();
            _this.onLogout.next(response);
            return response;
        })
            .catch(function (err) { return _this.handleError(err); });
    };
    AuthenticationService.prototype.callApiLogout = function () {
        if (this.alfrescoApi.getInstance()) {
            return this.alfrescoApi.getInstance().logout();
        }
    };
    AuthenticationService.prototype.removeTicket = function () {
        this.storage.removeItem('ticket-ECM');
        this.storage.removeItem('ticket-BPM');
        this.alfrescoApi.getInstance().setTicket(undefined, undefined);
    };
    AuthenticationService.prototype.getTicketEcm = function () {
        return this.storage.getItem('ticket-ECM');
    };
    AuthenticationService.prototype.getTicketBpm = function () {
        return this.storage.getItem('ticket-BPM');
    };
    AuthenticationService.prototype.getTicketEcmBase64 = function () {
        var ticket = this.storage.getItem('ticket-ECM');
        if (ticket) {
            return 'Basic ' + btoa(ticket);
        }
        return null;
    };
    AuthenticationService.prototype.saveTickets = function () {
        this.saveTicketEcm();
        this.saveTicketBpm();
        this.saveTicketAuth();
    };
    AuthenticationService.prototype.saveTicketEcm = function () {
        if (this.alfrescoApi.getInstance() && this.alfrescoApi.getInstance().getTicketEcm()) {
            this.storage.setItem('ticket-ECM', this.alfrescoApi.getInstance().getTicketEcm());
        }
    };
    AuthenticationService.prototype.saveTicketBpm = function () {
        if (this.alfrescoApi.getInstance() && this.alfrescoApi.getInstance().getTicketBpm()) {
            this.storage.setItem('ticket-BPM', this.alfrescoApi.getInstance().getTicketBpm());
        }
    };
    AuthenticationService.prototype.saveTicketAuth = function () {
        if (this.alfrescoApi.getInstance() && ((this.alfrescoApi.getInstance())).getTicketAuth()) {
            this.storage.setItem('ticket-AUTH', ((this.alfrescoApi.getInstance())).getTicketAuth());
        }
    };
    AuthenticationService.prototype.isEcmLoggedIn = function () {
        if (this.cookie.isEnabled() && !this.isRememberMeSet()) {
            return false;
        }
        return this.alfrescoApi.getInstance().ecmAuth && !!this.alfrescoApi.getInstance().ecmAuth.isLoggedIn();
    };
    AuthenticationService.prototype.isBpmLoggedIn = function () {
        if (this.cookie.isEnabled() && !this.isRememberMeSet()) {
            return false;
        }
        return this.alfrescoApi.getInstance().bpmAuth && !!this.alfrescoApi.getInstance().bpmAuth.isLoggedIn();
    };
    AuthenticationService.prototype.getEcmUsername = function () {
        return this.alfrescoApi.getInstance().ecmAuth.username;
    };
    AuthenticationService.prototype.getBpmUsername = function () {
        return this.alfrescoApi.getInstance().bpmAuth.username;
    };
    AuthenticationService.prototype.setRedirectUrl = function (url) {
        this.redirectUrl = url;
    };
    AuthenticationService.prototype.getRedirectUrl = function (provider) {
        return this.hasValidRedirection(provider) ? this.redirectUrl.url : null;
    };
    AuthenticationService.prototype.hasValidRedirection = function (provider) {
        return this.redirectUrl && (this.redirectUrl.provider === provider || this.hasSelectedProviderAll(provider));
    };
    AuthenticationService.prototype.hasSelectedProviderAll = function (provider) {
        return this.redirectUrl && (this.redirectUrl.provider === 'ALL' || provider === 'ALL');
    };
    AuthenticationService.prototype.handleError = function (error) {
        this.logService.error('Error when logging in', error);
        return Observable.throw(error || 'Server error');
    };
    return AuthenticationService;
}());
AuthenticationService.decorators = [
    { type: Injectable },
];
AuthenticationService.ctorParameters = function () { return [
    { type: UserPreferencesService, },
    { type: AlfrescoApiService, },
    { type: StorageService, },
    { type: CookieService, },
    { type: LogService, },
]; };
var ContentService = /** @class */ (function () {
    function ContentService(authService, apiService, logService, sanitizer) {
        this.authService = authService;
        this.apiService = apiService;
        this.logService = logService;
        this.sanitizer = sanitizer;
        this.folderCreated = new Subject();
        this.folderCreate = new Subject();
        this.folderEdit = new Subject();
        this.saveData = (function () {
            var a = document.createElement('a');
            document.body.appendChild(a);
            a.style.display = 'none';
            return function (data, format, fileName) {
                var blob = null;
                if (format === 'blob' || format === 'data') {
                    blob = new Blob([data], { type: 'octet/stream' });
                }
                if (format === 'object' || format === 'json') {
                    var json = JSON.stringify(data);
                    blob = new Blob([json], { type: 'octet/stream' });
                }
                if (blob) {
                    if (typeof window.navigator !== 'undefined' && window.navigator.msSaveOrOpenBlob) {
                        navigator.msSaveOrOpenBlob(blob, fileName);
                    }
                    else {
                        var url = window.URL.createObjectURL(blob);
                        a.href = url;
                        a.download = fileName;
                        a.click();
                        window.URL.revokeObjectURL(url);
                    }
                }
            };
        }());
    }
    ContentService.prototype.downloadBlob = function (blob, fileName) {
        this.saveData(blob, 'blob', fileName);
    };
    ContentService.prototype.downloadData = function (data, fileName) {
        this.saveData(data, 'data', fileName);
    };
    ContentService.prototype.downloadJSON = function (json, fileName) {
        this.saveData(json, 'json', fileName);
    };
    ContentService.prototype.createTrustedUrl = function (blob) {
        var url = window.URL.createObjectURL(blob);
        return (this.sanitizer.bypassSecurityTrustUrl(url));
    };
    Object.defineProperty(ContentService.prototype, "contentApi", {
        get: function () {
            return this.apiService.getInstance().content;
        },
        enumerable: true,
        configurable: true
    });
    ContentService.prototype.getDocumentThumbnailUrl = function (node, attachment, ticket) {
        if (node && node.entry) {
            node = node.entry.id;
        }
        return this.contentApi.getDocumentThumbnailUrl(node, attachment, ticket);
    };
    ContentService.prototype.getContentUrl = function (node, attachment, ticket) {
        if (node && node.entry) {
            node = node.entry.id;
        }
        return this.contentApi.getContentUrl(node, attachment, ticket);
    };
    ContentService.prototype.getNodeContent = function (nodeId) {
        return Observable.fromPromise(this.apiService.getInstance().core.nodesApi.getFileContent(nodeId).then(function (dataContent) {
            return dataContent;
        })).catch(this.handleError);
    };
    ContentService.prototype.createFolder = function (relativePath, name, parentId) {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().nodes.createFolder(name, relativePath, parentId))
            .do(function (data) {
            _this.folderCreated.next(({
                relativePath: relativePath,
                name: name,
                parentId: parentId,
                node: data
            }));
        })
            .catch(function (err) { return _this.handleError(err); });
    };
    ContentService.prototype.getNode = function (nodeId, opts) {
        return Observable.fromPromise(this.apiService.getInstance().nodes.getNode(nodeId, opts));
    };
    ContentService.prototype.hasPermission = function (node, permission) {
        var hasPermission = false;
        if (this.hasAllowableOperations(node)) {
            if (permission && permission.startsWith('!')) {
                hasPermission = node.allowableOperations.find(function (currentPermission) { return currentPermission === permission.replace('!', ''); }) ? false : true;
            }
            else {
                hasPermission = node.allowableOperations.find(function (currentPermission) { return currentPermission === permission; }) ? true : false;
            }
        }
        else {
            if (permission && permission.startsWith('!')) {
                hasPermission = true;
            }
        }
        if (permission === PermissionsEnum.COPY) {
            hasPermission = true;
        }
        if (permission === PermissionsEnum.LOCK) {
            hasPermission = node.isFile;
            if (node.isLocked && this.hasAllowableOperations(node)) {
                hasPermission = !!~node.allowableOperations.indexOf('updatePermissions');
            }
        }
        return hasPermission;
    };
    ContentService.prototype.hasAllowableOperations = function (node) {
        return node && node.allowableOperations ? true : false;
    };
    ContentService.prototype.handleError = function (error) {
        this.logService.error(error);
        return Observable.throw(error || 'Server error');
    };
    return ContentService;
}());
ContentService.decorators = [
    { type: Injectable },
];
ContentService.ctorParameters = function () { return [
    { type: AuthenticationService, },
    { type: AlfrescoApiService, },
    { type: LogService, },
    { type: DomSanitizer, },
]; };
var ImgViewerComponent = /** @class */ (function () {
    function ImgViewerComponent(contentService, el) {
        this.contentService = contentService;
        this.el = el;
        this.showToolbar = true;
        this.rotate = 0;
        this.scaleX = 1.0;
        this.scaleY = 1.0;
        this.offsetX = 0;
        this.offsetY = 0;
        this.isDragged = false;
        this.drag = { x: 0, y: 0 };
        this.delta = { x: 0, y: 0 };
    }
    Object.defineProperty(ImgViewerComponent.prototype, "transform", {
        get: function () {
            return "scale(" + this.scaleX + ", " + this.scaleY + ") rotate(" + this.rotate + "deg) translate(" + this.offsetX + "px, " + this.offsetY + "px)";
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImgViewerComponent.prototype, "currentScaleText", {
        get: function () {
            return Math.round(this.scaleX * 100) + '%';
        },
        enumerable: true,
        configurable: true
    });
    ImgViewerComponent.prototype.ngOnInit = function () {
        this.element = (this.el.nativeElement.querySelector('#viewer-image'));
        if (this.element) {
            this.element.addEventListener('mousedown', this.onMouseDown.bind(this));
            this.element.addEventListener('mouseup', this.onMouseUp.bind(this));
            this.element.addEventListener('mouseleave', this.onMouseLeave.bind(this));
            this.element.addEventListener('mouseout', this.onMouseOut.bind(this));
            this.element.addEventListener('mousemove', this.onMouseMove.bind(this));
        }
    };
    ImgViewerComponent.prototype.ngOnDestroy = function () {
        if (this.element) {
            this.element.removeEventListener('mousedown', this.onMouseDown);
            this.element.removeEventListener('mouseup', this.onMouseUp);
            this.element.removeEventListener('mouseleave', this.onMouseLeave);
            this.element.removeEventListener('mouseout', this.onMouseOut);
            this.element.removeEventListener('mousemove', this.onMouseMove);
        }
    };
    ImgViewerComponent.prototype.onMouseDown = function (event) {
        event.preventDefault();
        this.isDragged = true;
        this.drag = { x: event.pageX, y: event.pageY };
    };
    ImgViewerComponent.prototype.onMouseMove = function (event) {
        if (this.isDragged) {
            event.preventDefault();
            this.delta.x = event.pageX - this.drag.x;
            this.delta.y = event.pageY - this.drag.y;
            this.drag.x = event.pageX;
            this.drag.y = event.pageY;
            var scaleX = (this.scaleX !== 0 ? this.scaleX : 1.0);
            var scaleY = (this.scaleY !== 0 ? this.scaleY : 1.0);
            this.offsetX += (this.delta.x / scaleX);
            this.offsetY += (this.delta.y / scaleY);
        }
    };
    ImgViewerComponent.prototype.onMouseUp = function (event) {
        if (this.isDragged) {
            event.preventDefault();
            this.isDragged = false;
        }
    };
    ImgViewerComponent.prototype.onMouseLeave = function (event) {
        if (this.isDragged) {
            event.preventDefault();
            this.isDragged = false;
        }
    };
    ImgViewerComponent.prototype.onMouseOut = function (event) {
        if (this.isDragged) {
            event.preventDefault();
            this.isDragged = false;
        }
    };
    ImgViewerComponent.prototype.ngOnChanges = function (changes) {
        var blobFile = changes['blobFile'];
        if (blobFile && blobFile.currentValue) {
            this.urlFile = this.contentService.createTrustedUrl(this.blobFile);
            return;
        }
        if (!this.urlFile && !this.blobFile) {
            throw new Error('Attribute urlFile or blobFile is required');
        }
    };
    ImgViewerComponent.prototype.zoomIn = function () {
        var ratio = +((this.scaleX + 0.2).toFixed(1));
        this.scaleX = this.scaleY = ratio;
    };
    ImgViewerComponent.prototype.zoomOut = function () {
        var ratio = +((this.scaleX - 0.2).toFixed(1));
        if (ratio < 0.2) {
            ratio = 0.2;
        }
        this.scaleX = this.scaleY = ratio;
    };
    ImgViewerComponent.prototype.rotateLeft = function () {
        var angle = this.rotate - 90;
        this.rotate = Math.abs(angle) < 360 ? angle : 0;
    };
    ImgViewerComponent.prototype.rotateRight = function () {
        var angle = this.rotate + 90;
        this.rotate = Math.abs(angle) < 360 ? angle : 0;
    };
    ImgViewerComponent.prototype.reset = function () {
        this.rotate = 0;
        this.scaleX = 1.0;
        this.scaleY = 1.0;
        this.offsetX = 0;
        this.offsetY = 0;
    };
    return ImgViewerComponent;
}());
ImgViewerComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-img-viewer',
                template: "<div class=\"image-container\" [ngStyle]=\"{ transform: transform }\">\n    <img id=\"viewer-image\" [src]=\"urlFile\" [alt]=\"nameFile\" [ngStyle]=\"{ 'cursor' : isDragged ? 'move': 'default' } \" />\n</div>\n\n<div class=\"adf-image-viewer__toolbar\" *ngIf=\"showToolbar\">\n    <adf-toolbar>\n        <button\n            id=\"viewer-zoom-in-button\"\n            mat-icon-button\n            title=\"{{ 'ADF_VIEWER.ARIA.ZOOM_IN' | translate }}\"\n            attr.aria-label=\"{{ 'ADF_VIEWER.ARIA.ZOOM_IN' | translate }}\"\n            (click)=\"zoomIn()\">\n            <mat-icon>zoom_in</mat-icon>\n        </button>\n\n        <button\n            id=\"viewer-zoom-out-button\"\n            title=\"{{ 'ADF_VIEWER.ARIA.ZOOM_OUT' | translate }}\"\n            attr.aria-label=\"{{ 'ADF_VIEWER.ARIA.ZOOM_OUT' | translate }}\"\n            mat-icon-button\n            (click)=\"zoomOut()\">\n            <mat-icon>zoom_out</mat-icon>\n        </button>\n\n        <div class=\"adf-viewer__toolbar-page-scale\">\n            {{ currentScaleText }}\n        </div>\n\n        <button\n            id=\"viewer-rotate-left-button\"\n            title=\"{{ 'ADF_VIEWER.ARIA.ROTATE_LEFT' | translate }}\"\n            attr.aria-label=\"{{ 'ADF_VIEWER.ARIA.ROTATE_LEFT' | translate }}\"\n            mat-icon-button\n            (click)=\"rotateLeft()\">\n            <mat-icon>rotate_left</mat-icon>\n        </button>\n\n        <button\n            id=\"viewer-rotate-right-button\"\n            title=\"{{ 'ADF_VIEWER.ARIA.ROTATE_RIGHT' | translate }}\"\n            attr.aria-label=\"{{ 'ADF_VIEWER.ARIA.ROTATE_RIGHT' | translate }}\"\n            mat-icon-button\n            (click)=\"rotateRight()\">\n            <mat-icon>rotate_right</mat-icon>\n        </button>\n\n        <button\n            id=\"viewer-reset-button\"\n            title=\"{{ 'ADF_VIEWER.ARIA.RESET' | translate }}\"\n            attr.aria-label=\"{{ 'ADF_VIEWER.ARIA.RESET' | translate }}\"\n            mat-icon-button\n            (click)=\"reset()\">\n            <mat-icon>zoom_out_map</mat-icon>\n        </button>\n    </adf-toolbar>\n</div>\n",
                styles: [""],
                host: { 'class': 'adf-image-viewer' },
                encapsulation: ViewEncapsulation.None
            },] },
];
ImgViewerComponent.ctorParameters = function () { return [
    { type: ContentService, },
    { type: ElementRef, },
]; };
ImgViewerComponent.propDecorators = {
    "showToolbar": [{ type: Input },],
    "urlFile": [{ type: Input },],
    "blobFile": [{ type: Input },],
    "nameFile": [{ type: Input },],
};
var MediaPlayerComponent = /** @class */ (function () {
    function MediaPlayerComponent(contentService) {
        this.contentService = contentService;
    }
    MediaPlayerComponent.prototype.ngOnChanges = function (changes) {
        var blobFile = changes['blobFile'];
        if (blobFile && blobFile.currentValue) {
            this.urlFile = this.contentService.createTrustedUrl(this.blobFile);
            return;
        }
        if (!this.urlFile && !this.blobFile) {
            throw new Error('Attribute urlFile or blobFile is required');
        }
    };
    return MediaPlayerComponent;
}());
MediaPlayerComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-media-player',
                template: "<video controls>\n    <source [src]=\"urlFile\" [type]=\"mimeType\" />\n</video>\n",
                styles: [".adf-media-player{display:-webkit-box;display:-ms-flexbox;display:flex}.adf-media-player video{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1;flex:1;max-height:90vh;max-width:100%}"],
                host: { 'class': 'adf-media-player' },
                encapsulation: ViewEncapsulation.None
            },] },
];
MediaPlayerComponent.ctorParameters = function () { return [
    { type: ContentService, },
]; };
MediaPlayerComponent.propDecorators = {
    "urlFile": [{ type: Input },],
    "blobFile": [{ type: Input },],
    "mimeType": [{ type: Input },],
    "nameFile": [{ type: Input },],
};
var RenderingQueueServices = /** @class */ (function () {
    function RenderingQueueServices() {
        this.renderingStates = {
            INITIAL: 0,
            RUNNING: 1,
            PAUSED: 2,
            FINISHED: 3
        };
        this.CLEANUP_TIMEOUT = 30000;
        this.pdfViewer = null;
        this.pdfThumbnailViewer = null;
        this.onIdle = null;
        this.highestPriorityPage = null;
        this.idleTimeout = null;
        this.printing = false;
        this.isThumbnailViewEnabled = false;
    }
    RenderingQueueServices.prototype.setViewer = function (pdfViewer) {
        this.pdfViewer = pdfViewer;
    };
    RenderingQueueServices.prototype.setThumbnailViewer = function (pdfThumbnailViewer) {
        this.pdfThumbnailViewer = pdfThumbnailViewer;
    };
    RenderingQueueServices.prototype.isHighestPriority = function (view) {
        return this.highestPriorityPage === view.renderingId;
    };
    RenderingQueueServices.prototype.renderHighestPriority = function (currentlyVisiblePages) {
        if (this.idleTimeout) {
            clearTimeout(this.idleTimeout);
            this.idleTimeout = null;
        }
        if (this.pdfViewer.forceRendering(currentlyVisiblePages)) {
            return;
        }
        if (this.pdfThumbnailViewer && this.isThumbnailViewEnabled) {
            if (this.pdfThumbnailViewer.forceRendering()) {
                return;
            }
        }
        if (this.printing) {
            return;
        }
        if (this.onIdle) {
            this.idleTimeout = setTimeout(this.onIdle.bind(this), this.CLEANUP_TIMEOUT);
        }
    };
    RenderingQueueServices.prototype.getHighestPriority = function (visible, views, scrolledDown) {
        var visibleViews = visible.views;
        var numVisible = visibleViews.length;
        if (numVisible === 0) {
            return false;
        }
        for (var i = 0; i < numVisible; ++i) {
            var view = visibleViews[i].view;
            if (!this.isViewFinished(view)) {
                return view;
            }
        }
        if (scrolledDown) {
            var nextPageIndex = visible.last.id;
            if (views[nextPageIndex] && !this.isViewFinished(views[nextPageIndex])) {
                return views[nextPageIndex];
            }
        }
        else {
            var previousPageIndex = visible.first.id - 2;
            if (views[previousPageIndex] && !this.isViewFinished(views[previousPageIndex])) {
                return views[previousPageIndex];
            }
        }
        return null;
    };
    RenderingQueueServices.prototype.isViewFinished = function (view) {
        return view.renderingState === this.renderingStates.FINISHED;
    };
    RenderingQueueServices.prototype.renderView = function (view) {
        var state$$1 = view.renderingState;
        switch (state$$1) {
            case this.renderingStates.FINISHED:
                return false;
            case this.renderingStates.PAUSED:
                this.highestPriorityPage = view.renderingId;
                view.resume();
                break;
            case this.renderingStates.RUNNING:
                this.highestPriorityPage = view.renderingId;
                break;
            case this.renderingStates.INITIAL:
                this.highestPriorityPage = view.renderingId;
                var continueRendering = function () {
                    this.renderHighestPriority();
                }.bind(this);
                view.draw().then(continueRendering, continueRendering);
                break;
            default:
                break;
        }
        return true;
    };
    return RenderingQueueServices;
}());
RenderingQueueServices.decorators = [
    { type: Injectable },
];
RenderingQueueServices.ctorParameters = function () { return []; };
var PdfPasswordDialogComponent = /** @class */ (function () {
    function PdfPasswordDialogComponent(dialogRef, data) {
        this.dialogRef = dialogRef;
        this.data = data;
    }
    PdfPasswordDialogComponent.prototype.ngOnInit = function () {
        this.passwordFormControl = new FormControl('', [Validators.required]);
    };
    PdfPasswordDialogComponent.prototype.isError = function () {
        return this.data.reason === PDFJS.PasswordResponses.INCORRECT_PASSWORD;
    };
    PdfPasswordDialogComponent.prototype.isValid = function () {
        return !this.passwordFormControl.hasError('required');
    };
    PdfPasswordDialogComponent.prototype.submit = function () {
        this.dialogRef.close(this.passwordFormControl.value);
    };
    return PdfPasswordDialogComponent;
}());
PdfPasswordDialogComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-pdf-viewer-password-dialog',
                template: "<div mat-dialog-title>\n    <mat-icon>lock</mat-icon>\n</div>\n\n<mat-dialog-content>\n    <form (submit)=\"submit()\">\n        <mat-input-container class=\"adf-full-width\">\n                <input matInput\n                type=\"password\"\n                placeholder=\"{{ 'ADF_VIEWER.PDF_DIALOG.PLACEHOLDER' | translate }}\"\n                [formControl]=\"passwordFormControl\" />\n        </mat-input-container>\n\n        <mat-error *ngIf=\"isError()\">{{ 'ADF_VIEWER.PDF_DIALOG.ERROR' | translate }}</mat-error>\n    </form>\n</mat-dialog-content>\n\n<mat-dialog-actions class=\"adf-dialog-buttons\">\n    <span class=\"adf-fill-remaining-space\"></span>\n\n    <button mat-button mat-dialog-close>{{ 'ADF_VIEWER.PDF_DIALOG.CLOSE' | translate }}</button>\n\n    <button mat-button\n        class=\"adf-dialog-action-button\"\n        [disabled]=\"!isValid()\"\n        (click)=\"submit()\">\n        {{ 'ADF_VIEWER.PDF_DIALOG.SUBMIT' | translate }}\n    </button>\n</mat-dialog-actions>",
                styles: [".adf-fill-remaining-space{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}.adf-full-width{width:100%}"]
            },] },
];
PdfPasswordDialogComponent.ctorParameters = function () { return [
    { type: MatDialogRef, },
    { type: undefined, decorators: [{ type: Inject, args: [MAT_DIALOG_DATA,] },] },
]; };
var PdfViewerComponent = /** @class */ (function () {
    function PdfViewerComponent(dialog, renderingQueueServices, logService) {
        this.dialog = dialog;
        this.renderingQueueServices = renderingQueueServices;
        this.logService = logService;
        this.showToolbar = true;
        this.allowThumbnails = false;
        this.thumbnailsTemplate = null;
        this.rendered = new EventEmitter();
        this.error = new EventEmitter();
        this.currentScaleMode = 'auto';
        this.currentScale = 1;
        this.MAX_AUTO_SCALE = 1.25;
        this.DEFAULT_SCALE_DELTA = 1.1;
        this.MIN_SCALE = 0.25;
        this.MAX_SCALE = 10.0;
        this.isPanelDisabled = true;
        this.showThumbnails = false;
        this.pdfThumbnailsContext = { viewer: null };
        this.onPageChange = this.onPageChange.bind(this);
        this.onPagesLoaded = this.onPagesLoaded.bind(this);
        this.onPagerendered = this.onPagerendered.bind(this);
    }
    Object.defineProperty(PdfViewerComponent.prototype, "currentScaleText", {
        get: function () {
            return Math.round(this.currentScale * 100) + '%';
        },
        enumerable: true,
        configurable: true
    });
    PdfViewerComponent.prototype.ngOnChanges = function (changes) {
        var _this = this;
        var blobFile = changes['blobFile'];
        if (blobFile && blobFile.currentValue) {
            var reader_1 = new FileReader();
            reader_1.onload = function () {
                _this.executePdf(reader_1.result);
            };
            reader_1.readAsArrayBuffer(blobFile.currentValue);
        }
        var urlFile = changes['urlFile'];
        if (urlFile && urlFile.currentValue) {
            this.executePdf(urlFile.currentValue);
        }
        if (!this.urlFile && !this.blobFile) {
            throw new Error('Attribute urlFile or blobFile is required');
        }
    };
    PdfViewerComponent.prototype.executePdf = function (src) {
        var _this = this;
        this.loadingTask = this.getPDFJS().getDocument(src);
        this.loadingTask.onPassword = function (callback, reason) {
            _this.onPdfPassword(callback, reason);
        };
        this.loadingTask.onProgress = function (progressData) {
            var level = progressData.loaded / progressData.total;
            _this.loadingPercent = Math.round(level * 100);
        };
        this.loadingTask.then(function (pdfDocument) {
            _this.currentPdfDocument = pdfDocument;
            _this.totalPages = pdfDocument.numPages;
            _this.page = 1;
            _this.displayPage = 1;
            _this.initPDFViewer(_this.currentPdfDocument);
            _this.currentPdfDocument.getPage(1).then(function () {
                _this.scalePage('auto');
            }, function (error) {
                _this.error.emit();
            });
        }, function (error) {
            _this.error.emit();
        });
    };
    PdfViewerComponent.prototype.getPDFJS = function () {
        return PDFJS;
    };
    PdfViewerComponent.prototype.initPDFViewer = function (pdfDocument) {
        PDFJS.verbosity = 1;
        PDFJS.disableWorker = false;
        var viewer = document.getElementById('viewer-viewerPdf');
        this.documentContainer = document.getElementById('viewer-pdf-viewer');
        this.documentContainer.addEventListener('pagechange', this.onPageChange, true);
        this.documentContainer.addEventListener('pagesloaded', this.onPagesLoaded, true);
        this.documentContainer.addEventListener('textlayerrendered', this.onPagerendered, true);
        this.pdfViewer = new PDFJS.PDFViewer({
            container: this.documentContainer,
            viewer: viewer,
            renderingQueue: this.renderingQueueServices
        });
        this.renderingQueueServices.setViewer(this.pdfViewer);
        this.pdfViewer.setDocument(pdfDocument);
        this.pdfThumbnailsContext.viewer = this.pdfViewer;
    };
    PdfViewerComponent.prototype.ngOnDestroy = function () {
        if (this.documentContainer) {
            this.documentContainer.removeEventListener('pagechange', this.onPageChange, true);
            this.documentContainer.removeEventListener('pagesloaded', this.onPagesLoaded, true);
            this.documentContainer.removeEventListener('textlayerrendered', this.onPagerendered, true);
        }
        if (this.loadingTask) {
            this.loadingTask.destroy();
        }
    };
    PdfViewerComponent.prototype.toggleThumbnails = function () {
        this.showThumbnails = !this.showThumbnails;
    };
    PdfViewerComponent.prototype.scalePage = function (scaleMode) {
        this.currentScaleMode = scaleMode;
        if (this.pdfViewer) {
            var viewerContainer = document.getElementById('viewer-main-container');
            var documentContainer = document.getElementById('viewer-pdf-viewer');
            var widthContainer = void 0;
            var heightContainer = void 0;
            if (viewerContainer && viewerContainer.clientWidth <= documentContainer.clientWidth) {
                widthContainer = viewerContainer.clientWidth;
                heightContainer = viewerContainer.clientHeight;
            }
            else {
                widthContainer = documentContainer.clientWidth;
                heightContainer = documentContainer.clientHeight;
            }
            var currentPage = this.pdfViewer._pages[this.pdfViewer._currentPageNumber - 1];
            var padding = 20;
            var pageWidthScale = (widthContainer - padding) / currentPage.width * currentPage.scale;
            var pageHeightScale = (heightContainer - padding) / currentPage.width * currentPage.scale;
            var scale = void 0;
            switch (this.currentScaleMode) {
                case 'page-actual':
                    scale = 1;
                    break;
                case 'page-width':
                    scale = pageWidthScale;
                    break;
                case 'page-height':
                    scale = pageHeightScale;
                    break;
                case 'page-fit':
                    scale = Math.min(pageWidthScale, pageHeightScale);
                    break;
                case 'auto':
                    var horizontalScale = void 0;
                    if (this.isLandscape) {
                        horizontalScale = Math.min(pageHeightScale, pageWidthScale);
                    }
                    else {
                        horizontalScale = pageWidthScale;
                    }
                    scale = Math.min(this.MAX_AUTO_SCALE, horizontalScale);
                    break;
                default:
                    this.logService.error('pdfViewSetScale: \'' + scaleMode + '\' is an unknown zoom value.');
                    return;
            }
            this.setScaleUpdatePages(scale);
        }
    };
    PdfViewerComponent.prototype.setScaleUpdatePages = function (newScale) {
        if (!this.isSameScale(this.currentScale, newScale)) {
            this.currentScale = newScale;
            this.pdfViewer._pages.forEach(function (currentPage) {
                currentPage.update(newScale);
            });
            this.pdfViewer.update();
        }
    };
    PdfViewerComponent.prototype.isSameScale = function (oldScale, newScale) {
        return (newScale === oldScale);
    };
    PdfViewerComponent.prototype.isLandscape = function (width, height) {
        return (width > height);
    };
    PdfViewerComponent.prototype.onResize = function () {
        this.scalePage(this.currentScaleMode);
    };
    PdfViewerComponent.prototype.pageFit = function () {
        if (this.currentScaleMode !== 'page-fit') {
            this.scalePage('page-fit');
        }
        else {
            this.scalePage('auto');
        }
    };
    PdfViewerComponent.prototype.zoomIn = function (ticks) {
        var newScale = this.currentScale;
        do {
            newScale = (newScale * this.DEFAULT_SCALE_DELTA).toFixed(2);
            newScale = Math.ceil(newScale * 10) / 10;
            newScale = Math.min(this.MAX_SCALE, newScale);
        } while (--ticks > 0 && newScale < this.MAX_SCALE);
        this.currentScaleMode = 'auto';
        this.setScaleUpdatePages(newScale);
    };
    PdfViewerComponent.prototype.zoomOut = function (ticks) {
        var newScale = this.currentScale;
        do {
            newScale = (newScale / this.DEFAULT_SCALE_DELTA).toFixed(2);
            newScale = Math.floor(newScale * 10) / 10;
            newScale = Math.max(this.MIN_SCALE, newScale);
        } while (--ticks > 0 && newScale > this.MIN_SCALE);
        this.currentScaleMode = 'auto';
        this.setScaleUpdatePages(newScale);
    };
    PdfViewerComponent.prototype.previousPage = function () {
        if (this.pdfViewer && this.page > 1) {
            this.page--;
            this.displayPage = this.page;
            this.pdfViewer.currentPageNumber = this.page;
        }
    };
    PdfViewerComponent.prototype.nextPage = function () {
        if (this.pdfViewer && this.page < this.totalPages) {
            this.page++;
            this.displayPage = this.page;
            this.pdfViewer.currentPageNumber = this.page;
        }
    };
    PdfViewerComponent.prototype.inputPage = function (page) {
        var pageInput = parseInt(page, 10);
        if (!isNaN(pageInput) && pageInput > 0 && pageInput <= this.totalPages) {
            this.page = pageInput;
            this.displayPage = this.page;
            this.pdfViewer.currentPageNumber = this.page;
        }
        else {
            this.displayPage = this.page;
        }
    };
    PdfViewerComponent.prototype.onPageChange = function (event) {
        this.page = event.pageNumber;
        this.displayPage = event.pageNumber;
    };
    PdfViewerComponent.prototype.onPdfPassword = function (callback, reason) {
        this.dialog
            .open(PdfPasswordDialogComponent, {
            width: '400px',
            disableClose: true,
            data: { reason: reason }
        })
            .afterClosed().subscribe(function (password) {
            if (password) {
                callback(password);
            }
        });
    };
    PdfViewerComponent.prototype.onPagerendered = function () {
        this.rendered.emit();
    };
    PdfViewerComponent.prototype.onPagesLoaded = function (event) {
        this.isPanelDisabled = false;
    };
    PdfViewerComponent.prototype.handleKeyboardEvent = function (event) {
        var key = event.keyCode;
        if (key === 39) {
            this.nextPage();
        }
        else if (key === 37) {
            this.previousPage();
        }
    };
    return PdfViewerComponent;
}());
PdfViewerComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-pdf-viewer',
                template: "<div class=\"adf-pdf-viewer__container\">\n    <ng-container *ngIf=\"showThumbnails\">\n        <div class=\"adf-pdf-viewer__thumbnails\">\n            <div class=\"thumbnails-template__container\">\n                <div class=\"thumbnails-template__buttons\">\n                    <button mat-icon-button (click)=\"toggleThumbnails()\">\n                            <mat-icon>close</mat-icon>\n                    </button>\n                </div>\n\n                <ng-container *ngIf=\"thumbnailsTemplate\">\n                    <ng-container *ngTemplateOutlet=\"thumbnailsTemplate;context:pdfThumbnailsContext\"></ng-container>\n                </ng-container>\n\n                <ng-container *ngIf=\"!thumbnailsTemplate\">\n                    <adf-pdf-thumbnails [pdfViewer]=\"pdfViewer\"></adf-pdf-thumbnails>\n                </ng-container>\n            </div>\n        </div>\n    </ng-container>\n\n    <div class=\"adf-pdf-viewer__content\">\n        <div id=\"viewer-pdf-viewer\" class=\"viewer-pdf-viewer\" (window:resize)=\"onResize()\">\n            <div id=\"viewer-viewerPdf\" class=\"pdfViewer\">\n                <div id=\"loader-container\" class=\"loader-container\">\n                    <div class=\"loader-item\">\n                        <mat-progress-bar mode=\"indeterminate\"></mat-progress-bar>\n                    </div >\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class=\"adf-pdf-viewer__toolbar\" *ngIf=\"showToolbar\">\n    <adf-toolbar>\n\n        <ng-container *ngIf=\"allowThumbnails\">\n            <button mat-icon-button\n                [disabled]=\"isPanelDisabled\"\n                (click)=\"toggleThumbnails()\">\n                <mat-icon>dashboard</mat-icon>\n            </button>\n            <adf-toolbar-divider></adf-toolbar-divider>\n        </ng-container>\n\n        <button\n            id=\"viewer-previous-page-button\"\n            title=\"{{ 'ADF_VIEWER.ARIA.PREVIOUS_PAGE' | translate }}\"\n            attr.aria-label=\"{{ 'ADF_VIEWER.ARIA.PREVIOUS_PAGE' | translate }}\"\n            mat-icon-button\n            (click)=\"previousPage()\">\n            <mat-icon>keyboard_arrow_up</mat-icon>\n        </button>\n\n        <button\n            id=\"viewer-next-page-button\"\n            title=\"{{ 'ADF_VIEWER.ARIA.NEXT_PAGE' | translate }}\"\n            attr.aria-label=\"{{ 'ADF_VIEWER.ARIA.NEXT_PAGE' | translate }}\"\n            mat-icon-button\n            (click)=\"nextPage()\">\n            <mat-icon>keyboard_arrow_down</mat-icon>\n        </button>\n\n        <div class=\"adf-pdf-viewer__toolbar-page-selector\">\n            <span>{{ 'ADF_VIEWER.PAGE_LABEL.SHOWING' | translate }}</span>\n            <input #page\n                type=\"text\"\n                pattern=\"-?[0-9]*(.[0-9]+)?\"\n                value=\"{{ displayPage }}\"\n                (keyup.enter)=\"inputPage(page.value)\">\n            <span>{{ 'ADF_VIEWER.PAGE_LABEL.OF' | translate }} {{ totalPages }}</span>\n        </div>\n\n        <div class=\"adf-viewer__toolbar-page-scale\">\n            {{ currentScaleText }}\n        </div>\n\n        <button\n            id=\"viewer-zoom-in-button\"\n            title=\"{{ 'ADF_VIEWER.ARIA.ZOOM_IN' | translate }}\"\n            attr.aria-label=\"{{ 'ADF_VIEWER.ARIA.ZOOM_IN' | translate }}\"\n            mat-icon-button\n            (click)=\"zoomIn()\">\n            <mat-icon>zoom_in</mat-icon>\n        </button>\n\n        <button\n            id=\"viewer-zoom-out-button\"\n            title=\"{{ 'ADF_VIEWER.ARIA.ZOOM_OUT' | translate }}\"\n            attr.aria-label=\"{{ 'ADF_VIEWER.ARIA.ZOOM_OUT' | translate }}\"\n            mat-icon-button\n            (click)=\"zoomOut()\">\n            <mat-icon>zoom_out</mat-icon>\n        </button>\n\n        <button\n            id=\"viewer-scale-page-button\"\n            title=\"{{ 'ADF_VIEWER.ARIA.FIT_PAGE' | translate }}\"\n            attr.aria-label=\"{{ 'ADF_VIEWER.ARIA.FIT_PAGE' | translate }}\"\n            mat-icon-button\n            (click)=\"pageFit()\">\n            <mat-icon>zoom_out_map</mat-icon>\n        </button>\n\n    </adf-toolbar>\n</div>\n",
                styles: ["", ".adf-pdf-viewer .textLayer{position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;opacity:.2;line-height:1;border:1px solid gray}.adf-pdf-viewer .textLayer>div{color:transparent;position:absolute;white-space:pre;cursor:text;-webkit-transform-origin:0 0;transform-origin:0 0}.adf-pdf-viewer .textLayer .highlight{margin:-1px;padding:1px;background-color:#b400aa;border-radius:4px}.adf-pdf-viewer .textLayer .highlight.begin{border-radius:4px 0 0 4px}.adf-pdf-viewer .textLayer .highlight.end{border-radius:0 4px 4px 0}.adf-pdf-viewer .textLayer .highlight.middle{border-radius:0}.adf-pdf-viewer .textLayer .highlight.selected{background-color:#006400}.adf-pdf-viewer .textLayer::selection{background:#00f}.adf-pdf-viewer .textLayer::-moz-selection{background:#00f}.adf-pdf-viewer .textLayer .endOfContent{display:block;position:absolute;left:0;top:100%;right:0;bottom:0;z-index:-1;cursor:default;user-select:none;-webkit-user-select:none;-ms-user-select:none;-moz-user-select:none}.adf-pdf-viewer .textLayer .endOfContent.active{top:0}.adf-pdf-viewer .annotationLayer section{position:absolute}.adf-pdf-viewer .annotationLayer .linkAnnotation>a{position:absolute;font-size:1em;top:0;left:0;width:100%;height:100%;background:url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)}.adf-pdf-viewer .annotationLayer .linkAnnotation>a:hover{opacity:.2;background:#ff0;-webkit-box-shadow:0 2px 10px #ff0;box-shadow:0 2px 10px #ff0}.adf-pdf-viewer .annotationLayer .textAnnotation img{position:absolute;cursor:pointer}.adf-pdf-viewer .annotationLayer .popupWrapper{position:absolute;width:20em}.adf-pdf-viewer .annotationLayer .popup{position:absolute;z-index:200;max-width:20em;background-color:#ff9;-webkit-box-shadow:0 2px 5px #333;box-shadow:0 2px 5px #333;border-radius:2px;padding:.6em;margin-left:5px;cursor:pointer;word-wrap:break-word}.adf-pdf-viewer .annotationLayer .popup h1{font-size:1em;border-bottom:1px solid #000;padding-bottom:.2em}.adf-pdf-viewer .annotationLayer .popup p{padding-top:.2em}.adf-pdf-viewer .annotationLayer .fileAttachmentAnnotation,.adf-pdf-viewer .annotationLayer .highlightAnnotation,.adf-pdf-viewer .annotationLayer .squigglyAnnotation,.adf-pdf-viewer .annotationLayer .strikeoutAnnotation,.adf-pdf-viewer .annotationLayer .underlineAnnotation{cursor:pointer}.adf-pdf-viewer .pdfViewer canvasWrapper{overflow:hidden}.adf-pdf-viewer .pdfViewer .page{direction:ltr;width:816px;height:1056px;margin:1px auto -8px;position:relative;overflow:visible;border:9px solid transparent;background-clip:content-box;background-color:#fff}.adf-pdf-viewer .pdfViewer .page canvas{margin:0;display:block}.adf-pdf-viewer .pdfViewer .page .loadingIcon{position:absolute;display:block;left:0;top:0;right:0;bottom:0}.adf-pdf-viewer .pdfViewer .page *{padding:0;margin:0}.adf-pdf-viewer .pdfViewer.removePageBorders .page{margin:0 auto 10px;border:none}.adf-pdf-viewer .pdfViewer .loadingIcon{width:100px;height:100px;left:50%!important;top:50%!important;margin-top:-50px;margin-left:-50px;font-size:5px;text-indent:-9999em;border-top:1.1em solid rgba(3,0,2,.2);border-right:1.1em solid rgba(3,0,2,.2);border-bottom:1.1em solid rgba(3,0,2,.2);border-left:1.1em solid #030002;-webkit-transform:translateZ(0);transform:translateZ(0);-webkit-animation:1.1s linear infinite load8;animation:1.1s linear infinite load8;border-radius:50%}.adf-pdf-viewer .pdfViewer .loadingIcon:after{border-radius:50%}.adf-pdf-viewer .hidden,.adf-pdf-viewer [hidden]{display:none!important}@-webkit-keyframes load8{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes load8{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.viewer-pdf-viewer{overflow:auto;-webkit-overflow-scrolling:touch;position:absolute;top:0;right:0;bottom:0;left:0;outline:0}html[dir=ltr] .viewer-pdf-viewer{-webkit-box-shadow:inset 1px 0 0 rgba(255,255,255,.05);box-shadow:inset 1px 0 0 rgba(255,255,255,.05)}html[dir=rtl] .viewer-pdf-viewer{-webkit-box-shadow:inset -1px 0 0 rgba(255,255,255,.05);box-shadow:inset -1px 0 0 rgba(255,255,255,.05)}"],
                providers: [RenderingQueueServices],
                host: { 'class': 'adf-pdf-viewer' },
                encapsulation: ViewEncapsulation.None
            },] },
];
PdfViewerComponent.ctorParameters = function () { return [
    { type: MatDialog, },
    { type: RenderingQueueServices, },
    { type: LogService, },
]; };
PdfViewerComponent.propDecorators = {
    "urlFile": [{ type: Input },],
    "blobFile": [{ type: Input },],
    "nameFile": [{ type: Input },],
    "showToolbar": [{ type: Input },],
    "allowThumbnails": [{ type: Input },],
    "thumbnailsTemplate": [{ type: Input },],
    "rendered": [{ type: Output },],
    "error": [{ type: Output },],
    "handleKeyboardEvent": [{ type: HostListener, args: ['document:keydown', ['$event'],] },],
};
var PdfThumbListComponent = /** @class */ (function () {
    function PdfThumbListComponent(element) {
        this.element = element;
        this.virtualHeight = 0;
        this.translateY = 0;
        this.renderItems = [];
        this.items = [];
        this.margin = 15;
        this.itemHeight = 114 + this.margin;
        this.calculateItems = this.calculateItems.bind(this);
        this.onPageChange = this.onPageChange.bind(this);
    }
    PdfThumbListComponent.prototype.onResize = function (event) {
        this.calculateItems();
    };
    PdfThumbListComponent.prototype.ngOnInit = function () {
        this.element.nativeElement.addEventListener('scroll', this.calculateItems, true);
        this.pdfViewer.eventBus.on('pagechange', this.onPageChange);
        this.items = this.getPages();
        this.calculateItems();
    };
    PdfThumbListComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        setTimeout(function () { return _this.scrollInto(_this.pdfViewer.currentPageNumber); }, 0);
    };
    PdfThumbListComponent.prototype.ngOnDestroy = function () {
        this.element.nativeElement.removeEventListener('scroll', this.calculateItems, true);
        this.pdfViewer.eventBus.off('pagechange', this.onPageChange);
    };
    PdfThumbListComponent.prototype.trackByFn = function (index, item) {
        return item.id;
    };
    PdfThumbListComponent.prototype.isSelected = function (pageNum) {
        return this.pdfViewer.currentPageNumber === pageNum;
    };
    PdfThumbListComponent.prototype.goTo = function (pageNum) {
        this.pdfViewer.currentPageNumber = pageNum;
    };
    PdfThumbListComponent.prototype.scrollInto = function (item) {
        if (this.items.length) {
            var index = this.items.findIndex(function (element) { return element.id === item; });
            if (index < 0 || index >= this.items.length) {
                return;
            }
            this.element.nativeElement.scrollTop = index * this.itemHeight;
            this.calculateItems();
        }
    };
    PdfThumbListComponent.prototype.getPages = function () {
        var _this = this;
        return this.pdfViewer._pages.map(function (page) { return ({
            id: page.id,
            getPage: function () { return _this.pdfViewer.pdfDocument.getPage(page.id); }
        }); });
    };
    PdfThumbListComponent.prototype.calculateItems = function () {
        var _a = this.getContainerSetup(), element = _a.element, viewPort = _a.viewPort, itemsInView = _a.itemsInView;
        var indexByScrollTop = element.scrollTop / viewPort * this.items.length / itemsInView;
        var start = Math.floor(indexByScrollTop);
        var end = Math.ceil(indexByScrollTop) + (itemsInView);
        this.translateY = this.itemHeight * Math.ceil(start);
        this.virtualHeight = this.itemHeight * this.items.length - this.translateY;
        this.renderItems = this.items.slice(start, end);
    };
    PdfThumbListComponent.prototype.getContainerSetup = function () {
        var element = this.element.nativeElement;
        var elementRec = element.getBoundingClientRect();
        var itemsInView = Math.ceil(elementRec.height / this.itemHeight);
        var viewPort = (this.itemHeight * this.items.length) / itemsInView;
        return {
            element: element,
            viewPort: viewPort,
            itemsInView: itemsInView
        };
    };
    PdfThumbListComponent.prototype.onPageChange = function (event) {
        var index = this.renderItems.findIndex(function (element) { return element.id === event.pageNumber; });
        if (index < 0) {
            this.scrollInto(event.pageNumber);
        }
        if (index >= this.renderItems.length - 1) {
            this.element.nativeElement.scrollTop += this.itemHeight;
        }
    };
    return PdfThumbListComponent;
}());
PdfThumbListComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-pdf-thumbnails',
                template: "<div class=\"pdf-thumbnails__content\"\n    [style.height.px]=\"virtualHeight\"\n    [style.transform]=\"'translate(-50%, ' + translateY + 'px)'\">\n    <adf-pdf-thumb *ngFor=\"let page of renderItems; trackBy: trackByFn\"\n        class=\"pdf-thumbnails__thumb\"\n        [ngClass]=\"{'pdf-thumbnails__thumb--selected' : isSelected(page.id)}\"\n        [page]=\"page\"\n        (click)=\"goTo(page.id)\">\n    </adf-pdf-thumb>\n</div>\n",
                styles: [""],
                host: { 'class': 'pdf-thumbnails' },
                encapsulation: ViewEncapsulation.None
            },] },
];
PdfThumbListComponent.ctorParameters = function () { return [
    { type: ElementRef, },
]; };
PdfThumbListComponent.propDecorators = {
    "pdfViewer": [{ type: Input },],
    "template": [{ type: ContentChild, args: [TemplateRef,] },],
    "onResize": [{ type: HostListener, args: ['window:resize', ['$event'],] },],
};
var PdfThumbComponent = /** @class */ (function () {
    function PdfThumbComponent(element, sanitizer) {
        this.element = element;
        this.sanitizer = sanitizer;
        this.page = null;
    }
    PdfThumbComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.image$ = this.page.getPage().then(function (page) { return _this.getThumb(page); });
    };
    PdfThumbComponent.prototype.getThumb = function (page) {
        var _this = this;
        var canvas = this.getCanvas();
        var viewport = page.getViewport(1);
        var scale = Math.min((canvas.height / viewport.height), (canvas.width / viewport.width));
        return page.render({
            canvasContext: canvas.getContext('2d'),
            viewport: page.getViewport(scale)
        })
            .then(function () {
            var imageSource = canvas.toDataURL();
            return _this.sanitizer.bypassSecurityTrustUrl(imageSource);
        });
    };
    PdfThumbComponent.prototype.getCanvas = function () {
        var elementRect = this.element.nativeElement.getBoundingClientRect();
        var canvas = document.createElement('canvas');
        canvas.width = elementRect.width;
        canvas.height = elementRect.height;
        return canvas;
    };
    return PdfThumbComponent;
}());
PdfThumbComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-pdf-thumb',
                template: "<ng-container *ngIf=\"image$ | async as image\">\n    <img [src]=\"image\"\n        title=\"{{ 'ADF_VIEWER.SIDEBAR.THUMBNAILS.PAGE' | translate: { pageNum: page.id } }}\">\n</ng-container>",
                encapsulation: ViewEncapsulation.None
            },] },
];
PdfThumbComponent.ctorParameters = function () { return [
    { type: ElementRef, },
    { type: DomSanitizer, },
]; };
PdfThumbComponent.propDecorators = {
    "page": [{ type: Input, args: ['page',] },],
};
var TxtViewerComponent = /** @class */ (function () {
    function TxtViewerComponent(http) {
        this.http = http;
    }
    TxtViewerComponent.prototype.ngOnChanges = function (changes) {
        var blobFile = changes['blobFile'];
        if (blobFile && blobFile.currentValue) {
            return this.readBlob(blobFile.currentValue);
        }
        var urlFile = changes['urlFile'];
        if (urlFile && urlFile.currentValue) {
            return this.getUrlContent(urlFile.currentValue);
        }
        if (!this.urlFile && !this.blobFile) {
            throw new Error('Attribute urlFile or blobFile is required');
        }
    };
    TxtViewerComponent.prototype.getUrlContent = function (url) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            _this.http.get(url, { responseType: 'text' }).subscribe(function (res) {
                _this.content = res;
                resolve();
            }, function (event) {
                reject(event);
            });
        });
    };
    TxtViewerComponent.prototype.readBlob = function (blob) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var reader = new FileReader();
            reader.onload = function () {
                _this.content = reader.result;
                resolve();
            };
            reader.onerror = function (error) {
                reject(error);
            };
            reader.readAsText(blob);
        });
    };
    return TxtViewerComponent;
}());
TxtViewerComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-txt-viewer',
                template: "<pre class=\"adf-txt-viewer-content\">\n    {{content}}\n</pre>\n",
                styles: [""],
                host: { 'class': 'adf-txt-viewer' },
                encapsulation: ViewEncapsulation.None
            },] },
];
TxtViewerComponent.ctorParameters = function () { return [
    { type: HttpClient, },
]; };
TxtViewerComponent.propDecorators = {
    "urlFile": [{ type: Input },],
    "blobFile": [{ type: Input },],
};
var UnknownFormatComponent = /** @class */ (function () {
    function UnknownFormatComponent() {
    }
    return UnknownFormatComponent;
}());
UnknownFormatComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-viewer-unknown-format',
                template: "<div class=\"adf-viewer__unknown-format-view\">\n    <div>\n        <mat-icon class=\"icon\">wifi_tethering</mat-icon>\n        <div class=\"label\">{{ 'ADF_VIEWER.UNKNOWN_FORMAT' | translate }}</div>\n    </div>\n</div>\n",
                styles: [".adf-viewer__unknown-format-view{height:90vh;text-align:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1;flex:1;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}"]
            },] },
];
UnknownFormatComponent.ctorParameters = function () { return []; };
var ViewerToolbarActionsComponent = /** @class */ (function () {
    function ViewerToolbarActionsComponent() {
    }
    return ViewerToolbarActionsComponent;
}());
ViewerToolbarActionsComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-viewer-toolbar-actions',
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush,
                host: { class: 'adf-viewer-toolbar-actions' },
                template: "<ng-content></ng-content>"
            },] },
];
ViewerToolbarActionsComponent.ctorParameters = function () { return []; };
var ViewerExtensionDirective = /** @class */ (function () {
    function ViewerExtensionDirective(viewerComponent) {
        this.viewerComponent = viewerComponent;
    }
    ViewerExtensionDirective.prototype.ngAfterContentInit = function () {
        var _this = this;
        this.templateModel = { template: this.template, isVisible: false };
        this.viewerComponent.extensionTemplates.push(this.templateModel);
        this.viewerComponent.extensionChange.subscribe(function (fileExtension) {
            _this.templateModel.isVisible = _this.isVisible(fileExtension);
        });
        if (this.supportedExtensions instanceof Array) {
            this.supportedExtensions.forEach(function (extension) {
                _this.viewerComponent.externalExtensions.push(extension);
            });
        }
    };
    ViewerExtensionDirective.prototype.isVisible = function (fileExtension) {
        var supportedExtension;
        if (this.supportedExtensions && (this.supportedExtensions instanceof Array)) {
            supportedExtension = this.supportedExtensions.find(function (extension) {
                return extension.toLowerCase() === fileExtension;
            });
        }
        return !!supportedExtension;
    };
    return ViewerExtensionDirective;
}());
ViewerExtensionDirective.decorators = [
    { type: Directive, args: [{
                selector: 'adf-viewer-extension'
            },] },
];
ViewerExtensionDirective.ctorParameters = function () { return [
    { type: ViewerComponent, },
]; };
ViewerExtensionDirective.propDecorators = {
    "template": [{ type: ContentChild, args: [TemplateRef,] },],
    "urlFileContent": [{ type: Input },],
    "extension": [{ type: Input },],
    "supportedExtensions": [{ type: Input },],
};
function modules() {
    return [
        MatAutocompleteModule, MatButtonModule, MatCardModule, MatCheckboxModule,
        MatChipsModule, MatDatepickerModule, MatDialogModule, MatGridListModule, MatIconModule,
        MatInputModule, MatListModule, MatNativeDateModule, MatOptionModule, MatProgressSpinnerModule, MatRadioModule,
        MatRippleModule, MatSelectModule, MatSlideToggleModule, MatTableModule, MatTabsModule,
        MatMenuModule, MatProgressBarModule, MatSidenavModule, MatSnackBarModule, MatToolbarModule,
        MatTooltipModule, MatDatetimepickerModule, MatNativeDatetimeModule
    ];
}
var MaterialModule = /** @class */ (function () {
    function MaterialModule() {
    }
    return MaterialModule;
}());
MaterialModule.decorators = [
    { type: NgModule, args: [{
                imports: modules(),
                exports: modules()
            },] },
];
MaterialModule.ctorParameters = function () { return []; };
var ToolbarDividerComponent = /** @class */ (function () {
    function ToolbarDividerComponent() {
    }
    return ToolbarDividerComponent;
}());
ToolbarDividerComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-toolbar-divider',
                template: '<div></div>',
                host: { 'class': 'adf-toolbar-divider' },
                styles: ["\n        .adf-toolbar-divider > div {\n            height: 24px;\n            width: 1px;\n            background: rgba(0, 0, 0, 0.26);\n            margin-left: 5px;\n            margin-right: 5px;\n        }\n    "],
                encapsulation: ViewEncapsulation.None
            },] },
];
ToolbarDividerComponent.ctorParameters = function () { return []; };
var ToolbarTitleComponent = /** @class */ (function () {
    function ToolbarTitleComponent() {
    }
    return ToolbarTitleComponent;
}());
ToolbarTitleComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-toolbar-title',
                template: '<ng-content></ng-content>',
                host: { 'class': 'adf-toolbar-title' }
            },] },
];
ToolbarTitleComponent.ctorParameters = function () { return []; };
var ToolbarComponent = /** @class */ (function () {
    function ToolbarComponent() {
        this.title = '';
    }
    return ToolbarComponent;
}());
ToolbarComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-toolbar',
                template: "<mat-toolbar [color]=\"color\">\n    <span *ngIf=\"title\">{{ title }}</span>\n    <ng-content select=\"adf-toolbar-title\"></ng-content>\n    <span class=\"adf-toolbar--spacer\"></span>\n    <ng-content></ng-content>\n</mat-toolbar>\n",
                styles: [""],
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None,
                host: { 'class': 'adf-toolbar' }
            },] },
];
ToolbarComponent.ctorParameters = function () { return []; };
ToolbarComponent.propDecorators = {
    "title": [{ type: Input },],
    "color": [{ type: Input },],
};
var ToolbarModule = /** @class */ (function () {
    function ToolbarModule() {
    }
    return ToolbarModule;
}());
ToolbarModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    CommonModule,
                    MaterialModule
                ],
                declarations: [
                    ToolbarComponent,
                    ToolbarTitleComponent,
                    ToolbarDividerComponent
                ],
                exports: [
                    ToolbarComponent,
                    ToolbarTitleComponent,
                    ToolbarDividerComponent
                ]
            },] },
];
ToolbarModule.ctorParameters = function () { return []; };
var TRANSLATION_PROVIDER = new InjectionToken('Injection token for translation providers.');
var TranslationService = /** @class */ (function () {
    function TranslationService(translate, userPreference, providers) {
        var _this = this;
        this.translate = translate;
        this.customLoader = (this.translate.currentLoader);
        this.defaultLang = 'en';
        translate.setDefaultLang(this.defaultLang);
        if (providers && providers.length > 0) {
            try {
                for (var providers_1 = __values(providers), providers_1_1 = providers_1.next(); !providers_1_1.done; providers_1_1 = providers_1.next()) {
                    var provider = providers_1_1.value;
                    this.addTranslationFolder(provider.name, provider.source);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (providers_1_1 && !providers_1_1.done && (_a = providers_1.return)) _a.call(providers_1);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        userPreference.locale$.subscribe(function (locale) {
            _this.userLang = locale;
            _this.use(_this.userLang);
        });
        var e_2, _a;
    }
    TranslationService.prototype.addTranslationFolder = function (name, path) {
        var _this = this;
        if (name === void 0) { name = ''; }
        if (path === void 0) { path = ''; }
        if (!this.customLoader.providerRegistered(name)) {
            this.customLoader.registerProvider(name, path);
            if (this.userLang !== this.defaultLang) {
                this.translate.getTranslation(this.defaultLang).subscribe(function () {
                    _this.translate.getTranslation(_this.userLang).subscribe(function () {
                        _this.translate.use(_this.userLang);
                        _this.onTranslationChanged(_this.userLang);
                    });
                });
            }
            else {
                this.translate.getTranslation(this.userLang).subscribe(function () {
                    _this.translate.use(_this.userLang);
                    _this.onTranslationChanged(_this.userLang);
                });
            }
        }
    };
    TranslationService.prototype.onTranslationChanged = function (lang) {
        this.translate.onTranslationChange.next({
            lang: lang,
            translations: this.customLoader.getFullTranslationJSON(lang)
        });
    };
    TranslationService.prototype.use = function (lang) {
        this.customLoader.init(lang);
        return this.translate.use(lang);
    };
    TranslationService.prototype.get = function (key, interpolateParams) {
        return this.translate.get(key, interpolateParams);
    };
    TranslationService.prototype.instant = function (key, interpolateParams) {
        return this.translate.instant(key, interpolateParams);
    };
    return TranslationService;
}());
TranslationService.decorators = [
    { type: Injectable },
];
TranslationService.ctorParameters = function () { return [
    { type: TranslateService, },
    { type: UserPreferencesService, },
    { type: Array, decorators: [{ type: Optional }, { type: Inject, args: [TRANSLATION_PROVIDER,] },] },
]; };
var FileSizePipe = /** @class */ (function () {
    function FileSizePipe(translation) {
        this.translation = translation;
    }
    FileSizePipe.prototype.transform = function (bytes, decimals) {
        if (decimals === void 0) { decimals = 2; }
        if (bytes == null || bytes === undefined) {
            return '';
        }
        if (bytes === 0) {
            return '0 ' + this.translation.instant('CORE.FILE_SIZE.BYTES');
        }
        var k = 1024, dm = decimals || 2, sizes = ['BYTES', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'], i = Math.floor(Math.log(bytes) / Math.log(k));
        var i18nSize = this.translation.instant("CORE.FILE_SIZE." + sizes[i]);
        return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + i18nSize;
    };
    return FileSizePipe;
}());
FileSizePipe.decorators = [
    { type: Pipe, args: [{
                name: 'adfFileSize',
                pure: false
            },] },
];
FileSizePipe.ctorParameters = function () { return [
    { type: TranslationService, },
]; };
var ThumbnailService = /** @class */ (function () {
    function ThumbnailService(contentService, matIconRegistry, sanitizer) {
        var _this = this;
        this.contentService = contentService;
        this.DEFAULT_ICON = './assets/images/ft_ic_miscellaneous.svg';
        this.mimeTypeIcons = {
            'image/png': './assets/images/ft_ic_raster_image.svg',
            'image/jpeg': './assets/images/ft_ic_raster_image.svg',
            'image/gif': './assets/images/ft_ic_raster_image.svg',
            'image/bmp': './assets/images/ft_ic_raster_image.svg',
            'image/cgm': './assets/images/ft_ic_raster_image.svg',
            'image/ief': './assets/images/ft_ic_raster_image.svg',
            'image/jp2': './assets/images/ft_ic_raster_image.svg',
            'image/tiff': './assets/images/ft_ic_raster_image.svg',
            'image/vnd.adobe.photoshop': './assets/images/ft_ic_raster_image.svg',
            'image/vnd.adobe.premiere': './assets/images/ft_ic_raster_image.svg',
            'image/x-cmu-raster': './assets/images/ft_ic_raster_image.svg',
            'image/x-dwt': './assets/images/ft_ic_raster_image.svg',
            'image/x-portable-anymap': './assets/images/ft_ic_raster_image.svg',
            'image/x-portable-bitmap': './assets/images/ft_ic_raster_image.svg',
            'image/x-portable-graymap': './assets/images/ft_ic_raster_image.svg',
            'image/x-portable-pixmap': './assets/images/ft_ic_raster_image.svg',
            'image/x-raw-adobe': './assets/images/ft_ic_raster_image.svg',
            'image/x-raw-canon': './assets/images/ft_ic_raster_image.svg',
            'image/x-raw-fuji': './assets/images/ft_ic_raster_image.svg',
            'image/x-raw-hasselblad': './assets/images/ft_ic_raster_image.svg',
            'image/x-raw-kodak': './assets/images/ft_ic_raster_image.svg',
            'image/x-raw-leica': './assets/images/ft_ic_raster_image.svg',
            'image/x-raw-minolta': './assets/images/ft_ic_raster_image.svg',
            'image/x-raw-nikon': './assets/images/ft_ic_raster_image.svg',
            'image/x-raw-olympus': './assets/images/ft_ic_raster_image.svg',
            'image/x-raw-panasonic': './assets/images/ft_ic_raster_image.svg',
            'image/x-raw-pentax': './assets/images/ft_ic_raster_image.svg',
            'image/x-raw-red': './assets/images/ft_ic_raster_image.svg',
            'image/x-raw-sigma': './assets/images/ft_ic_raster_image.svg',
            'image/x-raw-sony': './assets/images/ft_ic_raster_image.svg',
            'image/x-xbitmap': './assets/images/ft_ic_raster_image.svg',
            'image/x-xpixmap': './assets/images/ft_ic_raster_image.svg',
            'image/x-xwindowdump': './assets/images/ft_ic_raster_image.svg',
            'image/svg+xml': './assets/images/ft_ic_vector_image.svg',
            'application/eps': './assets/images/ft_ic_raster_image.svg',
            'application/illustrator': './assets/images/ft_ic_raster_image.svg',
            'application/pdf': './assets/images/ft_ic_pdf.svg',
            'application/vnd.ms-excel': './assets/images/ft_ic_ms_excel.svg',
            'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': './assets/images/ft_ic_ms_excel.svg',
            'application/vnd.openxmlformats-officedocument.spreadsheetml.template': './assets/images/ft_ic_ms_excel.svg',
            'application/vnd.ms-excel.addin.macroenabled.12': './assets/images/ft_ic_ms_excel.svg',
            'application/vnd.ms-excel.sheet.binary.macroenabled.12': './assets/images/ft_ic_ms_excel.svg',
            'application/vnd.ms-excel.sheet.macroenabled.12': './assets/images/ft_ic_ms_excel.svg',
            'application/vnd.ms-excel.template.macroenabled.12': './assets/images/ft_ic_ms_excel.svg',
            'application/vnd.sun.xml.calc': './assets/images/ft_ic_ms_excel.svg',
            'application/vnd.sun.xml.calc.template': './assets/images/ft_ic_ms_excel.svg',
            'application/vnd.ms-outlook': './assets/images/ft_ic_document.svg',
            'application/msword': './assets/images/ft_ic_ms_word.svg',
            'application/vnd.openxmlformats-officedocument.wordprocessingml.document': './assets/images/ft_ic_ms_word.svg',
            'application/vnd.openxmlformats-officedocument.wordprocessingml.template': './assets/images/ft_ic_ms_word.svg',
            'application/vnd.ms-word.document.macroenabled.12': './assets/images/ft_ic_ms_word.svg',
            'application/vnd.ms-word.template.macroenabled.12': './assets/images/ft_ic_ms_word.svg',
            'application/vnd.sun.xml.writer': './assets/images/ft_ic_ms_word.svg',
            'application/vnd.sun.xml.writer.template': './assets/images/ft_ic_ms_word.svg',
            'application/rtf': './assets/images/ft_ic_ms_word.svg',
            'application/vnd.ms-powerpoint': './assets/images/ft_ic_ms_powerpoint.svg',
            'application/vnd.openxmlformats-officedocument.presentationml.presentation': './assets/images/ft_ic_ms_powerpoint.svg',
            'application/vnd.openxmlformats-officedocument.presentationml.template': './assets/images/ft_ic_ms_powerpoint.svg',
            'application/vnd.openxmlformats-officedocument.presentationml.slideshow': './assets/images/ft_ic_ms_powerpoint.svg',
            'application/vnd.oasis.opendocument.presentation': './assets/images/ft_ic_ms_powerpoint.svg',
            'application/vnd.oasis.opendocument.presentation-template': './assets/images/ft_ic_ms_powerpoint.svg',
            'application/vnd.openxmlformats-officedocument.presentationml.slide': './assets/images/ft_ic_ms_powerpoint.svg',
            'application/vnd.sun.xml.impress': './assets/images/ft_ic_ms_powerpoint.svg',
            'application/vnd.sun.xml.impress.template': './assets/images/ft_ic_ms_powerpoint.svg',
            'application/vnd.oasis.opendocument.spreadsheet': './assets/images/ft_ic_ms_excel.svg',
            'application/vnd.oasis.opendocument.spreadsheet-template': './assets/images/ft_ic_ms_excel.svg',
            'application/vnd.ms-powerpoint.addin.macroenabled.12': './assets/images/ft_ic_ms_powerpoint.svg',
            'application/vnd.ms-powerpoint.presentation.macroenabled.12': './assets/images/ft_ic_ms_powerpoint.svg',
            'application/vnd.ms-powerpoint.slide.macroenabled.12': './assets/images/ft_ic_ms_powerpoint.svg',
            'application/vnd.ms-powerpoint.slideshow.macroenabled.12': './assets/images/ft_ic_ms_powerpoint.svg',
            'application/vnd.ms-powerpoint.template.macroenabled.12': './assets/images/ft_ic_ms_powerpoint.svg',
            'video/mp4': './assets/images/ft_ic_video.svg',
            'video/3gpp': './assets/images/ft_ic_video.svg',
            'video/3gpp2': './assets/images/ft_ic_video.svg',
            'video/mp2t': './assets/images/ft_ic_video.svg',
            'video/mpeg': './assets/images/ft_ic_video.svg',
            'video/mpeg2': './assets/images/ft_ic_video.svg',
            'video/ogg': './assets/images/ft_ic_video.svg',
            'video/quicktime': './assets/images/ft_ic_video.svg',
            'video/webm': './assets/images/ft_ic_video.svg',
            'video/x-flv': './assets/images/ft_ic_video.svg',
            'video/x-m4v': './assets/images/ft_ic_video.svg',
            'video/x-ms-asf': './assets/images/ft_ic_video.svg',
            'video/x-ms-wmv': './assets/images/ft_ic_video.svg',
            'video/x-msvideo': './assets/images/ft_ic_video.svg',
            'video/x-rad-screenplay': './assets/images/ft_ic_video.svg',
            'video/x-sgi-movie': './assets/images/ft_ic_video.svg',
            'video/x-matroska': './assets/images/ft_ic_video.svg',
            'audio/mpeg': './assets/images/ft_ic_audio.svg',
            'audio/ogg': './assets/images/ft_ic_audio.svg',
            'audio/wav': './assets/images/ft_ic_audio.svg',
            'audio/basic': './assets/images/ft_ic_audio.svg',
            'audio/mp4': './assets/images/ft_ic_audio.svg',
            'audio/vnd.adobe.soundbooth': './assets/images/ft_ic_audio.svg',
            'audio/vorbis': './assets/images/ft_ic_audio.svg',
            'audio/x-aiff': './assets/images/ft_ic_audio.svg',
            'audio/x-flac': './assets/images/ft_ic_audio.svg',
            'audio/x-ms-wma': './assets/images/ft_ic_audio.svg',
            'audio/x-wav': './assets/images/ft_ic_audio.svg',
            'x-world/x-vrml': './assets/images/ft_ic_video.svg',
            'text/plain': './assets/images/ft_ic_document.svg',
            'application/vnd.oasis.opendocument.text': './assets/images/ft_ic_document.svg',
            'application/vnd.oasis.opendocument.text-template': './assets/images/ft_ic_document.svg',
            'application/x-javascript': './assets/images/ft_ic_document.svg',
            'application/json': './assets/images/ft_ic_document.svg',
            'text/csv': './assets/images/ft_ic_document.svg',
            'text/xml': './assets/images/ft_ic_document.svg',
            'text/html': './assets/images/ft_ic_website.svg',
            'application/x-compressed': './assets/images/ft_ic_archive.svg',
            'application/x-zip-compressed': './assets/images/ft_ic_archive.svg',
            'application/zip': './assets/images/ft_ic_archive.svg',
            'application/x-tar': './assets/images/ft_ic_archive.svg',
            'application/vnd.apple.keynote': './assets/images/ft_ic_presentation.svg',
            'application/vnd.apple.pages': './assets/images/ft_ic_document.svg',
            'application/vnd.apple.numbers': './assets/images/ft_ic_spreadsheet.svg',
            'application/vnd.visio': './assets/images/ft_ic_document.svg',
            'application/wordperfect': './assets/images/ft_ic_document.svg',
            'application/x-cpio': './assets/images/ft_ic_document.svg',
            'folder': './assets/images/ft_ic_folder.svg',
            'disable/folder': './assets/images/ft_ic_folder_disable.svg',
            'selected': './assets/images/ft_ic_selected.svg'
        };
        Object.keys(this.mimeTypeIcons).forEach(function (key) {
            matIconRegistry.addSvgIcon(key, sanitizer.bypassSecurityTrustResourceUrl(_this.mimeTypeIcons[key]));
        });
    }
    ThumbnailService.prototype.getDocumentThumbnailUrl = function (node) {
        var thumbnail = this.contentService.getDocumentThumbnailUrl(node);
        return thumbnail || this.DEFAULT_ICON;
    };
    ThumbnailService.prototype.getMimeTypeIcon = function (mimeType) {
        var icon = this.mimeTypeIcons[mimeType];
        return (icon || this.DEFAULT_ICON);
    };
    ThumbnailService.prototype.getDefaultMimeTypeIcon = function () {
        return this.DEFAULT_ICON;
    };
    return ThumbnailService;
}());
ThumbnailService.decorators = [
    { type: Injectable },
];
ThumbnailService.ctorParameters = function () { return [
    { type: ContentService, },
    { type: MatIconRegistry, },
    { type: DomSanitizer, },
]; };
var MimeTypeIconPipe = /** @class */ (function () {
    function MimeTypeIconPipe(thumbnailService) {
        this.thumbnailService = thumbnailService;
    }
    MimeTypeIconPipe.prototype.transform = function (text) {
        return this.thumbnailService.getMimeTypeIcon(text);
    };
    return MimeTypeIconPipe;
}());
MimeTypeIconPipe.decorators = [
    { type: Pipe, args: [{
                name: 'adfMimeTypeIcon'
            },] },
];
MimeTypeIconPipe.ctorParameters = function () { return [
    { type: ThumbnailService, },
]; };
var NodeNameTooltipPipe = /** @class */ (function () {
    function NodeNameTooltipPipe() {
    }
    NodeNameTooltipPipe.prototype.transform = function (node) {
        if (node) {
            return this.getNodeTooltip(node);
        }
        return null;
    };
    NodeNameTooltipPipe.prototype.containsLine = function (lines, line) {
        return lines.some(function (item) {
            return item.toLowerCase() === line.toLowerCase();
        });
    };
    NodeNameTooltipPipe.prototype.removeDuplicateLines = function (lines) {
        var _this = this;
        var reducer = function (acc, line) {
            if (!_this.containsLine(acc, line)) {
                acc.push(line);
            }
            return acc;
        };
        return lines.reduce(reducer, []);
    };
    NodeNameTooltipPipe.prototype.getNodeTooltip = function (node) {
        if (!node || !node.entry) {
            return null;
        }
        var _a = node.entry, properties = _a.properties, name = _a.name;
        var lines = [name];
        if (properties) {
            var title = properties["cm:title"], description = properties["cm:description"];
            if (title && description) {
                lines[0] = title;
                lines[1] = description;
            }
            if (title) {
                lines[1] = title;
            }
            if (description) {
                lines[1] = description;
            }
        }
        return this.removeDuplicateLines(lines).join("\n");
    };
    return NodeNameTooltipPipe;
}());
NodeNameTooltipPipe.decorators = [
    { type: Pipe, args: [{
                name: 'adfNodeNameTooltip'
            },] },
];
NodeNameTooltipPipe.ctorParameters = function () { return []; };
var HighlightTransformService = /** @class */ (function () {
    function HighlightTransformService() {
    }
    HighlightTransformService.prototype.highlight = function (text, search, wrapperClass) {
        if (wrapperClass === void 0) { wrapperClass = 'highlight'; }
        var isMatching = false, result = text;
        if (search && text) {
            var pattern = search.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, '\\$&');
            pattern = pattern.split(' ').filter(function (t) {
                return t.length > 0;
            }).join('|');
            var regex = new RegExp(pattern, 'gi');
            result = text.replace(regex, function (match) {
                isMatching = true;
                return "<span class=\"" + wrapperClass + "\">" + match + "</span>";
            });
            return { text: result, changed: isMatching };
        }
        else {
            return { text: result, changed: isMatching };
        }
    };
    return HighlightTransformService;
}());
var HighlightPipe = /** @class */ (function () {
    function HighlightPipe(highlightTransformService) {
        this.highlightTransformService = highlightTransformService;
    }
    HighlightPipe.prototype.transform = function (text, search) {
        var result = this.highlightTransformService.highlight(text, search);
        return result.text;
    };
    return HighlightPipe;
}());
HighlightPipe.decorators = [
    { type: Pipe, args: [{
                name: 'highlight'
            },] },
];
HighlightPipe.ctorParameters = function () { return [
    { type: HighlightTransformService, },
]; };
var TimeAgoPipe = /** @class */ (function () {
    function TimeAgoPipe() {
    }
    TimeAgoPipe.prototype.transform = function (value) {
        if (value !== null && value !== undefined) {
            var then = moment(value);
            var diff = moment().diff(then, 'days');
            return diff > 7 ? then.format('DD/MM/YYYY HH:mm') : then.fromNow();
        }
        return '';
    };
    return TimeAgoPipe;
}());
TimeAgoPipe.decorators = [
    { type: Pipe, args: [{
                name: 'adfTimeAgo'
            },] },
];
TimeAgoPipe.ctorParameters = function () { return []; };
var InitialUsernamePipe = /** @class */ (function () {
    function InitialUsernamePipe(sanitized) {
        this.sanitized = sanitized;
    }
    InitialUsernamePipe.prototype.transform = function (user, className, delimiter) {
        if (className === void 0) { className = ''; }
        if (delimiter === void 0) { delimiter = ''; }
        var result = '';
        if (user) {
            var initialResult = this.getInitialUserName(user.firstName, user.lastName, delimiter);
            result = this.sanitized.bypassSecurityTrustHtml("<div id=\"user-initials-image\" class=\"" + className + "\">" + initialResult + "</div>");
        }
        return result;
    };
    InitialUsernamePipe.prototype.getInitialUserName = function (firstName, lastName, delimiter) {
        firstName = (firstName ? firstName[0] : '');
        lastName = (lastName ? lastName[0] : '');
        return firstName + delimiter + lastName;
    };
    return InitialUsernamePipe;
}());
InitialUsernamePipe.decorators = [
    { type: Pipe, args: [{
                name: 'usernameInitials'
            },] },
];
InitialUsernamePipe.ctorParameters = function () { return [
    { type: DomSanitizer, },
]; };
var PipeModule = /** @class */ (function () {
    function PipeModule() {
    }
    return PipeModule;
}());
PipeModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    CommonModule
                ],
                declarations: [
                    FileSizePipe,
                    HighlightPipe,
                    TimeAgoPipe,
                    MimeTypeIconPipe,
                    InitialUsernamePipe,
                    NodeNameTooltipPipe
                ],
                providers: [
                    FileSizePipe,
                    HighlightPipe,
                    TimeAgoPipe,
                    MimeTypeIconPipe,
                    InitialUsernamePipe,
                    NodeNameTooltipPipe
                ],
                exports: [
                    FileSizePipe,
                    HighlightPipe,
                    TimeAgoPipe,
                    MimeTypeIconPipe,
                    InitialUsernamePipe,
                    NodeNameTooltipPipe
                ]
            },] },
];
PipeModule.ctorParameters = function () { return []; };
var ViewerModule = /** @class */ (function () {
    function ViewerModule() {
    }
    return ViewerModule;
}());
ViewerModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    CommonModule,
                    MaterialModule,
                    TranslateModule,
                    FormsModule,
                    ReactiveFormsModule,
                    ToolbarModule,
                    PipeModule,
                    FlexLayoutModule
                ],
                declarations: [
                    PdfPasswordDialogComponent,
                    ViewerComponent,
                    ImgViewerComponent,
                    TxtViewerComponent,
                    MediaPlayerComponent,
                    PdfViewerComponent,
                    PdfThumbComponent,
                    PdfThumbListComponent,
                    ViewerExtensionDirective,
                    UnknownFormatComponent,
                    ViewerToolbarComponent,
                    ViewerSidebarComponent,
                    ViewerOpenWithComponent,
                    ViewerMoreActionsComponent,
                    ViewerToolbarActionsComponent
                ],
                entryComponents: [
                    PdfPasswordDialogComponent
                ],
                exports: [
                    ViewerComponent,
                    ImgViewerComponent,
                    TxtViewerComponent,
                    MediaPlayerComponent,
                    PdfViewerComponent,
                    PdfPasswordDialogComponent,
                    PdfThumbComponent,
                    PdfThumbListComponent,
                    ViewerExtensionDirective,
                    UnknownFormatComponent,
                    ViewerToolbarComponent,
                    ViewerSidebarComponent,
                    ViewerOpenWithComponent,
                    ViewerMoreActionsComponent,
                    ViewerToolbarActionsComponent
                ]
            },] },
];
ViewerModule.ctorParameters = function () { return []; };
var BpmUserModel = /** @class */ (function () {
    function BpmUserModel(obj) {
        if (obj) {
            this.apps = obj.apps;
            this.capabilities = obj.capabilities;
            this.company = obj.company;
            this.created = obj.created;
            this.email = obj.email;
            this.externalId = obj.externalId;
            this.firstName = obj.firstName;
            this.lastName = obj.lastName;
            this.fullname = obj.fullname;
            this.fullNameDisplay = obj ? this.formatValue(obj.firstName).trim() + ' ' + this.formatValue(obj.lastName).trim() : null;
            this.groups = obj.groups;
            this.id = obj.id;
            this.lastUpdate = obj.lastUpdate;
            this.latestSyncTimeStamp = obj.latestSyncTimeStamp;
            this.password = obj.password;
            this.pictureId = obj.pictureId;
            this.status = obj.status;
            this.tenantId = obj.tenantId;
            this.tenantName = obj.tenantName;
            this.tenantPictureId = obj.tenantPictureId;
            this.type = obj.type;
        }
    }
    BpmUserModel.prototype.formatValue = function (value) {
        return value && value !== 'null' ? value : '';
    };
    return BpmUserModel;
}());
var EcmUserModel = /** @class */ (function () {
    function EcmUserModel(obj) {
        this.id = obj && obj.id || null;
        this.firstName = obj && obj.firstName;
        this.lastName = obj && obj.lastName;
        this.fullNameDisplay = obj ? this.formatValue(obj.firstName).trim() + ' ' + this.formatValue(obj.lastName).trim() : null;
        this.description = obj && obj.description || null;
        this.avatarId = obj && obj.avatarId || null;
        this.email = obj && obj.email || null;
        this.skypeId = obj && obj.skypeId;
        this.googleId = obj && obj.googleId;
        this.instantMessageId = obj && obj.instantMessageId;
        this.jobTitle = obj && obj.jobTitle || null;
        this.location = obj && obj.location || null;
        this.company = obj && obj.company;
        this.mobile = obj && obj.mobile;
        this.telephone = obj && obj.telephone;
        this.statusUpdatedAt = obj && obj.statusUpdatedAt;
        this.userStatus = obj && obj.userStatus;
        this.enabled = obj && obj.enabled;
        this.emailNotificationsEnabled = obj && obj.emailNotificationsEnabled;
    }
    EcmUserModel.prototype.formatValue = function (value) {
        return value && value !== 'null' ? value : '';
    };
    return EcmUserModel;
}());
var BpmUserService = /** @class */ (function () {
    function BpmUserService(apiService, logService) {
        this.apiService = apiService;
        this.logService = logService;
    }
    BpmUserService.prototype.getCurrentUserInfo = function () {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().activiti.profileApi.getProfile())
            .map(function (data) { return (data); })
            .catch(function (err) { return _this.handleError(err); });
    };
    BpmUserService.prototype.getCurrentUserProfileImage = function () {
        return this.apiService.getInstance().activiti.profileApi.getProfilePictureUrl();
    };
    BpmUserService.prototype.handleError = function (error) {
        this.logService.error(error);
        return Observable.throw(error || 'Server error');
    };
    return BpmUserService;
}());
BpmUserService.decorators = [
    { type: Injectable },
];
BpmUserService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: LogService, },
]; };
var EcmUserService = /** @class */ (function () {
    function EcmUserService(apiService, contentService, logService) {
        this.apiService = apiService;
        this.contentService = contentService;
        this.logService = logService;
    }
    EcmUserService.prototype.getUserInfo = function (userName) {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().core.peopleApi.getPerson(userName))
            .map(function (data) { return (data['entry']); })
            .catch(function (err) { return _this.handleError(err); });
    };
    EcmUserService.prototype.getCurrentUserInfo = function () {
        return this.getUserInfo('-me-');
    };
    EcmUserService.prototype.getUserProfileImage = function (avatarId) {
        if (avatarId) {
            var nodeObj = { entry: { id: avatarId } };
            return this.contentService.getContentUrl(nodeObj);
        }
    };
    EcmUserService.prototype.handleError = function (error) {
        this.logService.error(error);
        return Observable.throw(error || 'Server error');
    };
    return EcmUserService;
}());
EcmUserService.decorators = [
    { type: Injectable },
];
EcmUserService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: ContentService, },
    { type: LogService, },
]; };
var UserInfoComponent = /** @class */ (function () {
    function UserInfoComponent(ecmUserService, bpmUserService, authService) {
        this.ecmUserService = ecmUserService;
        this.bpmUserService = bpmUserService;
        this.authService = authService;
        this.ecmBackgroundImage = './assets/images/ecm-background.png';
        this.bpmBackgroundImage = './assets/images/bpm-background.png';
        this.menuPositionX = 'after';
        this.menuPositionY = 'below';
        this.showName = true;
        this.namePosition = 'right';
    }
    UserInfoComponent.prototype.ngOnInit = function () {
        this.getUserInfo();
    };
    UserInfoComponent.prototype.getUserInfo = function () {
        this.loadEcmUserInfo();
        this.loadBpmUserInfo();
    };
    UserInfoComponent.prototype.isLoggedIn = function () {
        return this.authService.isLoggedIn();
    };
    UserInfoComponent.prototype.loadEcmUserInfo = function () {
        var _this = this;
        if (this.authService.isEcmLoggedIn()) {
            this.ecmUserService.getCurrentUserInfo()
                .subscribe(function (res) {
                _this.ecmUser = new EcmUserModel(res);
                _this.getEcmAvatar();
            });
        }
        else {
            this.ecmUser = null;
            this.ecmUserImage = null;
        }
    };
    UserInfoComponent.prototype.loadBpmUserInfo = function () {
        var _this = this;
        if (this.authService.isBpmLoggedIn()) {
            this.bpmUserService.getCurrentUserInfo()
                .subscribe(function (res) {
                _this.bpmUser = new BpmUserModel(res);
            });
            this.bpmUserImage = this.bpmUserService.getCurrentUserProfileImage();
        }
        else {
            this.bpmUser = null;
            this.bpmUserImage = null;
        }
    };
    UserInfoComponent.prototype.stopClosing = function (event) {
        event.stopPropagation();
    };
    UserInfoComponent.prototype.getEcmAvatar = function () {
        this.ecmUserImage = this.ecmUserService.getUserProfileImage(this.ecmUser.avatarId);
    };
    UserInfoComponent.prototype.showOnRight = function () {
        return this.namePosition === 'right';
    };
    UserInfoComponent.prototype.hasBpmUserPictureId = function () {
        return !!this.bpmUser.pictureId;
    };
    UserInfoComponent.prototype.hasEcmUserAvatarId = function () {
        return !!this.ecmUser.avatarId;
    };
    return UserInfoComponent;
}());
UserInfoComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-userinfo',
                styles: [""],
                template: "<div id=\"userinfo_container\"\n    [class.adf-userinfo-name-right]=\"showOnRight()\"\n    class=\"adf-userinfo-container\" *ngIf=\"isLoggedIn()\">\n    <span *ngIf=\"ecmUser && showName\" id=\"adf-userinfo-ecm-name-display\"\n          class=\"adf-userinfo-name\">{{ecmUser.fullNameDisplay}}</span>\n    <span *ngIf=\"bpmUser && !ecmUser && showName\" id=\"adf-userinfo-bpm-name-display\"\n          class=\"adf-userinfo-name\">{{bpmUser.fullNameDisplay}}</span>\n    <button mat-button [matMenuTriggerFor]=\"menu\" class=\"adf-userinfo-menu_button\">\n        <div class=\"adf-userinfo-button-profile\" id=\"user-profile\" data-automation-id=\"user-profile\">\n            <div *ngIf=\"bpmUser && !ecmUser\" id=\"bpm-user-image\">\n                <div *ngIf=\"!hasBpmUserPictureId()\" [outerHTML]=\"bpmUser | usernameInitials:'adf-userinfo-pic'\"></div>\n                <div *ngIf=\"hasBpmUserPictureId()\" class=\"adf-userinfo-profile-container\">\n                    <img id=\"logged-user-img\" [src]=\"bpmUserImage\" alt=\"user-info-profile-button\"\n                        class=\"adf-userinfo-profile-image\"/>\n                </div>\n            </div>\n            <div *ngIf=\"ecmUser\" id=\"ecm-user-image\">\n                    <div *ngIf=\"!hasEcmUserAvatarId()\" [outerHTML]=\"ecmUser | usernameInitials:'adf-userinfo-pic'\"></div>\n                    <div *ngIf=\"hasEcmUserAvatarId()\" class=\"adf-userinfo-profile-container\">\n                        <img id=\"logged-user-img\" [src]=\"ecmUserImage\" alt=\"user-info-profile-button\"\n                            class=\"adf-userinfo-profile-image\"/>\n                    </div>\n            </div>\n    </div>\n</button>\n    <mat-menu #menu=\"matMenu\" id=\"user-profile-lists\" [xPosition]=\"menuPositionX\" [yPosition]=\"menuPositionY\" [overlapTrigger]=\"false\" class=\"adf-userinfo-menu\">\n        <mat-tab-group id=\"tab-group-env\" (click)=\"stopClosing($event)\"\n            class=\"adf-userinfo-tab\" [class.adf-hide-tab]=\"!bpmUser || !ecmUser\">\n            <mat-tab id=\"ecm-panel\" label=\"{{ 'USER_PROFILE.TAB.CS' | translate }}\" *ngIf=\"ecmUser\">\n                <mat-card class=\"adf-userinfo-card\">\n                    <mat-card-header class=\"adf-userinfo-card-header\" [style.background-image]=\"'url(' + ecmBackgroundImage + ')'\">\n                        <div *ngIf=\"!hasEcmUserAvatarId()\" [outerHTML]=\"ecmUser | usernameInitials:'adf-userinfo-profile-initials adf-hide-small'\"></div>\n                        <div *ngIf=\"hasEcmUserAvatarId()\" class=\"adf-userinfo-profile-container adf-hide-small\">\n                            <img class=\"adf-userinfo-profile-picture\" id=\"ecm-user-detail-image\"\n                                alt=\"ecm-profile-image\" [src]=\"ecmUserImage\" />\n                        </div>\n                       <div class=\"adf-userinfo-title\" id=\"ecm-username\">{{ecmUser.fullNameDisplay}}</div>\n                    </mat-card-header>\n                    <mat-card-content>\n                        <div class=\"adf-userinfo-supporting-text\">\n                                <div class=\"adf-userinfo-detail\">\n                                    <span id=\"ecm-full-name\" class=\"adf-userinfo__detail-title\">{{ecmUser.fullNameDisplay}}</span>\n                                    <span class=\"adf-userinfo__detail-profile\" id=\"ecm-email\"> {{ecmUser.email}} </span>\n                                </div>\n                                <div class=\"adf-userinfo-detail\">\n                                    <span class=\"adf-userinfo__secondary-info\" id=\"ecm-job-title-label\">\n                                        {{ 'USER_PROFILE.LABELS.ECM.JOB_TITLE' | translate }}\n                                        <span id=\"ecm-job-title\" class=\"adf-userinfo__detail-profile\"> {{ ecmUser.jobTitle ? ecmUser.jobTitle : 'N/A' }} </span>\n                                    </span>\n                                </div>\n                        </div>\n                    </mat-card-content>\n                </mat-card>\n            </mat-tab>\n            <mat-tab id=\"bpm-panel\" label=\"{{ 'USER_PROFILE.TAB.PS' | translate }}\" *ngIf=\"bpmUser\">\n            <mat-card class=\"adf-userinfo-card\">\n                <mat-card-header class=\"adf-userinfo-card-header\" [style.background-image]=\"'url(' + bpmBackgroundImage + ')'\">\n                    <div *ngIf=\"!hasBpmUserPictureId()\" [outerHTML]=\"bpmUser | usernameInitials:'adf-userinfo-profile-initials adf-hide-small'\"></div>\n                    <img *ngIf=\"hasBpmUserPictureId()\" class=\"adf-userinfo-profile-picture adf-hide-small\" id=\"bpm-user-detail-image\"\n                            alt=\"bpm-profile-image\" [src]=\"bpmUserImage\"/>\n                   <div class=\"adf-userinfo-title\" id=\"bpm-username\">{{bpmUser.fullNameDisplay}}</div>\n                </mat-card-header>\n                <mat-card-content>\n                    <div class=\"adf-userinfo-supporting-text\">\n                            <div class=\"adf-userinfo-detail\">\n                                <span id=\"bpm-full-name\" class=\"adf-userinfo__detail-title\">{{ bpmUser.fullNameDisplay }}</span>\n                                <span class=\"adf-userinfo__detail-profile\" id=\"bpm-email\"> {{bpmUser.email}} </span>\n                            </div>\n                            <div class=\"adf-userinfo-detail\">\n                                <span id=\"bpm-tenant\" class=\"adf-userinfo__secondary-info\">\n                                    {{ 'USER_PROFILE.LABELS.BPM.TENANT' | translate }}\n                                    <span class=\"adf-userinfo__detail-profile\">{{ bpmUser.tenantName ? bpmUser.tenantName : '' }}</span>\n                                </span>\n                            </div>\n                    </div>\n                </mat-card-content>\n            </mat-card>\n            </mat-tab>\n        </mat-tab-group>\n    </mat-menu>\n</div>\n",
                encapsulation: ViewEncapsulation.None
            },] },
];
UserInfoComponent.ctorParameters = function () { return [
    { type: EcmUserService, },
    { type: BpmUserService, },
    { type: AuthenticationService, },
]; };
UserInfoComponent.propDecorators = {
    "ecmBackgroundImage": [{ type: Input },],
    "bpmBackgroundImage": [{ type: Input },],
    "menuPositionX": [{ type: Input },],
    "menuPositionY": [{ type: Input },],
    "showName": [{ type: Input },],
    "namePosition": [{ type: Input },],
};
var UserInfoModule = /** @class */ (function () {
    function UserInfoModule() {
    }
    return UserInfoModule;
}());
UserInfoModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    CommonModule,
                    MaterialModule,
                    TranslateModule,
                    PipeModule
                ],
                declarations: [
                    UserInfoComponent
                ],
                providers: [
                    EcmUserService,
                    BpmUserService
                ],
                exports: [
                    UserInfoComponent
                ]
            },] },
];
UserInfoModule.ctorParameters = function () { return []; };
var SettingsService = /** @class */ (function () {
    function SettingsService(appConfig, logService, preferences) {
        this.appConfig = appConfig;
        this.logService = logService;
        this.preferences = preferences;
    }
    Object.defineProperty(SettingsService.prototype, "ecmHost", {
        get: function () {
            this.logService.log('SettingsService.ecmHost is deprecated. Use AppConfigService instead.');
            return this.appConfig.get('ecmHost');
        },
        set: function (ecmHostUrl) {
            this.logService.log('SettingsService.ecmHost is deprecated. Use AppConfigService instead.');
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SettingsService.prototype, "csrfDisabled", {
        set: function (csrfDisabled) {
            this.logService.log("SettingsService.csrfDisabled is deprecated. Use UserPreferencesService.disableCSRF instead.");
            this.preferences.disableCSRF = csrfDisabled;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SettingsService.prototype, "bpmHost", {
        get: function () {
            this.logService.log('SettingsService.bpmHost is deprecated. Use AppConfigService instead.');
            return this.appConfig.get('bpmHost');
        },
        set: function (bpmHostUrl) {
            this.logService.log('SettingsService.bpmHost is deprecated. Use AppConfigService instead.');
        },
        enumerable: true,
        configurable: true
    });
    SettingsService.prototype.getBPMApiBaseUrl = function () {
        this.logService.log('SettingsService.getBPMApiBaseUrl is deprecated.');
        return this.bpmHost + '/activiti-app';
    };
    SettingsService.prototype.getProviders = function () {
        this.logService.log("SettingsService.getProviders is deprecated. Use UserPreferencesService.authType instead.");
        return this.preferences.authType;
    };
    SettingsService.prototype.setProviders = function (providers) {
        this.logService.log("SettingsService.getProviders is deprecated. Use UserPreferencesService.authType instead.");
        this.preferences.authType = providers;
    };
    return SettingsService;
}());
SettingsService.decorators = [
    { type: Injectable },
];
SettingsService.ctorParameters = function () { return [
    { type: AppConfigService, },
    { type: LogService, },
    { type: UserPreferencesService, },
]; };
var HostSettingsComponent = /** @class */ (function () {
    function HostSettingsComponent(settingsService, storage, logService, translationService) {
        this.settingsService = settingsService;
        this.storage = storage;
        this.logService = logService;
        this.translationService = translationService;
        this.HOST_REGEX = '^(http|https):\/\/.*[^/]$';
        this.urlFormControlEcm = new FormControl('', [Validators.required, Validators.pattern(this.HOST_REGEX)]);
        this.urlFormControlBpm = new FormControl('', [Validators.required, Validators.pattern(this.HOST_REGEX)]);
        this.providers = 'ALL';
        this.error = new EventEmitter();
        this.ecmHostChange = new EventEmitter();
        this.bpmHostChange = new EventEmitter();
        this.ecmHostTmp = this.ecmHost = storage.getItem('ecmHost') || this.settingsService.ecmHost;
        this.bpmHostTmp = this.bpmHost = storage.getItem('bpmHost') || this.settingsService.bpmHost;
    }
    HostSettingsComponent.prototype.onChangeECMHost = function (event) {
        var _this = this;
        var value = ((event.target)).value.trim();
        if (value && this.isValidUrl(value)) {
            this.logService.info("ECM host: " + value);
            this.ecmHostTmp = value;
            this.ecmHostChange.emit(value);
        }
        else {
            this.translationService.get('CORE.HOST_SETTING.CS_URL_ERROR').subscribe(function (message) {
                _this.error.emit(message);
            });
        }
    };
    HostSettingsComponent.prototype.onChangeBPMHost = function (event) {
        var _this = this;
        var value = ((event.target)).value.trim();
        if (value && this.isValidUrl(value)) {
            this.logService.info("BPM host: " + value);
            this.bpmHostTmp = value;
            this.bpmHostChange.emit(value);
        }
        else {
            this.translationService.get('CORE.HOST_SETTING.PS_URL_ERROR').subscribe(function (message) {
                _this.error.emit(message);
            });
        }
    };
    HostSettingsComponent.prototype.save = function (event) {
        if (this.bpmHost !== this.bpmHostTmp) {
            this.storage.setItem("bpmHost", this.bpmHostTmp);
        }
        if (this.ecmHost !== this.ecmHostTmp) {
            this.storage.setItem("ecmHost", this.ecmHostTmp);
        }
        window.location.href = '/';
    };
    HostSettingsComponent.prototype.isValidUrl = function (url) {
        return /^(http|https):\/\/.*/.test(url);
    };
    return HostSettingsComponent;
}());
HostSettingsComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-host-settings',
                template: "<div class=\"adf-setting-container\">\n    <div class=\"adf-setting-card-padding\"></div>\n    <mat-toolbar color=\"primary\" class=\"adf-setting-toolbar\">\n        <h3>{{'CORE.HOST_SETTINGS.TITLE' | translate}}</h3>\n    </mat-toolbar>\n\n    <mat-card class=\"adf-setting-card\">\n        <div *ngIf=\"providers==='ALL' || providers==='ECM'\">\n            <mat-card-header>\n                <mat-card-subtitle>{{'CORE.HOST_SETTINGS.CS-HOST' | translate }}</mat-card-subtitle>\n            </mat-card-header>\n            <mat-card-content>\n                <mat-form-field class=\"full-width\">\n                    <mat-icon class=\"adf-CORE.HOST_SETTINGS-link-icon\" matPrefix>link</mat-icon>\n                    <input matInput\n                           [formControl]=\"urlFormControlEcm\"\n                           data-automation-id=\"ecmHost\"\n                           type=\"text\"\n                           (change)=\"onChangeECMHost($event)\"\n                           tabindex=\"2\"\n                           id=\"ecmHost\"\n                           value=\"{{ecmHost}}\"\n                           placeholder=\"http(s)://host|ip:port(/path)\">\n                    <mat-error *ngIf=\"urlFormControlEcm.hasError('pattern')\">\n                        {{ 'CORE.HOST_SETTINGS.NOT_VALID'| translate }}\n                    </mat-error>\n                </mat-form-field>\n                <p>\n            </mat-card-content>\n        </div>\n        <p>\n        <div *ngIf=\"providers==='ALL' || providers==='BPM'\">\n            <mat-card-header>\n                <mat-card-subtitle>{{'CORE.HOST_SETTINGS.BP-HOST' | translate }}</mat-card-subtitle>\n            </mat-card-header>\n            <mat-card-content>\n\n                <mat-form-field class=\"full-width\">\n                    <mat-icon class=\"adf-CORE.HOST_SETTINGS-link-icon\" matPrefix>link</mat-icon>\n                    <input matInput\n                           [formControl]=\"urlFormControlBpm\"\n                           data-automation-id=\"bpmHost\"\n                           type=\"text\"\n                           (change)=\"onChangeBPMHost($event)\"\n                           tabindex=\"2\"\n                           id=\"bpmHost\"\n                           value=\"{{bpmHost}}\"\n                           placeholder=\"http(s)://host|ip:port(/path)\">\n                    <mat-error *ngIf=\"urlFormControlBpm.hasError('pattern')\">\n                        {{ 'CORE.HOST_SETTINGS.NOT_VALID'| translate }}\n                    </mat-error>\n                </mat-form-field>\n            </mat-card-content>\n        </div>\n        <mat-card-actions class=\"adf-CORE.HOST_SETTINGS-actions\">\n\n            <button mat-button onclick=\"window.history.back()\" color=\"primary\">\n                {{'CORE.HOST_SETTINGS.BACK' | translate }}\n            </button>\n\n            <button mat-raised-button (click)=\"save($event)\"\n                    [disabled]=\"urlFormControlBpm.hasError('pattern') || urlFormControlEcm.hasError('pattern')\"\n                    color=\"primary\">\n                {{'CORE.HOST_SETTINGS.APPLY' | translate }}\n            </button>\n\n        </mat-card-actions>\n    </mat-card>\n    <div class=\"adf-setting-card-padding\"></div>\n</div>\n",
                host: {
                    'class': 'adf-host-settings'
                },
                styles: [""],
                encapsulation: ViewEncapsulation.None
            },] },
];
HostSettingsComponent.ctorParameters = function () { return [
    { type: SettingsService, },
    { type: StorageService, },
    { type: LogService, },
    { type: TranslationService, },
]; };
HostSettingsComponent.propDecorators = {
    "providers": [{ type: Input },],
    "error": [{ type: Output },],
    "ecmHostChange": [{ type: Output },],
    "bpmHostChange": [{ type: Output },],
};
var HostSettingsModule = /** @class */ (function () {
    function HostSettingsModule() {
    }
    return HostSettingsModule;
}());
HostSettingsModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    CommonModule,
                    MaterialModule,
                    TranslateModule,
                    FormsModule,
                    ReactiveFormsModule
                ],
                declarations: [
                    HostSettingsComponent
                ],
                exports: [
                    HostSettingsComponent
                ]
            },] },
];
HostSettingsModule.ctorParameters = function () { return []; };
var PaginationModel = /** @class */ (function () {
    function PaginationModel(obj) {
        if (obj) {
            this.count = obj.count;
            this.hasMoreItems = obj.hasMoreItems ? obj.hasMoreItems : false;
            this.merge = obj.merge ? obj.merge : false;
            this.totalItems = obj.totalItems;
            this.skipCount = obj.skipCount;
            this.maxItems = obj.maxItems;
        }
    }
    return PaginationModel;
}());
var PaginationComponent = /** @class */ (function () {
    function PaginationComponent(cdr) {
        this.cdr = cdr;
        this.supportedPageSizes = [5, 25, 50, 100];
        this.pagination = PaginationComponent.DEFAULT_PAGINATION;
        this.change = new EventEmitter();
        this.changePageNumber = new EventEmitter();
        this.changePageSize = new EventEmitter();
        this.nextPage = new EventEmitter();
        this.prevPage = new EventEmitter();
    }
    PaginationComponent.prototype.ngOnInit = function () {
        var _this = this;
        if (this.target) {
            this.paginationSubscription = this.target.pagination.subscribe(function (pagination) {
                _this.pagination = pagination;
                _this.cdr.detectChanges();
            });
        }
        if (!this.pagination) {
            this.pagination = PaginationComponent.DEFAULT_PAGINATION;
        }
    };
    Object.defineProperty(PaginationComponent.prototype, "lastPage", {
        get: function () {
            var _a = this.pagination, maxItems = _a.maxItems, totalItems = _a.totalItems;
            return (totalItems && maxItems)
                ? Math.ceil(totalItems / maxItems)
                : 1;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationComponent.prototype, "current", {
        get: function () {
            var _a = this.pagination, maxItems = _a.maxItems, skipCount = _a.skipCount;
            return (skipCount && maxItems)
                ? Math.floor(skipCount / maxItems) + 1
                : 1;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationComponent.prototype, "isLastPage", {
        get: function () {
            return this.current === this.lastPage;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationComponent.prototype, "isFirstPage", {
        get: function () {
            return this.current === 1;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationComponent.prototype, "next", {
        get: function () {
            return this.isLastPage ? this.current : this.current + 1;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationComponent.prototype, "previous", {
        get: function () {
            return this.isFirstPage ? 1 : this.current - 1;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationComponent.prototype, "hasItems", {
        get: function () {
            return this.pagination && this.pagination.count > 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationComponent.prototype, "isEmpty", {
        get: function () {
            return !this.hasItems;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationComponent.prototype, "range", {
        get: function () {
            var _a = this.pagination, skipCount = _a.skipCount, maxItems = _a.maxItems, totalItems = _a.totalItems;
            var isLastPage = this.isLastPage;
            var start = totalItems ? skipCount + 1 : 0;
            var end = isLastPage ? totalItems : skipCount + maxItems;
            return [start, end];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PaginationComponent.prototype, "pages", {
        get: function () {
            return Array(this.lastPage)
                .fill('n')
                .map(function (item, index) { return (index + 1); });
        },
        enumerable: true,
        configurable: true
    });
    PaginationComponent.prototype.goNext = function () {
        if (this.hasItems) {
            var maxItems = this.pagination.maxItems;
            var skipCount = (this.next - 1) * maxItems;
            this.pagination.skipCount = skipCount;
            this.handlePaginationEvent(PaginationComponent.ACTIONS.NEXT_PAGE, {
                skipCount: skipCount,
                maxItems: maxItems
            });
        }
    };
    PaginationComponent.prototype.goPrevious = function () {
        if (this.hasItems) {
            var maxItems = this.pagination.maxItems;
            var skipCount = (this.previous - 1) * maxItems;
            this.pagination.skipCount = skipCount;
            this.handlePaginationEvent(PaginationComponent.ACTIONS.PREV_PAGE, {
                skipCount: skipCount,
                maxItems: maxItems
            });
        }
    };
    PaginationComponent.prototype.onChangePageNumber = function (pageNumber) {
        if (this.hasItems) {
            var maxItems = this.pagination.maxItems;
            var skipCount = (pageNumber - 1) * maxItems;
            this.pagination.skipCount = skipCount;
            this.handlePaginationEvent(PaginationComponent.ACTIONS.CHANGE_PAGE_NUMBER, {
                skipCount: skipCount,
                maxItems: maxItems
            });
        }
    };
    PaginationComponent.prototype.onChangePageSize = function (maxItems) {
        this.pagination.skipCount = 0;
        this.pagination.maxItems = maxItems;
        this.handlePaginationEvent(PaginationComponent.ACTIONS.CHANGE_PAGE_SIZE, {
            skipCount: 0,
            maxItems: maxItems
        });
    };
    PaginationComponent.prototype.handlePaginationEvent = function (action, params) {
        var _a = PaginationComponent.ACTIONS, NEXT_PAGE = _a.NEXT_PAGE, PREV_PAGE = _a.PREV_PAGE, CHANGE_PAGE_NUMBER = _a.CHANGE_PAGE_NUMBER, CHANGE_PAGE_SIZE = _a.CHANGE_PAGE_SIZE;
        var _b = this, change = _b.change, changePageNumber = _b.changePageNumber, changePageSize = _b.changePageSize, nextPage = _b.nextPage, prevPage = _b.prevPage, pagination = _b.pagination;
        var data = Object.assign({}, pagination, params);
        if (action === NEXT_PAGE) {
            nextPage.emit(data);
        }
        if (action === PREV_PAGE) {
            prevPage.emit(data);
        }
        if (action === CHANGE_PAGE_NUMBER) {
            changePageNumber.emit(data);
        }
        if (action === CHANGE_PAGE_SIZE) {
            changePageSize.emit(data);
        }
        change.emit(params);
        if (this.target) {
            this.target.updatePagination(params);
        }
    };
    PaginationComponent.prototype.ngOnDestroy = function () {
        if (this.paginationSubscription) {
            this.paginationSubscription.unsubscribe();
        }
    };
    return PaginationComponent;
}());
PaginationComponent.DEFAULT_PAGINATION = {
    skipCount: 0,
    maxItems: 25,
    totalItems: 0
};
PaginationComponent.ACTIONS = {
    NEXT_PAGE: 'NEXT_PAGE',
    PREV_PAGE: 'PREV_PAGE',
    CHANGE_PAGE_SIZE: 'CHANGE_PAGE_SIZE',
    CHANGE_PAGE_NUMBER: 'CHANGE_PAGE_NUMBER'
};
PaginationComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-pagination',
                host: { 'class': 'adf-pagination' },
                template: "<ng-container *ngIf=\"hasItems\">\n    <div class=\"adf-pagination__block adf-pagination__range-block\">\n        <span class=\"adf-pagination__range\">\n            {{\n                'CORE.PAGINATION.ITEMS_RANGE' | translate: {\n                    range: range.join('-'),\n                    total: pagination.totalItems\n                }\n            }}\n        </span>\n    </div>\n\n    <div class=\"adf-pagination__block adf-pagination__perpage-block\">\n        <span>\n            {{ 'CORE.PAGINATION.ITEMS_PER_PAGE' | translate }}\n        </span>\n\n        <span class=\"adf-pagination__max-items\">\n            {{ pagination.maxItems }}\n        </span>\n\n        <button mat-icon-button [matMenuTriggerFor]=\"pageSizeMenu\">\n            <mat-icon>arrow_drop_down</mat-icon>\n        </button>\n\n        <mat-menu #pageSizeMenu=\"matMenu\" class=\"adf-pagination__page-selector\">\n            <button\n                mat-menu-item\n                *ngFor=\"let pageSize of supportedPageSizes\"\n                (click)=\"onChangePageSize(pageSize)\">\n                {{ pageSize }}\n            </button>\n        </mat-menu>\n    </div>\n\n    <div class=\"adf-pagination__block adf-pagination__actualinfo-block\">\n        <span class=\"adf-pagination__current-page\">\n            {{ 'CORE.PAGINATION.CURRENT_PAGE' | translate: { number: current } }}\n        </span>\n\n        <button\n            mat-icon-button\n            [matMenuTriggerFor]=\"pagesMenu\"\n            *ngIf=\"pages.length > 1\">\n            <mat-icon>arrow_drop_down</mat-icon>\n        </button>\n\n        <span class=\"adf-pagination__total-pages\">\n            {{ 'CORE.PAGINATION.TOTAL_PAGES' | translate: { total: pages.length } }}\n        </span>\n\n        <mat-menu #pagesMenu=\"matMenu\" class=\"adf-pagination__page-selector\">\n            <button\n                mat-menu-item\n                *ngFor=\"let pageNumber of pages\"\n                (click)=\"onChangePageNumber(pageNumber)\">\n                {{ pageNumber }}\n            </button>\n        </mat-menu>\n    </div>\n\n    <div class=\"adf-pagination__block adf-pagination__controls-block\">\n        <button\n            class=\"adf-pagination__previous-button\"\n            mat-icon-button\n            [disabled]=\"isFirstPage\"\n            (click)=\"goPrevious()\">\n            <mat-icon>keyboard_arrow_left</mat-icon>\n        </button>\n\n        <button\n            class=\"adf-pagination__next-button\"\n            mat-icon-button\n            [disabled]=\"isLastPage\"\n            (click)=\"goNext()\">\n            <mat-icon>keyboard_arrow_right</mat-icon>\n        </button>\n    </div>\n</ng-container>\n",
                styles: [""],
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            },] },
];
PaginationComponent.ctorParameters = function () { return [
    { type: ChangeDetectorRef, },
]; };
PaginationComponent.propDecorators = {
    "target": [{ type: Input },],
    "supportedPageSizes": [{ type: Input },],
    "pagination": [{ type: Input },],
    "change": [{ type: Output },],
    "changePageNumber": [{ type: Output },],
    "changePageSize": [{ type: Output },],
    "nextPage": [{ type: Output },],
    "prevPage": [{ type: Output },],
    "isEmpty": [{ type: HostBinding, args: ['class.adf-pagination__empty',] },],
};
var InfinitePaginationComponent = /** @class */ (function () {
    function InfinitePaginationComponent(cdr) {
        this.cdr = cdr;
        this.pageSize = InfinitePaginationComponent.DEFAULT_PAGE_SIZE;
        this.isLoading = false;
        this.loadMore = new EventEmitter();
    }
    InfinitePaginationComponent.prototype.ngOnInit = function () {
        var _this = this;
        if (this.target) {
            this.paginationSubscription = this.target.pagination.subscribe(function (pagination) {
                _this.isLoading = false;
                _this.pagination = pagination;
                _this.pageSize = pagination.maxItems;
                _this.cdr.detectChanges();
            });
        }
        if (!this.pagination) {
            this.pagination = InfinitePaginationComponent.DEFAULT_PAGINATION;
        }
    };
    InfinitePaginationComponent.prototype.onLoadMore = function () {
        this.pagination.skipCount += this.pageSize;
        this.pagination.skipCount = this.pagination.skipCount;
        this.pagination.merge = true;
        this.loadMore.next(this.pagination);
        if ((this.pagination.skipCount + this.pageSize) > this.pagination.totalItems) {
            this.pagination.hasMoreItems = false;
        }
        if (this.target) {
            this.target.pagination.value.merge = this.pagination.merge;
            this.target.pagination.value.skipCount = this.pagination.skipCount;
            this.isLoading = true;
            this.target.updatePagination((this.pagination));
        }
    };
    InfinitePaginationComponent.prototype.ngOnDestroy = function () {
        if (this.paginationSubscription) {
            this.paginationSubscription.unsubscribe();
        }
    };
    return InfinitePaginationComponent;
}());
InfinitePaginationComponent.DEFAULT_PAGE_SIZE = 25;
InfinitePaginationComponent.DEFAULT_PAGINATION = {
    skipCount: 0,
    hasMoreItems: false,
    merge: true
};
InfinitePaginationComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-infinite-pagination',
                host: { 'class': 'infinite-adf-pagination' },
                template: "<div *ngIf=\"pagination?.hasMoreItems || isLoading\" class=\"adf-infinite-pagination\">\n    <button mat-button\n        *ngIf=\"!isLoading\"\n        class=\"adf-infinite-pagination-load-more\"\n        (click)=\"onLoadMore($event)\"\n        data-automation-id=\"adf-infinite-pagination-button\">\n            <ng-content></ng-content>\n    </button>\n\n    <mat-progress-bar *ngIf=\"isLoading\"\n        mode=\"indeterminate\"\n        class=\"adf-infinite-pagination-spinner\"\n        data-automation-id=\"adf-infinite-pagination-spinner\"></mat-progress-bar>\n</div>\n",
                styles: [".adf-infinite-pagination{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around;min-height:56px}.adf-infinite-pagination-load-more{margin-bottom:10px;margin-top:10px}"],
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            },] },
];
InfinitePaginationComponent.ctorParameters = function () { return [
    { type: ChangeDetectorRef, },
]; };
InfinitePaginationComponent.propDecorators = {
    "pagination": [{ type: Input },],
    "target": [{ type: Input },],
    "pageSize": [{ type: Input },],
    "isLoading": [{ type: Input, args: ['loading',] },],
    "loadMore": [{ type: Output },],
};
var PaginationModule = /** @class */ (function () {
    function PaginationModule() {
    }
    return PaginationModule;
}());
PaginationModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    CommonModule,
                    MaterialModule,
                    TranslateModule
                ],
                declarations: [
                    InfinitePaginationComponent,
                    PaginationComponent
                ],
                exports: [
                    InfinitePaginationComponent,
                    PaginationComponent
                ]
            },] },
];
PaginationModule.ctorParameters = function () { return []; };
var LoginErrorEvent = /** @class */ (function () {
    function LoginErrorEvent(err) {
        this.err = err;
    }
    return LoginErrorEvent;
}());
var LoginSubmitEvent = /** @class */ (function () {
    function LoginSubmitEvent(_values) {
        this._defaultPrevented = false;
        this._values = _values;
    }
    Object.defineProperty(LoginSubmitEvent.prototype, "values", {
        get: function () {
            return this._values;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LoginSubmitEvent.prototype, "defaultPrevented", {
        get: function () {
            return this._defaultPrevented;
        },
        enumerable: true,
        configurable: true
    });
    LoginSubmitEvent.prototype.preventDefault = function () {
        this._defaultPrevented = true;
    };
    return LoginSubmitEvent;
}());
var LoginSuccessEvent = /** @class */ (function () {
    function LoginSuccessEvent(token, username, password) {
        this.token = token;
        this.username = username;
        this.password = password;
    }
    return LoginSuccessEvent;
}());
var LoginSteps = {
    Landing: 0,
    Checking: 1,
    Welcome: 2,
};
LoginSteps[LoginSteps.Landing] = "Landing";
LoginSteps[LoginSteps.Checking] = "Checking";
LoginSteps[LoginSteps.Welcome] = "Welcome";
var LoginComponent = /** @class */ (function () {
    function LoginComponent(_fb, authService, settingsService, translateService, logService, elementRef, router, userPreferences) {
        this._fb = _fb;
        this.authService = authService;
        this.settingsService = settingsService;
        this.translateService = translateService;
        this.logService = logService;
        this.elementRef = elementRef;
        this.router = router;
        this.userPreferences = userPreferences;
        this.isPasswordShow = false;
        this.showRememberMe = true;
        this.showLoginActions = true;
        this.needHelpLink = '';
        this.registerLink = '';
        this.logoImageUrl = './assets/images/alfresco-logo.svg';
        this.backgroundImageUrl = './assets/images/background.svg';
        this.copyrightText = '\u00A9 2016 Alfresco Software, Inc. All Rights Reserved.';
        this.successRoute = null;
        this.success = new EventEmitter();
        this.error = new EventEmitter();
        this.executeSubmit = new EventEmitter();
        this.isError = false;
        this.actualLoginStep = LoginSteps.Landing;
        this.LoginSteps = LoginSteps;
        this.rememberMe = true;
        this.minLength = 2;
        this.initFormError();
        this.initFormFieldsMessages();
    }
    LoginComponent.prototype.ngOnInit = function () {
        var _this = this;
        if (this.hasCustomFiledsValidation()) {
            this.form = this._fb.group(this.fieldsValidation);
        }
        else {
            this.initFormFieldsDefault();
            this.initFormFieldsMessagesDefault();
        }
        this.form.valueChanges.subscribe(function (data) { return _this.onValueChanged(data); });
    };
    LoginComponent.prototype.onSubmit = function (values) {
        if (!this.checkRequiredParams()) {
            return false;
        }
        this.settingsService.setProviders(this.providers);
        this.settingsService.csrfDisabled = this.disableCsrf;
        this.disableError();
        var args = new LoginSubmitEvent(this.form);
        this.executeSubmit.emit(args);
        if (args.defaultPrevented) {
            return false;
        }
        else {
            this.performLogin(values);
        }
    };
    LoginComponent.prototype.onValueChanged = function (data) {
        this.disableError();
        for (var field in this.formError) {
            if (field) {
                this.formError[field] = '';
                var hasError = (this.form.controls[field].errors && data[field] !== '') ||
                    (this.form.controls[field].dirty && !this.form.controls[field].valid);
                if (hasError) {
                    for (var key in this.form.controls[field].errors) {
                        if (key) {
                            this.formError[field] += this._message[field][key] + '';
                        }
                    }
                }
            }
        }
    };
    LoginComponent.prototype.performLogin = function (values) {
        var _this = this;
        this.actualLoginStep = LoginSteps.Checking;
        this.authService.login(values.username, values.password, this.rememberMe)
            .subscribe(function (token) {
            var redirectUrl = _this.authService.getRedirectUrl(_this.providers);
            _this.actualLoginStep = LoginSteps.Welcome;
            _this.userPreferences.setStoragePrefix(values.username);
            values.password = null;
            _this.success.emit(new LoginSuccessEvent(token, values.username, null));
            if (redirectUrl) {
                _this.authService.setRedirectUrl(null);
                _this.router.navigate([redirectUrl]);
            }
            else if (_this.successRoute) {
                _this.router.navigate([_this.successRoute]);
            }
        }, function (err) {
            _this.actualLoginStep = LoginSteps.Landing;
            _this.displayErrorMessage(err);
            _this.enableError();
            _this.error.emit(new LoginErrorEvent(err));
        }, function () { return _this.logService.info('Login done'); });
    };
    LoginComponent.prototype.displayErrorMessage = function (err) {
        if (err.error && err.error.crossDomain && err.error.message.indexOf('Access-Control-Allow-Origin') !== -1) {
            this.errorMsg = err.error.message;
        }
        else if (err.status === 403 && err.message.indexOf('Invalid CSRF-token') !== -1) {
            this.errorMsg = 'LOGIN.MESSAGES.LOGIN-ERROR-CSRF';
        }
        else if (err.status === 403 && err.message.indexOf('The system is currently in read-only mode') !== -1) {
            this.errorMsg = 'LOGIN.MESSAGES.LOGIN-ECM-LICENSE';
        }
        else {
            this.errorMsg = 'LOGIN.MESSAGES.LOGIN-ERROR-CREDENTIALS';
        }
    };
    LoginComponent.prototype.checkRequiredParams = function () {
        var isAllParamPresent = true;
        if (this.providers === undefined || this.providers === null || this.providers === '') {
            this.errorMsg = 'LOGIN.MESSAGES.LOGIN-ERROR-PROVIDERS';
            this.enableError();
            var messageProviders = void 0;
            messageProviders = this.translateService.get(this.errorMsg);
            this.error.emit(new LoginErrorEvent(messageProviders.value));
            isAllParamPresent = false;
        }
        return isAllParamPresent;
    };
    LoginComponent.prototype.addCustomFormError = function (field, msg) {
        this.formError[field] += msg;
    };
    LoginComponent.prototype.addCustomValidationError = function (field, ruleId, msg, params) {
        var _this = this;
        if (params) {
            this.translateService.get(msg, params).subscribe(function (res) {
                _this._message[field][ruleId] = res;
            });
        }
        else {
            this._message[field][ruleId] = msg;
        }
    };
    LoginComponent.prototype.toggleShowPassword = function () {
        this.isPasswordShow = !this.isPasswordShow;
        this.elementRef.nativeElement.querySelector('#password').type = this.isPasswordShow ? 'text' : 'password';
    };
    LoginComponent.prototype.isErrorStyle = function (field) {
        return !field.valid && field.dirty && !field.pristine;
    };
    LoginComponent.prototype.trimUsername = function (event) {
        event.target.value = event.target.value.trim();
    };
    LoginComponent.prototype.initFormError = function () {
        this.formError = {
            'username': '',
            'password': ''
        };
    };
    LoginComponent.prototype.initFormFieldsMessages = function () {
        this._message = {
            'username': {},
            'password': {}
        };
    };
    LoginComponent.prototype.initFormFieldsMessagesDefault = function () {
        var _this = this;
        this._message = {
            'username': {
                'required': 'LOGIN.MESSAGES.USERNAME-REQUIRED'
            },
            'password': {
                'required': 'LOGIN.MESSAGES.PASSWORD-REQUIRED'
            }
        };
        this.translateService.get('LOGIN.MESSAGES.USERNAME-MIN', { minLength: this.minLength }).subscribe(function (res) {
            _this._message['username']['minlength'] = res;
        });
    };
    LoginComponent.prototype.initFormFieldsDefault = function () {
        this.form = this._fb.group({
            username: ['', Validators.required],
            password: ['', Validators.required]
        });
    };
    LoginComponent.prototype.disableError = function () {
        this.isError = false;
        this.initFormError();
    };
    LoginComponent.prototype.enableError = function () {
        this.isError = true;
    };
    LoginComponent.prototype.hasCustomFiledsValidation = function () {
        return this.fieldsValidation !== undefined;
    };
    return LoginComponent;
}());
LoginComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-login',
                template: "<div class=\"adf-login-content\" [style.background-image]=\"'url(' + backgroundImageUrl + ')'\">\n     <div class=\"ie11FixerParent\">\n         <div class=\"ie11FixerChild\">\n\n            <mat-card class=\"adf-login-card-wide\">\n                <form id=\"adf-login-form\" [formGroup]=\"form\" (submit)=\"onSubmit(form.value)\" autocomplete=\"off\">\n\n                    <mat-card-header>\n                        <mat-card-title>\n                            <div class=\"adf-alfresco-logo\">\n                                <!--HEADER TEMPLATE-->\n                                <ng-template *ngIf=\"headerTemplate\"\n                                            ngFor [ngForOf]=\"[data]\"\n                                            [ngForTemplate]=\"headerTemplate\">\n                                </ng-template>\n                                <img *ngIf=\"!headerTemplate\" class=\"adf-img-logo\" [src]=\"logoImageUrl\"\n                                    alt=\"{{'LOGIN.LOGO' | translate }}\">\n                            </div>\n                        </mat-card-title>\n                    </mat-card-header>\n\n                    <mat-card-content class=\"adf-login-controls\">\n\n                        <!--ERRORS AREA-->\n                        <div class=\"adf-error-container\">\n                            <div *ngIf=\"isError\" id=\"login-error\" data-automation-id=\"login-error\"\n                                class=\"error  adf-error-message\">\n                                <mat-icon class=\"error-icon\">warning</mat-icon>\n                                <span class=\"login-error-message\">{{errorMsg | translate }}</span>\n                            </div>\n                        </div>\n\n                        <!--USERNAME FIELD-->\n                        <div class=\"adf-login__field\" [ngClass]=\"{'is-invalid': isErrorStyle(form.controls.username)}\">\n                            <mat-form-field class=\"adf-full-width\" floatPlaceholder=\"never\" color=\"primary\">\n                                <input matInput placeholder=\"{{'LOGIN.LABEL.USERNAME' | translate }}\"\n                                    type=\"text\"\n                                    class=\"adf-full-width\"\n                                    [formControl]=\"form.controls['username']\"\n                                    autocapitalize=\"none\"\n                                    id=\"username\"\n                                    data-automation-id=\"username\"\n                                    (blur)=\"trimUsername($event)\"\n                                    tabindex=\"1\">\n                            </mat-form-field>\n\n                            <span class=\"adf-login-validation\" for=\"username\" *ngIf=\"formError.username\">\n                                <span id=\"username-error\" class=\"adf-login-error\" data-automation-id=\"username-error\">{{formError.username | translate }}</span>\n                            </span>\n                        </div>\n\n                        <!--PASSWORD FIELD-->\n                        <div class=\"adf-login__field\">\n                            <mat-form-field class=\"adf-full-width\" floatPlaceholder=\"never\" color=\"primary\">\n                                <input matInput placeholder=\"{{'LOGIN.LABEL.PASSWORD' | translate }}\"\n                                    type=\"password\"\n                                    [formControl]=\"form.controls['password']\"\n                                    id=\"password\"\n                                    data-automation-id=\"password\"\n                                    tabindex=\"2\">\n                                <mat-icon *ngIf=\"isPasswordShow\" matSuffix class=\"adf-login-password-icon\"\n                                        data-automation-id=\"hide_password\" (click)=\"toggleShowPassword()\">visibility\n                                </mat-icon>\n                                <mat-icon *ngIf=\"!isPasswordShow\" matSuffix class=\"adf-login-password-icon\"\n                                        data-automation-id=\"show_password\" (click)=\"toggleShowPassword()\">visibility_off\n                                </mat-icon>\n                            </mat-form-field>\n                            <span class=\"adf-login-validation\" for=\"password\" *ngIf=\"formError.password\">\n                                <span id=\"password-required\" class=\"adf-login-error\"\n                                    data-automation-id=\"password-required\">{{formError.password | translate }}</span>\n                            </span>\n                        </div>\n\n                        <!--CUSTOM CONTENT-->\n                        <ng-content></ng-content>\n\n                        <br>\n                        <button type=\"submit\" id=\"login-button\" tabindex=\"3\"\n                                class=\"adf-login-button\"\n                                mat-raised-button color=\"primary\"\n                                [class.isChecking]=\"actualLoginStep === LoginSteps.Checking\"\n                                [class.isWelcome]=\"actualLoginStep === LoginSteps.Welcome\"\n                                data-automation-id=\"login-button\" [disabled]=\"!form.valid\">\n\n                            <span *ngIf=\"actualLoginStep === LoginSteps.Landing\" class=\"adf-login-button-label\">{{ 'LOGIN.BUTTON.LOGIN' | translate }}</span>\n\n                            <div *ngIf=\"actualLoginStep === LoginSteps.Checking\" class=\"adf-interactive-login-label\">\n                                <span class=\"adf-login-button-label\">{{ 'LOGIN.BUTTON.CHECKING' | translate }}</span>\n                                <div class=\"adf-login-spinner-container\">\n                                    <mat-spinner id=\"checking-spinner\" class=\"adf-login-checking-spinner\" [diameter]=\"25\"></mat-spinner>\n                                </div>\n                            </div>\n\n\n                            <div *ngIf=\"actualLoginStep === LoginSteps.Welcome\" class=\"adf-interactive-login-label\">\n                                <span class=\"adf-login-button-label\">{{ 'LOGIN.BUTTON.WELCOME' | translate }}</span>\n                                <mat-icon class=\"welcome-icon\">done</mat-icon>\n                            </div>\n\n                        </button>\n                        <div *ngIf=\"showRememberMe\" class=\"adf-login__remember-me\">\n                            <mat-checkbox id=\"adf-login-remember\" color=\"primary\" class=\"adf-login-rememberme\" [checked]=\"rememberMe\"\n                                        (change)=\"rememberMe = !rememberMe\">{{ 'LOGIN.LABEL.REMEMBER' | translate }}\n                            </mat-checkbox>\n                        </div>\n                    </mat-card-content>\n                    <mat-card-actions *ngIf=\"footerTemplate || showLoginActions\">\n\n                        <div class=\"adf-login-action-container\">\n                            <!--FOOTER TEMPLATE-->\n                            <ng-template *ngIf=\"footerTemplate\"\n                                        ngFor [ngForOf]=\"[data]\"\n                                        [ngForTemplate]=\"footerTemplate\">\n                            </ng-template>\n                            <div class=\"adf-login-action\" *ngIf=\"!footerTemplate && showLoginActions\">\n                                <div id=\"adf-login-action-left\" class=\"adf-login-action-left\">\n                                    <a href=\"{{needHelpLink}}\">{{'LOGIN.ACTION.HELP' | translate }}</a>\n                                </div>\n                                <div id=\"adf-login-action-right\" class=\"adf-login-action-right\">\n                                    <a href=\"{{registerLink}}\">{{'LOGIN.ACTION.REGISTER' | translate }}</a>\n                                </div>\n                            </div>\n                        </div>\n                    </mat-card-actions>\n\n                </form>\n            </mat-card>\n\n            <div class=\"copyright\" data-automation-id=\"login-copyright\">\n                {{ copyrightText }}\n            </div>\n\n        </div>\n     </div>\n</div>\n",
                styles: [""],
                host: { '(blur)': 'onBlur($event)' },
                encapsulation: ViewEncapsulation.None
            },] },
];
LoginComponent.ctorParameters = function () { return [
    { type: FormBuilder, },
    { type: AuthenticationService, },
    { type: SettingsService, },
    { type: TranslationService, },
    { type: LogService, },
    { type: ElementRef, },
    { type: Router, },
    { type: UserPreferencesService, },
]; };
LoginComponent.propDecorators = {
    "showRememberMe": [{ type: Input },],
    "showLoginActions": [{ type: Input },],
    "needHelpLink": [{ type: Input },],
    "registerLink": [{ type: Input },],
    "logoImageUrl": [{ type: Input },],
    "backgroundImageUrl": [{ type: Input },],
    "copyrightText": [{ type: Input },],
    "providers": [{ type: Input },],
    "fieldsValidation": [{ type: Input },],
    "disableCsrf": [{ type: Input },],
    "successRoute": [{ type: Input },],
    "success": [{ type: Output },],
    "error": [{ type: Output },],
    "executeSubmit": [{ type: Output },],
};
var LoginHeaderDirective = /** @class */ (function () {
    function LoginHeaderDirective(alfrescoLoginComponent) {
        this.alfrescoLoginComponent = alfrescoLoginComponent;
    }
    LoginHeaderDirective.prototype.ngAfterContentInit = function () {
        this.alfrescoLoginComponent.headerTemplate = this.template;
    };
    return LoginHeaderDirective;
}());
LoginHeaderDirective.decorators = [
    { type: Directive, args: [{
                selector: 'login-header'
            },] },
];
LoginHeaderDirective.ctorParameters = function () { return [
    { type: LoginComponent, },
]; };
LoginHeaderDirective.propDecorators = {
    "template": [{ type: ContentChild, args: [TemplateRef,] },],
};
var LoginFooterDirective = /** @class */ (function () {
    function LoginFooterDirective(alfrescoLoginComponent) {
        this.alfrescoLoginComponent = alfrescoLoginComponent;
    }
    LoginFooterDirective.prototype.ngAfterContentInit = function () {
        this.alfrescoLoginComponent.footerTemplate = this.template;
    };
    return LoginFooterDirective;
}());
LoginFooterDirective.decorators = [
    { type: Directive, args: [{
                selector: 'login-footer'
            },] },
];
LoginFooterDirective.ctorParameters = function () { return [
    { type: LoginComponent, },
]; };
LoginFooterDirective.propDecorators = {
    "template": [{ type: ContentChild, args: [TemplateRef,] },],
};
var LoginModule = /** @class */ (function () {
    function LoginModule() {
    }
    return LoginModule;
}());
LoginModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    RouterModule,
                    MaterialModule,
                    FormsModule,
                    ReactiveFormsModule,
                    CommonModule,
                    TranslateModule
                ],
                declarations: [
                    LoginComponent,
                    LoginFooterDirective,
                    LoginHeaderDirective
                ],
                exports: [
                    [
                        LoginComponent,
                        LoginFooterDirective,
                        LoginHeaderDirective
                    ]
                ]
            },] },
];
LoginModule.ctorParameters = function () { return []; };
var LanguageMenuComponent = /** @class */ (function () {
    function LanguageMenuComponent(appConfig, userPreference) {
        this.appConfig = appConfig;
        this.userPreference = userPreference;
        this.languages = [
            { key: 'en', label: 'English' }
        ];
    }
    LanguageMenuComponent.prototype.ngOnInit = function () {
        var languagesCongifApp = this.appConfig.get(AppConfigService.APP_CONFIG_LANGUAGES_KEY);
        if (languagesCongifApp) {
            this.languages = languagesCongifApp;
        }
    };
    LanguageMenuComponent.prototype.changeLanguage = function (lang) {
        this.userPreference.locale = lang;
    };
    return LanguageMenuComponent;
}());
LanguageMenuComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-language-menu',
                template: "<button mat-menu-item *ngFor=\"let language of languages\" (click)=\"changeLanguage(language.key)\">{{language.label}}\n</button>\n"
            },] },
];
LanguageMenuComponent.ctorParameters = function () { return [
    { type: AppConfigService, },
    { type: UserPreferencesService, },
]; };
var LanguageMenuModule = /** @class */ (function () {
    function LanguageMenuModule() {
    }
    return LanguageMenuModule;
}());
LanguageMenuModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    CommonModule,
                    MaterialModule
                ],
                declarations: [
                    LanguageMenuComponent
                ],
                exports: [
                    LanguageMenuComponent
                ]
            },] },
];
LanguageMenuModule.ctorParameters = function () { return []; };
var InfoDrawerLayoutComponent = /** @class */ (function () {
    function InfoDrawerLayoutComponent() {
    }
    return InfoDrawerLayoutComponent;
}());
InfoDrawerLayoutComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-info-drawer-layout',
                template: "<div class=\"adf-info-drawer-layout-header\">\n    <div class=\"adf-info-drawer-layout-header-title\">\n        <ng-content select=\"[info-drawer-title]\"></ng-content>\n    </div>\n    <div class=\"adf-info-drawer-layout-header-buttons\">\n        <ng-content select=\"[info-drawer-buttons]\"></ng-content>\n    </div>\n</div>\n<div class=\"adf-info-drawer-layout-content\">\n    <ng-content select=\"[info-drawer-content]\"></ng-content>\n</div>",
                styles: [""],
                encapsulation: ViewEncapsulation.None,
                host: { 'class': 'adf-info-drawer-layout' }
            },] },
];
InfoDrawerLayoutComponent.ctorParameters = function () { return []; };
var InfoDrawerTitleDirective = /** @class */ (function () {
    function InfoDrawerTitleDirective() {
    }
    return InfoDrawerTitleDirective;
}());
InfoDrawerTitleDirective.decorators = [
    { type: Directive, args: [{ selector: '[info-drawer-title]' },] },
];
InfoDrawerTitleDirective.ctorParameters = function () { return []; };
var InfoDrawerButtonsDirective = /** @class */ (function () {
    function InfoDrawerButtonsDirective() {
    }
    return InfoDrawerButtonsDirective;
}());
InfoDrawerButtonsDirective.decorators = [
    { type: Directive, args: [{ selector: '[info-drawer-buttons]' },] },
];
InfoDrawerButtonsDirective.ctorParameters = function () { return []; };
var InfoDrawerContentDirective = /** @class */ (function () {
    function InfoDrawerContentDirective() {
    }
    return InfoDrawerContentDirective;
}());
InfoDrawerContentDirective.decorators = [
    { type: Directive, args: [{ selector: '[info-drawer-content]' },] },
];
InfoDrawerContentDirective.ctorParameters = function () { return []; };
var InfoDrawerTabComponent = /** @class */ (function () {
    function InfoDrawerTabComponent() {
        this.label = 'Main tab';
    }
    return InfoDrawerTabComponent;
}());
InfoDrawerTabComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-info-drawer-tab',
                template: '<ng-template><ng-content></ng-content></ng-template>'
            },] },
];
InfoDrawerTabComponent.ctorParameters = function () { return []; };
InfoDrawerTabComponent.propDecorators = {
    "label": [{ type: Input, args: ['label',] },],
    "content": [{ type: ViewChild, args: [TemplateRef,] },],
};
var InfoDrawerComponent = /** @class */ (function () {
    function InfoDrawerComponent() {
        this.title = null;
        this.selectedIndex = 0;
        this.currentTab = new EventEmitter();
    }
    InfoDrawerComponent.prototype.showTabLayout = function () {
        return this.contentBlocks.length > 0;
    };
    InfoDrawerComponent.prototype.onTabChange = function (event) {
        this.currentTab.emit(event.index);
    };
    return InfoDrawerComponent;
}());
InfoDrawerComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-info-drawer',
                template: "<adf-info-drawer-layout>\n    <div *ngIf=\"title\" info-drawer-title>{{title}}</div>\n    <ng-content *ngIf=\"!title\" info-drawer-title select=\"[info-drawer-title]\"></ng-content>\n\n    <ng-content info-drawer-buttons select=\"[info-drawer-buttons]\"></ng-content>\n\n    <ng-container info-drawer-content *ngIf=\"showTabLayout(); then tabLayout else singleLayout\"></ng-container>\n\n    <ng-template #tabLayout>\n        <mat-tab-group [(selectedIndex)]=\"selectedIndex\" class=\"adf-info-drawer-tabs\" (selectedTabChange)=\"onTabChange($event)\">\n            <ng-container *ngFor=\"let contentBlock of contentBlocks\">\n                <mat-tab [label]=\"contentBlock.label\" class=\"adf-info-drawer-tab\">\n                    <ng-container *ngTemplateOutlet=\"contentBlock.content\"></ng-container>\n                </mat-tab>\n            </ng-container>\n        </mat-tab-group>\n    </ng-template>\n\n    <ng-template #singleLayout>\n        <ng-content select=\"[info-drawer-content]\"></ng-content>\n    </ng-template>\n</adf-info-drawer-layout>\n",
                styles: [".adf-info-drawer{display:block}.adf-info-drawer .adf-info-drawer-layout-content{padding:0}.adf-info-drawer .adf-info-drawer-layout-content>:not(.adf-info-drawer-tabs){padding:10px}.adf-info-drawer .adf-info-drawer-layout-content .adf-info-drawer-tabs .mat-tab-body-content>*,.adf-info-drawer .adf-info-drawer-layout-content>:not(.adf-info-drawer-tabs)>*{margin-bottom:20px;display:block}.adf-info-drawer .adf-info-drawer-layout-content .adf-info-drawer-tabs .mat-tab-body-content>:last-child{margin-bottom:0}.adf-info-drawer .adf-info-drawer-layout-content .adf-info-drawer-tabs .mat-tab-label{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.adf-info-drawer .adf-info-drawer-layout-content .adf-info-drawer-tabs .mat-ink-bar{height:4px}.adf-info-drawer .adf-info-drawer-layout-content .adf-info-drawer-tabs .mat-tab-body{padding:10px}.adf-info-drawer .adf-info-drawer-layout-content .adf-info-drawer-tabs .mat-tab-body-content{overflow:initial}"],
                encapsulation: ViewEncapsulation.None,
                host: { 'class': 'adf-info-drawer' }
            },] },
];
InfoDrawerComponent.ctorParameters = function () { return []; };
InfoDrawerComponent.propDecorators = {
    "title": [{ type: Input },],
    "selectedIndex": [{ type: Input },],
    "currentTab": [{ type: Output },],
    "contentBlocks": [{ type: ContentChildren, args: [InfoDrawerTabComponent,] },],
};
function declarations() {
    return [
        InfoDrawerLayoutComponent,
        InfoDrawerTabComponent,
        InfoDrawerComponent,
        InfoDrawerTitleDirective,
        InfoDrawerButtonsDirective,
        InfoDrawerContentDirective
    ];
}
var InfoDrawerModule = /** @class */ (function () {
    function InfoDrawerModule() {
    }
    return InfoDrawerModule;
}());
InfoDrawerModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    CommonModule,
                    MaterialModule
                ],
                declarations: declarations(),
                exports: declarations()
            },] },
];
InfoDrawerModule.ctorParameters = function () { return []; };
var SidebarActionMenuComponent = /** @class */ (function () {
    function SidebarActionMenuComponent() {
    }
    SidebarActionMenuComponent.prototype.isExpanded = function () {
        return this.expanded;
    };
    return SidebarActionMenuComponent;
}());
SidebarActionMenuComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-sidebar-action-menu',
                template: "<div class=\"adf-sidebar-action-menu\">\n    <button *ngIf=\"isExpanded()\" mat-raised-button class=\"adf-sidebar-action-menu-button\" data-automation-id=\"create-button\" [matMenuTriggerFor]=\"adfSidebarMenu\">\n        <span *ngIf=\"title\" class=\"adf-sidebar-action-menu-text\">{{ title }}</span>\n        <ng-content select=\"[sidebar-menu-title-icon]\"></ng-content>\n    </button>\n\n    <div *ngIf=\"!isExpanded()\" class=\"adf-sidebar-action-menu-icon\" [matMenuTriggerFor]=\"adfSidebarMenu\">\n        <ng-content select=\"[sidebar-menu-expand-icon]\"></ng-content>\n    </div>\n\n    <mat-menu #adfSidebarMenu=\"matMenu\" class=\"adf-sidebar-action-menu-panel\" [overlapTrigger]=\"false\" yPosition=\"below\">\n        <div class=\"adf-sidebar-action-menu-options\">\n            <ng-content select=\"[sidebar-menu-options]\"></ng-content>\n        </div>\n    </mat-menu>\n</div>\n",
                styles: [""],
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None,
                host: { 'class': 'adf-sidebar-action-menu' }
            },] },
];
SidebarActionMenuComponent.ctorParameters = function () { return []; };
SidebarActionMenuComponent.propDecorators = {
    "title": [{ type: Input },],
    "expanded": [{ type: Input },],
};
var SidebarMenuDirective = /** @class */ (function () {
    function SidebarMenuDirective() {
    }
    return SidebarMenuDirective;
}());
SidebarMenuDirective.decorators = [
    { type: Directive, args: [{ selector: '[sidebar-menu-options]' },] },
];
SidebarMenuDirective.ctorParameters = function () { return []; };
var SidebarMenuTitleIconDirective = /** @class */ (function () {
    function SidebarMenuTitleIconDirective() {
    }
    return SidebarMenuTitleIconDirective;
}());
SidebarMenuTitleIconDirective.decorators = [
    { type: Directive, args: [{ selector: '[sidebar-menu-title-icon]' },] },
];
SidebarMenuTitleIconDirective.ctorParameters = function () { return []; };
var SidebarMenuExpandIconDirective = /** @class */ (function () {
    function SidebarMenuExpandIconDirective() {
    }
    return SidebarMenuExpandIconDirective;
}());
SidebarMenuExpandIconDirective.decorators = [
    { type: Directive, args: [{ selector: '[sidebar-menu-expand-icon]' },] },
];
SidebarMenuExpandIconDirective.ctorParameters = function () { return []; };
var DataColumnComponent = /** @class */ (function () {
    function DataColumnComponent() {
        this.type = 'text';
        this.sortable = true;
        this.title = '';
    }
    DataColumnComponent.prototype.ngOnInit = function () {
        if (!this.srTitle && this.key === '$thumbnail') {
            this.srTitle = 'Thumbnail';
        }
    };
    return DataColumnComponent;
}());
DataColumnComponent.decorators = [
    { type: Component, args: [{
                selector: 'data-column',
                template: ''
            },] },
];
DataColumnComponent.ctorParameters = function () { return []; };
DataColumnComponent.propDecorators = {
    "key": [{ type: Input },],
    "type": [{ type: Input },],
    "format": [{ type: Input },],
    "sortable": [{ type: Input },],
    "title": [{ type: Input },],
    "template": [{ type: ContentChild, args: [TemplateRef,] },],
    "formatTooltip": [{ type: Input },],
    "srTitle": [{ type: Input, args: ['sr-title',] },],
    "cssClass": [{ type: Input, args: ['class',] },],
};
var DataColumnListComponent = /** @class */ (function () {
    function DataColumnListComponent() {
    }
    return DataColumnListComponent;
}());
DataColumnListComponent.decorators = [
    { type: Component, args: [{
                selector: 'data-columns',
                template: ''
            },] },
];
DataColumnListComponent.ctorParameters = function () { return []; };
DataColumnListComponent.propDecorators = {
    "columns": [{ type: ContentChildren, args: [DataColumnComponent,] },],
};
var DataColumnModule = /** @class */ (function () {
    function DataColumnModule() {
    }
    return DataColumnModule;
}());
DataColumnModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    CommonModule
                ],
                declarations: [
                    DataColumnComponent,
                    DataColumnListComponent
                ],
                exports: [
                    DataColumnComponent,
                    DataColumnListComponent
                ]
            },] },
];
DataColumnModule.ctorParameters = function () { return []; };
var DataRowEvent = /** @class */ (function (_super) {
    __extends(DataRowEvent, _super);
    function DataRowEvent(value, domEvent, sender) {
        var _this = _super.call(this) || this;
        _this.value = value;
        _this.event = domEvent;
        _this.sender = sender;
        return _this;
    }
    return DataRowEvent;
}(BaseUIEvent));
var DataSorting = /** @class */ (function () {
    function DataSorting(key, direction) {
        this.key = key;
        this.direction = direction;
    }
    return DataSorting;
}());
var FileUtils = /** @class */ (function () {
    function FileUtils() {
    }
    FileUtils.flattern = function (folder) {
        var reader = folder.createReader();
        var files = [];
        return new Promise(function (resolve) {
            var iterations = [];
            (function traverse() {
                reader.readEntries(function (entries) {
                    if (!entries.length) {
                        Promise.all(iterations).then(function (result) { return resolve(files); });
                    }
                    else {
                        iterations.push(Promise.all(entries.map(function (entry) {
                            if (entry.isFile) {
                                return new Promise(function (resolveFile) {
                                    entry.file(function (f) {
                                        files.push({
                                            entry: entry,
                                            file: f,
                                            relativeFolder: entry.fullPath.replace(/\/[^\/]*$/, '')
                                        });
                                        resolveFile();
                                    });
                                });
                            }
                            else {
                                return FileUtils.flattern(entry).then(function (result) {
                                    files.push.apply(files, __spread(result));
                                });
                            }
                        })));
                        traverse();
                    }
                });
            })();
        });
    };
    FileUtils.toFileArray = function (fileList) {
        var result = [];
        if (fileList && fileList.length > 0) {
            for (var i = 0; i < fileList.length; i++) {
                result.push(fileList[i]);
            }
        }
        return result;
    };
    return FileUtils;
}());
var MOMENT_DATE_FORMATS = {
    parse: {
        dateInput: 'DD/MM/YYYY'
    },
    display: {
        dateInput: 'DD/MM/YYYY',
        monthYearLabel: 'MMMM Y',
        dateA11yLabel: 'LL',
        monthYearA11yLabel: 'MMMM Y'
    }
};
var dateNames = [];
for (var date = 1; date <= 31; date++) {
    dateNames.push(String(date));
}
var dateNames$1 = [];
for (var date = 1; date <= 31; date++) {
    dateNames$1.push(String(date));
}
var MomentDateAdapter = /** @class */ (function (_super) {
    __extends(MomentDateAdapter, _super);
    function MomentDateAdapter() {
        var _this = _super.apply(this, __spread(arguments)) || this;
        _this.localeData = moment.localeData();
        return _this;
    }
    MomentDateAdapter.prototype.getYear = function (date) {
        return date.year();
    };
    MomentDateAdapter.prototype.getMonth = function (date) {
        return date.month();
    };
    MomentDateAdapter.prototype.getDate = function (date) {
        return date.date();
    };
    MomentDateAdapter.prototype.getDayOfWeek = function (date) {
        return date.day();
    };
    MomentDateAdapter.prototype.getMonthNames = function (style$$1) {
        switch (style$$1) {
            case 'long':
                return this.localeData.months();
            case 'short':
                return this.localeData.monthsShort();
            case 'narrow':
                return this.localeData.monthsShort().map(function (month) { return month[0]; });
            default:
                return;
        }
    };
    MomentDateAdapter.prototype.getDateNames = function () {
        return dateNames$1;
    };
    MomentDateAdapter.prototype.getDayOfWeekNames = function (style$$1) {
        switch (style$$1) {
            case 'long':
                return this.localeData.weekdays();
            case 'short':
                return this.localeData.weekdaysShort();
            case 'narrow':
                return this.localeData.weekdaysShort();
            default:
                return;
        }
    };
    MomentDateAdapter.prototype.getYearName = function (date) {
        return String(date.year());
    };
    MomentDateAdapter.prototype.getFirstDayOfWeek = function () {
        return this.localeData.firstDayOfWeek();
    };
    MomentDateAdapter.prototype.getNumDaysInMonth = function (date) {
        return date.daysInMonth();
    };
    MomentDateAdapter.prototype.clone = function (date) {
        return date.clone();
    };
    MomentDateAdapter.prototype.createDate = function (year, month, date) {
        return moment([year, month, date]);
    };
    MomentDateAdapter.prototype.today = function () {
        return moment();
    };
    MomentDateAdapter.prototype.parse = function (value, parseFormat) {
        var m = moment(value, parseFormat, true);
        if (!m.isValid()) {
            m = moment(value, this.overrideDisplyaFormat);
        }
        if (m.isValid()) {
            if (m.year() === 2001 && value.indexOf('2001') === -1) {
                var currentYear = new Date().getFullYear();
                m.set('year', currentYear);
                if (m.isAfter(moment())) {
                    m.set('year', currentYear - 1);
                }
            }
            return m;
        }
        else {
            return null;
        }
    };
    MomentDateAdapter.prototype.format = function (date, displayFormat) {
        displayFormat = this.overrideDisplyaFormat ? this.overrideDisplyaFormat : displayFormat;
        if (date && date.format) {
            return date.format(displayFormat);
        }
        else {
            return '';
        }
    };
    MomentDateAdapter.prototype.addCalendarYears = function (date, years) {
        return date.clone().add(years, 'y');
    };
    MomentDateAdapter.prototype.addCalendarMonths = function (date, months) {
        return date.clone().add(months, 'M');
    };
    MomentDateAdapter.prototype.addCalendarDays = function (date, days) {
        return date.clone().add(days, 'd');
    };
    MomentDateAdapter.prototype.getISODateString = function (date) {
        return date.toISOString();
    };
    MomentDateAdapter.prototype.setLocale = function (locale) {
        this.localeData = moment.localeData(locale);
    };
    MomentDateAdapter.prototype.compareDate = function (first, second) {
        return first.diff(second, 'seconds', true);
    };
    MomentDateAdapter.prototype.sameDate = function (first, second) {
        if (first == null) {
            return second == null;
        }
        else if (isMoment(first)) {
            return first.isSame(second);
        }
        else {
            var isSame = _super.prototype.sameDate.call(this, first, second);
            return isSame;
        }
    };
    MomentDateAdapter.prototype.clampDate = function (date, min, max) {
        if (min && date.isBefore(min)) {
            return min;
        }
        else if (max && date.isAfter(max)) {
            return max;
        }
        else {
            return date;
        }
    };
    MomentDateAdapter.prototype.isDateInstance = function (date) {
        var isValidDateInstance = false;
        if (date) {
            isValidDateInstance = date._isAMomentObject;
        }
        return isValidDateInstance;
    };
    MomentDateAdapter.prototype.isValid = function (date) {
        return date.isValid();
    };
    MomentDateAdapter.prototype.toIso8601 = function (date) {
        return this.clone(date).format();
    };
    MomentDateAdapter.prototype.fromIso8601 = function (iso8601String) {
        var d = moment(iso8601String, moment.ISO_8601).locale(this.locale);
        return this.isValid(d) ? d : null;
    };
    MomentDateAdapter.prototype.invalid = function () {
        return moment.invalid();
    };
    return MomentDateAdapter;
}(DateAdapter));
var ObjectDataRow = /** @class */ (function () {
    function ObjectDataRow(obj, isSelected) {
        if (isSelected === void 0) { isSelected = false; }
        this.obj = obj;
        this.isSelected = isSelected;
        if (!obj) {
            throw new Error('Object source not found');
        }
    }
    ObjectDataRow.prototype.getValue = function (key) {
        return ObjectUtils.getValue(this.obj, key);
    };
    ObjectDataRow.prototype.hasValue = function (key) {
        return this.getValue(key) !== undefined;
    };
    return ObjectDataRow;
}());
var ObjectDataColumn = /** @class */ (function () {
    function ObjectDataColumn(obj) {
        this.key = obj.key;
        this.type = obj.type || 'text';
        this.format = obj.format;
        this.sortable = obj.sortable;
        this.title = obj.title;
        this.srTitle = obj.srTitle;
        this.cssClass = obj.cssClass;
        this.template = obj.template;
    }
    return ObjectDataColumn;
}());
var ObjectDataTableAdapter = /** @class */ (function () {
    function ObjectDataTableAdapter(data, schema) {
        if (data === void 0) { data = []; }
        if (schema === void 0) { schema = []; }
        this._rows = [];
        this._columns = [];
        if (data && data.length > 0) {
            this._rows = data.map(function (item) {
                return new ObjectDataRow(item);
            });
        }
        if (schema && schema.length > 0) {
            this._columns = schema.map(function (item) {
                return new ObjectDataColumn(item);
            });
            var sortable = this._columns.filter(function (c) { return c.sortable; });
            if (sortable.length > 0) {
                this.sort(sortable[0].key, 'asc');
            }
        }
    }
    ObjectDataTableAdapter.generateSchema = function (data) {
        var schema = [];
        if (data && data.length) {
            var rowToExaminate = data[0];
            if (typeof rowToExaminate === 'object') {
                for (var key in rowToExaminate) {
                    if (rowToExaminate.hasOwnProperty(key)) {
                        schema.push({
                            type: 'text',
                            key: key,
                            title: key,
                            sortable: false
                        });
                    }
                }
            }
        }
        return schema;
    };
    ObjectDataTableAdapter.prototype.getRows = function () {
        return this._rows;
    };
    ObjectDataTableAdapter.prototype.setRows = function (rows) {
        this._rows = rows || [];
        this.sort();
    };
    ObjectDataTableAdapter.prototype.getColumns = function () {
        return this._columns;
    };
    ObjectDataTableAdapter.prototype.setColumns = function (columns) {
        this._columns = columns || [];
    };
    ObjectDataTableAdapter.prototype.getValue = function (row, col) {
        if (!row) {
            throw new Error('Row not found');
        }
        if (!col) {
            throw new Error('Column not found');
        }
        var value = row.getValue(col.key);
        if (col.type === 'date') {
            try {
                return this.formatDate(col, value);
            }
            catch (err) {
                console.error("Error parsing date " + value + " to format " + col.format);
            }
        }
        if (col.type === 'icon') {
            var icon = row.getValue(col.key);
            return icon;
        }
        return value;
    };
    ObjectDataTableAdapter.prototype.formatDate = function (col, value) {
        if (col.type === 'date') {
            var format = col.format || 'medium';
            if (format === 'timeAgo') {
                var timeAgoPipe = new TimeAgoPipe();
                return timeAgoPipe.transform(value);
            }
            else {
                var datePipe = new DatePipe('en-US');
                return datePipe.transform(value, format);
            }
        }
        return value;
    };
    ObjectDataTableAdapter.prototype.getSorting = function () {
        return this._sorting;
    };
    ObjectDataTableAdapter.prototype.setSorting = function (sorting) {
        this._sorting = sorting;
        if (sorting && sorting.key) {
            this._rows.sort(function (a, b) {
                var left = a.getValue(sorting.key);
                if (left) {
                    left = (left instanceof Date) ? left.valueOf().toString() : left.toString();
                }
                else {
                    left = '';
                }
                var right = b.getValue(sorting.key);
                if (right) {
                    right = (right instanceof Date) ? right.valueOf().toString() : right.toString();
                }
                else {
                    right = '';
                }
                return sorting.direction === 'asc'
                    ? left.localeCompare(right)
                    : right.localeCompare(left);
            });
        }
    };
    ObjectDataTableAdapter.prototype.sort = function (key, direction) {
        var sorting = this._sorting || new DataSorting();
        if (key) {
            sorting.key = key;
            sorting.direction = direction || 'asc';
        }
        this.setSorting(sorting);
    };
    return ObjectDataTableAdapter;
}());
var DataCellEventModel = /** @class */ (function () {
    function DataCellEventModel(row, col, actions) {
        this.row = row;
        this.col = col;
        this.actions = actions || [];
    }
    return DataCellEventModel;
}());
var DataCellEvent = /** @class */ (function (_super) {
    __extends(DataCellEvent, _super);
    function DataCellEvent(row, col, actions) {
        var _this = _super.call(this) || this;
        _this.value = new DataCellEventModel(row, col, actions);
        return _this;
    }
    return DataCellEvent;
}(BaseEvent));
var DataRowActionModel = /** @class */ (function () {
    function DataRowActionModel(row, action) {
        this.row = row;
        this.action = action;
    }
    return DataRowActionModel;
}());
var DataRowActionEvent = /** @class */ (function (_super) {
    __extends(DataRowActionEvent, _super);
    function DataRowActionEvent(row, action) {
        var _this = _super.call(this) || this;
        _this.value = new DataRowActionModel(row, action);
        return _this;
    }
    Object.defineProperty(DataRowActionEvent.prototype, "args", {
        get: function () {
            return this.value;
        },
        enumerable: true,
        configurable: true
    });
    return DataRowActionEvent;
}(BaseEvent));
var DataTableCellComponent = /** @class */ (function () {
    function DataTableCellComponent() {
    }
    DataTableCellComponent.prototype.ngOnInit = function () {
        if (!this.value && this.column && this.column.key && this.row && this.data) {
            this.value = this.data.getValue(this.row, this.column);
            if (!this.tooltip) {
                this.tooltip = this.value;
            }
        }
    };
    return DataTableCellComponent;
}());
DataTableCellComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-datatable-cell',
                changeDetection: ChangeDetectionStrategy.OnPush,
                template: "\n        <ng-container>\n            <span [title]=\"tooltip\" class=\"adf-datatable-cell-value\">{{value}}</span>\n        </ng-container>",
                encapsulation: ViewEncapsulation.None,
                host: { class: 'adf-datatable-cell' }
            },] },
];
DataTableCellComponent.ctorParameters = function () { return []; };
DataTableCellComponent.propDecorators = {
    "data": [{ type: Input },],
    "column": [{ type: Input },],
    "row": [{ type: Input },],
    "value": [{ type: Input },],
    "tooltip": [{ type: Input },],
};
var DisplayMode = {
    List: 'list',
    Gallery: 'gallery',
};
var DataTableComponent = /** @class */ (function () {
    function DataTableComponent(elementRef, differs, thumbnailService) {
        var _this = this;
        this.elementRef = elementRef;
        this.thumbnailService = thumbnailService;
        this.display = DisplayMode.List;
        this.rows = [];
        this.selectionMode = 'single';
        this.multiselect = false;
        this.actions = false;
        this.actionsPosition = 'right';
        this.contextMenu = false;
        this.allowDropFiles = false;
        this.rowStyleClass = '';
        this.showHeader = true;
        this.rowClick = new EventEmitter();
        this.rowDblClick = new EventEmitter();
        this.showRowContextMenu = new EventEmitter();
        this.showRowActionsMenu = new EventEmitter();
        this.executeRowAction = new EventEmitter();
        this.loading = false;
        this.noPermission = false;
        this.isSelectAllChecked = false;
        this.selection = new Array();
        this.schema = [];
        this.rowMenuCache = {};
        if (differs) {
            this.differ = differs.find([]).create(null);
        }
        this.click$ = new Observable(function (observer) { return _this.clickObserver = observer; }).share();
    }
    DataTableComponent.prototype.ngAfterContentInit = function () {
        this.setTableSchema();
    };
    DataTableComponent.prototype.ngOnChanges = function (changes) {
        this.initAndSubscribeClickStream();
        if (this.isPropertyChanged(changes['data'])) {
            if (this.isTableEmpty()) {
                this.initTable();
            }
            else {
                this.data = changes['data'].currentValue;
            }
            return;
        }
        if (this.isPropertyChanged(changes['rows'])) {
            if (this.isTableEmpty()) {
                this.initTable();
            }
            else {
                this.setTableRows(changes['rows'].currentValue);
            }
            return;
        }
        if (changes["selectionMode"] && !changes["selectionMode"].isFirstChange()) {
            this.resetSelection();
            this.emitRowSelectionEvent('row-unselect', null);
        }
    };
    DataTableComponent.prototype.ngDoCheck = function () {
        var changes = this.differ.diff(this.rows);
        if (changes) {
            this.setTableRows(this.rows);
        }
    };
    DataTableComponent.prototype.isPropertyChanged = function (property) {
        return property && property.currentValue ? true : false;
    };
    DataTableComponent.prototype.convertToRowsData = function (rows) {
        return rows.map(function (row) { return new ObjectDataRow(row); });
    };
    DataTableComponent.prototype.initAndSubscribeClickStream = function () {
        var _this = this;
        this.unsubscribeClickStream();
        var singleClickStream = this.click$
            .buffer(this.click$.debounceTime(250))
            .map(function (list) { return list; })
            .filter(function (x) { return x.length === 1; });
        this.singleClickStreamSub = singleClickStream.subscribe(function (obj) {
            var event = obj[0];
            _this.rowClick.emit(event);
            if (!event.defaultPrevented) {
                _this.elementRef.nativeElement.dispatchEvent(new CustomEvent('row-click', {
                    detail: event,
                    bubbles: true
                }));
            }
        });
        var multiClickStream = this.click$
            .buffer(this.click$.debounceTime(250))
            .map(function (list) { return list; })
            .filter(function (x) { return x.length >= 2; });
        this.multiClickStreamSub = multiClickStream.subscribe(function (obj) {
            var event = obj[0];
            _this.rowDblClick.emit(event);
            if (!event.defaultPrevented) {
                _this.elementRef.nativeElement.dispatchEvent(new CustomEvent('row-dblclick', {
                    detail: event,
                    bubbles: true
                }));
            }
        });
    };
    DataTableComponent.prototype.unsubscribeClickStream = function () {
        if (this.singleClickStreamSub) {
            this.singleClickStreamSub.unsubscribe();
        }
        if (this.multiClickStreamSub) {
            this.multiClickStreamSub.unsubscribe();
        }
    };
    DataTableComponent.prototype.initTable = function () {
        this.data = new ObjectDataTableAdapter(this.rows, this.schema);
        this.rowMenuCache = {};
    };
    DataTableComponent.prototype.isTableEmpty = function () {
        return this.data === undefined || this.data === null;
    };
    DataTableComponent.prototype.setTableRows = function (rows) {
        if (this.data) {
            this.data.setRows(this.convertToRowsData(rows));
        }
    };
    DataTableComponent.prototype.setTableSchema = function () {
        if (this.columnList && this.columnList.columns) {
            this.schema = this.columnList.columns.map(function (c) { return (c); });
        }
        if (this.data && this.schema && this.schema.length > 0) {
            this.data.setColumns(this.schema);
        }
    };
    DataTableComponent.prototype.onRowClick = function (row, e) {
        if (e) {
            e.preventDefault();
        }
        if (row) {
            this.handleRowSelection(row, e);
            var dataRowEvent = new DataRowEvent(row, e, this);
            this.clickObserver.next(dataRowEvent);
        }
    };
    DataTableComponent.prototype.onEnterKeyPressed = function (row, e) {
        if (row) {
            this.handleRowSelection(row, e);
        }
    };
    DataTableComponent.prototype.handleRowSelection = function (row, e) {
        if (this.data) {
            if (this.isSingleSelectionMode()) {
                this.resetSelection();
                this.selectRow(row, true);
                this.emitRowSelectionEvent('row-select', row);
            }
            if (this.isMultiSelectionMode()) {
                var modifier = e && (e.metaKey || e.ctrlKey);
                var newValue = modifier ? !row.isSelected : true;
                var domEventName = newValue ? 'row-select' : 'row-unselect';
                if (!modifier) {
                    this.resetSelection();
                }
                this.selectRow(row, newValue);
                this.emitRowSelectionEvent(domEventName, row);
            }
        }
    };
    DataTableComponent.prototype.resetSelection = function () {
        if (this.data) {
            var rows = this.data.getRows();
            if (rows && rows.length > 0) {
                rows.forEach(function (r) { return r.isSelected = false; });
            }
            this.selection.splice(0);
        }
        this.isSelectAllChecked = false;
    };
    DataTableComponent.prototype.onRowDblClick = function (row, e) {
        if (e) {
            e.preventDefault();
        }
        var dataRowEvent = new DataRowEvent(row, e, this);
        this.clickObserver.next(dataRowEvent);
    };
    DataTableComponent.prototype.onRowKeyUp = function (row, e) {
        var event = new CustomEvent('row-keyup', {
            detail: {
                row: row,
                keyboardEvent: e,
                sender: this
            },
            bubbles: true
        });
        this.elementRef.nativeElement.dispatchEvent(event);
        if (event.defaultPrevented) {
            e.preventDefault();
        }
        else {
            if (e.key === 'Enter') {
                this.onKeyboardNavigate(row, e);
            }
        }
    };
    DataTableComponent.prototype.onKeyboardNavigate = function (row, e) {
        if (e) {
            e.preventDefault();
        }
        var event = new DataRowEvent(row, e, this);
        this.rowDblClick.emit(event);
        this.elementRef.nativeElement.dispatchEvent(new CustomEvent('row-dblclick', {
            detail: event,
            bubbles: true
        }));
    };
    DataTableComponent.prototype.onColumnHeaderClick = function (column) {
        if (column && column.sortable) {
            var current = this.data.getSorting();
            var newDirection = 'asc';
            if (current && column.key === current.key) {
                newDirection = current.direction === 'asc' ? 'desc' : 'asc';
            }
            this.data.setSorting(new DataSorting(column.key, newDirection));
            this.emitSortingChangedEvent(column.key, newDirection);
        }
    };
    DataTableComponent.prototype.onSelectAllClick = function (e) {
        this.isSelectAllChecked = e.checked;
        if (this.multiselect) {
            var rows = this.data.getRows();
            if (rows && rows.length > 0) {
                for (var i = 0; i < rows.length; i++) {
                    this.selectRow(rows[i], e.checked);
                }
            }
            var domEventName = e.checked ? 'row-select' : 'row-unselect';
            var row = this.selection.length > 0 ? this.selection[0] : null;
            this.emitRowSelectionEvent(domEventName, row);
        }
    };
    DataTableComponent.prototype.onCheckboxChange = function (row, event) {
        var newValue = event.checked;
        this.selectRow(row, newValue);
        var domEventName = newValue ? 'row-select' : 'row-unselect';
        this.emitRowSelectionEvent(domEventName, row);
    };
    DataTableComponent.prototype.onImageLoadingError = function (event, mimeType) {
        if (event) {
            var element = (event.target);
            if (this.fallbackThumbnail) {
                element.src = this.fallbackThumbnail;
            }
            else {
                element.src = this.thumbnailService.getMimeTypeIcon(mimeType);
            }
        }
    };
    DataTableComponent.prototype.isIconValue = function (row, col) {
        if (row && col) {
            var value = row.getValue(col.key);
            return value && value.startsWith('material-icons://');
        }
        return false;
    };
    DataTableComponent.prototype.asIconValue = function (row, col) {
        if (this.isIconValue(row, col)) {
            var value = row.getValue(col.key) || '';
            return value.replace('material-icons://', '');
        }
        return null;
    };
    DataTableComponent.prototype.iconAltTextKey = function (value) {
        return value ? 'ICONS.' + value.substring(value.lastIndexOf('/') + 1).replace(/\.[a-z]+/, '') : '';
    };
    DataTableComponent.prototype.isColumnSorted = function (col, direction) {
        if (col && direction) {
            var sorting = this.data.getSorting();
            return sorting && sorting.key === col.key && sorting.direction === direction;
        }
        return false;
    };
    DataTableComponent.prototype.getContextMenuActions = function (row, col) {
        var event = new DataCellEvent(row, col, []);
        this.showRowContextMenu.emit(event);
        return event.value.actions;
    };
    DataTableComponent.prototype.getRowActions = function (row, col) {
        var id = row.getValue('id');
        if (!this.rowMenuCache[id]) {
            var event = new DataCellEvent(row, col, []);
            this.showRowActionsMenu.emit(event);
            this.rowMenuCache[id] = event.value.actions;
        }
        return this.rowMenuCache[id];
    };
    DataTableComponent.prototype.onExecuteRowAction = function (row, action) {
        if (action.disabled || action.disabled) {
            event.stopPropagation();
        }
        else {
            this.executeRowAction.emit(new DataRowActionEvent(row, action));
        }
    };
    DataTableComponent.prototype.rowAllowsDrop = function (row) {
        return row.isDropTarget === true;
    };
    DataTableComponent.prototype.hasSelectionMode = function () {
        return this.isSingleSelectionMode() || this.isMultiSelectionMode();
    };
    DataTableComponent.prototype.isSingleSelectionMode = function () {
        return this.selectionMode && this.selectionMode.toLowerCase() === 'single';
    };
    DataTableComponent.prototype.isMultiSelectionMode = function () {
        return this.selectionMode && this.selectionMode.toLowerCase() === 'multiple';
    };
    DataTableComponent.prototype.getRowStyle = function (row) {
        row.cssClass = row.cssClass ? row.cssClass : '';
        this.rowStyleClass = this.rowStyleClass ? this.rowStyleClass : '';
        return row.cssClass + " " + this.rowStyleClass;
    };
    DataTableComponent.prototype.getFilename = function (row) {
        return row.getValue('name');
    };
    DataTableComponent.prototype.getSortingKey = function () {
        if (this.data.getSorting()) {
            return this.data.getSorting().key;
        }
    };
    DataTableComponent.prototype.selectRow = function (row, value) {
        if (row) {
            row.isSelected = value;
            var idx = this.selection.indexOf(row);
            if (value) {
                if (idx < 0) {
                    this.selection.push(row);
                }
            }
            else {
                if (idx > -1) {
                    this.selection.splice(idx, 1);
                }
            }
        }
    };
    DataTableComponent.prototype.getCellTooltip = function (row, col) {
        if (row && col && col.formatTooltip) {
            var result = col.formatTooltip(row, col);
            if (result) {
                return result;
            }
        }
        return null;
    };
    DataTableComponent.prototype.getSortableColumns = function () {
        return this.data.getColumns().filter(function (currentColum) {
            return currentColum.sortable === true;
        });
    };
    DataTableComponent.prototype.isEmpty = function () {
        return this.data.getRows().length === 0;
    };
    DataTableComponent.prototype.isHeaderVisible = function () {
        return this.showHeader && !this.loading && !this.isEmpty();
    };
    DataTableComponent.prototype.emitRowSelectionEvent = function (name, row) {
        var domEvent = new CustomEvent(name, {
            detail: {
                row: row,
                selection: this.selection
            },
            bubbles: true
        });
        this.elementRef.nativeElement.dispatchEvent(domEvent);
    };
    DataTableComponent.prototype.emitSortingChangedEvent = function (key, direction) {
        var domEvent = new CustomEvent('sorting-changed', {
            detail: {
                key: key,
                direction: direction
            },
            bubbles: true
        });
        this.elementRef.nativeElement.dispatchEvent(domEvent);
    };
    return DataTableComponent;
}());
DataTableComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-datatable',
                styles: [""],
                template: "<div\n    *ngIf=\"data\" class=\"full-width\"\n    [class.adf-data-table-card]=\"display === 'gallery'\"\n    [class.adf-data-table]=\"display === 'list'\">\n    <div *ngIf=\"isHeaderVisible()\" class=\"adf-datatable-header\">\n        <div class=\"adf-datatable-row\" *ngIf=\"display === 'list'\">\n            <!-- Actions (left) -->\n            <div *ngIf=\"actions && actionsPosition === 'left'\" class=\"actions-column adf-datatable-table-cell-header\">\n                <span class=\"sr-only\">Actions</span>\n            </div>\n            <!-- Columns -->\n            <div *ngIf=\"multiselect\" class=\"adf-datatable-table-cell-header\">\n                <mat-checkbox [checked]=\"isSelectAllChecked\" (change)=\"onSelectAllClick($event)\"></mat-checkbox>\n            </div>\n            <div class=\"adf-data-table-cell--{{col.type || 'text'}} {{col.cssClass}} adf-datatable-table-cell-header\"\n                 *ngFor=\"let col of data.getColumns()\"\n                 [class.sortable]=\"col.sortable\"\n                 [attr.data-automation-id]=\"'auto_id_' + col.key\"\n                 [class.adf-data-table__header--sorted-asc]=\"isColumnSorted(col, 'asc')\"\n                 [class.adf-data-table__header--sorted-desc]=\"isColumnSorted(col, 'desc')\"\n                 (click)=\"onColumnHeaderClick(col)\"\n                 (keyup.enter)=\"onColumnHeaderClick(col)\"\n                 role=\"button\"\n                 tabindex=\"0\"\n                 title=\"{{ col.title | translate }}\">\n                <span *ngIf=\"col.srTitle\" class=\"sr-only\">{{ col.srTitle | translate }}</span>\n                <span *ngIf=\"col.title\">{{ col.title | translate}}</span>\n            </div>\n            <!-- Actions (right) -->\n            <div *ngIf=\"actions && actionsPosition === 'right'\" class=\"actions-column adf-datatable-table-cell-header\">\n                <span class=\"sr-only\">Actions</span>\n            </div>\n        </div>\n        <mat-form-field *ngIf=\"display === 'gallery'\">\n            <mat-select [value]=\"getSortingKey()\">\n                <mat-option *ngFor=\"let col of getSortableColumns()\"\n                            [value]=\"col.key\"\n                            (click)=\"onColumnHeaderClick(col)\"\n                            (keyup.enter)=\"onColumnHeaderClick(col)\">\n                    {{ col.title | translate}}\n                </mat-option>\n            </mat-select>\n        </mat-form-field>\n\n    </div>\n\n    <div class=\"adf-datatable-body\">\n        <ng-container *ngIf=\"!loading && !noPermission\">\n            <div *ngFor=\"let row of data.getRows(); let idx = index\"\n                 class=\"adf-datatable-row\"\n                 role=\"button\"\n                 [class.is-selected]=\"row.isSelected\"\n                 [adf-upload]=\"allowDropFiles && rowAllowsDrop(row)\" [adf-upload-data]=\"row\"\n                 [ngStyle]=\"rowStyle\"\n                 [ngClass]=\"getRowStyle(row)\"\n                 (keyup)=\"onRowKeyUp(row, $event)\">\n\n                <!-- Actions (left) -->\n                <div *ngIf=\"actions && actionsPosition === 'left'\" class=\"adf-datatable-table-cell\">\n                    <button mat-icon-button [matMenuTriggerFor]=\"menu\"\n                            [attr.id]=\"'action_menu_left_' + idx\"\n                            [attr.data-automation-id]=\"'action_menu_' + idx\">\n                        <mat-icon>more_vert</mat-icon>\n                    </button>\n                    <mat-menu #menu=\"matMenu\">\n                        <button mat-menu-item *ngFor=\"let action of getRowActions(row)\"\n                                [attr.data-automation-id]=\"action.title\"\n                                [disabled]=\"action.disabled\"\n                                (click)=\"onExecuteRowAction(row, action)\">\n                            <mat-icon *ngIf=\"action.icon\">{{ action.icon }}</mat-icon>\n                            <span>{{ action.title | translate }}</span>\n                        </button>\n                    </mat-menu>\n                </div>\n\n                <div *ngIf=\"multiselect\" class=\"adf-datatable-table-cell adf-datatable-table-checkbox\">\n                    <mat-checkbox\n                        [checked]=\"row.isSelected\"\n                        (change)=\"onCheckboxChange(row, $event)\">\n                    </mat-checkbox>\n                </div>\n                <div *ngFor=\"let col of data.getColumns()\"\n                     class=\"adf-data-table-cell adf-datatable-table-cell adf-data-table-cell--{{col.type || 'text'}} {{col.cssClass}}\"\n                     [attr.title]=\"col.title | translate\"\n                     [attr.filename]=\"getFilename(row)\"\n                     tabindex=\"0\"\n                     (click)=\"onRowClick(row, $event)\"\n                     (keydown.enter)=\"onEnterKeyPressed(row, $event)\"\n                     [context-menu]=\"getContextMenuActions(row, col)\"\n                     [context-menu-enabled]=\"contextMenu\">\n                    <div *ngIf=\"!col.template\" class=\"cell-container\">\n                        <ng-container [ngSwitch]=\"col.type\">\n                            <div *ngSwitchCase=\"'image'\" class=\"cell-value\">\n                                <mat-icon *ngIf=\"isIconValue(row, col)\">{{ asIconValue(row, col) }}</mat-icon>\n                                <mat-icon class=\"adf-datatable-selected\"\n                                          *ngIf=\"!isIconValue(row, col) && row.isSelected\" svgIcon=\"selected\">\n                                </mat-icon>\n\n                                <img *ngIf=\"!isIconValue(row, col) && !row.isSelected\"\n                                     alt=\"{{ iconAltTextKey(data.getValue(row, col)) | translate }}\"\n                                     src=\"{{ data.getValue(row, col) }}\"\n                                     (error)=\"onImageLoadingError($event, row.obj.entry.content.mimeType)\">\n                            </div>\n                            <div *ngSwitchCase=\"'icon'\" class=\"cell-value\">\n                                <span class=\"sr-only\">{{ iconAltTextKey(data.getValue(row, col)) | translate }}</span>\n                                <mat-icon>{{ data.getValue(row, col) }}</mat-icon>\n                            </div>\n                            <div *ngSwitchCase=\"'date'\" class=\"cell-value\"\n                                 [attr.data-automation-id]=\"'date_' + data.getValue(row, col)\">\n                                <adf-date-cell\n                                    [data]=\"data\"\n                                    [column]=\"col\"\n                                    [row]=\"row\"\n                                    [tooltip]=\"getCellTooltip(row, col)\">\n                                </adf-date-cell>\n                            </div>\n                            <div *ngSwitchCase=\"'location'\" class=\"cell-value\"\n                                 [attr.data-automation-id]=\"'location' + data.getValue(row, col)\">\n                                <adf-location-cell\n                                    [data]=\"data\"\n                                    [column]=\"col\"\n                                    [row]=\"row\"\n                                    [tooltip]=\"getCellTooltip(row, col)\">\n                                </adf-location-cell>\n                            </div>\n                            <div *ngSwitchCase=\"'fileSize'\" class=\"cell-value\"\n                                 [attr.data-automation-id]=\"'fileSize_' + data.getValue(row, col)\">\n                                <adf-filesize-cell\n                                    [data]=\"data\"\n                                    [column]=\"col\"\n                                    [row]=\"row\"\n                                    [tooltip]=\"getCellTooltip(row, col)\">\n                                </adf-filesize-cell>\n                            </div>\n                            <div *ngSwitchCase=\"'text'\" class=\"cell-value\"\n                                 [attr.data-automation-id]=\"'text_' + data.getValue(row, col)\">\n                                <adf-datatable-cell\n                                    [data]=\"data\"\n                                    [column]=\"col\"\n                                    [row]=\"row\"\n                                    [tooltip]=\"getCellTooltip(row, col)\">\n                                </adf-datatable-cell>\n                            </div>\n                            <span *ngSwitchDefault class=\"cell-value\">\n                    <!-- empty cell for unknown column type -->\n                    </span>\n                        </ng-container>\n                    </div>\n                    <div *ngIf=\"col.template\" class=\"cell-container\">\n                        <ng-container\n                            [ngTemplateOutlet]=\"col.template\"\n                            [ngTemplateOutletContext]=\"{ $implicit: { data: data, row: row, col: col }, value: data.getValue(row, col) }\">\n                        </ng-container>\n                    </div>\n                </div>\n\n                <!-- Actions (right) -->\n                <div *ngIf=\"actions && actionsPosition === 'right'\"\n                     class=\"adf-datatable-table-cell alfresco-datatable__actions-cell\">\n                    <button mat-icon-button [matMenuTriggerFor]=\"menu\"\n                            [attr.id]=\"'action_menu_right_' + idx\"\n                            [attr.data-automation-id]=\"'action_menu_' + idx\">\n                        <mat-icon>more_vert</mat-icon>\n                    </button>\n                    <mat-menu #menu=\"matMenu\">\n                        <button mat-menu-item *ngFor=\"let action of getRowActions(row)\"\n                                [attr.data-automation-id]=\"action.title\"\n                                [disabled]=\"action.disabled\"\n                                (click)=\"onExecuteRowAction(row, action)\">\n                            <mat-icon *ngIf=\"action.icon\">{{ action.icon }}</mat-icon>\n                            <span>{{ action.title | translate }}</span>\n                        </button>\n                    </mat-menu>\n                </div>\n\n            </div>\n            <div *ngIf=\"isEmpty()\"\n                 [class.adf-datatable-row]=\"display === 'list'\"\n                 [class.adf-data-table-card-empty]=\"display === 'gallery'\">\n                <div class=\"adf-no-content-container adf-datatable-table-cell\">\n                    <ng-template *ngIf=\"noContentTemplate\"\n                                 ngFor [ngForOf]=\"[data]\"\n                                 [ngForTemplate]=\"noContentTemplate\">\n                    </ng-template>\n                    <ng-content select=\"adf-empty-list\"></ng-content>\n                </div>\n            </div>\n        </ng-container>\n        <div *ngIf=\"!loading && noPermission\"\n             [class.adf-datatable-row]=\"display === 'list'\"\n             [class.adf-data-table-card-permissions]=\"display === 'gallery'\"\n             class=\"adf-no-permission__row\">\n            <div class=\"adf-no-permission__cell adf-no-content-container adf-datatable-table-cell\">\n                <ng-template *ngIf=\"noPermissionTemplate\"\n                             ngFor [ngForOf]=\"[data]\"\n                             [ngForTemplate]=\"noPermissionTemplate\">\n                </ng-template>\n            </div>\n        </div>\n        <div *ngIf=\"loading\"\n             [class.adf-datatable-row]=\"display === 'list'\"\n             [class.adf-data-table-card-loading]=\"display === 'gallery'\">\n            <div class=\"adf-datatable-table-cell\" >\n                <ng-template *ngIf=\"loadingTemplate\"\n                             ngFor [ngForOf]=\"[data]\"\n                             [ngForTemplate]=\"loadingTemplate\">\n                </ng-template>\n            </div>\n        </div>\n    </div>\n</div>\n",
                encapsulation: ViewEncapsulation.None
            },] },
];
DataTableComponent.ctorParameters = function () { return [
    { type: ElementRef, },
    { type: IterableDiffers, },
    { type: ThumbnailService, },
]; };
DataTableComponent.propDecorators = {
    "columnList": [{ type: ContentChild, args: [DataColumnListComponent,] },],
    "data": [{ type: Input },],
    "display": [{ type: Input },],
    "rows": [{ type: Input },],
    "selectionMode": [{ type: Input },],
    "multiselect": [{ type: Input },],
    "actions": [{ type: Input },],
    "actionsPosition": [{ type: Input },],
    "fallbackThumbnail": [{ type: Input },],
    "contextMenu": [{ type: Input },],
    "allowDropFiles": [{ type: Input },],
    "rowStyle": [{ type: Input },],
    "rowStyleClass": [{ type: Input },],
    "showHeader": [{ type: Input },],
    "rowClick": [{ type: Output },],
    "rowDblClick": [{ type: Output },],
    "showRowContextMenu": [{ type: Output },],
    "showRowActionsMenu": [{ type: Output },],
    "executeRowAction": [{ type: Output },],
    "loading": [{ type: Input },],
    "noPermission": [{ type: Input },],
};
var DateCellComponent = /** @class */ (function (_super) {
    __extends(DateCellComponent, _super);
    function DateCellComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return DateCellComponent;
}(DataTableCellComponent));
DateCellComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-date-cell',
                changeDetection: ChangeDetectionStrategy.OnPush,
                template: "\n        <ng-container>\n            <span [title]=\"tooltip\">{{value}}</span>\n        </ng-container>\n    ",
                encapsulation: ViewEncapsulation.None,
                host: { class: 'adf-date-cell' }
            },] },
];
DateCellComponent.ctorParameters = function () { return []; };
var EmptyListComponent = /** @class */ (function () {
    function EmptyListComponent() {
    }
    return EmptyListComponent;
}());
EmptyListComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-empty-list',
                styles: [".adf-empty-list_template{text-align:center;margin-top:20px;margin-bottom:20px}"],
                template: "<div class=\"adf-empty-list_template\">\n    <ng-content select=\"[adf-empty-list-header]\"></ng-content>\n    <ng-content select=\"[adf-empty-list-body]\"></ng-content>\n    <ng-content select=\"[adf-empty-list-footer]\"></ng-content>\n    <ng-content></ng-content>\n</div>",
                encapsulation: ViewEncapsulation.None
            },] },
];
EmptyListComponent.ctorParameters = function () { return []; };
var EmptyListHeaderDirective = /** @class */ (function () {
    function EmptyListHeaderDirective() {
    }
    return EmptyListHeaderDirective;
}());
EmptyListHeaderDirective.decorators = [
    { type: Directive, args: [{ selector: '[adf-empty-list-header]' },] },
];
EmptyListHeaderDirective.ctorParameters = function () { return []; };
var EmptyListBodyDirective = /** @class */ (function () {
    function EmptyListBodyDirective() {
    }
    return EmptyListBodyDirective;
}());
EmptyListBodyDirective.decorators = [
    { type: Directive, args: [{ selector: '[adf-empty-list-body]' },] },
];
EmptyListBodyDirective.ctorParameters = function () { return []; };
var EmptyListFooterDirective = /** @class */ (function () {
    function EmptyListFooterDirective() {
    }
    return EmptyListFooterDirective;
}());
EmptyListFooterDirective.decorators = [
    { type: Directive, args: [{ selector: '[adf-empty-list-footer]' },] },
];
EmptyListFooterDirective.ctorParameters = function () { return []; };
var FileSizeCellComponent = /** @class */ (function (_super) {
    __extends(FileSizeCellComponent, _super);
    function FileSizeCellComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return FileSizeCellComponent;
}(DataTableCellComponent));
FileSizeCellComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-filesize-cell',
                template: "\n        <ng-container>\n            <span [title]=\"tooltip\">{{ value | adfFileSize }}</span>\n        </ng-container>\n    ",
                encapsulation: ViewEncapsulation.None,
                host: { class: 'adf-filesize-cell' }
            },] },
];
FileSizeCellComponent.ctorParameters = function () { return []; };
var LocationCellComponent = /** @class */ (function (_super) {
    __extends(LocationCellComponent, _super);
    function LocationCellComponent() {
        var _this = _super.apply(this, __spread(arguments)) || this;
        _this.displayText = '';
        return _this;
    }
    LocationCellComponent.prototype.ngOnInit = function () {
        if (!this.value && this.column && this.column.key && this.row && this.data) {
            var path = this.data.getValue(this.row, this.column);
            if (path && path.name && path.elements) {
                this.value = path;
                this.displayText = path.name.split('/').pop();
                if (!this.tooltip) {
                    this.tooltip = path.name;
                }
                var parent = path.elements[path.elements.length - 1];
                this.link = [this.column.format, parent.id];
            }
        }
    };
    return LocationCellComponent;
}(DataTableCellComponent));
LocationCellComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-location-cell',
                changeDetection: ChangeDetectionStrategy.OnPush,
                template: "\n        <ng-container>\n            <a href=\"\" [title]=\"tooltip\" [routerLink]=\"link\">\n                {{ displayText }}\n            </a>\n        </ng-container>\n    ",
                encapsulation: ViewEncapsulation.None,
                host: { class: 'adf-location-cell' }
            },] },
];
LocationCellComponent.ctorParameters = function () { return []; };
LocationCellComponent.propDecorators = {
    "link": [{ type: Input },],
    "displayText": [{ type: Input },],
};
var LoadingContentTemplateDirective = /** @class */ (function () {
    function LoadingContentTemplateDirective(dataTable) {
        this.dataTable = dataTable;
    }
    LoadingContentTemplateDirective.prototype.ngAfterContentInit = function () {
        if (this.dataTable) {
            this.dataTable.loadingTemplate = this.template;
        }
    };
    return LoadingContentTemplateDirective;
}());
LoadingContentTemplateDirective.decorators = [
    { type: Directive, args: [{
                selector: 'loading-content-template'
            },] },
];
LoadingContentTemplateDirective.ctorParameters = function () { return [
    { type: DataTableComponent, },
]; };
LoadingContentTemplateDirective.propDecorators = {
    "template": [{ type: ContentChild, args: [TemplateRef,] },],
};
var NoContentTemplateDirective = /** @class */ (function () {
    function NoContentTemplateDirective(dataTable) {
        this.dataTable = dataTable;
    }
    NoContentTemplateDirective.prototype.ngAfterContentInit = function () {
        if (this.dataTable) {
            this.dataTable.noContentTemplate = this.template;
        }
    };
    return NoContentTemplateDirective;
}());
NoContentTemplateDirective.decorators = [
    { type: Directive, args: [{
                selector: 'no-content-template'
            },] },
];
NoContentTemplateDirective.ctorParameters = function () { return [
    { type: DataTableComponent, },
]; };
NoContentTemplateDirective.propDecorators = {
    "template": [{ type: ContentChild, args: [TemplateRef,] },],
};
var NoPermissionTemplateDirective = /** @class */ (function () {
    function NoPermissionTemplateDirective(dataTable) {
        this.dataTable = dataTable;
    }
    NoPermissionTemplateDirective.prototype.ngAfterContentInit = function () {
        if (this.dataTable) {
            this.dataTable.noPermissionTemplate = this.template;
        }
    };
    return NoPermissionTemplateDirective;
}());
NoPermissionTemplateDirective.decorators = [
    { type: Directive, args: [{
                selector: 'no-permission-template'
            },] },
];
NoPermissionTemplateDirective.ctorParameters = function () { return [
    { type: DataTableComponent, },
]; };
NoPermissionTemplateDirective.propDecorators = {
    "template": [{ type: ContentChild, args: [TemplateRef,] },],
};
var ContextMenuService = /** @class */ (function () {
    function ContextMenuService() {
        this.show = new Subject();
    }
    return ContextMenuService;
}());
ContextMenuService.decorators = [
    { type: Injectable },
];
ContextMenuService.ctorParameters = function () { return []; };
var ContextMenuHolderComponent = /** @class */ (function () {
    function ContextMenuHolderComponent(viewport, overlayContainer, contextMenuService, renderer) {
        this.viewport = viewport;
        this.overlayContainer = overlayContainer;
        this.contextMenuService = contextMenuService;
        this.renderer = renderer;
        this.links = [];
        this.mouseLocation = { left: 0, top: 0 };
        this.menuElement = null;
        this.showIcons = false;
    }
    ContextMenuHolderComponent.prototype.onShowContextMenu = function (event) {
        if (event) {
            event.preventDefault();
        }
    };
    ContextMenuHolderComponent.prototype.onResize = function (event) {
        if (this.mdMenuElement) {
            this.setPositionAfterCDKrecalculation();
        }
    };
    ContextMenuHolderComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.contextSubscription = this.contextMenuService.show.subscribe(function (e) { return _this.showMenu(e.event, e.obj); });
        this.openSubscription = this.menuTrigger.onMenuOpen.subscribe(function () {
            var container = _this.overlayContainer.getContainerElement();
            if (container) {
                _this.contextMenuListenerFn = _this.renderer.listen(container, 'contextmenu', function (e) {
                    e.preventDefault();
                });
            }
            _this.menuElement = _this.getContextMenuElement();
        });
        this.closeSubscription = this.menuTrigger.onMenuClose.subscribe(function () {
            _this.menuElement = null;
            if (_this.contextMenuListenerFn) {
                _this.contextMenuListenerFn();
            }
        });
    };
    ContextMenuHolderComponent.prototype.ngOnDestroy = function () {
        if (this.contextMenuListenerFn) {
            this.contextMenuListenerFn();
        }
        this.contextSubscription.unsubscribe();
        this.openSubscription.unsubscribe();
        this.closeSubscription.unsubscribe();
        this.menuElement = null;
    };
    ContextMenuHolderComponent.prototype.onMenuItemClick = function (event, menuItem) {
        if (menuItem && menuItem.model && menuItem.model.disabled) {
            event.preventDefault();
            event.stopImmediatePropagation();
            return;
        }
        menuItem.subject.next(menuItem);
    };
    ContextMenuHolderComponent.prototype.showMenu = function (e, links) {
        this.links = links;
        if (e) {
            this.mouseLocation = {
                left: e.clientX,
                top: e.clientY
            };
        }
        this.menuTrigger.openMenu();
        if (this.mdMenuElement) {
            this.setPositionAfterCDKrecalculation();
        }
    };
    ContextMenuHolderComponent.prototype.setPositionAfterCDKrecalculation = function () {
        var _this = this;
        setTimeout(function () {
            _this.setPosition();
        }, 0);
    };
    Object.defineProperty(ContextMenuHolderComponent.prototype, "mdMenuElement", {
        get: function () {
            return this.menuElement;
        },
        enumerable: true,
        configurable: true
    });
    ContextMenuHolderComponent.prototype.locationCss = function () {
        return {
            left: this.mouseLocation.left + 'px',
            top: this.mouseLocation.top + 'px'
        };
    };
    ContextMenuHolderComponent.prototype.setPosition = function () {
        if (this.mdMenuElement.clientWidth + this.mouseLocation.left > this.viewport.getViewportRect().width) {
            this.menuTrigger.menu.xPosition = 'before';
            this.mdMenuElement.parentElement.style.left = this.mouseLocation.left - this.mdMenuElement.clientWidth + 'px';
        }
        else {
            this.menuTrigger.menu.xPosition = 'after';
            this.mdMenuElement.parentElement.style.left = this.locationCss().left;
        }
        if (this.mdMenuElement.clientHeight + this.mouseLocation.top > this.viewport.getViewportRect().height) {
            this.menuTrigger.menu.yPosition = 'above';
            this.mdMenuElement.parentElement.style.top = this.mouseLocation.top - this.mdMenuElement.clientHeight + 'px';
        }
        else {
            this.menuTrigger.menu.yPosition = 'below';
            this.mdMenuElement.parentElement.style.top = this.locationCss().top;
        }
    };
    ContextMenuHolderComponent.prototype.getContextMenuElement = function () {
        return this.overlayContainer.getContainerElement().querySelector('.context-menu');
    };
    return ContextMenuHolderComponent;
}());
ContextMenuHolderComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-context-menu-holder, context-menu-holder',
                template: "\n        <button mat-button [matMenuTriggerFor]=\"contextMenu\"></button>\n        <mat-menu #contextMenu=\"matMenu\" class=\"context-menu\">\n            <button\n                *ngFor=\"let link of links\"\n                mat-menu-item\n                (click)=\"onMenuItemClick($event, link)\"\n                [attr.disabled]=\"link.model?.disabled || undefined\">\n                <mat-icon *ngIf=\"showIcons && link.model?.icon\">\n                    {{ link.model?.icon }}\n                </mat-icon>\n                    {{ (link.title || link.model?.title) | translate}}\n            </button>\n        </mat-menu>\n    "
            },] },
];
ContextMenuHolderComponent.ctorParameters = function () { return [
    { type: ViewportRuler, },
    { type: OverlayContainer, },
    { type: ContextMenuService, },
    { type: Renderer2, },
]; };
ContextMenuHolderComponent.propDecorators = {
    "showIcons": [{ type: Input },],
    "menuTrigger": [{ type: ViewChild, args: [MatMenuTrigger,] },],
    "onShowContextMenu": [{ type: HostListener, args: ['contextmenu', ['$event'],] },],
    "onResize": [{ type: HostListener, args: ['window:resize', ['$event'],] },],
};
var ContextMenuDirective = /** @class */ (function () {
    function ContextMenuDirective(_contextMenuService) {
        this._contextMenuService = _contextMenuService;
        this.enabled = false;
    }
    ContextMenuDirective.prototype.onShowContextMenu = function (event) {
        if (this.enabled) {
            if (event) {
                event.preventDefault();
            }
            if (this.links && this.links.length > 0) {
                if (this._contextMenuService) {
                    this._contextMenuService.show.next({ event: event, obj: this.links });
                }
            }
        }
    };
    return ContextMenuDirective;
}());
ContextMenuDirective.decorators = [
    { type: Directive, args: [{
                selector: '[adf-context-menu], [context-menu]'
            },] },
];
ContextMenuDirective.ctorParameters = function () { return [
    { type: ContextMenuService, },
]; };
ContextMenuDirective.propDecorators = {
    "links": [{ type: Input, args: ['context-menu',] },],
    "enabled": [{ type: Input, args: ['context-menu-enabled',] },],
    "onShowContextMenu": [{ type: HostListener, args: ['contextmenu', ['$event'],] },],
};
var ContextMenuModule = /** @class */ (function () {
    function ContextMenuModule() {
    }
    return ContextMenuModule;
}());
ContextMenuModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    CommonModule,
                    MaterialModule,
                    TranslateModule
                ],
                declarations: [
                    ContextMenuHolderComponent,
                    ContextMenuDirective
                ],
                exports: [
                    ContextMenuHolderComponent,
                    ContextMenuDirective
                ],
                providers: [
                    ContextMenuService
                ]
            },] },
];
ContextMenuModule.ctorParameters = function () { return []; };
var HighlightDirective = /** @class */ (function () {
    function HighlightDirective(el, renderer, highlightTransformService) {
        this.el = el;
        this.renderer = renderer;
        this.highlightTransformService = highlightTransformService;
        this.selector = '';
        this.search = '';
        this.classToApply = 'adf-highlight';
    }
    HighlightDirective.prototype.highlight = function (search, selector, classToApply) {
        var _this = this;
        if (search === void 0) { search = this.search; }
        if (selector === void 0) { selector = this.selector; }
        if (classToApply === void 0) { classToApply = this.classToApply; }
        if (search && selector) {
            var elements = this.el.nativeElement.querySelectorAll(selector);
            elements.forEach(function (element) {
                var result = _this.highlightTransformService.highlight(element.innerHTML, search, classToApply);
                if (result.changed) {
                    _this.renderer.setElementProperty(element, 'innerHTML', result.text);
                }
            });
        }
    };
    return HighlightDirective;
}());
HighlightDirective.decorators = [
    { type: Directive, args: [{
                selector: '[adf-highlight]'
            },] },
];
HighlightDirective.ctorParameters = function () { return [
    { type: ElementRef, },
    { type: Renderer, },
    { type: HighlightTransformService, },
]; };
HighlightDirective.propDecorators = {
    "selector": [{ type: Input, args: ['adf-highlight-selector',] },],
    "search": [{ type: Input, args: ['adf-highlight',] },],
    "classToApply": [{ type: Input, args: ['adf-highlight-class',] },],
};
var LogoutDirective = /** @class */ (function () {
    function LogoutDirective(elementRef, renderer, router, auth) {
        this.elementRef = elementRef;
        this.renderer = renderer;
        this.router = router;
        this.auth = auth;
    }
    LogoutDirective.prototype.ngOnInit = function () {
        var _this = this;
        if (this.elementRef.nativeElement) {
            this.renderer.listen(this.elementRef.nativeElement, 'click', function (evt) {
                evt.preventDefault();
                _this.logout();
            });
        }
    };
    LogoutDirective.prototype.logout = function () {
        var _this = this;
        this.auth.logout().subscribe(function () { return _this.redirectToLogin(); }, function () { return _this.redirectToLogin(); });
    };
    LogoutDirective.prototype.redirectToLogin = function () {
        this.router.navigate(['/login']);
    };
    return LogoutDirective;
}());
LogoutDirective.decorators = [
    { type: Directive, args: [{
                selector: '[adf-logout]'
            },] },
];
LogoutDirective.ctorParameters = function () { return [
    { type: ElementRef, },
    { type: Renderer2, },
    { type: Router, },
    { type: AuthenticationService, },
]; };
var NodeDeleteDirective = /** @class */ (function () {
    function NodeDeleteDirective(alfrescoApiService, translation, elementRef) {
        this.alfrescoApiService = alfrescoApiService;
        this.translation = translation;
        this.elementRef = elementRef;
        this.permanent = false;
        this.delete = new EventEmitter();
    }
    NodeDeleteDirective.prototype.onClick = function () {
        this.process(this.selection);
    };
    NodeDeleteDirective.prototype.ngOnChanges = function () {
        if (!this.selection || (this.selection && this.selection.length === 0)) {
            this.setDisableAttribute(true);
        }
        else {
            if (!this.elementRef.nativeElement.hasAttribute('adf-node-permission')) {
                this.setDisableAttribute(false);
            }
        }
    };
    NodeDeleteDirective.prototype.setDisableAttribute = function (disable) {
        this.elementRef.nativeElement.disabled = disable;
    };
    NodeDeleteDirective.prototype.process = function (selection) {
        var _this = this;
        if (selection && selection.length) {
            var batch = this.getDeleteNodesBatch(selection);
            Observable.forkJoin.apply(Observable, __spread(batch)).subscribe(function (data) {
                var processedItems = _this.processStatus(data);
                _this.delete.emit(_this.getMessage(processedItems));
            });
        }
    };
    NodeDeleteDirective.prototype.getDeleteNodesBatch = function (selection) {
        var _this = this;
        return selection.map(function (node) { return _this.deleteNode(node); });
    };
    NodeDeleteDirective.prototype.deleteNode = function (node) {
        var id = ((node.entry)).nodeId || node.entry.id;
        var promise;
        if (node.entry.hasOwnProperty('archivedAt')) {
            promise = this.alfrescoApiService.getInstance().nodes.purgeDeletedNode(id);
        }
        else {
            promise = this.alfrescoApiService.getInstance().nodes.deleteNode(id, { permanent: this.permanent });
        }
        return Observable.fromPromise(promise)
            .map(function () { return ({
            entry: node.entry,
            status: 1
        }); })
            .catch(function (error) {
            return Observable.of({
                entry: node.entry,
                status: 0
            });
        });
    };
    NodeDeleteDirective.prototype.processStatus = function (data) {
        var deleteStatus = {
            success: [],
            failed: [],
            get someFailed() {
                return !!(this.failed.length);
            },
            get someSucceeded() {
                return !!(this.success.length);
            },
            get oneFailed() {
                return this.failed.length === 1;
            },
            get oneSucceeded() {
                return this.success.length === 1;
            },
            get allSucceeded() {
                return this.someSucceeded && !this.someFailed;
            },
            get allFailed() {
                return this.someFailed && !this.someSucceeded;
            }
        };
        return data.reduce(function (acc, next) {
            if (next.status === 1) {
                acc.success.push(next);
            }
            else {
                acc.failed.push(next);
            }
            return acc;
        }, deleteStatus);
    };
    NodeDeleteDirective.prototype.getMessage = function (status) {
        if (status.allFailed && !status.oneFailed) {
            return this.translation.instant('CORE.DELETE_NODE.ERROR_PLURAL', { number: status.failed.length });
        }
        if (status.allSucceeded && !status.oneSucceeded) {
            return this.translation.instant('CORE.DELETE_NODE.PLURAL', { number: status.success.length });
        }
        if (status.someFailed && status.someSucceeded && !status.oneSucceeded) {
            return this.translation.instant('CORE.DELETE_NODE.PARTIAL_PLURAL', {
                success: status.success.length,
                failed: status.failed.length
            });
        }
        if (status.someFailed && status.oneSucceeded) {
            return this.translation.instant('CORE.DELETE_NODE.PARTIAL_SINGULAR', {
                success: status.success.length,
                failed: status.failed.length
            });
        }
        if (status.oneFailed && !status.someSucceeded) {
            return this.translation.instant('CORE.DELETE_NODE.ERROR_SINGULAR', { name: status.failed[0].entry.name });
        }
        if (status.oneSucceeded && !status.someFailed) {
            return this.translation.instant('CORE.DELETE_NODE.SINGULAR', { name: status.success[0].entry.name });
        }
    };
    return NodeDeleteDirective;
}());
NodeDeleteDirective.decorators = [
    { type: Directive, args: [{
                selector: '[adf-delete]'
            },] },
];
NodeDeleteDirective.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: TranslationService, },
    { type: ElementRef, },
]; };
NodeDeleteDirective.propDecorators = {
    "selection": [{ type: Input, args: ['adf-delete',] },],
    "permanent": [{ type: Input },],
    "delete": [{ type: Output },],
    "onClick": [{ type: HostListener, args: ['click',] },],
};
var NodeFavoriteDirective = /** @class */ (function () {
    function NodeFavoriteDirective(alfrescoApiService) {
        this.alfrescoApiService = alfrescoApiService;
        this.favorites = [];
        this.selection = [];
        this.toggle = new EventEmitter();
    }
    NodeFavoriteDirective.prototype.onClick = function () {
        this.toggleFavorite();
    };
    NodeFavoriteDirective.prototype.ngOnChanges = function (changes) {
        if (!changes.selection.currentValue.length) {
            this.favorites = [];
            return;
        }
        this.markFavoritesNodes(changes.selection.currentValue);
    };
    NodeFavoriteDirective.prototype.toggleFavorite = function () {
        var _this = this;
        if (!this.favorites.length) {
            return;
        }
        var every = this.favorites.every(function (selected) { return selected.entry.isFavorite; });
        if (every) {
            var batch = this.favorites.map(function (selected) {
                var id = selected.entry.nodeId || selected.entry.id;
                return Observable.fromPromise(_this.alfrescoApiService.getInstance().core.favoritesApi.removeFavoriteSite('-me-', id));
            });
            Observable.forkJoin(batch).subscribe(function () {
                _this.favorites.map(function (selected) { return selected.entry.isFavorite = false; });
                _this.toggle.emit();
            });
        }
        if (!every) {
            var notFavorite_1 = this.favorites.filter(function (node) { return !node.entry.isFavorite; });
            var body = notFavorite_1.map(function (node) { return _this.createFavoriteBody(node); });
            Observable.fromPromise(this.alfrescoApiService.getInstance().core.favoritesApi.addFavorite('-me-', (body)))
                .subscribe(function () {
                notFavorite_1.map(function (selected) { return selected.entry.isFavorite = true; });
                _this.toggle.emit();
            });
        }
    };
    NodeFavoriteDirective.prototype.markFavoritesNodes = function (selection) {
        var _this = this;
        if (selection.length <= this.favorites.length) {
            var newFavorites = this.reduce(this.favorites, selection);
            this.favorites = newFavorites;
        }
        var result = this.diff(selection, this.favorites);
        var batch = this.getProcessBatch(result);
        Observable.forkJoin(batch).subscribe(function (data) {
            return (_a = _this.favorites).push.apply(_a, __spread(data));
            var _a;
        });
    };
    NodeFavoriteDirective.prototype.hasFavorites = function () {
        if (this.favorites && !this.favorites.length) {
            return false;
        }
        return this.favorites.every(function (selected) { return selected.entry.isFavorite; });
    };
    NodeFavoriteDirective.prototype.getProcessBatch = function (selection) {
        var _this = this;
        return selection.map(function (selected) { return _this.getFavorite(selected); });
    };
    NodeFavoriteDirective.prototype.getFavorite = function (selected) {
        var _a = selected.entry, name = _a.name, isFile = _a.isFile, isFolder = _a.isFolder;
        var id = ((selected)).entry.nodeId || selected.entry.id;
        var promise = this.alfrescoApiService.getInstance()
            .core.favoritesApi.getFavorite('-me-', id);
        return Observable.from(promise)
            .map(function () { return ({
            entry: {
                id: id,
                isFolder: isFolder,
                isFile: isFile,
                name: name,
                isFavorite: true
            }
        }); })
            .catch(function () {
            return Observable.of({
                entry: {
                    id: id,
                    isFolder: isFolder,
                    isFile: isFile,
                    name: name,
                    isFavorite: false
                }
            });
        });
    };
    NodeFavoriteDirective.prototype.createFavoriteBody = function (node) {
        var type = this.getNodeType(node);
        var id = node.entry.nodeId || node.entry.id;
        return {
            target: (_a = {}, _a[type] = {
                    guid: id
                }, _a)
        };
        var _a;
    };
    NodeFavoriteDirective.prototype.getNodeType = function (node) {
        if (!node.entry.isFile && !node.entry.isFolder) {
            return 'file';
        }
        return node.entry.isFile ? 'file' : 'folder';
    };
    NodeFavoriteDirective.prototype.diff = function (list, patch) {
        var ids = patch.map(function (item) { return item.entry.id; });
        return list.filter(function (item) { return ids.includes(item.entry.id) ? null : item; });
    };
    NodeFavoriteDirective.prototype.reduce = function (patch, comparator) {
        var ids = comparator.map(function (item) { return item.entry.id; });
        return patch.filter(function (item) { return ids.includes(item.entry.id) ? item : null; });
    };
    return NodeFavoriteDirective;
}());
NodeFavoriteDirective.decorators = [
    { type: Directive, args: [{
                selector: '[adf-node-favorite]',
                exportAs: 'adfFavorite'
            },] },
];
NodeFavoriteDirective.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
]; };
NodeFavoriteDirective.propDecorators = {
    "selection": [{ type: Input, args: ['adf-node-favorite',] },],
    "toggle": [{ type: Output },],
    "onClick": [{ type: HostListener, args: ['click',] },],
};
var EXTENDIBLE_COMPONENT = new InjectionToken('extendible.component');
var NodePermissionDirective = /** @class */ (function () {
    function NodePermissionDirective(elementRef, renderer, contentService, changeDetector, parentComponent) {
        this.elementRef = elementRef;
        this.renderer = renderer;
        this.contentService = contentService;
        this.changeDetector = changeDetector;
        this.parentComponent = parentComponent;
        this.permission = null;
        this.nodes = [];
    }
    NodePermissionDirective.prototype.ngOnChanges = function (changes) {
        if (changes["nodes"] && !changes["nodes"].firstChange) {
            this.updateElement();
        }
    };
    NodePermissionDirective.prototype.updateElement = function () {
        var enable = this.hasPermission(this.nodes, this.permission);
        if (enable) {
            this.enable();
        }
        else {
            this.disable();
        }
        return enable;
    };
    NodePermissionDirective.prototype.enable = function () {
        if (this.parentComponent) {
            this.parentComponent.disabled = false;
            this.changeDetector.detectChanges();
        }
        else {
            this.enableElement();
        }
    };
    NodePermissionDirective.prototype.disable = function () {
        if (this.parentComponent) {
            this.parentComponent.disabled = true;
            this.changeDetector.detectChanges();
        }
        else {
            this.disableElement();
        }
    };
    NodePermissionDirective.prototype.enableElement = function () {
        this.renderer.removeAttribute(this.elementRef.nativeElement, 'disabled');
    };
    NodePermissionDirective.prototype.disableElement = function () {
        this.renderer.setAttribute(this.elementRef.nativeElement, 'disabled', 'true');
    };
    NodePermissionDirective.prototype.hasPermission = function (nodes, permission) {
        var _this = this;
        if (nodes && nodes.length > 0) {
            return nodes.every(function (node) { return _this.contentService.hasPermission(node.entry, permission); });
        }
        return false;
    };
    return NodePermissionDirective;
}());
NodePermissionDirective.decorators = [
    { type: Directive, args: [{
                selector: '[adf-node-permission]'
            },] },
];
NodePermissionDirective.ctorParameters = function () { return [
    { type: ElementRef, },
    { type: Renderer2, },
    { type: ContentService, },
    { type: ChangeDetectorRef, },
    { type: undefined, decorators: [{ type: Host }, { type: Optional }, { type: Inject, args: [EXTENDIBLE_COMPONENT,] },] },
]; };
NodePermissionDirective.propDecorators = {
    "permission": [{ type: Input, args: ['adf-node-permission',] },],
    "nodes": [{ type: Input, args: ['adf-nodes',] },],
};
var NotificationService = /** @class */ (function () {
    function NotificationService(snackbar) {
        this.snackbar = snackbar;
    }
    NotificationService.prototype.openSnackMessage = function (message, millisecondsDuration) {
        return this.snackbar.open(message, null, {
            duration: millisecondsDuration || NotificationService.DEFAULT_DURATION_MESSAGE
        });
    };
    NotificationService.prototype.openSnackMessageAction = function (message, action, millisecondsDuration) {
        return this.snackbar.open(message, action, {
            duration: millisecondsDuration || NotificationService.DEFAULT_DURATION_MESSAGE
        });
    };
    return NotificationService;
}());
NotificationService.DEFAULT_DURATION_MESSAGE = 5000;
NotificationService.decorators = [
    { type: Injectable },
];
NotificationService.ctorParameters = function () { return [
    { type: MatSnackBar, },
]; };
var NodeRestoreDirective = /** @class */ (function () {
    function NodeRestoreDirective(alfrescoApiService, translation, router, notification) {
        this.alfrescoApiService = alfrescoApiService;
        this.translation = translation;
        this.router = router;
        this.notification = notification;
        this.location = '';
        this.restore = new EventEmitter();
        this.restoreProcessStatus = this.processStatus();
    }
    NodeRestoreDirective.prototype.onClick = function () {
        this.recover(this.selection);
    };
    NodeRestoreDirective.prototype.recover = function (selection) {
        var _this = this;
        if (!selection.length) {
            return;
        }
        var nodesWithPath = this.getNodesWithPath(selection);
        if (selection.length && !nodesWithPath.length) {
            (_a = this.restoreProcessStatus.fail).push.apply(_a, __spread(selection));
            this.restoreNotification();
            this.refresh();
            return;
        }
        this.restoreNodesBatch(nodesWithPath)
            .do(function (restoredNodes) {
            var status = _this.processStatus(restoredNodes);
            (_a = _this.restoreProcessStatus.fail).push.apply(_a, __spread(status.fail));
            (_b = _this.restoreProcessStatus.success).push.apply(_b, __spread(status.success));
            var _a, _b;
        })
            .mergeMap(function () { return _this.getDeletedNodes(); })
            .subscribe(function (deletedNodesList) {
            var nodelist = deletedNodesList.list.entries;
            var restoreErrorNodes = _this.restoreProcessStatus.fail;
            var selectedNodes = _this.diff(restoreErrorNodes, selection, false);
            var remainingNodes = _this.diff(selectedNodes, nodelist);
            if (!remainingNodes.length) {
                _this.restoreNotification();
                _this.refresh();
            }
            else {
                _this.recover(remainingNodes);
            }
        });
        var _a;
    };
    NodeRestoreDirective.prototype.restoreNodesBatch = function (batch) {
        var _this = this;
        return Observable.forkJoin(batch.map(function (node) { return _this.restoreNode(node); }));
    };
    NodeRestoreDirective.prototype.getNodesWithPath = function (selection) {
        return selection.filter(function (node) { return node.entry.path; });
    };
    NodeRestoreDirective.prototype.getDeletedNodes = function () {
        var promise = this.alfrescoApiService.getInstance()
            .core.nodesApi.getDeletedNodes({ include: ['path'] });
        return Observable.from(promise);
    };
    NodeRestoreDirective.prototype.restoreNode = function (node) {
        var entry = node.entry;
        var promise = this.alfrescoApiService.getInstance().nodes.restoreNode(entry.id);
        return Observable.from(promise)
            .map(function () { return ({
            status: 1,
            entry: entry
        }); })
            .catch(function (error) {
            var statusCode = (JSON.parse(error.message)).error.statusCode;
            return Observable.of({
                status: 0,
                statusCode: statusCode,
                entry: entry
            });
        });
    };
    NodeRestoreDirective.prototype.navigateLocation = function (path) {
        var parent = path.elements[path.elements.length - 1];
        this.router.navigate([this.location, parent.id]);
    };
    NodeRestoreDirective.prototype.diff = function (selection, list, fromList) {
        if (fromList === void 0) { fromList = true; }
        var ids = selection.map(function (item) { return item.entry.id; });
        return list.filter(function (item) {
            if (fromList) {
                return ids.includes(item.entry.id) ? item : null;
            }
            else {
                return !ids.includes(item.entry.id) ? item : null;
            }
        });
    };
    NodeRestoreDirective.prototype.processStatus = function (data) {
        if (data === void 0) { data = []; }
        var status = {
            fail: [],
            success: [],
            get someFailed() {
                return !!(this.fail.length);
            },
            get someSucceeded() {
                return !!(this.success.length);
            },
            get oneFailed() {
                return this.fail.length === 1;
            },
            get oneSucceeded() {
                return this.success.length === 1;
            },
            get allSucceeded() {
                return this.someSucceeded && !this.someFailed;
            },
            get allFailed() {
                return this.someFailed && !this.someSucceeded;
            },
            reset: function () {
                this.fail = [];
                this.success = [];
            }
        };
        return data.reduce(function (acc, node) {
            if (node.status) {
                acc.success.push(node);
            }
            else {
                acc.fail.push(node);
            }
            return acc;
        }, status);
    };
    NodeRestoreDirective.prototype.getRestoreMessage = function () {
        var status = this.restoreProcessStatus;
        if (status.someFailed && !status.oneFailed) {
            return this.translation.instant('CORE.RESTORE_NODE.PARTIAL_PLURAL', {
                number: status.fail.length
            });
        }
        if (status.oneFailed && status.fail[0].statusCode) {
            if (status.fail[0].statusCode === 409) {
                return this.translation.instant('CORE.RESTORE_NODE.NODE_EXISTS', {
                    name: status.fail[0].entry.name
                });
            }
            else {
                return this.translation.instant('CORE.RESTORE_NODE.GENERIC', {
                    name: status.fail[0].entry.name
                });
            }
        }
        if (status.oneFailed && !status.fail[0].statusCode) {
            return this.translation.instant('CORE.RESTORE_NODE.LOCATION_MISSING', {
                name: status.fail[0].entry.name
            });
        }
        if (status.allSucceeded && !status.oneSucceeded) {
            return this.translation.instant('CORE.RESTORE_NODE.PLURAL');
        }
        if (status.allSucceeded && status.oneSucceeded) {
            return this.translation.instant('CORE.RESTORE_NODE.SINGULAR', {
                name: status.success[0].entry.name
            });
        }
    };
    NodeRestoreDirective.prototype.restoreNotification = function () {
        var _this = this;
        var status = Object.assign({}, this.restoreProcessStatus);
        var message = this.getRestoreMessage();
        var action = (status.oneSucceeded && !status.someFailed) ? this.translation.instant('CORE.RESTORE_NODE.VIEW') : '';
        this.notification.openSnackMessageAction(message, action)
            .onAction()
            .subscribe(function () { return _this.navigateLocation(status.success[0].entry.path); });
    };
    NodeRestoreDirective.prototype.refresh = function () {
        this.restoreProcessStatus.reset();
        this.selection = [];
        this.restore.emit();
    };
    return NodeRestoreDirective;
}());
NodeRestoreDirective.decorators = [
    { type: Directive, args: [{
                selector: '[adf-restore]'
            },] },
];
NodeRestoreDirective.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: TranslationService, },
    { type: Router, },
    { type: NotificationService, },
]; };
NodeRestoreDirective.propDecorators = {
    "selection": [{ type: Input, args: ['adf-restore',] },],
    "location": [{ type: Input },],
    "restore": [{ type: Output },],
    "onClick": [{ type: HostListener, args: ['click',] },],
};
var UploadDirective = /** @class */ (function () {
    function UploadDirective(el, renderer, ngZone) {
        this.el = el;
        this.renderer = renderer;
        this.ngZone = ngZone;
        this.enabled = true;
        this.mode = ['drop'];
        this.isDragging = false;
        this.cssClassName = 'adf-upload__dragging';
        this.element = el.nativeElement;
    }
    UploadDirective.prototype.ngOnInit = function () {
        var _this = this;
        if (this.isClickMode() && this.renderer) {
            this.upload = (this.renderer.createElement(this.el.nativeElement.parentNode, 'input'));
            this.upload.type = 'file';
            this.upload.style.display = 'none';
            this.upload.addEventListener('change', function (e) { return _this.onSelectFiles(e); });
            if (this.multiple) {
                this.upload.setAttribute('multiple', '');
            }
            if (this.accept) {
                this.upload.setAttribute('accept', this.accept);
            }
            if (this.directory) {
                this.upload.setAttribute('webkitdirectory', '');
            }
        }
        if (this.isDropMode()) {
            this.ngZone.runOutsideAngular(function () {
                _this.element.addEventListener('dragenter', _this.onDragEnter.bind(_this));
                _this.element.addEventListener('dragover', _this.onDragOver.bind(_this));
                _this.element.addEventListener('dragleave', _this.onDragLeave.bind(_this));
                _this.element.addEventListener('drop', _this.onDrop.bind(_this));
            });
        }
    };
    UploadDirective.prototype.ngOnDestroy = function () {
        this.element.removeEventListener('dragenter', this.onDragEnter);
        this.element.removeEventListener('dragover', this.onDragOver);
        this.element.removeEventListener('dragleave', this.onDragLeave);
        this.element.removeEventListener('drop', this.onDrop);
    };
    UploadDirective.prototype.onClick = function (event) {
        if (this.isClickMode() && this.upload) {
            event.preventDefault();
            this.upload.click();
        }
    };
    UploadDirective.prototype.onDragEnter = function (event) {
        if (this.isDropMode()) {
            this.element.classList.add(this.cssClassName);
            this.isDragging = true;
        }
    };
    UploadDirective.prototype.onDragOver = function (event) {
        event.preventDefault();
        if (this.isDropMode()) {
            this.element.classList.add(this.cssClassName);
            this.isDragging = true;
        }
        return false;
    };
    UploadDirective.prototype.onDragLeave = function (event) {
        if (this.isDropMode()) {
            this.element.classList.remove(this.cssClassName);
            this.isDragging = false;
        }
    };
    UploadDirective.prototype.onDrop = function (event) {
        var _this = this;
        if (this.isDropMode()) {
            event.stopPropagation();
            event.preventDefault();
            this.element.classList.remove(this.cssClassName);
            this.isDragging = false;
            var dataTranfer = this.getDataTransfer(event);
            if (dataTranfer) {
                this.getFilesDropped(dataTranfer).then(function (files) {
                    _this.onUploadFiles(files);
                });
            }
        }
        return false;
    };
    UploadDirective.prototype.onUploadFiles = function (files) {
        if (this.enabled && files.length > 0) {
            var e = new CustomEvent('upload-files', {
                detail: {
                    sender: this,
                    data: this.data,
                    files: files
                },
                bubbles: true
            });
            this.el.nativeElement.dispatchEvent(e);
        }
    };
    UploadDirective.prototype.hasMode = function (mode) {
        return this.enabled && mode && this.mode && this.mode.indexOf(mode) > -1;
    };
    UploadDirective.prototype.isDropMode = function () {
        return this.hasMode('drop');
    };
    UploadDirective.prototype.isClickMode = function () {
        return this.hasMode('click');
    };
    UploadDirective.prototype.getDataTransfer = function (event) {
        if (event && event.dataTransfer) {
            return event.dataTransfer;
        }
        if (event && event.originalEvent && event.originalEvent.dataTransfer) {
            return event.originalEvent.dataTransfer;
        }
        return null;
    };
    UploadDirective.prototype.getFilesDropped = function (dataTransfer) {
        return new Promise(function (resolve) {
            var iterations = [];
            if (dataTransfer) {
                var items = dataTransfer.items;
                if (items) {
                    var _loop_1 = function (i) {
                        if (typeof items[i].webkitGetAsEntry !== 'undefined') {
                            var item_1 = items[i].webkitGetAsEntry();
                            if (item_1) {
                                if (item_1.isFile) {
                                    iterations.push(Promise.resolve(({
                                        entry: item_1,
                                        file: items[i].getAsFile(),
                                        relativeFolder: '/'
                                    })));
                                }
                                else if (item_1.isDirectory) {
                                    iterations.push(new Promise(function (resolveFolder) {
                                        FileUtils.flattern(item_1).then(function (files) { return resolveFolder(files); });
                                    }));
                                }
                            }
                        }
                        else {
                            iterations.push(Promise.resolve(({
                                entry: null,
                                file: items[i].getAsFile(),
                                relativeFolder: '/'
                            })));
                        }
                    };
                    for (var i = 0; i < items.length; i++) {
                        _loop_1(i);
                    }
                }
                else {
                    var files = FileUtils
                        .toFileArray(dataTransfer.files)
                        .map(function (file) { return ({
                        entry: null,
                        file: file,
                        relativeFolder: '/'
                    }); });
                    iterations.push(Promise.resolve(files));
                }
            }
            Promise.all(iterations).then(function (result) {
                resolve(result.reduce(function (a, b) { return a.concat(b); }, []));
            });
        });
    };
    UploadDirective.prototype.onSelectFiles = function (e) {
        if (this.isClickMode()) {
            var input = ((e.currentTarget));
            var files = FileUtils.toFileArray(input.files);
            this.onUploadFiles(files.map(function (file) { return ({
                entry: null,
                file: file,
                relativeFolder: '/'
            }); }));
            e.target.value = '';
        }
    };
    return UploadDirective;
}());
UploadDirective.decorators = [
    { type: Directive, args: [{
                selector: '[adf-upload]'
            },] },
];
UploadDirective.ctorParameters = function () { return [
    { type: ElementRef, },
    { type: Renderer, },
    { type: NgZone, },
]; };
UploadDirective.propDecorators = {
    "enabled": [{ type: Input, args: ['adf-upload',] },],
    "data": [{ type: Input, args: ['adf-upload-data',] },],
    "mode": [{ type: Input },],
    "multiple": [{ type: Input },],
    "accept": [{ type: Input },],
    "directory": [{ type: Input },],
    "onClick": [{ type: HostListener, args: ['click', ['$event'],] },],
};
var DirectiveModule = /** @class */ (function () {
    function DirectiveModule() {
    }
    return DirectiveModule;
}());
DirectiveModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    CommonModule,
                    MaterialModule
                ],
                declarations: [
                    HighlightDirective,
                    LogoutDirective,
                    NodeDeleteDirective,
                    NodeFavoriteDirective,
                    NodePermissionDirective,
                    NodeRestoreDirective,
                    UploadDirective
                ],
                exports: [
                    HighlightDirective,
                    LogoutDirective,
                    NodeDeleteDirective,
                    NodeFavoriteDirective,
                    NodePermissionDirective,
                    NodeRestoreDirective,
                    UploadDirective
                ]
            },] },
];
DirectiveModule.ctorParameters = function () { return []; };
var DataTableModule = /** @class */ (function () {
    function DataTableModule() {
    }
    return DataTableModule;
}());
DataTableModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    RouterModule,
                    MaterialModule,
                    CommonModule,
                    TranslateModule,
                    ContextMenuModule,
                    PipeModule,
                    DirectiveModule
                ],
                declarations: [
                    DataTableComponent,
                    EmptyListComponent,
                    EmptyListHeaderDirective,
                    EmptyListBodyDirective,
                    EmptyListFooterDirective,
                    DataTableCellComponent,
                    DateCellComponent,
                    FileSizeCellComponent,
                    LocationCellComponent,
                    NoContentTemplateDirective,
                    NoPermissionTemplateDirective,
                    LoadingContentTemplateDirective
                ],
                exports: [
                    DataTableComponent,
                    EmptyListComponent,
                    EmptyListHeaderDirective,
                    EmptyListBodyDirective,
                    EmptyListFooterDirective,
                    DataTableCellComponent,
                    DateCellComponent,
                    FileSizeCellComponent,
                    LocationCellComponent,
                    NoContentTemplateDirective,
                    NoPermissionTemplateDirective,
                    LoadingContentTemplateDirective
                ]
            },] },
];
DataTableModule.ctorParameters = function () { return []; };
var AccordionComponent = /** @class */ (function () {
    function AccordionComponent() {
        this.groups = [];
    }
    AccordionComponent.prototype.addGroup = function (group) {
        this.groups.push(group);
    };
    AccordionComponent.prototype.closeOthers = function (openGroup) {
        this.groups.forEach(function (group) {
            if (group !== openGroup) {
                group.isOpen = false;
            }
        });
    };
    AccordionComponent.prototype.removeGroup = function (group) {
        var index = this.groups.indexOf(group);
        if (index !== -1) {
            this.groups.splice(index, 1);
        }
    };
    return AccordionComponent;
}());
AccordionComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-accordion',
                template: "\n        <ng-content></ng-content>\n    ",
                host: {
                    'class': 'panel-group'
                },
                encapsulation: ViewEncapsulation.None
            },] },
];
AccordionComponent.ctorParameters = function () { return []; };
var AccordionGroupComponent = /** @class */ (function () {
    function AccordionGroupComponent(accordion) {
        this.accordion = accordion;
        this._isOpen = false;
        this._isSelected = false;
        this.hasAccordionIcon = true;
        this.headingClick = new EventEmitter();
        this.accordion.addGroup(this);
    }
    Object.defineProperty(AccordionGroupComponent.prototype, "isOpen", {
        get: function () {
            return this._isOpen;
        },
        set: function (value) {
            this._isOpen = value;
            if (value) {
                this.accordion.closeOthers(this);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AccordionGroupComponent.prototype, "isSelected", {
        get: function () {
            return this._isSelected;
        },
        set: function (value) {
            this._isSelected = value;
        },
        enumerable: true,
        configurable: true
    });
    AccordionGroupComponent.prototype.ngOnDestroy = function () {
        this.accordion.removeGroup(this);
    };
    AccordionGroupComponent.prototype.hasHeadingIcon = function () {
        return this.headingIcon ? true : false;
    };
    AccordionGroupComponent.prototype.toggleOpen = function (event) {
        event.preventDefault();
        this.isOpen = !this.isOpen;
        this.headingClick.emit(this.heading);
    };
    AccordionGroupComponent.prototype.getAccordionIcon = function () {
        return this.isOpen ? 'expand_less' : 'expand_more';
    };
    return AccordionGroupComponent;
}());
AccordionGroupComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-accordion-group',
                template: "<div class=\"adf-panel adf-panel-default\" [ngClass]=\"{'adf-panel-open': isOpen}\">\n    <div class=\"adf-panel-heading\" [ngClass]=\"{'adf-panel-heading-selected': isSelected}\" (click)=\"toggleOpen($event)\">\n        <div id=\"heading-icon\" *ngIf=\"hasHeadingIcon()\" class=\"adf-panel-heading-icon\">\n            <mat-icon class=\"material-icons\"\n               [matTooltip]=\"headingIconTooltip\"\n               [matTooltipDisabled]=\"!headingIconTooltip\">\n                {{headingIcon}}\n            </mat-icon>\n        </div>\n        <div id=\"heading-text\" class=\"adf-panel-heading-text\">{{heading}}</div>\n        <div id=\"accordion-button\" *ngIf=\"hasAccordionIcon\" class=\"adf-panel-heading-toggle\">\n            <i class=\"material-icons\">{{getAccordionIcon()}}</i>\n        </div>\n    </div>\n    <div class=\"adf-panel-collapse\" [hidden]=\"!isOpen\">\n        <div class=\"adf-panel-body\" #contentWrapper>\n            <ng-content></ng-content>\n        </div>\n    </div>\n</div>\n",
                styles: [""],
                encapsulation: ViewEncapsulation.None
            },] },
];
AccordionGroupComponent.ctorParameters = function () { return [
    { type: AccordionComponent, },
]; };
AccordionGroupComponent.propDecorators = {
    "contentWrapper": [{ type: ViewChild, args: ['contentWrapper',] },],
    "heading": [{ type: Input },],
    "headingIcon": [{ type: Input },],
    "headingIconTooltip": [{ type: Input },],
    "hasAccordionIcon": [{ type: Input },],
    "headingClick": [{ type: Output },],
    "isOpen": [{ type: Input },],
    "isSelected": [{ type: Input },],
};
var CollapsableModule = /** @class */ (function () {
    function CollapsableModule() {
    }
    return CollapsableModule;
}());
CollapsableModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    MaterialModule,
                    CommonModule
                ],
                declarations: [
                    AccordionComponent,
                    AccordionGroupComponent
                ],
                exports: [
                    AccordionComponent,
                    AccordionGroupComponent
                ]
            },] },
];
CollapsableModule.ctorParameters = function () { return []; };
var CardViewComponent = /** @class */ (function () {
    function CardViewComponent() {
        this.displayEmpty = true;
    }
    return CardViewComponent;
}());
CardViewComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-card-view',
                template: "<div class=\"adf-property-list\">\n    <div *ngFor=\"let property of properties\">\n        <div [attr.data-automation-id]=\"'header-'+property.key\" class=\"adf-property\">\n            <adf-card-view-item-dispatcher\n                [property]=\"property\"\n                [editable]=\"editable\"\n                [displayEmpty]=\"displayEmpty\">\n            </adf-card-view-item-dispatcher>\n        </div>\n    </div>\n</div>\n",
                styles: [""]
            },] },
];
CardViewComponent.ctorParameters = function () { return []; };
CardViewComponent.propDecorators = {
    "properties": [{ type: Input },],
    "editable": [{ type: Input },],
    "displayEmpty": [{ type: Input },],
};
var CardViewBaseItemModel = /** @class */ (function () {
    function CardViewBaseItemModel(obj) {
        this.label = obj.label || '';
        this.value = obj.value;
        this.key = obj.key;
        this.default = obj.default;
        this.editable = !!obj.editable;
        this.clickable = !!obj.clickable;
        this.icon = obj.icon || '';
        this.validators = obj.validators || [];
    }
    CardViewBaseItemModel.prototype.isEmpty = function () {
        return this.value === undefined || this.value === null || this.value === '';
    };
    CardViewBaseItemModel.prototype.isValid = function (newValue) {
        if (!this.validators.length) {
            return true;
        }
        return this.validators
            .map(function (validator) { return validator.isValid(newValue); })
            .reduce(function (isValidUntilNow, isValid) { return isValidUntilNow && isValid; }, true);
    };
    CardViewBaseItemModel.prototype.getValidationErrors = function (value) {
        if (!this.validators.length) {
            return [];
        }
        return this.validators
            .filter(function (validator) { return !validator.isValid(value); })
            .map(function (validator) { return validator.message; });
    };
    return CardViewBaseItemModel;
}());
var CardViewBoolItemModel = /** @class */ (function (_super) {
    __extends(CardViewBoolItemModel, _super);
    function CardViewBoolItemModel(obj) {
        var _this = _super.call(this, obj) || this;
        _this.type = 'bool';
        _this.value = false;
        if (obj.value !== undefined) {
            _this.value = !!JSON.parse(obj.value);
        }
        return _this;
    }
    Object.defineProperty(CardViewBoolItemModel.prototype, "displayValue", {
        get: function () {
            if (this.isEmpty()) {
                return this.default;
            }
            else {
                return this.value;
            }
        },
        enumerable: true,
        configurable: true
    });
    return CardViewBoolItemModel;
}(CardViewBaseItemModel));
function transformKeyToObject(key, value) {
    var objectLevels = key.split('.').reverse();
    return objectLevels.reduce(function (previousValue, currentValue) {
        return _a = {}, _a[currentValue] = previousValue, _a;
        var _a;
    }, value);
}
var CardViewUpdateService = /** @class */ (function () {
    function CardViewUpdateService() {
        this.itemUpdatedSource = new Subject();
        this.itemClickedSource = new Subject();
        this.itemUpdated$ = (this.itemUpdatedSource.asObservable());
        this.itemClicked$ = (this.itemClickedSource.asObservable());
    }
    CardViewUpdateService.prototype.update = function (property, newValue) {
        this.itemUpdatedSource.next({
            target: property,
            changed: transformKeyToObject(property.key, newValue)
        });
    };
    CardViewUpdateService.prototype.clicked = function (property) {
        this.itemClickedSource.next({
            target: property
        });
    };
    return CardViewUpdateService;
}());
CardViewUpdateService.decorators = [
    { type: Injectable },
];
CardViewUpdateService.ctorParameters = function () { return []; };
var CardViewBoolItemComponent = /** @class */ (function () {
    function CardViewBoolItemComponent(cardViewUpdateService) {
        this.cardViewUpdateService = cardViewUpdateService;
    }
    CardViewBoolItemComponent.prototype.isEditable = function () {
        return this.editable && this.property.editable;
    };
    CardViewBoolItemComponent.prototype.changed = function (change) {
        this.cardViewUpdateService.update(this.property, change.checked);
        this.property.value = change.checked;
    };
    return CardViewBoolItemComponent;
}());
CardViewBoolItemComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-card-view-boolitem',
                template: "<ng-container *ngIf=\"!property.isEmpty() || isEditable()\">\n    <div class=\"adf-property-label\">{{ property.label | translate }}</div>\n    <div class=\"adf-property-value\">\n        <mat-checkbox\n            [attr.title]=\"'CORE.METADATA.ACTIONS.TOGGLE' | translate\"\n            [checked]=\"property.displayValue\"\n            [disabled]=\"!isEditable()\"\n            (change)=\"changed($event)\">\n        </mat-checkbox>\n    </div>\n</ng-container>\n",
                styles: [""]
            },] },
];
CardViewBoolItemComponent.ctorParameters = function () { return [
    { type: CardViewUpdateService, },
]; };
CardViewBoolItemComponent.propDecorators = {
    "property": [{ type: Input },],
    "editable": [{ type: Input },],
};
var CardViewDateItemModel = /** @class */ (function (_super) {
    __extends(CardViewDateItemModel, _super);
    function CardViewDateItemModel(obj) {
        var _this = _super.call(this, obj) || this;
        _this.type = 'date';
        _this.format = 'MMM DD YYYY';
        if (obj.format) {
            _this.format = obj.format;
        }
        return _this;
    }
    Object.defineProperty(CardViewDateItemModel.prototype, "displayValue", {
        get: function () {
            if (!this.value) {
                return this.default;
            }
            else {
                return moment(this.value).format(this.format);
            }
        },
        enumerable: true,
        configurable: true
    });
    return CardViewDateItemModel;
}(CardViewBaseItemModel));
var 0 = MOMENT_DATE_FORMATS;
var 1 = MAT_MOMENT_DATETIME_FORMATS;
var CardViewDateItemComponent = /** @class */ (function () {
    function CardViewDateItemComponent(cardViewUpdateService, dateAdapter, preferences) {
        this.cardViewUpdateService = cardViewUpdateService;
        this.dateAdapter = dateAdapter;
        this.preferences = preferences;
        this.SHOW_FORMAT = 'MMM DD YY';
        this.editable = false;
        this.displayEmpty = true;
    }
    CardViewDateItemComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.preferences.locale$.subscribe(function (locale) {
            _this.dateAdapter.setLocale(locale);
        });
        ((this.dateAdapter)).overrideDisplyaFormat = this.SHOW_FORMAT;
        if (this.property.value) {
            this.valueDate = moment(this.property.value, this.SHOW_FORMAT);
        }
    };
    CardViewDateItemComponent.prototype.showProperty = function () {
        return this.displayEmpty || !this.property.isEmpty();
    };
    CardViewDateItemComponent.prototype.isEditable = function () {
        return this.editable && this.property.editable;
    };
    CardViewDateItemComponent.prototype.showDatePicker = function () {
        this.datepicker.open();
    };
    CardViewDateItemComponent.prototype.onDateChanged = function (newDateValue) {
        if (newDateValue) {
            var momentDate = moment(newDateValue.value, this.SHOW_FORMAT, true);
            if (momentDate.isValid()) {
                this.valueDate = momentDate;
                this.cardViewUpdateService.update(this.property, momentDate.toDate());
                this.property.value = momentDate.toDate();
            }
        }
    };
    return CardViewDateItemComponent;
}());
CardViewDateItemComponent.decorators = [
    { type: Component, args: [{
                providers: [
                    { provide: DateAdapter, useClass: MomentDateAdapter },
                    { provide: MAT_DATE_FORMATS, useValue: 0 },
                    { provide: DatetimeAdapter, useClass: MomentDatetimeAdapter },
                    { provide: MAT_DATETIME_FORMATS, useValue: 1 }
                ],
                selector: 'adf-card-view-dateitem',
                template: "<div class=\"adf-property-label\" *ngIf=\"showProperty() || isEditable()\">{{ property.label | translate }}</div>\n<div class=\"adf-property-value\">\n    <span *ngIf=\"!isEditable()\">\n        <span [attr.data-automation-id]=\"'card-dateitem-' + property.key\">\n            <span *ngIf=\"showProperty()\">{{ property.displayValue }}</span>\n        </span>\n    </span>\n    <div *ngIf=\"isEditable()\" class=\"adf-dateitem-editable\">\n        <div class=\"adf-dateitem-editable-controls\">\n            <span\n                class=\"adf-datepicker-toggle\"\n                [attr.data-automation-id]=\"'datepicker-label-toggle-' + property.key\"\n                (click)=\"showDatePicker($event)\">\n                <span *ngIf=\"showProperty(); else elseEmptyValueBlock\">{{ property.displayValue }}</span>\n            </span>\n            <mat-datetimepicker-toggle\n                [attr.title]=\"'CORE.METADATA.ACTIONS.EDIT' | translate\"\n                [attr.data-automation-id]=\"'datepickertoggle-' + property.key\"\n                [for]=\"datetimePicker\">\n            </mat-datetimepicker-toggle>\n        </div>\n\n        <input class=\"adf-invisible-date-input\"\n            [matDatetimepicker]=\"datetimePicker\"\n            [value]=\"valueDate\"\n            (dateChange)=\"onDateChanged($event)\">\n\n        <mat-datetimepicker #datetimePicker\n            [type]=\"property.type\"\n            timeInterval=\"5\"\n            [attr.data-automation-id]=\"'datepicker-' + property.key\"\n            [startAt]=\"valueDate\">\n        </mat-datetimepicker>\n    </div>\n    <ng-template #elseEmptyValueBlock>\n        {{ property.default | translate }}\n    </ng-template>\n</div>\n",
                styles: [""]
            },] },
];
CardViewDateItemComponent.ctorParameters = function () { return [
    { type: CardViewUpdateService, },
    { type: DateAdapter, },
    { type: UserPreferencesService, },
]; };
CardViewDateItemComponent.propDecorators = {
    "property": [{ type: Input },],
    "editable": [{ type: Input },],
    "displayEmpty": [{ type: Input },],
    "datepicker": [{ type: ViewChild, args: ['datetimePicker',] },],
};
var CardViewMapItemModel = /** @class */ (function (_super) {
    __extends(CardViewMapItemModel, _super);
    function CardViewMapItemModel() {
        var _this = _super.apply(this, __spread(arguments)) || this;
        _this.type = 'map';
        return _this;
    }
    Object.defineProperty(CardViewMapItemModel.prototype, "displayValue", {
        get: function () {
            if (this.value && this.value.size > 0) {
                return this.value.values().next().value;
            }
            else {
                return this.default;
            }
        },
        enumerable: true,
        configurable: true
    });
    return CardViewMapItemModel;
}(CardViewBaseItemModel));
var CardViewMapItemComponent = /** @class */ (function () {
    function CardViewMapItemComponent(cardViewUpdateService) {
        this.cardViewUpdateService = cardViewUpdateService;
        this.displayEmpty = true;
    }
    CardViewMapItemComponent.prototype.showProperty = function () {
        return this.displayEmpty || !this.property.isEmpty();
    };
    CardViewMapItemComponent.prototype.isClickable = function () {
        return this.property.clickable;
    };
    CardViewMapItemComponent.prototype.clicked = function () {
        this.cardViewUpdateService.clicked(this.property);
    };
    return CardViewMapItemComponent;
}());
CardViewMapItemComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-card-view-mapitem',
                template: "<div class=\"adf-property-label\" *ngIf=\"showProperty()\">{{ property.label | translate }}</div>\n<div class=\"adf-property-value\">\n    <div>\n        <span *ngIf=\"!isClickable(); else elseBlock\" [attr.data-automation-id]=\"'card-mapitem-value-' + property.key\">\n            <span *ngIf=\"showProperty();\">{{ property.displayValue }}</span>\n        </span>\n        <ng-template #elseBlock>\n            <span class=\"adf-mapitem-clickable-value\" (click)=\"clicked()\" [attr.data-automation-id]=\"'card-mapitem-value-' + property.key\">\n                <span *ngIf=\"showProperty(); else elseEmptyValueBlock\">{{ property.displayValue }}</span>\n            </span>\n        </ng-template>\n    </div>\n    <ng-template #elseEmptyValueBlock>\n        {{ property.default | translate }}\n    </ng-template>\n</div>\n",
                styles: [".adf-mapitem-clickable-value{cursor:pointer}"]
            },] },
];
CardViewMapItemComponent.ctorParameters = function () { return [
    { type: CardViewUpdateService, },
]; };
CardViewMapItemComponent.propDecorators = {
    "property": [{ type: Input },],
    "displayEmpty": [{ type: Input },],
};
var CardViewTextItemModel = /** @class */ (function (_super) {
    __extends(CardViewTextItemModel, _super);
    function CardViewTextItemModel(obj) {
        var _this = _super.call(this, obj) || this;
        _this.type = 'text';
        _this.multiline = !!obj.multiline;
        _this.pipes = obj.pipes || [];
        return _this;
    }
    Object.defineProperty(CardViewTextItemModel.prototype, "displayValue", {
        get: function () {
            if (this.isEmpty()) {
                return this.default;
            }
            else {
                return this.applyPipes(this.value);
            }
        },
        enumerable: true,
        configurable: true
    });
    CardViewTextItemModel.prototype.applyPipes = function (displayValue) {
        if (this.pipes.length) {
            displayValue = this.pipes.reduce(function (accumulator, _a) {
                var pipe = _a.pipe, _b = _a.params, params = _b === void 0 ? [] : _b;
                return pipe.transform.apply(pipe, __spread([accumulator], params));
            }, displayValue);
        }
        return displayValue;
    };
    return CardViewTextItemModel;
}(CardViewBaseItemModel));
var CardViewTextItemComponent = /** @class */ (function () {
    function CardViewTextItemComponent(cardViewUpdateService) {
        this.cardViewUpdateService = cardViewUpdateService;
        this.editable = false;
        this.displayEmpty = true;
        this.inEdit = false;
    }
    CardViewTextItemComponent.prototype.ngOnChanges = function () {
        this.editedValue = this.property.value;
    };
    CardViewTextItemComponent.prototype.showProperty = function () {
        return this.displayEmpty || !this.property.isEmpty();
    };
    CardViewTextItemComponent.prototype.isEditable = function () {
        return this.editable && this.property.editable;
    };
    CardViewTextItemComponent.prototype.isClickable = function () {
        return this.property.clickable;
    };
    CardViewTextItemComponent.prototype.hasIcon = function () {
        return !!this.property.icon;
    };
    CardViewTextItemComponent.prototype.hasErrors = function () {
        return this.errorMessages && this.errorMessages.length;
    };
    CardViewTextItemComponent.prototype.setEditMode = function (editStatus) {
        var _this = this;
        this.inEdit = editStatus;
        setTimeout(function () {
            if (_this.editorInput) {
                _this.editorInput.nativeElement.click();
            }
        }, 0);
    };
    CardViewTextItemComponent.prototype.reset = function () {
        this.editedValue = this.property.value;
        this.setEditMode(false);
    };
    CardViewTextItemComponent.prototype.update = function () {
        if (this.property.isValid(this.editedValue)) {
            this.cardViewUpdateService.update(this.property, this.editedValue);
            this.property.value = this.editedValue;
            this.setEditMode(false);
        }
        else {
            this.errorMessages = this.property.getValidationErrors(this.editedValue);
        }
    };
    CardViewTextItemComponent.prototype.clicked = function () {
        this.cardViewUpdateService.clicked(this.property);
    };
    return CardViewTextItemComponent;
}());
CardViewTextItemComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-card-view-textitem',
                template: "<div class=\"adf-property-label\" *ngIf=\"showProperty() || isEditable()\">{{ property.label | translate }}</div>\n<div class=\"adf-property-value\">\n    <span *ngIf=\"!isEditable()\">\n        <span *ngIf=\"!isClickable(); else elseBlock\" [attr.data-automation-id]=\"'card-textitem-value-' + property.key\">\n            <span *ngIf=\"showProperty()\">{{ property.displayValue }}</span>\n        </span>\n        <ng-template #elseBlock>\n        <div class=\"adf-textitem-clickable\" (click)=\"clicked()\" fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n            <span class=\"adf-textitem-clickable-value\" [attr.data-automation-id]=\"'card-textitem-value-' + property.key\">\n                <span *ngIf=\"showProperty(); else elseEmptyValueBlock\">{{ property.displayValue }}</span>\n            </span>\n            <mat-icon *ngIf=\"hasIcon()\" fxFlex=\"0 0 auto\" [attr.data-automation-id]=\"'card-textitem-edit-icon-' + property.icon\" class=\"adf-textitem-icon\">{{ property.icon }}</mat-icon>\n        </div>\n        </ng-template>\n    </span>\n    <span *ngIf=\"isEditable()\">\n        <div *ngIf=\"!inEdit\" (click)=\"setEditMode(true)\" class=\"adf-textitem-readonly\" [attr.data-automation-id]=\"'card-textitem-edit-toggle-' + property.key\" fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n            <span [attr.data-automation-id]=\"'card-textitem-value-' + property.key\">\n                <span *ngIf=\"showProperty(); else elseEmptyValueBlock\">{{ property.displayValue }}</span>\n            </span>\n            <mat-icon fxFlex=\"0 0 auto\"\n                [attr.data-automation-id]=\"'card-textitem-edit-icon-' + property.key\"\n                [attr.title]=\"'CORE.METADATA.ACTIONS.EDIT' | translate\"\n                class=\"adf-textitem-icon\">create</mat-icon>\n        </div>\n        <div *ngIf=\"inEdit\" class=\"adf-textitem-editable\">\n            <div class=\"adf-textitem-editable-controls\">\n                <mat-form-field floatPlaceholder=\"never\" class=\"adf-input-container\">\n                    <input *ngIf=\"!property.multiline\" #editorInput\n                        matInput\n                        class=\"adf-input\"\n                        [placeholder]=\"property.default | translate\"\n                        [(ngModel)]=\"editedValue\"\n                        [attr.data-automation-id]=\"'card-textitem-editinput-' + property.key\">\n                    <textarea *ngIf=\"property.multiline\" #editorInput\n                        matInput\n                        matTextareaAutosize\n                        matAutosizeMaxRows=\"1\"\n                        matAutosizeMaxRows=\"5\"\n                        class=\"adf-textarea\"\n                        [placeholder]=\"property.default | translate\"\n                        [(ngModel)]=\"editedValue\"\n                        [attr.data-automation-id]=\"'card-textitem-edittextarea-' + property.key\"></textarea>\n                </mat-form-field>\n                <mat-icon\n                    class=\"adf-textitem-icon adf-update-icon\"\n                    (click)=\"update()\"\n                    [attr.title]=\"'CORE.METADATA.ACTIONS.SAVE' | translate\"\n                    [attr.data-automation-id]=\"'card-textitem-update-' + property.key\">done</mat-icon>\n                <mat-icon\n                    class=\"adf-textitem-icon adf-reset-icon\"\n                    (click)=\"reset()\"\n                    [attr.title]=\"'CORE.METADATA.ACTIONS.CANCEL' | translate\"\n                    [attr.data-automation-id]=\"'card-textitem-reset-' + property.key\">clear</mat-icon>\n            </div>\n            <mat-error class=\"adf-textitem-editable-error\" *ngIf=\"hasErrors()\">\n                <ul>\n                    <li *ngFor=\"let errorMessage of errorMessages\">{{ errorMessage | translate }}</li>\n                </ul>\n            </mat-error>\n        </div>\n    </span>\n    <ng-template #elseEmptyValueBlock>\n        <span class=\"adf-textitem-default-value\">{{ property.default | translate }}</span>\n    </ng-template>\n</div>\n",
                styles: [""]
            },] },
];
CardViewTextItemComponent.ctorParameters = function () { return [
    { type: CardViewUpdateService, },
]; };
CardViewTextItemComponent.propDecorators = {
    "property": [{ type: Input },],
    "editable": [{ type: Input },],
    "displayEmpty": [{ type: Input },],
    "editorInput": [{ type: ViewChild, args: ['editorInput',] },],
};
function getType(type) {
    return function () { return type; };
}
var DynamicComponentResolver = /** @class */ (function () {
    function DynamicComponentResolver() {
    }
    DynamicComponentResolver.fromType = function (type) {
        return getType(type);
    };
    return DynamicComponentResolver;
}());
var DynamicComponentMapper = /** @class */ (function () {
    function DynamicComponentMapper() {
        this.defaultValue = undefined;
        this.types = {};
    }
    DynamicComponentMapper.prototype.getComponentTypeResolver = function (type, defaultValue) {
        if (defaultValue === void 0) { defaultValue = this.defaultValue; }
        if (type) {
            return this.types[type] || DynamicComponentResolver.fromType(defaultValue);
        }
        return DynamicComponentResolver.fromType(defaultValue);
    };
    DynamicComponentMapper.prototype.setComponentTypeResolver = function (type, resolver, override) {
        if (override === void 0) { override = false; }
        if (!type) {
            throw new Error("type is null or not defined");
        }
        if (!resolver) {
            throw new Error("resolver is null or not defined");
        }
        var existing = this.types[type];
        if (existing && !override) {
            throw new Error("already mapped, use override option if you intend replacing existing mapping.");
        }
        this.types[type] = resolver;
    };
    DynamicComponentMapper.prototype.resolveComponentType = function (model, defaultValue) {
        if (defaultValue === void 0) { defaultValue = this.defaultValue; }
        if (model) {
            var resolver = this.getComponentTypeResolver(model.type, defaultValue);
            return resolver(model);
        }
        return defaultValue;
    };
    return DynamicComponentMapper;
}());
var CardItemTypeService = /** @class */ (function (_super) {
    __extends(CardItemTypeService, _super);
    function CardItemTypeService() {
        var _this = _super.apply(this, __spread(arguments)) || this;
        _this.defaultValue = CardViewTextItemComponent;
        _this.types = {
            'text': DynamicComponentResolver.fromType(CardViewTextItemComponent),
            'int': DynamicComponentResolver.fromType(CardViewTextItemComponent),
            'float': DynamicComponentResolver.fromType(CardViewTextItemComponent),
            'date': DynamicComponentResolver.fromType(CardViewDateItemComponent),
            'datetime': DynamicComponentResolver.fromType(CardViewDateItemComponent),
            'bool': DynamicComponentResolver.fromType(CardViewBoolItemComponent),
            'map': DynamicComponentResolver.fromType(CardViewMapItemComponent)
        };
        return _this;
    }
    return CardItemTypeService;
}(DynamicComponentMapper));
CardItemTypeService.decorators = [
    { type: Injectable },
];
CardItemTypeService.ctorParameters = function () { return []; };
var CardViewContentProxyDirective = /** @class */ (function () {
    function CardViewContentProxyDirective(viewContainerRef) {
        this.viewContainerRef = viewContainerRef;
    }
    return CardViewContentProxyDirective;
}());
CardViewContentProxyDirective.decorators = [
    { type: Directive, args: [{
                selector: '[adf-card-view-content-proxy]'
            },] },
];
CardViewContentProxyDirective.ctorParameters = function () { return [
    { type: ViewContainerRef, },
]; };
var CardViewItemDispatcherComponent = /** @class */ (function () {
    function CardViewItemDispatcherComponent(cardItemTypeService, resolver) {
        var _this = this;
        this.cardItemTypeService = cardItemTypeService;
        this.resolver = resolver;
        this.displayEmpty = true;
        this.loaded = false;
        this.componentReference = null;
        var dynamicLifecycleMethods = [
            'ngOnInit',
            'ngDoCheck',
            'ngAfterContentInit',
            'ngAfterContentChecked',
            'ngAfterViewInit',
            'ngAfterViewChecked',
            'ngOnDestroy'
        ];
        dynamicLifecycleMethods.forEach(function (dynamicLifecycleMethod) {
            _this[dynamicLifecycleMethod] = _this.proxy.bind(_this, dynamicLifecycleMethod);
        });
    }
    CardViewItemDispatcherComponent.prototype.ngOnChanges = function (changes) {
        var _this = this;
        if (!this.loaded) {
            this.loadComponent();
            this.loaded = true;
        }
        Object.keys(changes)
            .map(function (changeName) { return [changeName, changes[changeName]]; })
            .forEach(function (_a) {
            var _b = __read(_a, 2), inputParamName = _b[0], simpleChange = _b[1];
            _this.componentReference.instance[inputParamName] = simpleChange.currentValue;
        });
        this.proxy('ngOnChanges', changes);
    };
    CardViewItemDispatcherComponent.prototype.loadComponent = function () {
        var factoryClass = this.cardItemTypeService.resolveComponentType(this.property);
        var factory = this.resolver.resolveComponentFactory(factoryClass);
        this.componentReference = this.content.viewContainerRef.createComponent(factory);
        this.componentReference.instance.editable = this.editable;
        this.componentReference.instance.property = this.property;
        this.componentReference.instance.displayEmpty = this.displayEmpty;
    };
    CardViewItemDispatcherComponent.prototype.proxy = function (methodName) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        if (this.componentReference.instance[methodName]) {
            this.componentReference.instance[methodName].apply(this.componentReference.instance, args);
        }
    };
    return CardViewItemDispatcherComponent;
}());
CardViewItemDispatcherComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-card-view-item-dispatcher',
                template: '<ng-template adf-card-view-content-proxy></ng-template>'
            },] },
];
CardViewItemDispatcherComponent.ctorParameters = function () { return [
    { type: CardItemTypeService, },
    { type: ComponentFactoryResolver, },
]; };
CardViewItemDispatcherComponent.propDecorators = {
    "property": [{ type: Input },],
    "editable": [{ type: Input },],
    "displayEmpty": [{ type: Input },],
    "content": [{ type: ViewChild, args: [CardViewContentProxyDirective,] },],
};
var CardViewItemIntValidator = /** @class */ (function () {
    function CardViewItemIntValidator() {
        this.message = 'CORE.CARDVIEW.VALIDATORS.INT_VALIDATION_ERROR';
    }
    CardViewItemIntValidator.prototype.isValid = function (value) {
        return !isNaN(value) && (function (x) { return (x | 0) === x; })(parseFloat(value));
    };
    return CardViewItemIntValidator;
}());
var CardViewItemFloatValidator = /** @class */ (function () {
    function CardViewItemFloatValidator() {
        this.message = 'CORE.CARDVIEW.VALIDATORS.FLOAT_VALIDATION_ERROR';
    }
    CardViewItemFloatValidator.prototype.isValid = function (value) {
        return !isNaN(parseFloat(value)) && isFinite(value);
    };
    return CardViewItemFloatValidator;
}());
var CardViewDatetimeItemModel = /** @class */ (function (_super) {
    __extends(CardViewDatetimeItemModel, _super);
    function CardViewDatetimeItemModel() {
        var _this = _super.apply(this, __spread(arguments)) || this;
        _this.type = 'datetime';
        _this.format = 'MMM DD YYYY HH:mm';
        return _this;
    }
    return CardViewDatetimeItemModel;
}(CardViewDateItemModel));
var CardViewFloatItemModel = /** @class */ (function (_super) {
    __extends(CardViewFloatItemModel, _super);
    function CardViewFloatItemModel(obj) {
        var _this = _super.call(this, obj) || this;
        _this.type = 'float';
        _this.validators.push(new CardViewItemFloatValidator());
        if (obj.value) {
            _this.value = parseFloat(obj.value);
        }
        return _this;
    }
    return CardViewFloatItemModel;
}(CardViewTextItemModel));
var CardViewIntItemModel = /** @class */ (function (_super) {
    __extends(CardViewIntItemModel, _super);
    function CardViewIntItemModel(obj) {
        var _this = _super.call(this, obj) || this;
        _this.type = 'int';
        _this.validators.push(new CardViewItemIntValidator());
        if (obj.value) {
            _this.value = parseInt(obj.value, 10);
        }
        return _this;
    }
    return CardViewIntItemModel;
}(CardViewTextItemModel));
var CardViewModule = /** @class */ (function () {
    function CardViewModule() {
    }
    return CardViewModule;
}());
CardViewModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    CommonModule,
                    FormsModule,
                    FlexLayoutModule,
                    TranslateModule,
                    MatDatepickerModule,
                    MatNativeDateModule,
                    MatCheckboxModule,
                    MatInputModule,
                    MatIconModule,
                    MatButtonModule,
                    MatDatetimepickerModule,
                    MatNativeDatetimeModule
                ],
                declarations: [
                    CardViewComponent,
                    CardViewBoolItemComponent,
                    CardViewDateItemComponent,
                    CardViewMapItemComponent,
                    CardViewTextItemComponent,
                    CardViewItemDispatcherComponent,
                    CardViewContentProxyDirective
                ],
                entryComponents: [
                    CardViewBoolItemComponent,
                    CardViewDateItemComponent,
                    CardViewMapItemComponent,
                    CardViewTextItemComponent
                ],
                exports: [
                    CardViewComponent,
                    CardViewBoolItemComponent,
                    CardViewDateItemComponent,
                    CardViewMapItemComponent,
                    CardViewTextItemComponent
                ]
            },] },
];
CardViewModule.ctorParameters = function () { return []; };
var AppConfigModule = /** @class */ (function () {
    function AppConfigModule() {
    }
    return AppConfigModule;
}());
AppConfigModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    HttpClientModule
                ],
                providers: [
                    AppConfigService
                ]
            },] },
];
AppConfigModule.ctorParameters = function () { return []; };
var FormEvent = /** @class */ (function () {
    function FormEvent(form) {
        this.isDefaultPrevented = false;
        this.form = form;
    }
    Object.defineProperty(FormEvent.prototype, "defaultPrevented", {
        get: function () {
            return this.isDefaultPrevented;
        },
        enumerable: true,
        configurable: true
    });
    FormEvent.prototype.preventDefault = function () {
        this.isDefaultPrevented = true;
    };
    return FormEvent;
}());
var FormErrorEvent = /** @class */ (function (_super) {
    __extends(FormErrorEvent, _super);
    function FormErrorEvent(form, error) {
        var _this = _super.call(this, form) || this;
        _this.error = error;
        return _this;
    }
    return FormErrorEvent;
}(FormEvent));
var FormFieldEvent = /** @class */ (function (_super) {
    __extends(FormFieldEvent, _super);
    function FormFieldEvent(form, field) {
        var _this = _super.call(this, form) || this;
        _this.field = field;
        return _this;
    }
    return FormFieldEvent;
}(FormEvent));
var ValidateFormFieldEvent = /** @class */ (function (_super) {
    __extends(ValidateFormFieldEvent, _super);
    function ValidateFormFieldEvent(form, field) {
        var _this = _super.call(this, form, field) || this;
        _this.isValid = true;
        return _this;
    }
    return ValidateFormFieldEvent;
}(FormFieldEvent));
var ValidateFormEvent = /** @class */ (function (_super) {
    __extends(ValidateFormEvent, _super);
    function ValidateFormEvent(form) {
        var _this = _super.call(this, form) || this;
        _this.isValid = true;
        return _this;
    }
    return ValidateFormEvent;
}(FormEvent));
var ValidateDynamicTableRowEvent = /** @class */ (function (_super) {
    __extends(ValidateDynamicTableRowEvent, _super);
    function ValidateDynamicTableRowEvent(form, field, row, summary) {
        var _this = _super.call(this, form, field) || this;
        _this.row = row;
        _this.summary = summary;
        _this.isValid = true;
        return _this;
    }
    return ValidateDynamicTableRowEvent;
}(FormFieldEvent));
var EcmModelService = /** @class */ (function () {
    function EcmModelService(apiService, logService) {
        this.apiService = apiService;
        this.logService = logService;
    }
    EcmModelService.prototype.createEcmTypeForActivitiForm = function (formName, form) {
        var _this = this;
        return Observable.create(function (observer) {
            _this.searchActivitiEcmModel().subscribe(function (model) {
                if (!model) {
                    _this.createActivitiEcmModel(formName, form).subscribe(function (typeForm) {
                        observer.next(typeForm);
                        observer.complete();
                    });
                }
                else {
                    _this.saveFomType(formName, form).subscribe(function (typeForm) {
                        observer.next(typeForm);
                        observer.complete();
                    });
                }
            }, function (err) { return _this.handleError(err); });
        });
    };
    EcmModelService.prototype.searchActivitiEcmModel = function () {
        return this.getEcmModels().map(function (ecmModels) {
            return ecmModels.list.entries.find(function (model) { return model.entry.name === EcmModelService.MODEL_NAME; });
        });
    };
    EcmModelService.prototype.createActivitiEcmModel = function (formName, form) {
        var _this = this;
        return Observable.create(function (observer) {
            _this.createEcmModel(EcmModelService.MODEL_NAME, EcmModelService.MODEL_NAMESPACE).subscribe(function (model) {
                _this.logService.info('model created', model);
                _this.activeEcmModel(EcmModelService.MODEL_NAME).subscribe(function (modelActive) {
                    _this.logService.info('model active', modelActive);
                    _this.createEcmTypeWithProperties(formName, form).subscribe(function (typeCreated) {
                        observer.next(typeCreated);
                        observer.complete();
                    });
                }, function (err) { return _this.handleError(err); });
            }, function (err) { return _this.handleError(err); });
        });
    };
    EcmModelService.prototype.saveFomType = function (formName, form) {
        var _this = this;
        return Observable.create(function (observer) {
            _this.searchEcmType(formName, EcmModelService.MODEL_NAME).subscribe(function (ecmType) {
                _this.logService.info('custom types', ecmType);
                if (!ecmType) {
                    _this.createEcmTypeWithProperties(formName, form).subscribe(function (typeCreated) {
                        observer.next(typeCreated);
                        observer.complete();
                    });
                }
                else {
                    observer.next(ecmType);
                    observer.complete();
                }
            }, function (err) { return _this.handleError(err); });
        });
    };
    EcmModelService.prototype.createEcmTypeWithProperties = function (formName, form) {
        var _this = this;
        return Observable.create(function (observer) {
            _this.createEcmType(formName, EcmModelService.MODEL_NAME, EcmModelService.TYPE_MODEL).subscribe(function (typeCreated) {
                _this.logService.info('type Created', typeCreated);
                _this.addPropertyToAType(EcmModelService.MODEL_NAME, formName, form).subscribe(function (properyAdded) {
                    _this.logService.info('property Added', properyAdded);
                    observer.next(typeCreated);
                    observer.complete();
                }, function (err) { return _this.handleError(err); });
            }, function (err) { return _this.handleError(err); });
        });
    };
    EcmModelService.prototype.searchEcmType = function (typeName, modelName) {
        return this.getEcmType(modelName).map(function (customTypes) {
            return customTypes.list.entries.find(function (type) { return type.entry.prefixedName === typeName || type.entry.title === typeName; });
        });
    };
    EcmModelService.prototype.activeEcmModel = function (modelName) {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().core.customModelApi.activateCustomModel(modelName))
            .map(this.toJson)
            .catch(function (err) { return _this.handleError(err); });
    };
    EcmModelService.prototype.createEcmModel = function (modelName, nameSpace) {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().core.customModelApi.createCustomModel('DRAFT', '', modelName, modelName, nameSpace))
            .map(this.toJson)
            .catch(function (err) { return _this.handleError(err); });
    };
    EcmModelService.prototype.getEcmModels = function () {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().core.customModelApi.getAllCustomModel())
            .map(this.toJson)
            .catch(function (err) { return _this.handleError(err); });
    };
    EcmModelService.prototype.getEcmType = function (modelName) {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().core.customModelApi.getAllCustomType(modelName))
            .map(this.toJson)
            .catch(function (err) { return _this.handleError(err); });
    };
    EcmModelService.prototype.createEcmType = function (typeName, modelName, parentType) {
        var _this = this;
        var name = this.cleanNameType(typeName);
        return Observable.fromPromise(this.apiService.getInstance().core.customModelApi.createCustomType(modelName, name, parentType, typeName, ''))
            .map(this.toJson)
            .catch(function (err) { return _this.handleError(err); });
    };
    EcmModelService.prototype.addPropertyToAType = function (modelName, typeName, formFields) {
        var _this = this;
        var name = this.cleanNameType(typeName);
        var properties = [];
        if (formFields && formFields.values) {
            for (var key in formFields.values) {
                if (key) {
                    properties.push({
                        name: key,
                        title: key,
                        description: key,
                        dataType: 'd:text',
                        multiValued: false,
                        mandatory: false,
                        mandatoryEnforced: false
                    });
                }
            }
        }
        return Observable.fromPromise(this.apiService.getInstance().core.customModelApi.addPropertyToType(modelName, name, properties))
            .map(this.toJson)
            .catch(function (err) { return _this.handleError(err); });
    };
    EcmModelService.prototype.cleanNameType = function (name) {
        var cleanName = name;
        if (name.indexOf(':') !== -1) {
            cleanName = name.split(':')[1];
        }
        return cleanName.replace(/[^a-zA-Z ]/g, '');
    };
    EcmModelService.prototype.toJson = function (res) {
        if (res) {
            return res || {};
        }
        return {};
    };
    EcmModelService.prototype.handleError = function (err) {
        this.logService.error(err);
    };
    return EcmModelService;
}());
EcmModelService.MODEL_NAMESPACE = 'activitiForms';
EcmModelService.MODEL_NAME = 'activitiFormsModel';
EcmModelService.TYPE_MODEL = 'cm:folder';
EcmModelService.decorators = [
    { type: Injectable },
];
EcmModelService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: LogService, },
]; };
var FormDefinitionModel = /** @class */ (function () {
    function FormDefinitionModel(id, name, lastUpdatedByFullName, lastUpdated, metadata) {
        this.reusable = false;
        this.newVersion = false;
        this.formImageBase64 = '';
        this.formRepresentation = {
            id: id,
            name: name,
            description: '',
            version: 1,
            lastUpdatedBy: 1,
            lastUpdatedByFullName: lastUpdatedByFullName,
            lastUpdated: lastUpdated,
            stencilSetId: 0,
            referenceId: null,
            formDefinition: {
                fields: [{
                        name: 'Label',
                        type: 'container',
                        fieldType: 'ContainerRepresentation',
                        numberOfColumns: 2,
                        required: false,
                        readOnly: false,
                        sizeX: 2,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        fields: { '1': this.metadataToFields(metadata) }
                    }],
                gridsterForm: false,
                javascriptEvents: [],
                metadata: {},
                outcomes: [],
                className: '',
                style: '',
                tabs: [],
                variables: []
            }
        };
    }
    FormDefinitionModel.prototype.metadataToFields = function (metadata) {
        var fields = [];
        if (metadata) {
            metadata.forEach(function (property) {
                if (property) {
                    var field = {
                        type: 'text',
                        id: property.name,
                        name: property.name,
                        required: false,
                        readOnly: false,
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        colspan: 1,
                        params: {
                            existingColspan: 1,
                            maxColspan: 2
                        },
                        layout: {
                            colspan: 1,
                            row: -1,
                            column: -1
                        }
                    };
                    fields.push(field);
                }
            });
        }
        return fields;
    };
    return FormDefinitionModel;
}());
var FormFieldTypes = /** @class */ (function () {
    function FormFieldTypes() {
    }
    FormFieldTypes.isReadOnlyType = function (type) {
        return FormFieldTypes.READONLY_TYPES.indexOf(type) > -1;
    };
    FormFieldTypes.isContainerType = function (type) {
        return type === FormFieldTypes.CONTAINER || type === FormFieldTypes.GROUP;
    };
    return FormFieldTypes;
}());
FormFieldTypes.CONTAINER = 'container';
FormFieldTypes.GROUP = 'group';
FormFieldTypes.DYNAMIC_TABLE = 'dynamic-table';
FormFieldTypes.TEXT = 'text';
FormFieldTypes.MULTILINE_TEXT = 'multi-line-text';
FormFieldTypes.DROPDOWN = 'dropdown';
FormFieldTypes.HYPERLINK = 'hyperlink';
FormFieldTypes.RADIO_BUTTONS = 'radio-buttons';
FormFieldTypes.DISPLAY_VALUE = 'readonly';
FormFieldTypes.READONLY_TEXT = 'readonly-text';
FormFieldTypes.UPLOAD = 'upload';
FormFieldTypes.TYPEAHEAD = 'typeahead';
FormFieldTypes.FUNCTIONAL_GROUP = 'functional-group';
FormFieldTypes.PEOPLE = 'people';
FormFieldTypes.BOOLEAN = 'boolean';
FormFieldTypes.NUMBER = 'integer';
FormFieldTypes.DATE = 'date';
FormFieldTypes.AMOUNT = 'amount';
FormFieldTypes.DOCUMENT = 'document';
FormFieldTypes.DATETIME = 'datetime';
FormFieldTypes.READONLY_TYPES = [
    FormFieldTypes.HYPERLINK,
    FormFieldTypes.DISPLAY_VALUE,
    FormFieldTypes.READONLY_TEXT
];
var FormWidgetModel = /** @class */ (function () {
    function FormWidgetModel(form, json) {
        this.form = form;
        this.json = json;
        if (json) {
            this.fieldType = json.fieldType;
            this.id = json.id;
            this.name = json.name;
            this.type = json.type;
            this.tab = json.tab;
        }
    }
    return FormWidgetModel;
}());
var ContainerColumnModel = /** @class */ (function () {
    function ContainerColumnModel() {
        this.size = 12;
        this.fields = [];
        this.colspan = 1;
        this.rowspan = 1;
    }
    ContainerColumnModel.prototype.hasFields = function () {
        return this.fields && this.fields.length > 0;
    };
    return ContainerColumnModel;
}());
var ErrorMessageModel = /** @class */ (function () {
    function ErrorMessageModel(obj) {
        this.message = '';
        this.attributes = null;
        this.message = obj && obj.message ? obj.message : '';
        this.attributes = new Map();
    }
    ErrorMessageModel.prototype.isActive = function () {
        return this.message ? true : false;
    };
    ErrorMessageModel.prototype.getAttributesAsJsonObj = function () {
        var result = {};
        if (this.attributes.size > 0) {
            var obj_1 = Object.create(null);
            this.attributes.forEach(function (value, key) {
                obj_1[key] = value;
            });
            result = JSON.stringify(obj_1);
        }
        return result;
    };
    return ErrorMessageModel;
}());
var RequiredFieldValidator = /** @class */ (function () {
    function RequiredFieldValidator() {
        this.supportedTypes = [
            FormFieldTypes.TEXT,
            FormFieldTypes.MULTILINE_TEXT,
            FormFieldTypes.NUMBER,
            FormFieldTypes.BOOLEAN,
            FormFieldTypes.TYPEAHEAD,
            FormFieldTypes.DROPDOWN,
            FormFieldTypes.PEOPLE,
            FormFieldTypes.FUNCTIONAL_GROUP,
            FormFieldTypes.RADIO_BUTTONS,
            FormFieldTypes.UPLOAD,
            FormFieldTypes.AMOUNT,
            FormFieldTypes.DYNAMIC_TABLE,
            FormFieldTypes.DATE,
            FormFieldTypes.DATETIME
        ];
    }
    RequiredFieldValidator.prototype.isSupported = function (field) {
        return field &&
            this.supportedTypes.indexOf(field.type) > -1 &&
            field.required;
    };
    RequiredFieldValidator.prototype.validate = function (field) {
        if (this.isSupported(field) && field.isVisible) {
            if (field.type === FormFieldTypes.DROPDOWN) {
                if (field.hasEmptyValue && field.emptyOption) {
                    if (field.value === field.emptyOption.id) {
                        return false;
                    }
                }
            }
            if (field.type === FormFieldTypes.RADIO_BUTTONS) {
                var option = field.options.find(function (opt) { return opt.id === field.value; });
                return !!option;
            }
            if (field.type === FormFieldTypes.UPLOAD) {
                return field.value && field.value.length > 0;
            }
            if (field.type === FormFieldTypes.DYNAMIC_TABLE) {
                return field.value && field.value instanceof Array && field.value.length > 0;
            }
            if (field.type === FormFieldTypes.BOOLEAN) {
                return field.value ? true : false;
            }
            if (field.value === null || field.value === undefined || field.value === '') {
                return false;
            }
        }
        return true;
    };
    return RequiredFieldValidator;
}());
var NumberFieldValidator = /** @class */ (function () {
    function NumberFieldValidator() {
        this.supportedTypes = [
            FormFieldTypes.NUMBER,
            FormFieldTypes.AMOUNT
        ];
    }
    NumberFieldValidator.isNumber = function (value) {
        if (value === null || value === undefined || value === '') {
            return false;
        }
        return !isNaN(+value);
    };
    NumberFieldValidator.prototype.isSupported = function (field) {
        return field && this.supportedTypes.indexOf(field.type) > -1;
    };
    NumberFieldValidator.prototype.validate = function (field) {
        if (this.isSupported(field) && field.isVisible) {
            if (field.value === null ||
                field.value === undefined ||
                field.value === '') {
                return true;
            }
            var valueStr = '' + field.value;
            var pattern = new RegExp(/^-?\d+$/);
            if (field.enableFractions) {
                pattern = new RegExp(/^-?[0-9]+(\.[0-9]{1,2})?$/);
            }
            if (valueStr.match(pattern)) {
                return true;
            }
            field.validationSummary.message = 'FORM.FIELD.VALIDATOR.INVALID_NUMBER';
            return false;
        }
        return true;
    };
    return NumberFieldValidator;
}());
var DateFieldValidator = /** @class */ (function () {
    function DateFieldValidator() {
        this.supportedTypes = [
            FormFieldTypes.DATE
        ];
    }
    DateFieldValidator.isValidDate = function (inputDate, dateFormat) {
        if (dateFormat === void 0) { dateFormat = 'D-M-YYYY'; }
        if (inputDate) {
            var d = moment(inputDate, dateFormat, true);
            return d.isValid();
        }
        return false;
    };
    DateFieldValidator.prototype.isSupported = function (field) {
        return field && this.supportedTypes.indexOf(field.type) > -1;
    };
    DateFieldValidator.prototype.validate = function (field) {
        if (this.isSupported(field) && field.value && field.isVisible) {
            if (DateFieldValidator.isValidDate(field.value, field.dateDisplayFormat)) {
                return true;
            }
            field.validationSummary.message = field.dateDisplayFormat;
            return false;
        }
        return true;
    };
    return DateFieldValidator;
}());
var MinDateFieldValidator = /** @class */ (function () {
    function MinDateFieldValidator() {
        this.supportedTypes = [
            FormFieldTypes.DATE
        ];
    }
    MinDateFieldValidator.prototype.isSupported = function (field) {
        return field &&
            this.supportedTypes.indexOf(field.type) > -1 && !!field.minValue;
    };
    MinDateFieldValidator.prototype.validate = function (field) {
        var isValid = true;
        if (this.isSupported(field) && field.value && field.isVisible) {
            var dateFormat = field.dateDisplayFormat;
            if (!DateFieldValidator.isValidDate(field.value, dateFormat)) {
                field.validationSummary.message = 'FORM.FIELD.VALIDATOR.INVALID_DATE';
                isValid = false;
            }
            else {
                isValid = this.checkDate(field, dateFormat);
            }
        }
        return isValid;
    };
    MinDateFieldValidator.prototype.checkDate = function (field, dateFormat) {
        var MIN_DATE_FORMAT = 'DD-MM-YYYY';
        var isValid = true;
        var fieldValueData;
        if (typeof field.value === 'string') {
            fieldValueData = moment(field.value.split('T')[0], dateFormat);
        }
        else {
            fieldValueData = field.value;
        }
        var min = moment(field.minValue, MIN_DATE_FORMAT);
        if (fieldValueData.isBefore(min)) {
            field.validationSummary.message = "FORM.FIELD.VALIDATOR.NOT_LESS_THAN";
            field.validationSummary.attributes.set('minValue', field.minValue.toLocaleString());
            isValid = false;
        }
        return isValid;
    };
    return MinDateFieldValidator;
}());
var MaxDateFieldValidator = /** @class */ (function () {
    function MaxDateFieldValidator() {
        this.MAX_DATE_FORMAT = 'DD-MM-YYYY';
        this.supportedTypes = [
            FormFieldTypes.DATE
        ];
    }
    MaxDateFieldValidator.prototype.isSupported = function (field) {
        return field &&
            this.supportedTypes.indexOf(field.type) > -1 && !!field.maxValue;
    };
    MaxDateFieldValidator.prototype.validate = function (field) {
        if (this.isSupported(field) && field.value && field.isVisible) {
            var dateFormat = field.dateDisplayFormat;
            if (!DateFieldValidator.isValidDate(field.value, dateFormat)) {
                field.validationSummary.message = 'FORM.FIELD.VALIDATOR.INVALID_DATE';
                return false;
            }
            var d = void 0;
            if (typeof field.value === 'string') {
                d = moment(field.value.split('T')[0], dateFormat);
            }
            else {
                d = field.value;
            }
            var max = moment(field.maxValue, this.MAX_DATE_FORMAT);
            if (d.isAfter(max)) {
                field.validationSummary.message = "FORM.FIELD.VALIDATOR.NOT_GREATER_THAN";
                field.validationSummary.attributes.set('maxValue', field.maxValue.toLocaleString());
                return false;
            }
        }
        return true;
    };
    return MaxDateFieldValidator;
}());
var MinDateTimeFieldValidator = /** @class */ (function () {
    function MinDateTimeFieldValidator() {
        this.supportedTypes = [
            FormFieldTypes.DATETIME
        ];
    }
    MinDateTimeFieldValidator.prototype.isSupported = function (field) {
        return field &&
            this.supportedTypes.indexOf(field.type) > -1 && !!field.minValue;
    };
    MinDateTimeFieldValidator.prototype.validate = function (field) {
        var isValid = true;
        if (this.isSupported(field) && field.value && field.isVisible) {
            var dateFormat = field.dateDisplayFormat;
            if (!DateFieldValidator.isValidDate(field.value, dateFormat)) {
                field.validationSummary.message = 'FORM.FIELD.VALIDATOR.INVALID_DATE';
                isValid = false;
            }
            else {
                isValid = this.checkDateTime(field, dateFormat);
            }
        }
        return isValid;
    };
    MinDateTimeFieldValidator.prototype.checkDateTime = function (field, dateFormat) {
        var MIN_DATE_FORMAT = 'YYYY-MM-DD hh:mm A';
        var isValid = true;
        var fieldValueDate;
        if (typeof field.value === 'string') {
            fieldValueDate = moment(field.value, dateFormat);
        }
        else {
            fieldValueDate = field.value;
        }
        var min = moment(field.minValue, MIN_DATE_FORMAT);
        if (fieldValueDate.isBefore(min)) {
            field.validationSummary.message = "FORM.FIELD.VALIDATOR.NOT_LESS_THAN";
            field.validationSummary.attributes.set('minValue', min.format('D-M-YYYY hh-mm A'));
            isValid = false;
        }
        return isValid;
    };
    return MinDateTimeFieldValidator;
}());
var MaxDateTimeFieldValidator = /** @class */ (function () {
    function MaxDateTimeFieldValidator() {
        this.supportedTypes = [
            FormFieldTypes.DATETIME
        ];
    }
    MaxDateTimeFieldValidator.prototype.isSupported = function (field) {
        return field &&
            this.supportedTypes.indexOf(field.type) > -1 && !!field.maxValue;
    };
    MaxDateTimeFieldValidator.prototype.validate = function (field) {
        var isValid = true;
        if (this.isSupported(field) && field.value && field.isVisible) {
            var dateFormat = field.dateDisplayFormat;
            if (!DateFieldValidator.isValidDate(field.value, dateFormat)) {
                field.validationSummary.message = 'FORM.FIELD.VALIDATOR.INVALID_DATE';
                isValid = false;
            }
            else {
                isValid = this.checkDateTime(field, dateFormat);
            }
        }
        return isValid;
    };
    MaxDateTimeFieldValidator.prototype.checkDateTime = function (field, dateFormat) {
        var MAX_DATE_FORMAT = 'YYYY-MM-DD hh:mm A';
        var isValid = true;
        var fieldValueDate;
        if (typeof field.value === 'string') {
            fieldValueDate = moment(field.value, dateFormat);
        }
        else {
            fieldValueDate = field.value;
        }
        var max = moment(field.maxValue, MAX_DATE_FORMAT);
        if (fieldValueDate.isAfter(max)) {
            field.validationSummary.message = "FORM.FIELD.VALIDATOR.NOT_GREATER_THAN";
            field.validationSummary.attributes.set('maxValue', max.format('D-M-YYYY hh-mm A'));
            isValid = false;
        }
        return isValid;
    };
    return MaxDateTimeFieldValidator;
}());
var MinLengthFieldValidator = /** @class */ (function () {
    function MinLengthFieldValidator() {
        this.supportedTypes = [
            FormFieldTypes.TEXT,
            FormFieldTypes.MULTILINE_TEXT
        ];
    }
    MinLengthFieldValidator.prototype.isSupported = function (field) {
        return field &&
            this.supportedTypes.indexOf(field.type) > -1 &&
            field.minLength > 0;
    };
    MinLengthFieldValidator.prototype.validate = function (field) {
        if (this.isSupported(field) && field.value && field.isVisible) {
            if (field.value.length >= field.minLength) {
                return true;
            }
            field.validationSummary.message = "FORM.FIELD.VALIDATOR.AT_LEAST_LONG";
            field.validationSummary.attributes.set('minLength', field.minLength.toLocaleString());
            return false;
        }
        return true;
    };
    return MinLengthFieldValidator;
}());
var MaxLengthFieldValidator = /** @class */ (function () {
    function MaxLengthFieldValidator() {
        this.supportedTypes = [
            FormFieldTypes.TEXT,
            FormFieldTypes.MULTILINE_TEXT
        ];
    }
    MaxLengthFieldValidator.prototype.isSupported = function (field) {
        return field &&
            this.supportedTypes.indexOf(field.type) > -1 &&
            field.maxLength > 0;
    };
    MaxLengthFieldValidator.prototype.validate = function (field) {
        if (this.isSupported(field) && field.value && field.isVisible) {
            if (field.value.length <= field.maxLength) {
                return true;
            }
            field.validationSummary.message = "FORM.FIELD.VALIDATOR.NO_LONGER_THAN";
            field.validationSummary.attributes.set('maxLength', field.maxLength.toLocaleString());
            return false;
        }
        return true;
    };
    return MaxLengthFieldValidator;
}());
var MinValueFieldValidator = /** @class */ (function () {
    function MinValueFieldValidator() {
        this.supportedTypes = [
            FormFieldTypes.NUMBER,
            FormFieldTypes.AMOUNT
        ];
    }
    MinValueFieldValidator.prototype.isSupported = function (field) {
        return field &&
            this.supportedTypes.indexOf(field.type) > -1 &&
            NumberFieldValidator.isNumber(field.minValue);
    };
    MinValueFieldValidator.prototype.validate = function (field) {
        if (this.isSupported(field) && field.value && field.isVisible) {
            var value = +field.value;
            var minValue = +field.minValue;
            if (value >= minValue) {
                return true;
            }
            field.validationSummary.message = "FORM.FIELD.VALIDATOR.NOT_LESS_THAN";
            field.validationSummary.attributes.set('minValue', field.minValue.toLocaleString());
            return false;
        }
        return true;
    };
    return MinValueFieldValidator;
}());
var MaxValueFieldValidator = /** @class */ (function () {
    function MaxValueFieldValidator() {
        this.supportedTypes = [
            FormFieldTypes.NUMBER,
            FormFieldTypes.AMOUNT
        ];
    }
    MaxValueFieldValidator.prototype.isSupported = function (field) {
        return field &&
            this.supportedTypes.indexOf(field.type) > -1 &&
            NumberFieldValidator.isNumber(field.maxValue);
    };
    MaxValueFieldValidator.prototype.validate = function (field) {
        if (this.isSupported(field) && field.value && field.isVisible) {
            var value = +field.value;
            var maxValue = +field.maxValue;
            if (value <= maxValue) {
                return true;
            }
            field.validationSummary.message = "FORM.FIELD.VALIDATOR.NOT_GREATER_THAN";
            field.validationSummary.attributes.set('maxValue', field.maxValue.toLocaleString());
            return false;
        }
        return true;
    };
    return MaxValueFieldValidator;
}());
var RegExFieldValidator = /** @class */ (function () {
    function RegExFieldValidator() {
        this.supportedTypes = [
            FormFieldTypes.TEXT,
            FormFieldTypes.MULTILINE_TEXT
        ];
    }
    RegExFieldValidator.prototype.isSupported = function (field) {
        return field &&
            this.supportedTypes.indexOf(field.type) > -1 && !!field.regexPattern;
    };
    RegExFieldValidator.prototype.validate = function (field) {
        if (this.isSupported(field) && field.value && field.isVisible) {
            if (field.value.length > 0 && field.value.match(new RegExp('^' + field.regexPattern + '$'))) {
                return true;
            }
            field.validationSummary.message = 'FORM.FIELD.VALIDATOR.INVALID_VALUE';
            return false;
        }
        return true;
    };
    return RegExFieldValidator;
}());
var FixedValueFieldValidator = /** @class */ (function () {
    function FixedValueFieldValidator() {
        this.supportedTypes = [
            FormFieldTypes.TYPEAHEAD
        ];
    }
    FixedValueFieldValidator.prototype.isSupported = function (field) {
        return field && this.supportedTypes.indexOf(field.type) > -1;
    };
    FixedValueFieldValidator.prototype.hasValidNameOrValidId = function (field) {
        return this.hasValidName(field) || this.hasValidId(field);
    };
    FixedValueFieldValidator.prototype.hasValidName = function (field) {
        return field.options.find(function (item) { return item.name && item.name.toLocaleLowerCase() === field.value.toLocaleLowerCase(); }) ? true : false;
    };
    FixedValueFieldValidator.prototype.hasValidId = function (field) {
        return field.options[field.value - 1] ? true : false;
    };
    FixedValueFieldValidator.prototype.hasStringValue = function (field) {
        return field.value && typeof field.value === 'string';
    };
    FixedValueFieldValidator.prototype.hasOptions = function (field) {
        return field.options && field.options.length > 0;
    };
    FixedValueFieldValidator.prototype.validate = function (field) {
        if (this.isSupported(field) && field.isVisible) {
            if (this.hasStringValue(field) && this.hasOptions(field) && !this.hasValidNameOrValidId(field)) {
                field.validationSummary.message = 'FORM.FIELD.VALIDATOR.INVALID_VALUE';
                return false;
            }
        }
        return true;
    };
    return FixedValueFieldValidator;
}());
var FORM_FIELD_VALIDATORS = [
    new RequiredFieldValidator(),
    new NumberFieldValidator(),
    new MinLengthFieldValidator(),
    new MaxLengthFieldValidator(),
    new MinValueFieldValidator(),
    new MaxValueFieldValidator(),
    new RegExFieldValidator(),
    new DateFieldValidator(),
    new MinDateFieldValidator(),
    new MaxDateFieldValidator(),
    new FixedValueFieldValidator(),
    new MinDateTimeFieldValidator(),
    new MaxDateTimeFieldValidator()
];
var FormFieldModel = /** @class */ (function (_super) {
    __extends(FormFieldModel, _super);
    function FormFieldModel(form, json) {
        var _this = _super.call(this, form, json) || this;
        _this._readOnly = false;
        _this._isValid = true;
        _this._required = false;
        _this.defaultDateFormat = 'D-M-YYYY';
        _this.deafultDateTimeFormat = 'D-M-YYYY hh:mm A';
        _this.rowspan = 1;
        _this.colspan = 1;
        _this.placeholder = null;
        _this.minLength = 0;
        _this.maxLength = 0;
        _this.options = [];
        _this.params = {};
        _this.isVisible = true;
        _this.visibilityCondition = null;
        _this.enableFractions = false;
        _this.currency = null;
        _this.dateDisplayFormat = _this.dateDisplayFormat || _this.defaultDateFormat;
        _this.numberOfColumns = 1;
        _this.fields = [];
        _this.columns = [];
        if (json) {
            _this.fieldType = json.fieldType;
            _this.id = json.id;
            _this.name = json.name;
            _this.type = json.type;
            _this._required = (json.required);
            _this._readOnly = (json.readOnly) || json.type === 'readonly';
            _this.overrideId = (json.overrideId);
            _this.tab = json.tab;
            _this.restUrl = json.restUrl;
            _this.restResponsePath = json.restResponsePath;
            _this.restIdProperty = json.restIdProperty;
            _this.restLabelProperty = json.restLabelProperty;
            _this.colspan = (json.colspan);
            _this.minLength = (json.minLength) || 0;
            _this.maxLength = (json.maxLength) || 0;
            _this.minValue = json.minValue;
            _this.maxValue = json.maxValue;
            _this.regexPattern = json.regexPattern;
            _this.options = (json.options) || [];
            _this.hasEmptyValue = (json.hasEmptyValue);
            _this.className = json.className;
            _this.optionType = json.optionType;
            _this.params = (json.params) || {};
            _this.hyperlinkUrl = json.hyperlinkUrl;
            _this.displayText = json.displayText;
            _this.visibilityCondition = (json.visibilityCondition);
            _this.enableFractions = (json.enableFractions);
            _this.currency = json.currency;
            _this.dateDisplayFormat = json.dateDisplayFormat || _this.getDefaultDateFormat(json);
            _this._value = _this.parseValue(json);
            _this.validationSummary = new ErrorMessageModel();
            if (json.placeholder && json.placeholder !== '' && json.placeholder !== 'null') {
                _this.placeholder = json.placeholder;
            }
            if (FormFieldTypes.isReadOnlyType(json.type)) {
                if (json.params && json.params.field) {
                    if (form.processVariables) {
                        var processVariable = _this.getProcessVariableValue(json.params.field, form);
                        if (processVariable) {
                            _this.value = processVariable;
                        }
                    }
                    else if (json.params.field.responseVariable) {
                        var formVariable = _this.getVariablesValue(json.params.field.name, form);
                        if (formVariable) {
                            _this.value = formVariable;
                        }
                    }
                }
            }
            if (FormFieldTypes.isContainerType(json.type)) {
                _this.containerFactory(json, form);
            }
        }
        if (_this.hasEmptyValue && _this.options && _this.options.length > 0) {
            _this.emptyOption = _this.options[0];
        }
        _this.updateForm();
        return _this;
    }
    Object.defineProperty(FormFieldModel.prototype, "value", {
        get: function () {
            return this._value;
        },
        set: function (v) {
            this._value = v;
            this.updateForm();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormFieldModel.prototype, "readOnly", {
        get: function () {
            if (this.form && this.form.readOnly) {
                return true;
            }
            return this._readOnly;
        },
        set: function (readOnly) {
            this._readOnly = readOnly;
            this.updateForm();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormFieldModel.prototype, "required", {
        get: function () {
            return this._required;
        },
        set: function (value) {
            this._required = value;
            this.updateForm();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormFieldModel.prototype, "isValid", {
        get: function () {
            return this._isValid;
        },
        enumerable: true,
        configurable: true
    });
    FormFieldModel.prototype.markAsInvalid = function () {
        this._isValid = false;
    };
    FormFieldModel.prototype.validate = function () {
        this.validationSummary = new ErrorMessageModel();
        var validators = this.form.fieldValidators || [];
        try {
            for (var validators_1 = __values(validators), validators_1_1 = validators_1.next(); !validators_1_1.done; validators_1_1 = validators_1.next()) {
                var validator = validators_1_1.value;
                if (!validator.validate(this)) {
                    this._isValid = false;
                    return this._isValid;
                }
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (validators_1_1 && !validators_1_1.done && (_a = validators_1.return)) _a.call(validators_1);
            }
            finally { if (e_3) throw e_3.error; }
        }
        this._isValid = true;
        return this._isValid;
        var e_3, _a;
    };
    FormFieldModel.prototype.getDefaultDateFormat = function (jsonField) {
        var originalType = jsonField.type;
        if (FormFieldTypes.isReadOnlyType(jsonField.type) &&
            jsonField.params &&
            jsonField.params.field) {
            originalType = jsonField.params.field.type;
        }
        return originalType === FormFieldTypes.DATETIME ? this.deafultDateTimeFormat : this.defaultDateFormat;
    };
    FormFieldModel.prototype.isTypeaHeadFieldType = function (type) {
        return type === 'typeahead' ? true : false;
    };
    FormFieldModel.prototype.getFieldNameWithLabel = function (name) {
        return name += '_LABEL';
    };
    FormFieldModel.prototype.getProcessVariableValue = function (field, form) {
        var fieldName = field.name;
        if (this.isTypeaHeadFieldType(field.type)) {
            fieldName = this.getFieldNameWithLabel(field.id);
        }
        return this.findProcessVariableValue(fieldName, form);
    };
    FormFieldModel.prototype.getVariablesValue = function (variableName, form) {
        var variable = form.json.variables.find(function (currentVariable) {
            return currentVariable.name === variableName;
        });
        if (variable) {
            if (variable.type === 'boolean') {
                return JSON.parse(variable.value);
            }
            return variable.value;
        }
        return null;
    };
    FormFieldModel.prototype.findProcessVariableValue = function (variableName, form) {
        if (form.processVariables) {
            var variable = form.processVariables.find(function (currentVariable) {
                return currentVariable.name === variableName;
            });
            if (variable) {
                return variable.type === 'boolean' ? JSON.parse(variable.value) : variable.value;
            }
        }
        return undefined;
    };
    FormFieldModel.prototype.containerFactory = function (json, form) {
        var _this = this;
        this.numberOfColumns = (json.numberOfColumns) || 1;
        this.fields = json.fields;
        this.rowspan = 1;
        this.colspan = 1;
        if (json.fields) {
            for (var currentField in json.fields) {
                if (json.fields.hasOwnProperty(currentField)) {
                    var col = new ContainerColumnModel();
                    var fields = (json.fields[currentField] || []).map(function (f) { return new FormFieldModel(form, f); });
                    col.fields = fields;
                    col.rowspan = json.fields[currentField].length;
                    col.fields.forEach(function (colFields) {
                        _this.colspan = colFields.colspan > _this.colspan ? colFields.colspan : _this.colspan;
                    });
                    this.rowspan = this.rowspan < col.rowspan ? col.rowspan : this.rowspan;
                    this.columns.push(col);
                }
            }
        }
    };
    FormFieldModel.prototype.parseValue = function (json) {
        var value = json.value;
        if (json.type === FormFieldTypes.DROPDOWN) {
            if (json.hasEmptyValue && json.options) {
                var options = (json.options) || [];
                if (options.length > 0) {
                    var emptyOption = json.options[0];
                    if (value === '' || value === emptyOption.id || value === emptyOption.name) {
                        value = emptyOption.id;
                    }
                    else if (value.id && value.name) {
                        value = value.id;
                    }
                }
            }
        }
        if (json.type === FormFieldTypes.RADIO_BUTTONS) {
            var entry = this.options.filter(function (opt) { return opt.id === value || opt.name === value || (value && (opt.id === value.id || opt.name === value.name)); });
            if (entry.length > 0) {
                value = entry[0].id;
            }
            else {
                value = this.options[0] ? this.options[0].id : json.value;
            }
        }
        if (this.isDateField(json) || this.isDateTimeField(json)) {
            if (value) {
                var dateValue = void 0;
                if (NumberFieldValidator.isNumber(value)) {
                    dateValue = moment(value);
                }
                else {
                    dateValue = this.isDateTimeField(json) ? moment(value, 'YYYY-MM-DD hh:mm A') : moment(value.split('T')[0], 'YYYY-M-D');
                }
                if (dateValue && dateValue.isValid()) {
                    value = dateValue.format(this.dateDisplayFormat);
                }
            }
        }
        return value;
    };
    FormFieldModel.prototype.updateForm = function () {
        var _this = this;
        if (!this.form) {
            return;
        }
        switch (this.type) {
            case FormFieldTypes.DROPDOWN:
                if (this.value === 'empty' || this.value === '') {
                    this.form.values[this.id] = {};
                }
                else {
                    var entry = this.options.filter(function (opt) { return opt.id === _this.value; });
                    if (entry.length > 0) {
                        this.form.values[this.id] = entry[0];
                    }
                }
                break;
            case FormFieldTypes.RADIO_BUTTONS:
                var rbEntry = this.options.filter(function (opt) { return opt.id === _this.value; });
                if (rbEntry.length > 0) {
                    this.form.values[this.id] = rbEntry[0];
                }
                break;
            case FormFieldTypes.UPLOAD:
                if (this.value && this.value.length > 0) {
                    this.form.values[this.id] = this.value.map(function (elem) { return elem.id; }).join(',');
                }
                else {
                    this.form.values[this.id] = null;
                }
                break;
            case FormFieldTypes.TYPEAHEAD:
                var taEntry = this.options.filter(function (opt) { return opt.id === _this.value || opt.name === _this.value; });
                if (taEntry.length > 0) {
                    this.form.values[this.id] = taEntry[0];
                }
                else if (this.options.length > 0) {
                    this.form.values[this.id] = null;
                }
                break;
            case FormFieldTypes.DATE:
                var dateValue = moment(this.value, this.dateDisplayFormat, true);
                if (dateValue && dateValue.isValid()) {
                    this.form.values[this.id] = dateValue.format('YYYY-MM-DD') + "T00:00:00.000Z";
                }
                else {
                    this.form.values[this.id] = null;
                    this._value = this.value;
                }
                break;
            case FormFieldTypes.DATETIME:
                var dateTimeValue = moment(this.value, this.dateDisplayFormat, true);
                if (dateTimeValue && dateTimeValue.isValid()) {
                    this.form.values[this.id] = dateTimeValue.format('YYYY-MM-DDTHH:mm:ssZ');
                }
                else {
                    this.form.values[this.id] = null;
                    this._value = this.value;
                }
                break;
            case FormFieldTypes.NUMBER:
                this.form.values[this.id] = parseInt(this.value, 10);
                break;
            case FormFieldTypes.AMOUNT:
                this.form.values[this.id] = this.enableFractions ? parseFloat(this.value) : parseInt(this.value, 10);
                break;
            default:
                if (!FormFieldTypes.isReadOnlyType(this.type) && !this.isInvalidFieldType(this.type)) {
                    this.form.values[this.id] = this.value;
                }
        }
        this.form.onFormFieldChanged(this);
    };
    FormFieldModel.prototype.isInvalidFieldType = function (type) {
        if (type === 'container') {
            return true;
        }
        else {
            return false;
        }
    };
    FormFieldModel.prototype.getOptionName = function () {
        var _this = this;
        var option = this.options.find(function (opt) { return opt.id === _this.value; });
        return option ? option.name : null;
    };
    FormFieldModel.prototype.hasOptions = function () {
        return this.options && this.options.length > 0;
    };
    FormFieldModel.prototype.isDateField = function (json) {
        return (json.params &&
            json.params.field &&
            json.params.field.type === FormFieldTypes.DATE) ||
            json.type === FormFieldTypes.DATE;
    };
    FormFieldModel.prototype.isDateTimeField = function (json) {
        return (json.params &&
            json.params.field &&
            json.params.field.type === FormFieldTypes.DATETIME) ||
            json.type === FormFieldTypes.DATETIME;
    };
    return FormFieldModel;
}(FormWidgetModel));
var ContainerModel = /** @class */ (function (_super) {
    __extends(ContainerModel, _super);
    function ContainerModel(field) {
        var _this = _super.call(this, field.form, field.json) || this;
        if (field) {
            _this.field = field;
        }
        return _this;
    }
    Object.defineProperty(ContainerModel.prototype, "isVisible", {
        get: function () {
            return this.field.isVisible;
        },
        enumerable: true,
        configurable: true
    });
    return ContainerModel;
}(FormWidgetModel));
var FormOutcomeModel = /** @class */ (function (_super) {
    __extends(FormOutcomeModel, _super);
    function FormOutcomeModel(form, json) {
        var _this = _super.call(this, form, json) || this;
        _this.isSystem = false;
        _this.isSelected = false;
        if (json) {
            _this.isSystem = json.isSystem ? true : false;
            _this.isSelected = form && json.name === form.selectedOutcome ? true : false;
        }
        return _this;
    }
    return FormOutcomeModel;
}(FormWidgetModel));
FormOutcomeModel.SAVE_ACTION = 'Save';
FormOutcomeModel.COMPLETE_ACTION = 'Complete';
FormOutcomeModel.START_PROCESS_ACTION = 'Start Process';
var TabModel = /** @class */ (function (_super) {
    __extends(TabModel, _super);
    function TabModel(form, json) {
        var _this = _super.call(this, form, json) || this;
        _this.isVisible = true;
        _this.fields = [];
        if (json) {
            _this.title = json.title;
            _this.visibilityCondition = (json.visibilityCondition);
        }
        return _this;
    }
    TabModel.prototype.hasContent = function () {
        return this.fields && this.fields.length > 0;
    };
    return TabModel;
}(FormWidgetModel));
var FormModel = /** @class */ (function () {
    function FormModel(json, data, readOnly, formService) {
        if (readOnly === void 0) { readOnly = false; }
        var _this = this;
        this.formService = formService;
        this.taskName = FormModel.UNSET_TASK_NAME;
        this._isValid = true;
        this.readOnly = false;
        this.tabs = [];
        this.fields = [];
        this.outcomes = [];
        this.customFieldTemplates = {};
        this.fieldValidators = __spread(FORM_FIELD_VALIDATORS);
        this.values = {};
        this.readOnly = readOnly;
        if (json) {
            this.json = json;
            this.id = json.id;
            this.name = json.name;
            this.taskId = json.taskId;
            this.taskName = json.taskName || json.name || FormModel.UNSET_TASK_NAME;
            this.processDefinitionId = json.processDefinitionId;
            this.customFieldTemplates = json.customFieldTemplates || {};
            this.selectedOutcome = json.selectedOutcome || {};
            this.className = json.className || '';
            var tabCache_1 = {};
            this.processVariables = json.processVariables;
            this.tabs = (json.tabs || []).map(function (t) {
                var model = new TabModel(_this, t);
                tabCache_1[model.id] = model;
                return model;
            });
            this.fields = this.parseRootFields(json);
            if (data) {
                this.loadData(data);
            }
            for (var i = 0; i < this.fields.length; i++) {
                var field = this.fields[i];
                if (field.tab) {
                    var tab = tabCache_1[field.tab];
                    if (tab) {
                        tab.fields.push(field);
                    }
                }
            }
            if (json.fields) {
                var saveOutcome = new FormOutcomeModel(this, { id: FormModel.SAVE_OUTCOME, name: 'Save', isSystem: true });
                var completeOutcome = new FormOutcomeModel(this, { id: FormModel.COMPLETE_OUTCOME, name: 'Complete', isSystem: true });
                var startProcessOutcome = new FormOutcomeModel(this, { id: FormModel.START_PROCESS_OUTCOME, name: 'Start Process', isSystem: true });
                var customOutcomes = (json.outcomes || []).map(function (obj) { return new FormOutcomeModel(_this, obj); });
                this.outcomes = [saveOutcome].concat(customOutcomes.length > 0 ? customOutcomes : [completeOutcome, startProcessOutcome]);
            }
        }
        this.validateForm();
    }
    Object.defineProperty(FormModel.prototype, "isValid", {
        get: function () {
            return this._isValid;
        },
        enumerable: true,
        configurable: true
    });
    FormModel.prototype.hasTabs = function () {
        return this.tabs && this.tabs.length > 0;
    };
    FormModel.prototype.hasFields = function () {
        return this.fields && this.fields.length > 0;
    };
    FormModel.prototype.hasOutcomes = function () {
        return this.outcomes && this.outcomes.length > 0;
    };
    FormModel.prototype.onFormFieldChanged = function (field) {
        this.validateField(field);
        if (this.formService) {
            this.formService.formFieldValueChanged.next(new FormFieldEvent(this, field));
        }
    };
    FormModel.prototype.getFieldById = function (fieldId) {
        return this.getFormFields().find(function (field) { return field.id === fieldId; });
    };
    FormModel.prototype.getFormFields = function () {
        var result = [];
        for (var i = 0; i < this.fields.length; i++) {
            var field = this.fields[i];
            if (field instanceof ContainerModel) {
                var container = (field);
                result.push(container.field);
                container.field.columns.forEach(function (column) {
                    result.push.apply(result, __spread(column.fields));
                });
            }
        }
        return result;
    };
    FormModel.prototype.markAsInvalid = function () {
        this._isValid = false;
    };
    FormModel.prototype.validateForm = function () {
        var validateFormEvent = new ValidateFormEvent(this);
        if (this.formService) {
            this.formService.validateForm.next(validateFormEvent);
        }
        this._isValid = validateFormEvent.isValid;
        if (validateFormEvent.defaultPrevented) {
            return;
        }
        if (validateFormEvent.isValid) {
            var fields = this.getFormFields();
            for (var i = 0; i < fields.length; i++) {
                if (!fields[i].validate()) {
                    this._isValid = false;
                    return;
                }
            }
        }
    };
    FormModel.prototype.validateField = function (field) {
        if (!field) {
            return;
        }
        var validateFieldEvent = new ValidateFormFieldEvent(this, field);
        if (this.formService) {
            this.formService.validateFormField.next(validateFieldEvent);
        }
        if (!validateFieldEvent.isValid) {
            this._isValid = false;
            return;
        }
        if (validateFieldEvent.defaultPrevented) {
            return;
        }
        if (!field.validate()) {
            this._isValid = false;
            return;
        }
        this.validateForm();
    };
    FormModel.prototype.parseRootFields = function (json) {
        var fields = [];
        if (json.fields) {
            fields = json.fields;
        }
        else if (json.formDefinition && json.formDefinition.fields) {
            fields = json.formDefinition.fields;
        }
        var result = [];
        try {
            for (var fields_1 = __values(fields), fields_1_1 = fields_1.next(); !fields_1_1.done; fields_1_1 = fields_1.next()) {
                var field = fields_1_1.value;
                if (field.type === FormFieldTypes.DISPLAY_VALUE) {
                    if (field.params) {
                        var originalField = field.params['field'];
                        if (originalField.type === FormFieldTypes.DYNAMIC_TABLE) {
                            result.push(new ContainerModel(new FormFieldModel(this, field)));
                        }
                    }
                }
                else {
                    result.push(new ContainerModel(new FormFieldModel(this, field)));
                }
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (fields_1_1 && !fields_1_1.done && (_a = fields_1.return)) _a.call(fields_1);
            }
            finally { if (e_4) throw e_4.error; }
        }
        return result;
        var e_4, _a;
    };
    FormModel.prototype.loadData = function (data) {
        try {
            for (var _a = __values(this.getFormFields()), _b = _a.next(); !_b.done; _b = _a.next()) {
                var field = _b.value;
                if (data[field.id]) {
                    field.json.value = data[field.id];
                    field.value = field.parseValue(field.json);
                }
            }
        }
        catch (e_5_1) { e_5 = { error: e_5_1 }; }
        finally {
            try {
                if (_b && !_b.done && (_c = _a.return)) _c.call(_a);
            }
            finally { if (e_5) throw e_5.error; }
        }
        var e_5, _c;
    };
    return FormModel;
}());
FormModel.UNSET_TASK_NAME = 'Nameless task';
FormModel.SAVE_OUTCOME = '$save';
FormModel.COMPLETE_OUTCOME = '$complete';
FormModel.START_PROCESS_OUTCOME = '$startProcess';
var FormOutcomeEvent = /** @class */ (function () {
    function FormOutcomeEvent(outcome) {
        this._defaultPrevented = false;
        this._outcome = outcome;
    }
    Object.defineProperty(FormOutcomeEvent.prototype, "outcome", {
        get: function () {
            return this._outcome;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormOutcomeEvent.prototype, "defaultPrevented", {
        get: function () {
            return this._defaultPrevented;
        },
        enumerable: true,
        configurable: true
    });
    FormOutcomeEvent.prototype.preventDefault = function () {
        this._defaultPrevented = true;
    };
    return FormOutcomeEvent;
}());
var ContentLinkModel = /** @class */ (function () {
    function ContentLinkModel(obj) {
        this.contentAvailable = obj && obj.contentAvailable;
        this.created = obj && obj.created;
        this.createdBy = obj && obj.createdBy || {};
        this.id = obj && obj.id;
        this.link = obj && obj.link;
        this.mimeType = obj && obj.mimeType;
        this.name = obj && obj.name;
        this.previewStatus = obj && obj.previewStatus;
        this.relatedContent = obj && obj.relatedContent;
        this.simpleType = obj && obj.simpleType;
        this.thumbnailStatus = obj && obj.thumbnailStatus;
    }
    ContentLinkModel.prototype.hasPreviewStatus = function () {
        return this.previewStatus === 'supported' ? true : false;
    };
    ContentLinkModel.prototype.isTypeImage = function () {
        return this.simpleType === 'image' ? true : false;
    };
    ContentLinkModel.prototype.isTypePdf = function () {
        return this.simpleType === 'pdf' ? true : false;
    };
    ContentLinkModel.prototype.isTypeDoc = function () {
        return this.simpleType === 'word' || this.simpleType === 'content' ? true : false;
    };
    ContentLinkModel.prototype.isThumbnailReady = function () {
        return this.thumbnailStatus === 'created';
    };
    ContentLinkModel.prototype.isThumbnailSupported = function () {
        return this.isTypeImage() || ((this.isTypePdf() || this.isTypeDoc()) && this.isThumbnailReady());
    };
    return ContentLinkModel;
}());
var FormService = /** @class */ (function () {
    function FormService(ecmModelService, apiService, logService) {
        this.ecmModelService = ecmModelService;
        this.apiService = apiService;
        this.logService = logService;
        this.formLoaded = new Subject();
        this.formDataRefreshed = new Subject();
        this.formFieldValueChanged = new Subject();
        this.formEvents = new Subject();
        this.taskCompleted = new Subject();
        this.taskCompletedError = new Subject();
        this.taskSaved = new Subject();
        this.taskSavedError = new Subject();
        this.formContentClicked = new Subject();
        this.validateForm = new Subject();
        this.validateFormField = new Subject();
        this.validateDynamicTableRow = new Subject();
        this.executeOutcome = new Subject();
    }
    Object.defineProperty(FormService.prototype, "taskApi", {
        get: function () {
            return this.apiService.getInstance().activiti.taskApi;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormService.prototype, "modelsApi", {
        get: function () {
            return this.apiService.getInstance().activiti.modelsApi;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormService.prototype, "editorApi", {
        get: function () {
            return this.apiService.getInstance().activiti.editorApi;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormService.prototype, "processApi", {
        get: function () {
            return this.apiService.getInstance().activiti.processApi;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormService.prototype, "processInstanceVariablesApi", {
        get: function () {
            return this.apiService.getInstance().activiti.processInstanceVariablesApi;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormService.prototype, "usersWorkflowApi", {
        get: function () {
            return this.apiService.getInstance().activiti.usersWorkflowApi;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormService.prototype, "groupsApi", {
        get: function () {
            return this.apiService.getInstance().activiti.groupsApi;
        },
        enumerable: true,
        configurable: true
    });
    FormService.prototype.parseForm = function (json, data, readOnly) {
        if (readOnly === void 0) { readOnly = false; }
        if (json) {
            var form = new FormModel(json, data, readOnly, this);
            if (!json.fields) {
                form.outcomes = [
                    new FormOutcomeModel(form, {
                        id: '$custom',
                        name: FormOutcomeModel.SAVE_ACTION,
                        isSystem: true
                    })
                ];
            }
            return form;
        }
        return null;
    };
    FormService.prototype.createFormFromANode = function (formName) {
        var _this = this;
        return Observable.create(function (observer) {
            _this.createForm(formName).subscribe(function (form) {
                _this.ecmModelService.searchEcmType(formName, EcmModelService.MODEL_NAME).subscribe(function (customType) {
                    var formDefinitionModel = new FormDefinitionModel(form.id, form.name, form.lastUpdatedByFullName, form.lastUpdated, customType.entry.properties);
                    _this.addFieldsToAForm(form.id, formDefinitionModel).subscribe(function (formData) {
                        observer.next(formData);
                        observer.complete();
                    }, function (err) { return _this.handleError(err); });
                }, function (err) { return _this.handleError(err); });
            }, function (err) { return _this.handleError(err); });
        });
    };
    FormService.prototype.createForm = function (formName) {
        var dataModel = {
            name: formName,
            description: '',
            modelType: 2,
            stencilSet: 0
        };
        return Observable.fromPromise(this.modelsApi.createModel(dataModel));
    };
    FormService.prototype.saveForm = function (formId, formModel) {
        return Observable.fromPromise(this.editorApi.saveForm(formId, formModel));
    };
    FormService.prototype.addFieldsToAForm = function (formId, formModel) {
        this.logService.log('addFieldsToAForm is deprecated in 1.7.0, use saveForm API instead');
        return Observable.fromPromise(this.editorApi.saveForm(formId, formModel));
    };
    FormService.prototype.searchFrom = function (name) {
        var _this = this;
        var opts = {
            'modelType': 2
        };
        return Observable.fromPromise(this.modelsApi.getModels(opts))
            .map(function (forms) {
            return forms.data.find(function (formdata) { return formdata.name === name; });
        })
            .catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getForms = function () {
        var _this = this;
        var opts = {
            'modelType': 2
        };
        return Observable.fromPromise(this.modelsApi.getModels(opts))
            .map(this.toJsonArray)
            .catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getProcessDefinitions = function () {
        var _this = this;
        return Observable.fromPromise(this.processApi.getProcessDefinitions({}))
            .map(this.toJsonArray)
            .catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getProcessVarablesById = function (processInstanceId) {
        var _this = this;
        return Observable.fromPromise(this.processInstanceVariablesApi.getProcessInstanceVariables(processInstanceId))
            .map(this.toJson)
            .catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getTasks = function () {
        var _this = this;
        return Observable.fromPromise(this.taskApi.listTasks({}))
            .map(this.toJsonArray)
            .catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getTask = function (taskId) {
        var _this = this;
        return Observable.fromPromise(this.taskApi.getTask(taskId))
            .map(this.toJson)
            .catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.saveTaskForm = function (taskId, formValues) {
        var _this = this;
        var body = JSON.stringify({ values: formValues });
        return Observable.fromPromise(this.taskApi.saveTaskForm(taskId, body))
            .catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.completeTaskForm = function (taskId, formValues, outcome) {
        var _this = this;
        var data = { values: formValues };
        if (outcome) {
            data.outcome = outcome;
        }
        var body = JSON.stringify(data);
        return Observable.fromPromise(this.taskApi.completeTaskForm(taskId, body))
            .catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getTaskForm = function (taskId) {
        var _this = this;
        return Observable.fromPromise(this.taskApi.getTaskForm(taskId))
            .map(this.toJson)
            .catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getFormDefinitionById = function (formId) {
        var _this = this;
        return Observable.fromPromise(this.editorApi.getForm(formId))
            .map(this.toJson)
            .catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getFormDefinitionByName = function (name) {
        var _this = this;
        var opts = {
            'filter': 'myReusableForms',
            'filterText': name,
            'modelType': 2
        };
        return Observable.fromPromise(this.modelsApi.getModels(opts))
            .map(this.getFormId)
            .catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getStartFormInstance = function (processId) {
        var _this = this;
        return Observable.fromPromise(this.processApi.getProcessInstanceStartForm(processId))
            .map(this.toJson)
            .catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getProcessIntance = function (processId) {
        var _this = this;
        return Observable.fromPromise(this.processApi.getProcessInstance(processId))
            .map(this.toJson)
            .catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getStartFormDefinition = function (processId) {
        var _this = this;
        return Observable.fromPromise(this.processApi.getProcessDefinitionStartForm(processId))
            .map(this.toJson)
            .catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getRestFieldValues = function (taskId, field) {
        var _this = this;
        return Observable.fromPromise(this.taskApi.getRestFieldValues(taskId, field)).catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getRestFieldValuesByProcessId = function (processDefinitionId, field) {
        var _this = this;
        return Observable.fromPromise(this.processApi.getRestFieldValues(processDefinitionId, field)).catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getRestFieldValuesColumnByProcessId = function (processDefinitionId, field, column) {
        var _this = this;
        return Observable.fromPromise(this.processApi.getRestTableFieldValues(processDefinitionId, field, column)).catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getRestFieldValuesColumn = function (taskId, field, column) {
        var _this = this;
        return Observable.fromPromise(this.taskApi.getRestFieldValuesColumn(taskId, field, column)).catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getUserProfileImageApi = function (userId) {
        return this.apiService.getInstance().activiti.userApi.getUserProfilePictureUrl(userId);
    };
    FormService.prototype.getWorkflowUsers = function (filter, groupId) {
        var _this = this;
        var option = { filter: filter };
        if (groupId) {
            option.groupId = groupId;
        }
        return Observable.fromPromise(this.usersWorkflowApi.getUsers(option))
            .switchMap(function (response) { return (response.data) || []; })
            .map(function (user) {
            user.userImage = _this.getUserProfileImageApi(user.id);
            return Observable.of(user);
        })
            .combineAll()
            .defaultIfEmpty([])
            .catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getWorkflowGroups = function (filter, groupId) {
        var _this = this;
        var option = { filter: filter };
        if (groupId) {
            option.groupId = groupId;
        }
        return Observable.fromPromise(this.groupsApi.getGroups(option))
            .map(function (response) { return (response.data) || []; })
            .catch(function (err) { return _this.handleError(err); });
    };
    FormService.prototype.getFormId = function (res) {
        var result = null;
        if (res && res.data && res.data.length > 0) {
            result = res.data[0].id;
        }
        return result;
    };
    FormService.prototype.toJson = function (res) {
        if (res) {
            return res || {};
        }
        return {};
    };
    FormService.prototype.toJsonArray = function (res) {
        if (res) {
            return res.data || [];
        }
        return [];
    };
    FormService.prototype.handleError = function (error) {
        var errMsg = FormService.UNKNOWN_ERROR_MESSAGE;
        if (error) {
            errMsg = (error.message) ? error.message :
                error.status ? error.status + " - " + error.statusText : FormService.GENERIC_ERROR_MESSAGE;
        }
        this.logService.error(errMsg);
        return Observable.throw(errMsg);
    };
    return FormService;
}());
FormService.UNKNOWN_ERROR_MESSAGE = 'Unknown error';
FormService.GENERIC_ERROR_MESSAGE = 'Server error';
FormService.decorators = [
    { type: Injectable },
];
FormService.ctorParameters = function () { return [
    { type: EcmModelService, },
    { type: AlfrescoApiService, },
    { type: LogService, },
]; };
var NodeMetadata = /** @class */ (function () {
    function NodeMetadata(metadata, nodeType) {
        this.metadata = metadata;
        this.nodeType = nodeType;
    }
    return NodeMetadata;
}());
var NodeService = /** @class */ (function () {
    function NodeService(apiService) {
        this.apiService = apiService;
    }
    NodeService.prototype.getNodeMetadata = function (nodeId) {
        return Observable.fromPromise(this.apiService.getInstance().nodes.getNodeInfo(nodeId)).map(this.cleanMetadataFromSemicolon);
    };
    NodeService.prototype.createNodeMetadata = function (nodeType, nameSpace, data, path, name) {
        var properties = {};
        for (var key in data) {
            if (data[key]) {
                properties[nameSpace + ':' + key] = data[key];
            }
        }
        return this.createNode(name || this.generateUuid(), nodeType, properties, path);
    };
    NodeService.prototype.createNode = function (name, nodeType, properties, path) {
        var body = {
            name: name,
            nodeType: nodeType,
            properties: properties,
            relativePath: path
        };
        var apiService = this.apiService.getInstance();
        return Observable.fromPromise(apiService.nodes.addNode('-root-', body, {}));
    };
    NodeService.prototype.generateUuid = function () {
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
            var r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
        });
    };
    NodeService.prototype.cleanMetadataFromSemicolon = function (data) {
        var metadata = {};
        if (data && data.properties) {
            for (var key in data.properties) {
                if (key) {
                    if (key.indexOf(':') !== -1) {
                        metadata[key.split(':')[1]] = data.properties[key];
                    }
                    else {
                        metadata[key] = data.properties[key];
                    }
                }
            }
        }
        return new NodeMetadata(metadata, data.nodeType);
    };
    return NodeService;
}());
NodeService.decorators = [
    { type: Injectable },
];
NodeService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
]; };
var WidgetVisibilityService = /** @class */ (function () {
    function WidgetVisibilityService(apiService, logService) {
        this.apiService = apiService;
        this.logService = logService;
    }
    WidgetVisibilityService.prototype.refreshVisibility = function (form) {
        var _this = this;
        if (form && form.tabs && form.tabs.length > 0) {
            form.tabs.map(function (tabModel) { return _this.refreshEntityVisibility(tabModel); });
        }
        if (form) {
            form.getFormFields().map(function (field) { return _this.refreshEntityVisibility(field); });
        }
    };
    WidgetVisibilityService.prototype.refreshEntityVisibility = function (element) {
        var visible = this.evaluateVisibility(element.form, element.visibilityCondition);
        element.isVisible = visible;
    };
    WidgetVisibilityService.prototype.evaluateVisibility = function (form, visibilityObj) {
        var isLeftFieldPresent = visibilityObj && (visibilityObj.leftFormFieldId || visibilityObj.leftRestResponseId);
        if (!isLeftFieldPresent || isLeftFieldPresent === 'null') {
            return true;
        }
        else {
            return this.isFieldVisible(form, visibilityObj);
        }
    };
    WidgetVisibilityService.prototype.isFieldVisible = function (form, visibilityObj) {
        var leftValue = this.getLeftValue(form, visibilityObj);
        var rightValue = this.getRightValue(form, visibilityObj);
        var actualResult = this.evaluateCondition(leftValue, rightValue, visibilityObj.operator);
        if (visibilityObj.nextCondition) {
            return this.evaluateLogicalOperation(visibilityObj.nextConditionOperator, actualResult, this.isFieldVisible(form, visibilityObj.nextCondition));
        }
        else {
            return actualResult;
        }
    };
    WidgetVisibilityService.prototype.getLeftValue = function (form, visibilityObj) {
        var leftValue = '';
        if (visibilityObj.leftRestResponseId && visibilityObj.leftRestResponseId !== 'null') {
            leftValue = this.getVariableValue(form, visibilityObj.leftRestResponseId, this.processVarList);
        }
        else {
            leftValue = this.getVariableValue(form, visibilityObj.leftFormFieldId, this.processVarList);
            leftValue = leftValue ? leftValue : this.getFormValue(form, visibilityObj.leftFormFieldId);
        }
        return leftValue;
    };
    WidgetVisibilityService.prototype.getRightValue = function (form, visibilityObj) {
        var valueFound = '';
        if (visibilityObj.rightRestResponseId) {
            valueFound = this.getVariableValue(form, visibilityObj.rightRestResponseId, this.processVarList);
        }
        else if (visibilityObj.rightFormFieldId) {
            valueFound = this.getFormValue(form, visibilityObj.rightFormFieldId);
        }
        else {
            if (moment(visibilityObj.rightValue, 'YYYY-MM-DD', true).isValid()) {
                valueFound = visibilityObj.rightValue + 'T00:00:00.000Z';
            }
            else {
                valueFound = visibilityObj.rightValue;
            }
        }
        return valueFound;
    };
    WidgetVisibilityService.prototype.getFormValue = function (form, fieldId) {
        var value = this.getFieldValue(form.values, fieldId);
        if (!value) {
            value = this.searchValueInForm(form, fieldId);
        }
        return value;
    };
    WidgetVisibilityService.prototype.getFieldValue = function (valueList, fieldId) {
        var dropDownFilterByName, valueFound;
        if (fieldId && fieldId.indexOf('_LABEL') > 0) {
            dropDownFilterByName = fieldId.substring(0, fieldId.length - 6);
            if (valueList[dropDownFilterByName]) {
                valueFound = valueList[dropDownFilterByName].name;
            }
        }
        else if (valueList[fieldId] && valueList[fieldId].id) {
            valueFound = valueList[fieldId].id;
        }
        else {
            valueFound = valueList[fieldId];
        }
        return valueFound;
    };
    WidgetVisibilityService.prototype.searchValueInForm = function (form, fieldId) {
        var _this = this;
        var fieldValue = '';
        form.getFormFields().forEach(function (formField) {
            if (_this.isSearchedField(formField, fieldId)) {
                fieldValue = _this.getObjectValue(formField, fieldId);
                if (!fieldValue) {
                    if (formField.value && formField.value.id) {
                        fieldValue = formField.value.id;
                    }
                    else {
                        fieldValue = formField.value;
                    }
                }
            }
        });
        return fieldValue;
    };
    WidgetVisibilityService.prototype.getObjectValue = function (field, fieldId) {
        var value = '';
        if (field.value && field.value.name) {
            value = field.value.name;
        }
        else if (field.options) {
            var option = field.options.find(function (opt) { return opt.id === field.value; });
            if (option) {
                value = this.getValueFromOption(fieldId, option);
            }
        }
        return value;
    };
    WidgetVisibilityService.prototype.getValueFromOption = function (fieldId, option) {
        var optionValue = '';
        if (fieldId && fieldId.indexOf('_LABEL') > 0) {
            optionValue = option.name;
        }
        else {
            optionValue = option.id;
        }
        return optionValue;
    };
    WidgetVisibilityService.prototype.isSearchedField = function (field, fieldToFind) {
        var formattedFieldName = this.removeLabel(field, fieldToFind);
        return field.id ? field.id.toUpperCase() === formattedFieldName.toUpperCase() : false;
    };
    WidgetVisibilityService.prototype.removeLabel = function (field, fieldToFind) {
        var formattedFieldName = fieldToFind || '';
        if (field.fieldType === 'RestFieldRepresentation' && fieldToFind.indexOf('_LABEL') > 0) {
            formattedFieldName = fieldToFind.substring(0, fieldToFind.length - 6);
        }
        return formattedFieldName;
    };
    WidgetVisibilityService.prototype.getVariableValue = function (form, name, processVarList) {
        return this.getFormVariableValue(form, name) ||
            this.getProcessVariableValue(name, processVarList);
    };
    WidgetVisibilityService.prototype.getFormVariableValue = function (form, name) {
        if (form.json.variables) {
            var formVariable = form.json.variables.find(function (formVar) { return formVar.name === name; });
            return formVariable ? formVariable.value : formVariable;
        }
    };
    WidgetVisibilityService.prototype.getProcessVariableValue = function (name, processVarList) {
        if (this.processVarList) {
            var processVariable = this.processVarList.find(function (variable) { return variable.id === name; });
            return processVariable ? processVariable.value : processVariable;
        }
    };
    WidgetVisibilityService.prototype.evaluateLogicalOperation = function (logicOp, previousValue, newValue) {
        switch (logicOp) {
            case 'and':
                return previousValue && newValue;
            case 'or':
                return previousValue || newValue;
            case 'and-not':
                return previousValue && !newValue;
            case 'or-not':
                return previousValue || !newValue;
            default:
                this.logService.error('NO valid operation! wrong op request : ' + logicOp);
                break;
        }
    };
    WidgetVisibilityService.prototype.evaluateCondition = function (leftValue, rightValue, operator) {
        switch (operator) {
            case '==':
                return leftValue + '' === rightValue + '';
            case '<':
                return leftValue < rightValue;
            case '!=':
                return leftValue + '' !== rightValue + '';
            case '>':
                return leftValue > rightValue;
            case '>=':
                return leftValue >= rightValue;
            case '<=':
                return leftValue <= rightValue;
            case 'empty':
                return leftValue ? leftValue === '' : true;
            case '!empty':
                return leftValue ? leftValue !== '' : false;
            default:
                this.logService.error('NO valid operation!');
                break;
        }
        return;
    };
    WidgetVisibilityService.prototype.cleanProcessVariable = function () {
        this.processVarList = [];
    };
    WidgetVisibilityService.prototype.getTaskProcessVariable = function (taskId) {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().activiti.taskFormsApi.getTaskFormVariables(taskId))
            .map(function (res) {
            var jsonRes = _this.toJson(res);
            _this.processVarList = (jsonRes);
            return jsonRes;
        })
            .catch(function (err) { return _this.handleError(err); });
    };
    WidgetVisibilityService.prototype.toJson = function (res) {
        return res || {};
    };
    WidgetVisibilityService.prototype.handleError = function (err) {
        this.logService.error('Error while performing a call');
        return Observable.throw('Error while performing a call - Server error');
    };
    return WidgetVisibilityService;
}());
WidgetVisibilityService.decorators = [
    { type: Injectable },
];
WidgetVisibilityService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: LogService, },
]; };
var FormComponent = /** @class */ (function () {
    function FormComponent(formService, visibilityService, ecmModelService, nodeService) {
        this.formService = formService;
        this.visibilityService = visibilityService;
        this.ecmModelService = ecmModelService;
        this.nodeService = nodeService;
        this.saveMetadata = false;
        this.showTitle = true;
        this.showCompleteButton = true;
        this.disableCompleteButton = false;
        this.disableStartProcessButton = false;
        this.showSaveButton = true;
        this.showDebugButton = false;
        this.readOnly = false;
        this.showRefreshButton = true;
        this.showValidationIcon = true;
        this.fieldValidators = [];
        this.formSaved = new EventEmitter();
        this.formCompleted = new EventEmitter();
        this.formContentClicked = new EventEmitter();
        this.formLoaded = new EventEmitter();
        this.formDataRefreshed = new EventEmitter();
        this.executeOutcome = new EventEmitter();
        this.onError = new EventEmitter();
        this.debugMode = false;
    }
    FormComponent.prototype.hasForm = function () {
        return this.form ? true : false;
    };
    FormComponent.prototype.isTitleEnabled = function () {
        if (this.showTitle) {
            if (this.form && this.form.taskName) {
                return true;
            }
        }
        return false;
    };
    FormComponent.prototype.getColorForOutcome = function (outcomeName) {
        return outcomeName === FormComponent.COMPLETE_OUTCOME_NAME ? FormComponent.COMPLETE_BUTTON_COLOR : '';
    };
    FormComponent.prototype.isOutcomeButtonEnabled = function (outcome) {
        if (this.form.readOnly) {
            return false;
        }
        if (outcome) {
            if (outcome.name === FormOutcomeModel.SAVE_ACTION) {
                return true;
            }
            if (outcome.name === FormOutcomeModel.COMPLETE_ACTION) {
                return this.disableCompleteButton ? false : this.form.isValid;
            }
            if (outcome.name === FormOutcomeModel.START_PROCESS_ACTION) {
                return this.disableStartProcessButton ? false : this.form.isValid;
            }
            return this.form.isValid;
        }
        return false;
    };
    FormComponent.prototype.isOutcomeButtonVisible = function (outcome, isFormReadOnly) {
        if (outcome && outcome.name) {
            if (outcome.name === FormOutcomeModel.COMPLETE_ACTION) {
                return this.showCompleteButton;
            }
            if (isFormReadOnly) {
                return outcome.isSelected;
            }
            if (outcome.name === FormOutcomeModel.SAVE_ACTION) {
                return this.showSaveButton;
            }
            if (outcome.name === FormOutcomeModel.START_PROCESS_ACTION) {
                return false;
            }
            return true;
        }
        return false;
    };
    FormComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.formService.formContentClicked.subscribe(function (content) {
            _this.formContentClicked.emit(content);
        });
    };
    FormComponent.prototype.ngOnChanges = function (changes) {
        var taskId = changes['taskId'];
        if (taskId && taskId.currentValue) {
            this.getFormByTaskId(taskId.currentValue);
            return;
        }
        var formId = changes['formId'];
        if (formId && formId.currentValue) {
            this.getFormDefinitionByFormId(formId.currentValue);
            return;
        }
        var formName = changes['formName'];
        if (formName && formName.currentValue) {
            this.getFormDefinitionByFormName(formName.currentValue);
            return;
        }
        var nodeId = changes['nodeId'];
        if (nodeId && nodeId.currentValue) {
            this.loadFormForEcmNode(nodeId.currentValue);
            return;
        }
        var data = changes['data'];
        if (data && data.currentValue) {
            this.refreshFormData();
            return;
        }
    };
    FormComponent.prototype.onOutcomeClicked = function (outcome) {
        if (!this.readOnly && outcome && this.form) {
            if (!this.onExecuteOutcome(outcome)) {
                return false;
            }
            if (outcome.isSystem) {
                if (outcome.id === FormComponent.SAVE_OUTCOME_ID) {
                    this.saveTaskForm();
                    return true;
                }
                if (outcome.id === FormComponent.COMPLETE_OUTCOME_ID) {
                    this.completeTaskForm();
                    return true;
                }
                if (outcome.id === FormComponent.START_PROCESS_OUTCOME_ID) {
                    this.completeTaskForm();
                    return true;
                }
                if (outcome.id === FormComponent.CUSTOM_OUTCOME_ID) {
                    this.onTaskSaved(this.form);
                    this.storeFormAsMetadata();
                    return true;
                }
            }
            else {
                if (outcome.name) {
                    this.onTaskSaved(this.form);
                    this.completeTaskForm(outcome.name);
                    return true;
                }
            }
        }
        return false;
    };
    FormComponent.prototype.onRefreshClicked = function () {
        this.loadForm();
    };
    FormComponent.prototype.loadForm = function () {
        if (this.taskId) {
            this.getFormByTaskId(this.taskId);
            return;
        }
        if (this.formId) {
            this.getFormDefinitionByFormId(this.formId);
            return;
        }
        if (this.formName) {
            this.getFormDefinitionByFormName(this.formName);
            return;
        }
    };
    FormComponent.prototype.findProcessVariablesByTaskId = function (taskId) {
        var _this = this;
        return this.formService.getTask(taskId).
            switchMap(function (task) {
            if (_this.isAProcessTask(task)) {
                return _this.visibilityService.getTaskProcessVariable(taskId);
            }
            else {
                return Observable.of({});
            }
        });
    };
    FormComponent.prototype.isAProcessTask = function (taskRepresentation) {
        return taskRepresentation.processDefinitionId && taskRepresentation.processDefinitionDeploymentId !== 'null';
    };
    FormComponent.prototype.getFormByTaskId = function (taskId) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            _this.findProcessVariablesByTaskId(taskId).subscribe(function (processVariables) {
                _this.formService
                    .getTaskForm(taskId)
                    .subscribe(function (form) {
                    var parsedForm = _this.parseForm(form);
                    _this.visibilityService.refreshVisibility(parsedForm);
                    parsedForm.validateForm();
                    _this.form = parsedForm;
                    _this.onFormLoaded(_this.form);
                    resolve(_this.form);
                }, function (error) {
                    _this.handleError(error);
                    resolve(null);
                });
            });
        });
    };
    FormComponent.prototype.getFormDefinitionByFormId = function (formId) {
        var _this = this;
        this.formService
            .getFormDefinitionById(formId)
            .subscribe(function (form) {
            _this.formName = form.name;
            _this.form = _this.parseForm(form);
            _this.visibilityService.refreshVisibility(_this.form);
            _this.form.validateForm();
            _this.onFormLoaded(_this.form);
        }, function (error) {
            _this.handleError(error);
        });
    };
    FormComponent.prototype.getFormDefinitionByFormName = function (formName) {
        var _this = this;
        this.formService
            .getFormDefinitionByName(formName)
            .subscribe(function (id) {
            _this.formService.getFormDefinitionById(id).subscribe(function (form) {
                _this.form = _this.parseForm(form);
                _this.visibilityService.refreshVisibility(_this.form);
                _this.form.validateForm();
                _this.onFormLoaded(_this.form);
            }, function (error) {
                _this.handleError(error);
            });
        }, function (error) {
            _this.handleError(error);
        });
    };
    FormComponent.prototype.saveTaskForm = function () {
        var _this = this;
        if (this.form && this.form.taskId) {
            this.formService
                .saveTaskForm(this.form.taskId, this.form.values)
                .subscribe(function () {
                _this.onTaskSaved(_this.form);
                _this.storeFormAsMetadata();
            }, function (error) { return _this.onTaskSavedError(_this.form, error); });
        }
    };
    FormComponent.prototype.completeTaskForm = function (outcome) {
        var _this = this;
        if (this.form && this.form.taskId) {
            this.formService
                .completeTaskForm(this.form.taskId, this.form.values, outcome)
                .subscribe(function () {
                _this.onTaskCompleted(_this.form);
                _this.storeFormAsMetadata();
            }, function (error) { return _this.onTaskCompletedError(_this.form, error); });
        }
    };
    FormComponent.prototype.handleError = function (err) {
        this.onError.emit(err);
    };
    FormComponent.prototype.parseForm = function (json) {
        if (json) {
            var form = new FormModel(json, this.data, this.readOnly, this.formService);
            if (!json.fields) {
                form.outcomes = this.getFormDefinitionOutcomes(form);
            }
            if (this.fieldValidators && this.fieldValidators.length > 0) {
                form.fieldValidators = this.fieldValidators;
            }
            return form;
        }
        return null;
    };
    FormComponent.prototype.getFormDefinitionOutcomes = function (form) {
        return [
            new FormOutcomeModel(form, { id: '$custom', name: FormOutcomeModel.SAVE_ACTION, isSystem: true })
        ];
    };
    FormComponent.prototype.checkVisibility = function (field) {
        if (field && field.form) {
            this.visibilityService.refreshVisibility(field.form);
        }
    };
    FormComponent.prototype.refreshFormData = function () {
        this.form = this.parseForm(this.form.json);
        this.onFormLoaded(this.form);
        this.onFormDataRefreshed(this.form);
    };
    FormComponent.prototype.loadFormForEcmNode = function (nodeId) {
        var _this = this;
        this.nodeService.getNodeMetadata(nodeId).subscribe(function (data) {
            _this.data = data.metadata;
            _this.loadFormFromActiviti(data.nodeType);
        }, this.handleError);
    };
    FormComponent.prototype.loadFormFromActiviti = function (nodeType) {
        var _this = this;
        this.formService.searchFrom(nodeType).subscribe(function (form) {
            if (!form) {
                _this.formService.createFormFromANode(nodeType).subscribe(function (formMetadata) {
                    _this.loadFormFromFormId(formMetadata.id);
                });
            }
            else {
                _this.loadFormFromFormId(form.id);
            }
        }, function (error) {
            _this.handleError(error);
        });
    };
    FormComponent.prototype.loadFormFromFormId = function (formId) {
        this.formId = formId;
        this.loadForm();
    };
    FormComponent.prototype.storeFormAsMetadata = function () {
        var _this = this;
        if (this.saveMetadata) {
            this.ecmModelService.createEcmTypeForActivitiForm(this.formName, this.form).subscribe(function (type) {
                _this.nodeService.createNodeMetadata(type.nodeType || type.entry.prefixedName, EcmModelService.MODEL_NAMESPACE, _this.form.values, _this.path, _this.nameNode);
            }, function (error) {
                _this.handleError(error);
            });
        }
    };
    FormComponent.prototype.onFormLoaded = function (form) {
        this.formLoaded.emit(form);
        this.formService.formLoaded.next(new FormEvent(form));
    };
    FormComponent.prototype.onFormDataRefreshed = function (form) {
        this.formDataRefreshed.emit(form);
        this.formService.formDataRefreshed.next(new FormEvent(form));
    };
    FormComponent.prototype.onTaskSaved = function (form) {
        this.formSaved.emit(form);
        this.formService.taskSaved.next(new FormEvent(form));
    };
    FormComponent.prototype.onTaskSavedError = function (form, error) {
        this.handleError(error);
        this.formService.taskSavedError.next(new FormErrorEvent(form, error));
    };
    FormComponent.prototype.onTaskCompleted = function (form) {
        this.formCompleted.emit(form);
        this.formService.taskCompleted.next(new FormEvent(form));
    };
    FormComponent.prototype.onTaskCompletedError = function (form, error) {
        this.handleError(error);
        this.formService.taskCompletedError.next(new FormErrorEvent(form, error));
    };
    FormComponent.prototype.onExecuteOutcome = function (outcome) {
        var args = new FormOutcomeEvent(outcome);
        this.formService.executeOutcome.next(args);
        if (args.defaultPrevented) {
            return false;
        }
        this.executeOutcome.emit(args);
        if (args.defaultPrevented) {
            return false;
        }
        return true;
    };
    return FormComponent;
}());
FormComponent.SAVE_OUTCOME_ID = '$save';
FormComponent.COMPLETE_OUTCOME_ID = '$complete';
FormComponent.START_PROCESS_OUTCOME_ID = '$startProcess';
FormComponent.CUSTOM_OUTCOME_ID = '$custom';
FormComponent.COMPLETE_BUTTON_COLOR = 'primary';
FormComponent.COMPLETE_OUTCOME_NAME = 'Complete';
FormComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-form',
                template: "<div *ngIf=\"!hasForm()\">\n    <ng-content select=\"[empty-form]\">\n    </ng-content>\n</div>\n<div *ngIf=\"hasForm()\" class=\"{{form.className}} adf-form-container\">\n    <mat-card>\n        <mat-card-header>\n            <mat-card-title>\n                <h4 *ngIf=\"isTitleEnabled()\">\n                    <div *ngIf=\"showRefreshButton\" class=\"adf-form-reload-button\">\n                        <button mat-icon-button (click)=\"onRefreshClicked()\">\n                            <mat-icon>refresh</mat-icon>\n                        </button>\n                    </div>\n                    <span class=\"adf-form-title\">{{form.taskName}}</span>\n\n                </h4>\n            </mat-card-title>\n        </mat-card-header>\n        <mat-card-content>\n            <div *ngIf=\"form.hasTabs()\">\n                <tabs-widget [tabs]=\"form.tabs\" (formTabChanged)=\"onFieldChanged($event);\"></tabs-widget>\n            </div>\n\n            <div *ngIf=\"!form.hasTabs() && form.hasFields()\">\n                <div *ngFor=\"let field of form.fields\">\n                    <form-field [field]=\"field.field\"></form-field>\n                </div>\n            </div>\n        </mat-card-content>\n        <mat-card-actions *ngIf=\"form.hasOutcomes()\" class=\"adf-form-mat-card-actions\">\n            <!--[class.mdl-button--colored]=\"!outcome.isSystem\"-->\n            <button [id]=\"'adf-form-'+ outcome.name  | lowercase\" *ngFor=\"let outcome of form.outcomes\"\n                    [color]=\"getColorForOutcome(outcome.name)\"\n                    mat-button\n                    [disabled]=\"!isOutcomeButtonEnabled(outcome)\"\n                    [class.adf-form-hide-button]=\"!isOutcomeButtonVisible(outcome, form.readOnly)\"\n                    (click)=\"onOutcomeClicked(outcome, $event)\">\n                {{outcome.name | uppercase}}\n            </button>\n        </mat-card-actions>\n    </mat-card>\n</div>\n<!--\nFor debugging and data visualisation purposes,\nwill be removed during future revisions\n-->\n<div *ngIf=\"showDebugButton\" class=\"adf-form-debug-container\">\n    <mat-slide-toggle [(ngModel)]=\"debugMode\">Debug mode</mat-slide-toggle>\n    <div *ngIf=\"debugMode && hasForm()\">\n        <h4>Values</h4>\n        <pre>{{form.values | json}}</pre>\n\n        <h4>Form</h4>\n        <pre>{{form.json | json}}</pre>\n    </div>\n</div>\n",
                styles: [""],
                encapsulation: ViewEncapsulation.None
            },] },
];
FormComponent.ctorParameters = function () { return [
    { type: FormService, },
    { type: WidgetVisibilityService, },
    { type: EcmModelService, },
    { type: NodeService, },
]; };
FormComponent.propDecorators = {
    "form": [{ type: Input },],
    "taskId": [{ type: Input },],
    "nodeId": [{ type: Input },],
    "formId": [{ type: Input },],
    "formName": [{ type: Input },],
    "saveMetadata": [{ type: Input },],
    "data": [{ type: Input },],
    "path": [{ type: Input },],
    "nameNode": [{ type: Input },],
    "showTitle": [{ type: Input },],
    "showCompleteButton": [{ type: Input },],
    "disableCompleteButton": [{ type: Input },],
    "disableStartProcessButton": [{ type: Input },],
    "showSaveButton": [{ type: Input },],
    "showDebugButton": [{ type: Input },],
    "readOnly": [{ type: Input },],
    "showRefreshButton": [{ type: Input },],
    "showValidationIcon": [{ type: Input },],
    "fieldValidators": [{ type: Input },],
    "formSaved": [{ type: Output },],
    "formCompleted": [{ type: Output },],
    "formContentClicked": [{ type: Output },],
    "formLoaded": [{ type: Output },],
    "formDataRefreshed": [{ type: Output },],
    "executeOutcome": [{ type: Output },],
    "onError": [{ type: Output },],
};
var FormListComponent = /** @class */ (function () {
    function FormListComponent(formService) {
        this.formService = formService;
        this.forms = [];
    }
    FormListComponent.prototype.ngOnChanges = function (changes) {
        this.getForms();
    };
    FormListComponent.prototype.isEmpty = function () {
        return this.forms && this.forms.length === 0;
    };
    FormListComponent.prototype.getForms = function () {
        var _this = this;
        this.formService.getForms().subscribe(function (forms) {
            (_a = _this.forms).push.apply(_a, __spread(forms));
            var _a;
        });
    };
    return FormListComponent;
}());
FormListComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-form-list',
                template: "<adf-datatable *ngIf=\"!isEmpty()\"\n    [rows]=\"forms\">\n    <data-columns>\n        <data-column key=\"name\" type=\"text\" title=\"Name\" class=\"ellipsis-cell\" [sortable]=\"true\"></data-column>\n        <data-column key=\"lastUpdatedByFullName\" type=\"text\" title=\"User\" class=\"ellipsis-cell\" [sortable]=\"true\"></data-column>\n        <data-column key=\"lastUpdated\" type=\"date\" format=\"shortDate\" title=\"Date\"></data-column>\n    </data-columns>\n</adf-datatable>\n",
                styles: [""],
                encapsulation: ViewEncapsulation.None
            },] },
];
FormListComponent.ctorParameters = function () { return [
    { type: FormService, },
]; };
FormListComponent.propDecorators = {
    "forms": [{ type: Input },],
};
var ProcessContentService = /** @class */ (function () {
    function ProcessContentService(apiService, logService) {
        this.apiService = apiService;
        this.logService = logService;
    }
    Object.defineProperty(ProcessContentService.prototype, "contentApi", {
        get: function () {
            return this.apiService.getInstance().activiti.contentApi;
        },
        enumerable: true,
        configurable: true
    });
    ProcessContentService.prototype.createTemporaryRawRelatedContent = function (file) {
        var _this = this;
        return Observable.fromPromise(this.contentApi.createTemporaryRawRelatedContent(file)).catch(function (err) { return _this.handleError(err); });
    };
    ProcessContentService.prototype.getFileContent = function (contentId) {
        var _this = this;
        return Observable.fromPromise(this.contentApi.getContent(contentId)).catch(function (err) { return _this.handleError(err); });
    };
    ProcessContentService.prototype.getFileRawContent = function (contentId) {
        var _this = this;
        return Observable.fromPromise(this.contentApi.getRawContent(contentId)).catch(function (err) { return _this.handleError(err); });
    };
    ProcessContentService.prototype.getContentPreview = function (contentId) {
        var _this = this;
        return new Observable(function (observer) {
            _this.contentApi.getContentPreview(contentId).then(function (result) {
                observer.next(result);
                observer.complete();
            }, function () {
                _this.contentApi.getRawContent(contentId).then(function (data) {
                    observer.next(data);
                    observer.complete();
                }, function (err) {
                    observer.error(err);
                    observer.complete();
                });
            });
        });
    };
    ProcessContentService.prototype.getFileRawContentUrl = function (contentId) {
        return this.contentApi.getRawContentUrl(contentId);
    };
    ProcessContentService.prototype.getContentThumbnail = function (contentId) {
        var _this = this;
        return Observable.fromPromise(this.contentApi.getContentThumbnail(contentId)).catch(function (err) { return _this.handleError(err); });
    };
    ProcessContentService.prototype.getTaskRelatedContent = function (taskId) {
        var _this = this;
        return Observable.fromPromise(this.contentApi.getRelatedContentForTask(taskId))
            .catch(function (err) { return _this.handleError(err); });
    };
    ProcessContentService.prototype.getProcessRelatedContent = function (processId) {
        var _this = this;
        return Observable.fromPromise(this.contentApi.getRelatedContentForProcessInstance(processId))
            .catch(function (err) { return _this.handleError(err); });
    };
    ProcessContentService.prototype.deleteRelatedContent = function (contentId) {
        var _this = this;
        return Observable.fromPromise(this.contentApi.deleteContent(contentId))
            .catch(function (err) { return _this.handleError(err); });
    };
    ProcessContentService.prototype.createProcessRelatedContent = function (processInstanceId, content, opts) {
        var _this = this;
        return Observable.fromPromise(this.contentApi.createRelatedContentOnProcessInstance(processInstanceId, content, opts))
            .catch(function (err) { return _this.handleError(err); });
    };
    ProcessContentService.prototype.createTaskRelatedContent = function (taskId, file, opts) {
        var _this = this;
        return Observable.fromPromise(this.contentApi.createRelatedContentOnTask(taskId, file, opts))
            .catch(function (err) { return _this.handleError(err); });
    };
    ProcessContentService.prototype.toJson = function (res) {
        if (res) {
            return res || {};
        }
        return {};
    };
    ProcessContentService.prototype.toJsonArray = function (res) {
        if (res) {
            return res.data || [];
        }
        return [];
    };
    ProcessContentService.prototype.handleError = function (error) {
        var errMsg = ProcessContentService.UNKNOWN_ERROR_MESSAGE;
        if (error) {
            errMsg = (error.message) ? error.message :
                error.status ? error.status + " - " + error.statusText : ProcessContentService.GENERIC_ERROR_MESSAGE;
        }
        this.logService.error(errMsg);
        return Observable.throw(errMsg);
    };
    return ProcessContentService;
}());
ProcessContentService.UNKNOWN_ERROR_MESSAGE = 'Unknown error';
ProcessContentService.GENERIC_ERROR_MESSAGE = 'Server error';
ProcessContentService.decorators = [
    { type: Injectable },
];
ProcessContentService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: LogService, },
]; };
var ContentWidgetComponent = /** @class */ (function () {
    function ContentWidgetComponent(formService, logService, contentService, processContentService) {
        this.formService = formService;
        this.logService = logService;
        this.contentService = contentService;
        this.processContentService = processContentService;
        this.showDocumentContent = true;
        this.contentClick = new EventEmitter();
        this.thumbnailLoaded = new EventEmitter();
        this.contentLoaded = new EventEmitter();
        this.error = new EventEmitter();
    }
    ContentWidgetComponent.prototype.ngOnChanges = function (changes) {
        var contentId = changes['id'];
        if (contentId && contentId.currentValue) {
            this.loadContent(contentId.currentValue);
        }
    };
    ContentWidgetComponent.prototype.loadContent = function (id) {
        var _this = this;
        this.processContentService
            .getFileContent(id)
            .subscribe(function (response) {
            _this.content = new ContentLinkModel(response);
            _this.contentLoaded.emit(_this.content);
            _this.loadThumbnailUrl(_this.content);
        }, function (error) {
            _this.error.emit(error);
        });
    };
    ContentWidgetComponent.prototype.loadThumbnailUrl = function (content) {
        var _this = this;
        if (this.content.isThumbnailSupported()) {
            var observable = void 0;
            if (this.content.isTypeImage()) {
                observable = this.processContentService.getFileRawContent(content.id);
            }
            else {
                observable = this.processContentService.getContentThumbnail(content.id);
            }
            if (observable) {
                observable.subscribe(function (response) {
                    _this.content.thumbnailUrl = _this.contentService.createTrustedUrl(response);
                    _this.thumbnailLoaded.emit(_this.content.thumbnailUrl);
                }, function (error) {
                    _this.error.emit(error);
                });
            }
        }
    };
    ContentWidgetComponent.prototype.openViewer = function (content) {
        var _this = this;
        var fetch = this.processContentService.getContentPreview(content.id);
        if (content.isTypeImage() || content.isTypePdf()) {
            fetch = this.processContentService.getFileRawContent(content.id);
        }
        fetch.subscribe(function (blob) {
            content.contentBlob = blob;
            _this.contentClick.emit(content);
            _this.logService.info('Content clicked' + content.id);
            _this.formService.formContentClicked.next(content);
        }, function (error) {
            _this.error.emit(error);
        });
    };
    ContentWidgetComponent.prototype.download = function (content) {
        var _this = this;
        this.processContentService.getFileRawContent(content.id).subscribe(function (blob) { return _this.contentService.downloadBlob(blob, content.name); }, function (error) {
            _this.error.emit(error);
        });
    };
    return ContentWidgetComponent;
}());
ContentWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-content',
                template: "<mat-card class=\"adf-content-container\" *ngIf=\"content\">\n    <mat-card-content *ngIf=\"showDocumentContent\">\n        <div *ngIf=\"content.isThumbnailSupported()\" >\n            <img id=\"thumbnailPreview\" class=\"adf-img-upload-widget\" [src]=\"content.thumbnailUrl\" alt=\"{{content.name}}\">\n        </div>\n        <div *ngIf=\"!content.isThumbnailSupported()\">\n            <mat-icon>image</mat-icon>\n            <div id=\"unsupported-thumbnail\" class=\"adf-content-widget-preview-text\">{{ 'FORM.PREVIEW.IMAGE_NOT_AVAILABLE' | translate }}\n            </div>\n        </div>\n        <div class=\"mdl-card__supporting-text upload-widget__content-text\">{{content.name}}</div>\n    </mat-card-content>\n\n    <mat-card-actions>\n        <button mat-icon-button id=\"view\" (click)=\"openViewer(content)\">\n            <mat-icon class=\"mat-24\">zoom_in</mat-icon>\n        </button>\n        <button mat-icon-button id=\"download\" (click)=\"download(content)\">\n            <mat-icon class=\"mat-24\">file_download</mat-icon>\n        </button>\n    </mat-card-actions>\n</mat-card>\n",
                styles: [".adf-img-upload-widget{width:100%;height:100%;border:1px solid rgba(117,117,117,.57);-webkit-box-shadow:1px 1px 2px #ddd;box-shadow:1px 1px 2px #ddd;background-color:#fff}.adf-content-widget-preview-text{word-wrap:break-word;word-break:break-all;text-align:center}"],
                encapsulation: ViewEncapsulation.None
            },] },
];
ContentWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
    { type: LogService, },
    { type: ContentService, },
    { type: ProcessContentService, },
]; };
ContentWidgetComponent.propDecorators = {
    "id": [{ type: Input },],
    "showDocumentContent": [{ type: Input },],
    "contentClick": [{ type: Output },],
    "thumbnailLoaded": [{ type: Output },],
    "contentLoaded": [{ type: Output },],
    "error": [{ type: Output },],
};
var StartFormComponent = /** @class */ (function (_super) {
    __extends(StartFormComponent, _super);
    function StartFormComponent(formService, visibilityService, logService) {
        var _this = _super.call(this, formService, visibilityService, null, null) || this;
        _this.showOutcomeButtons = true;
        _this.showRefreshButton = true;
        _this.readOnlyForm = false;
        _this.outcomeClick = new EventEmitter();
        _this.formContentClicked = new EventEmitter();
        _this.outcomesContainer = null;
        _this.showTitle = false;
        return _this;
    }
    StartFormComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.formService.formContentClicked.subscribe(function (content) {
            _this.formContentClicked.emit(content);
        });
    };
    StartFormComponent.prototype.ngOnChanges = function (changes) {
        var processDefinitionId = changes['processDefinitionId'];
        if (processDefinitionId && processDefinitionId.currentValue) {
            this.visibilityService.cleanProcessVariable();
            this.getStartFormDefinition(processDefinitionId.currentValue);
            return;
        }
        var processId = changes['processId'];
        if (processId && processId.currentValue) {
            this.visibilityService.cleanProcessVariable();
            this.loadStartForm(processId.currentValue);
            return;
        }
    };
    StartFormComponent.prototype.loadStartForm = function (processId) {
        var _this = this;
        this.formService.getProcessIntance(processId)
            .subscribe(function (intance) {
            _this.formService
                .getStartFormInstance(processId)
                .subscribe(function (form) {
                _this.formName = form.name;
                if (intance.variables) {
                    form.processVariables = intance.variables;
                }
                _this.form = _this.parseForm(form);
                _this.visibilityService.refreshVisibility(_this.form);
                _this.form.validateForm();
                _this.form.readOnly = _this.readOnlyForm;
                _this.onFormLoaded(_this.form);
            }, function (error) { return _this.handleError(error); });
        });
    };
    StartFormComponent.prototype.getStartFormDefinition = function (processId) {
        var _this = this;
        this.formService
            .getStartFormDefinition(processId)
            .subscribe(function (form) {
            _this.formName = form.processDefinitionName;
            _this.form = _this.parseForm(form);
            _this.visibilityService.refreshVisibility(_this.form);
            _this.form.validateForm();
            _this.form.readOnly = _this.readOnlyForm;
            _this.onFormLoaded(_this.form);
        }, function (error) { return _this.handleError(error); });
    };
    StartFormComponent.prototype.isOutcomeButtonVisible = function (outcome, isFormReadOnly) {
        if (outcome && outcome.isSystem && (outcome.name === FormOutcomeModel.SAVE_ACTION ||
            outcome.name === FormOutcomeModel.COMPLETE_ACTION)) {
            return false;
        }
        else if (outcome && outcome.name === FormOutcomeModel.START_PROCESS_ACTION) {
            return true;
        }
        return _super.prototype.isOutcomeButtonVisible.call(this, outcome, isFormReadOnly);
    };
    StartFormComponent.prototype.saveTaskForm = function () {
    };
    StartFormComponent.prototype.onRefreshClicked = function () {
        if (this.processDefinitionId) {
            this.visibilityService.cleanProcessVariable();
            this.getStartFormDefinition(this.processDefinitionId);
        }
        else if (this.processId) {
            this.visibilityService.cleanProcessVariable();
            this.loadStartForm(this.processId);
        }
    };
    StartFormComponent.prototype.completeTaskForm = function (outcome) {
        this.outcomeClick.emit(outcome);
    };
    return StartFormComponent;
}(FormComponent));
StartFormComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-start-form',
                template: "<div class=\"adf-start-form-container\" *ngIf=\"hasForm()\">\n    <mat-card>\n        <mat-card-header>\n            <mat-card-title>\n                <h2 *ngIf=\"isTitleEnabled()\" class=\"mdl-card__title-text\">{{form.taskName}}</h2>\n            </mat-card-title>\n        </mat-card-header>\n        <mat-card-content>\n            <div *ngIf=\"form.hasTabs()\">\n                <tabs-widget [tabs]=\"form.tabs\" (formTabChanged)=\"checkVisibility($event);\"></tabs-widget>\n            </div>\n\n            <div *ngIf=\"!form.hasTabs() && form.hasFields()\">\n                <div *ngFor=\"let field of form.fields\">\n                    <form-field [field]=\"field.field\"></form-field>\n                </div>\n            </div>\n        </mat-card-content>\n        <mat-card-content class=\"adf-start-form-actions\" *ngIf=\"showOutcomeButtons && form.hasOutcomes()\" #outcomesContainer>\n             <ng-content select=\"[form-custom-button]\"></ng-content>\n            <button *ngFor=\"let outcome of form.outcomes\"\n                    mat-button\n                    [attr.data-automation-id]=\"'adf-form-' + outcome.name  | lowercase\"\n                    [disabled]=\"!isOutcomeButtonEnabled(outcome)\"\n                    [class.mdl-button--colored]=\"!outcome.isSystem\"\n                    [class.adf-form-hide-button]=\"!isOutcomeButtonVisible(outcome, form.readOnly)\"\n                    (click)=\"onOutcomeClicked(outcome, $event)\">\n                {{outcome.name}}\n            </button>\n        </mat-card-content>\n        <mat-card-actions *ngIf=\"showRefreshButton\">\n            <button mat-button\n                    (click)=\"onRefreshClicked()\">\n                <mat-icon>refresh</mat-icon>\n            </button>\n        </mat-card-actions>\n    </mat-card>\n</div>\n",
                styles: [""],
                encapsulation: ViewEncapsulation.None
            },] },
];
StartFormComponent.ctorParameters = function () { return [
    { type: FormService, },
    { type: WidgetVisibilityService, },
    { type: LogService, },
]; };
StartFormComponent.propDecorators = {
    "processDefinitionId": [{ type: Input },],
    "processId": [{ type: Input },],
    "showOutcomeButtons": [{ type: Input },],
    "showRefreshButton": [{ type: Input },],
    "readOnlyForm": [{ type: Input },],
    "outcomeClick": [{ type: Output },],
    "formContentClicked": [{ type: Output },],
    "outcomesContainer": [{ type: ViewChild, args: ['outcomesContainer', {},] },],
};
var baseHost = {
    '(click)': 'event($event)',
    '(blur)': 'event($event)',
    '(change)': 'event($event)',
    '(focus)': 'event($event)',
    '(focusin)': 'event($event)',
    '(focusout)': 'event($event)',
    '(input)': 'event($event)',
    '(invalid)': 'event($event)',
    '(select)': 'event($event)'
};
var WidgetComponent = /** @class */ (function () {
    function WidgetComponent(formService) {
        this.formService = formService;
        this.readOnly = false;
        this.fieldChanged = new EventEmitter();
    }
    WidgetComponent.prototype.hasField = function () {
        return this.field ? true : false;
    };
    WidgetComponent.prototype.isRequired = function () {
        if (this.field && this.field.required) {
            return true;
        }
        return null;
    };
    WidgetComponent.prototype.isValid = function () {
        return this.field.validationSummary ? true : false;
    };
    WidgetComponent.prototype.hasValue = function () {
        return this.field &&
            this.field.value !== null &&
            this.field.value !== undefined;
    };
    WidgetComponent.prototype.isInvalidFieldRequired = function () {
        return !this.field.isValid && !this.field.validationSummary && this.isRequired();
    };
    WidgetComponent.prototype.ngAfterViewInit = function () {
        this.fieldChanged.emit(this.field);
    };
    WidgetComponent.prototype.checkVisibility = function (field) {
        this.fieldChanged.emit(field);
    };
    WidgetComponent.prototype.onFieldChanged = function (field) {
        this.fieldChanged.emit(field);
    };
    WidgetComponent.prototype.getHyperlinkUrl = function (field) {
        var url = WidgetComponent.DEFAULT_HYPERLINK_URL;
        if (field && field.hyperlinkUrl) {
            url = field.hyperlinkUrl;
            if (!/^https?:\/\//i.test(url)) {
                url = "" + WidgetComponent.DEFAULT_HYPERLINK_SCHEME + url;
            }
        }
        return url;
    };
    WidgetComponent.prototype.getHyperlinkText = function (field) {
        if (field) {
            return field.displayText || field.hyperlinkUrl;
        }
        return null;
    };
    WidgetComponent.prototype.event = function (event) {
        this.formService.formEvents.next(event);
    };
    return WidgetComponent;
}());
WidgetComponent.DEFAULT_HYPERLINK_URL = '#';
WidgetComponent.DEFAULT_HYPERLINK_SCHEME = 'http://';
WidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'base-widget',
                template: '',
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
WidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
]; };
WidgetComponent.propDecorators = {
    "readOnly": [{ type: Input },],
    "field": [{ type: Input },],
    "fieldChanged": [{ type: Output },],
};
var ContainerWidgetComponentModel = /** @class */ (function (_super) {
    __extends(ContainerWidgetComponentModel, _super);
    function ContainerWidgetComponentModel(field) {
        var _this = _super.call(this, field) || this;
        _this.columns = [];
        _this.isExpanded = true;
        _this.rowspan = 1;
        _this.colspan = 1;
        if (_this.field) {
            _this.columns = _this.field.columns || [];
            _this.isExpanded = !_this.isCollapsedByDefault();
            _this.colspan = field.colspan;
            _this.rowspan = field.rowspan;
        }
        return _this;
    }
    ContainerWidgetComponentModel.prototype.isGroup = function () {
        return this.type === FormFieldTypes.GROUP;
    };
    ContainerWidgetComponentModel.prototype.isCollapsible = function () {
        var allowCollapse = false;
        if (this.isGroup() && this.field.params['allowCollapse']) {
            allowCollapse = (this.field.params['allowCollapse']);
        }
        return allowCollapse;
    };
    ContainerWidgetComponentModel.prototype.isCollapsedByDefault = function () {
        var collapseByDefault = false;
        if (this.isCollapsible() && this.field.params['collapseByDefault']) {
            collapseByDefault = (this.field.params['collapseByDefault']);
        }
        return collapseByDefault;
    };
    return ContainerWidgetComponentModel;
}(ContainerModel));
var ContainerWidgetComponent = /** @class */ (function (_super) {
    __extends(ContainerWidgetComponent, _super);
    function ContainerWidgetComponent(formService) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        return _this;
    }
    ContainerWidgetComponent.prototype.onExpanderClicked = function () {
        if (this.content && this.content.isCollapsible()) {
            this.content.isExpanded = !this.content.isExpanded;
        }
    };
    ContainerWidgetComponent.prototype.ngOnInit = function () {
        if (this.field) {
            this.content = new ContainerWidgetComponentModel(this.field);
        }
    };
    Object.defineProperty(ContainerWidgetComponent.prototype, "fields", {
        get: function () {
            var fields = [];
            var rowContainsElement = true, rowIndex = 0;
            while (rowContainsElement) {
                rowContainsElement = false;
                for (var i = 0; i < this.content.columns.length; i++) {
                    var field = this.content.columns[i].fields[rowIndex];
                    if (field) {
                        rowContainsElement = true;
                    }
                    fields.push(field);
                }
                rowIndex++;
            }
            return fields;
        },
        enumerable: true,
        configurable: true
    });
    ContainerWidgetComponent.prototype.getColumnWith = function (field) {
        var colspan = field ? field.colspan : 1;
        return (100 / this.content.json.numberOfColumns) * colspan + '%';
    };
    return ContainerWidgetComponent;
}(WidgetComponent));
ContainerWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'container-widget',
                template: "<div [hidden]=\"!content?.isGroup()\" class=\"container-widget__header\">\n    <h4 class=\"container-widget__header-text\" id=\"container-header\"\n        [class.collapsible]=\"content?.isCollapsible()\">\n        <button *ngIf=\"content?.isCollapsible()\"\n                mat-icon-button\n                class=\"mdl-button--icon\"\n                (click)=\"onExpanderClicked()\">\n            <mat-icon>{{ content?.isExpanded ? 'expand_more' : 'expand_less' }}</mat-icon>\n        </button>\n        <span (click)=\"onExpanderClicked()\" id=\"container-header-label\">{{content.name}}</span>\n    </h4>\n</div>\n\n<section class=\"grid-list\" *ngIf=\"content?.isExpanded\">\n    <div class=\"grid-list-item\" *ngFor=\"let field of fields\" [style.width]=\"getColumnWith(field)\">\n        <form-field *ngIf=\"field\" [field]=\"field\"></form-field>\n    </div>\n</section>\n\n\n",
                styles: [""],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
ContainerWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
]; };
var TabsWidgetComponent = /** @class */ (function () {
    function TabsWidgetComponent() {
        this.tabs = [];
        this.formTabChanged = new EventEmitter();
        this.visibleTabs = [];
    }
    TabsWidgetComponent.prototype.hasTabs = function () {
        return this.tabs && this.tabs.length > 0;
    };
    TabsWidgetComponent.prototype.ngAfterContentChecked = function () {
        this.filterVisibleTabs();
    };
    TabsWidgetComponent.prototype.filterVisibleTabs = function () {
        this.visibleTabs = this.tabs.filter(function (tab) {
            return tab.isVisible;
        });
    };
    TabsWidgetComponent.prototype.tabChanged = function (field) {
        this.formTabChanged.emit(field);
    };
    return TabsWidgetComponent;
}());
TabsWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'tabs-widget',
                template: "<div *ngIf=\"hasTabs()\" class=\"alfresco-tabs-widget\">\n    <mat-tab-group>\n        <mat-tab *ngFor=\"let tab of visibleTabs\" [label]=\"tab.title\">\n            <div *ngFor=\"let field of tab.fields\">\n                <form-field [field]=\"field.field\"></form-field>\n             </div>\n        </mat-tab>\n    </mat-tab-group>\n</div>\n",
                encapsulation: ViewEncapsulation.None
            },] },
];
TabsWidgetComponent.ctorParameters = function () { return []; };
TabsWidgetComponent.propDecorators = {
    "tabs": [{ type: Input },],
    "formTabChanged": [{ type: Output },],
};
var UnknownWidgetComponent = /** @class */ (function (_super) {
    __extends(UnknownWidgetComponent, _super);
    function UnknownWidgetComponent(formService) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        return _this;
    }
    return UnknownWidgetComponent;
}(WidgetComponent));
UnknownWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'unknown-widget',
                template: "\n            <mat-list class=\"adf-unknown-widget\">\n                <mat-list-item>\n                     <mat-icon class=\"mat-24\">error_outline</mat-icon>\n                     <span class=\"adf-unknown-text\">Unknown type: {{field.type}}</span>\n                </mat-list-item>\n            </mat-list>\n\n    ",
                styles: [".adf-unknown-text{margin-left:10px;color:red}.adf-unknown-widget{margin:42px}"],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
UnknownWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
]; };
var AmountWidgetComponent = /** @class */ (function (_super) {
    __extends(AmountWidgetComponent, _super);
    function AmountWidgetComponent(formService) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        _this.currency = AmountWidgetComponent.DEFAULT_CURRENCY;
        return _this;
    }
    AmountWidgetComponent.prototype.ngOnInit = function () {
        if (this.field && this.field.currency) {
            this.currency = this.field.currency;
        }
    };
    return AmountWidgetComponent;
}(WidgetComponent));
AmountWidgetComponent.DEFAULT_CURRENCY = '$';
AmountWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'amount-widget',
                template: "<div class=\"adf-amount-widget__container adf-amount-widget {{field.className}}\" [class.adf-invalid]=\"!field.isValid\" [class.adf-readonly]=\"field.readOnly\">\n    <mat-form-field floatPlaceholder=\"never\" class=\"adf-amount-widget__input\">\n        <label class=\"adf-label\" [attr.for]=\"field.id\">{{field.name}}<span *ngIf=\"isRequired()\">*</span></label>\n        <span matPrefix class=\"adf-amount-widget__prefix-spacing\"> {{currency }}</span>\n        <input matInput\n                class=\"adf-amount-widget\"\n                type=\"text\"\n                [id]=\"field.id\"\n                [required]=\"isRequired()\"\n                [value]=\"field.value\"\n                [(ngModel)]=\"field.value\"\n                (ngModelChange)=\"onFieldChanged(field)\"\n                [disabled]=\"field.readOnly\"\n                placeholder=\"{{field.placeholder}}\">\n    </mat-form-field>\n    <error-widget [error]=\"field.validationSummary\" ></error-widget>\n    <error-widget *ngIf=\"isInvalidFieldRequired()\" required=\"{{ 'FORM.FIELD.REQUIRED' | translate }}\"></error-widget>\n</div>\n\n",
                styles: [".adf-amount-widget{width:100%;vertical-align:baseline!important}.adf-amount-widget .mat-input-element{margin-left:11px}.adf-amount-widget .mat-input-prefix{position:absolute;margin-top:58px}.adf-amount-widget .mat-input-placeholder{margin-top:5px;display:none}.adf-amount-widget__container{max-width:100%}.adf-amount-widget__container .mat-input-placeholder-wrapper{top:0!important;left:13px}.adf-amount-widget__input .mat-focused{-webkit-transition:none;transition:none}.adf-amount-widget__prefix-spacing{padding-right:5px}"],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
AmountWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
]; };
var CheckboxWidgetComponent = /** @class */ (function (_super) {
    __extends(CheckboxWidgetComponent, _super);
    function CheckboxWidgetComponent(formService) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        return _this;
    }
    return CheckboxWidgetComponent;
}(WidgetComponent));
CheckboxWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'checkbox-widget',
                template: "<div [ngClass]=\"field.className\">\n    <mat-checkbox\n        [id]=\"field.id\"\n        color=\"primary\"\n        [required]=\"field.required\"\n        [disabled]=\"field.readOnly || readOnly\"\n        [(ngModel)]=\"field.value\"\n        (ngModelChange)=\"onFieldChanged(field)\">\n        {{field.name}}\n        <span *ngIf=\"field.required\">*</span>\n    </mat-checkbox>\n</div>\n",
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
CheckboxWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
]; };
var 0$1 = MOMENT_DATE_FORMATS;
var DateWidgetComponent = /** @class */ (function (_super) {
    __extends(DateWidgetComponent, _super);
    function DateWidgetComponent(formService, dateAdapter, preferences) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        _this.dateAdapter = dateAdapter;
        _this.preferences = preferences;
        return _this;
    }
    DateWidgetComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.preferences.locale$.subscribe(function (locale) {
            _this.dateAdapter.setLocale(locale);
        });
        var momentDateAdapter = (this.dateAdapter);
        momentDateAdapter.overrideDisplyaFormat = this.field.dateDisplayFormat;
        if (this.field) {
            if (this.field.minValue) {
                this.minDate = moment(this.field.minValue, 'DD/MM/YYYY');
            }
            if (this.field.maxValue) {
                this.maxDate = moment(this.field.maxValue, 'DD/MM/YYYY');
            }
        }
        this.displayDate = moment(this.field.value, this.field.dateDisplayFormat);
    };
    DateWidgetComponent.prototype.onDateChanged = function (newDateValue) {
        if (newDateValue && newDateValue.value) {
            this.field.value = newDateValue.value.format(this.field.dateDisplayFormat);
        }
        else if (newDateValue) {
            this.field.value = newDateValue;
        }
        else {
            this.field.value = null;
        }
        this.onFieldChanged(this.field);
    };
    return DateWidgetComponent;
}(WidgetComponent));
DateWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'date-widget',
                providers: [
                    { provide: DateAdapter, useClass: MomentDateAdapter },
                    { provide: MAT_DATE_FORMATS, useValue: 0$1 }
                ],
                template: "<div class=\"{{field.className}}\" id=\"data-widget\" [class.adf-invalid]=\"!field.isValid\">\n    <mat-form-field class=\"adf-date-widget\">\n        <label class=\"adf-label\" [attr.for]=\"field.id\">{{field.name}} ({{field.dateDisplayFormat}})<span *ngIf=\"isRequired()\">*</span></label>\n        <input matInput\n               [id]=\"field.id\"\n               [matDatepicker]=\"datePicker\"\n               [(ngModel)]=\"displayDate\"\n               [required]=\"isRequired()\"\n               [disabled]=\"field.readOnly\"\n               [min]=\"minDate\"\n               [max]=\"maxDate\"\n               (focusout)=\"onDateChanged($event.srcElement.value)\"\n               (dateChange)=\"onDateChanged($event)\"\n               placeholder=\"{{field.placeholder}}\">\n        <mat-datepicker-toggle  matSuffix [for]=\"datePicker\" [disabled]=\"field.readOnly\" ></mat-datepicker-toggle>\n    </mat-form-field>\n    <error-widget [error]=\"field.validationSummary\"></error-widget>\n    <error-widget *ngIf=\"isInvalidFieldRequired()\" required=\"{{ 'FORM.FIELD.REQUIRED' | translate }}\"></error-widget>\n    <mat-datepicker #datePicker [touchUi]=\"true\" [startAt]=\"displayDate\" ></mat-datepicker>\n</div>\n\n",
                styles: [".adf-date-widget .mat-input-suffix{text-align:right;position:absolute;margin-top:30px;width:100%}.adf-date-widget-date-widget-button{position:relative;float:right}.adf-date-widget-date-input{padding-top:5px;padding-bottom:5px}.adf-date-widget-grid-date-widget{-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0}.adf-date-widget-date-widget-button__cell{margin-top:0;margin-bottom:0}"],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
DateWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
    { type: DateAdapter, },
    { type: UserPreferencesService, },
]; };
var DisplayTextWidgetComponentComponent = /** @class */ (function (_super) {
    __extends(DisplayTextWidgetComponentComponent, _super);
    function DisplayTextWidgetComponentComponent(formService) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        return _this;
    }
    return DisplayTextWidgetComponentComponent;
}(WidgetComponent));
DisplayTextWidgetComponentComponent.decorators = [
    { type: Component, args: [{
                selector: 'display-text-widget',
                template: "<div class=\"adf-display-text-widget {{field.className}}\">{{field.value}}</div>\n",
                styles: [".adf-display-text-widget{white-space:pre-wrap}"],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
DisplayTextWidgetComponentComponent.ctorParameters = function () { return [
    { type: FormService, },
]; };
var DocumentWidgetComponent = /** @class */ (function (_super) {
    __extends(DocumentWidgetComponent, _super);
    function DocumentWidgetComponent(formService) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        _this.fileId = null;
        _this.hasFile = false;
        return _this;
    }
    DocumentWidgetComponent.prototype.ngOnInit = function () {
        if (this.field) {
            var file = this.field.value;
            if (file) {
                this.fileId = file.id;
                this.hasFile = true;
            }
            else {
                this.fileId = null;
                this.hasFile = false;
            }
        }
    };
    return DocumentWidgetComponent;
}(WidgetComponent));
DocumentWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-form-document-widget',
                template: "<div class=\"adf-form-document-widget {{field.className}}\">\n    <ng-container *ngIf=\"hasFile\">\n        <adf-content [id]=\"fileId\" [showDocumentContent]=\"true\"></adf-content>\n    </ng-container>\n</div>\n",
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
DocumentWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
]; };
var DropdownWidgetComponent = /** @class */ (function (_super) {
    __extends(DropdownWidgetComponent, _super);
    function DropdownWidgetComponent(formService, logService) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        _this.logService = logService;
        return _this;
    }
    DropdownWidgetComponent.prototype.ngOnInit = function () {
        if (this.field && this.field.restUrl) {
            if (this.field.form.taskId) {
                this.getValuesByTaskId();
            }
            else {
                this.getValuesByProcessDefinitionId();
            }
        }
    };
    DropdownWidgetComponent.prototype.getValuesByTaskId = function () {
        var _this = this;
        this.formService
            .getRestFieldValues(this.field.form.taskId, this.field.id)
            .subscribe(function (result) {
            var options = [];
            if (_this.field.emptyOption) {
                options.push(_this.field.emptyOption);
            }
            _this.field.options = options.concat((result || []));
            _this.field.updateForm();
        }, function (err) { return _this.handleError(err); });
    };
    DropdownWidgetComponent.prototype.getValuesByProcessDefinitionId = function () {
        var _this = this;
        this.formService
            .getRestFieldValuesByProcessId(this.field.form.processDefinitionId, this.field.id)
            .subscribe(function (result) {
            var options = [];
            if (_this.field.emptyOption) {
                options.push(_this.field.emptyOption);
            }
            _this.field.options = options.concat((result || []));
            _this.field.updateForm();
        }, function (err) { return _this.handleError(err); });
    };
    DropdownWidgetComponent.prototype.getOptionValue = function (option, fieldValue) {
        var optionValue = '';
        if (option.id === 'empty' || option.name !== fieldValue) {
            optionValue = option.id;
        }
        else {
            optionValue = option.name;
        }
        return optionValue;
    };
    DropdownWidgetComponent.prototype.handleError = function (error) {
        this.logService.error(error);
    };
    DropdownWidgetComponent.prototype.isReadOnlyType = function () {
        return this.field.type === 'readonly' ? true : false;
    };
    return DropdownWidgetComponent;
}(WidgetComponent));
DropdownWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'dropdown-widget',
                template: "<div class=\"adf-dropdown-widget {{field.className}}\"\n     [class.adf-invalid]=\"!field.isValid\" [class.adf-readonly]=\"field.readOnly\">\n    <label class=\"adf-label\" [attr.for]=\"field.id\">{{field.name}}<span *ngIf=\"isRequired()\">*</span></label>\n    <mat-form-field>\n        <mat-select class=\"adf-select\"\n                    [id]=\"field.id\"\n                    [(ngModel)]=\"field.value\"\n                    [disabled]=\"field.readOnly\"\n                    (ngModelChange)=\"onFieldChanged(field)\">\n            <mat-option *ngFor=\"let opt of field.options\"\n                        [value]=\"getOptionValue(opt, field.value)\"\n                        [id]=\"opt.id\">{{opt.name}}\n            </mat-option>\n            <mat-option id=\"readonlyOption\" *ngIf=\"isReadOnlyType()\" [value]=\"field.value\">{{field.value}}</mat-option>\n        </mat-select>\n    </mat-form-field>\n    <error-widget [error]=\"field.validationSummary\"></error-widget>\n    <error-widget class=\"adf-dropdown-required-message\" *ngIf=\"isInvalidFieldRequired()\"\n                  required=\"{{ 'FORM.FIELD.REQUIRED' | translate }}\"></error-widget>\n</div>\n",
                styles: [".adf-dropdown-widget{width:100%;margin-top:13px}.adf-dropdown-widget .adf-select{padding-top:0!important;width:100%}.adf-dropdown-widget .mat-select-value-text{font-size:14px}.adf-dropdown-widget-select{width:100%}.adf-dropdown-widget-dropdown-required-message .adf-error-text-container{margin-top:1px!important}"],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
DropdownWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
    { type: LogService, },
]; };
var DateCellValidator = /** @class */ (function () {
    function DateCellValidator() {
        this.supportedTypes = [
            'Date'
        ];
    }
    DateCellValidator.prototype.isSupported = function (column) {
        return column && column.editable && this.supportedTypes.indexOf(column.type) > -1;
    };
    DateCellValidator.prototype.validate = function (row, column, summary) {
        if (this.isSupported(column)) {
            var value = row.value[column.id];
            var dateValue = moment(value, 'D-M-YYYY');
            if (!dateValue.isValid()) {
                if (summary) {
                    summary.isValid = false;
                    summary.message = "Invalid '" + column.name + "' format.";
                }
                return false;
            }
        }
        return true;
    };
    return DateCellValidator;
}());
var DynamicRowValidationSummary = /** @class */ (function (_super) {
    __extends(DynamicRowValidationSummary, _super);
    function DynamicRowValidationSummary(json) {
        var _this = _super.call(this, json) || this;
        _this.isValid = json.isValid;
        return _this;
    }
    return DynamicRowValidationSummary;
}(ErrorMessageModel));
var NumberCellValidator = /** @class */ (function () {
    function NumberCellValidator() {
        this.supportedTypes = [
            'Number',
            'Amount'
        ];
    }
    NumberCellValidator.prototype.isSupported = function (column) {
        return column && column.required && this.supportedTypes.indexOf(column.type) > -1;
    };
    NumberCellValidator.prototype.isNumber = function (value) {
        if (value === null || value === undefined || value === '') {
            return false;
        }
        return !isNaN(+value);
    };
    NumberCellValidator.prototype.validate = function (row, column, summary) {
        if (this.isSupported(column)) {
            var value = row.value[column.id];
            if (value === null ||
                value === undefined ||
                value === '' ||
                this.isNumber(value)) {
                return true;
            }
            if (summary) {
                summary.isValid = false;
                summary.message = "Field '" + column.name + "' must be a number.";
            }
            return false;
        }
        return true;
    };
    return NumberCellValidator;
}());
var RequiredCellValidator = /** @class */ (function () {
    function RequiredCellValidator() {
        this.supportedTypes = [
            'String',
            'Number',
            'Amount',
            'Date',
            'Dropdown'
        ];
    }
    RequiredCellValidator.prototype.isSupported = function (column) {
        return column && column.required && this.supportedTypes.indexOf(column.type) > -1;
    };
    RequiredCellValidator.prototype.validate = function (row, column, summary) {
        if (this.isSupported(column)) {
            var value = row.value[column.id];
            if (column.required) {
                if (value === null || value === undefined || value === '') {
                    if (summary) {
                        summary.isValid = false;
                        summary.message = "Field '" + column.name + "' is required.";
                    }
                    return false;
                }
            }
        }
        return true;
    };
    return RequiredCellValidator;
}());
var DynamicTableModel = /** @class */ (function (_super) {
    __extends(DynamicTableModel, _super);
    function DynamicTableModel(field, formService) {
        var _this = _super.call(this, field.form, field.json) || this;
        _this.formService = formService;
        _this.columns = [];
        _this.visibleColumns = [];
        _this.rows = [];
        _this._validators = [];
        _this.field = field;
        if (field.json) {
            var columns = _this.getColumns(field);
            if (columns) {
                _this.columns = columns;
                _this.visibleColumns = _this.columns.filter(function (col) { return col.visible; });
            }
            if (field.json.value) {
                _this.rows = field.json.value.map(function (obj) { return ({ selected: false, value: obj }); });
            }
        }
        _this._validators = [
            new RequiredCellValidator(),
            new DateCellValidator(),
            new NumberCellValidator()
        ];
        return _this;
    }
    Object.defineProperty(DynamicTableModel.prototype, "selectedRow", {
        get: function () {
            return this._selectedRow;
        },
        set: function (value) {
            if (this._selectedRow && this._selectedRow === value) {
                this._selectedRow.selected = false;
                this._selectedRow = null;
                return;
            }
            this.rows.forEach(function (row) { return row.selected = false; });
            this._selectedRow = value;
            if (value) {
                this._selectedRow.selected = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    DynamicTableModel.prototype.getColumns = function (field) {
        if (field && field.json) {
            var definitions = field.json.columnDefinitions;
            if (!definitions && field.json.params && field.json.params.field) {
                definitions = field.json.params.field.columnDefinitions;
            }
            if (definitions) {
                return definitions.map(function (obj) { return (obj); });
            }
        }
        return null;
    };
    DynamicTableModel.prototype.flushValue = function () {
        if (this.field) {
            this.field.value = this.rows.map(function (r) { return r.value; });
            this.field.updateForm();
        }
    };
    DynamicTableModel.prototype.moveRow = function (row, offset) {
        var oldIndex = this.rows.indexOf(row);
        if (oldIndex > -1) {
            var newIndex = (oldIndex + offset);
            if (newIndex < 0) {
                newIndex = 0;
            }
            else if (newIndex >= this.rows.length) {
                newIndex = this.rows.length;
            }
            var arr = this.rows.slice();
            arr.splice(oldIndex, 1);
            arr.splice(newIndex, 0, row);
            this.rows = arr;
            this.flushValue();
        }
    };
    DynamicTableModel.prototype.deleteRow = function (row) {
        if (row) {
            if (this.selectedRow === row) {
                this.selectedRow = null;
            }
            var idx = this.rows.indexOf(row);
            if (idx > -1) {
                this.rows.splice(idx, 1);
                this.flushValue();
            }
        }
    };
    DynamicTableModel.prototype.addRow = function (row) {
        if (row) {
            this.rows.push(row);
        }
    };
    DynamicTableModel.prototype.validateRow = function (row) {
        var summary = new DynamicRowValidationSummary({
            isValid: true,
            message: null
        });
        var event = new ValidateDynamicTableRowEvent(this.form, this.field, row, summary);
        this.formService.validateDynamicTableRow.next(event);
        if (event.defaultPrevented || !summary.isValid) {
            return summary;
        }
        if (row) {
            try {
                for (var _a = __values(this.columns), _b = _a.next(); !_b.done; _b = _a.next()) {
                    var col = _b.value;
                    try {
                        for (var _c = __values(this._validators), _d = _c.next(); !_d.done; _d = _c.next()) {
                            var validator = _d.value;
                            if (!validator.validate(row, col, summary)) {
                                return summary;
                            }
                        }
                    }
                    catch (e_6_1) { e_6 = { error: e_6_1 }; }
                    finally {
                        try {
                            if (_d && !_d.done && (_e = _c.return)) _e.call(_c);
                        }
                        finally { if (e_6) throw e_6.error; }
                    }
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (_b && !_b.done && (_f = _a.return)) _f.call(_a);
                }
                finally { if (e_7) throw e_7.error; }
            }
        }
        return summary;
        var e_7, _f, e_6, _e;
    };
    DynamicTableModel.prototype.getCellValue = function (row, column) {
        var result = row.value[column.id];
        if (column.type === 'Dropdown') {
            if (result) {
                return result.name;
            }
        }
        if (column.type === 'Boolean') {
            return result ? true : false;
        }
        if (column.type === 'Date') {
            if (result) {
                return moment(result.split('T')[0], 'YYYY-MM-DD').format('DD-MM-YYYY');
            }
        }
        return result || '';
    };
    DynamicTableModel.prototype.getDisplayText = function (column) {
        var result = column.name;
        if (column.type === 'Amount') {
            var currency = column.amountCurrency || '$';
            result = column.name + " (" + currency + ")";
        }
        return result;
    };
    return DynamicTableModel;
}(FormWidgetModel));
var DynamicTableWidgetComponent = /** @class */ (function (_super) {
    __extends(DynamicTableWidgetComponent, _super);
    function DynamicTableWidgetComponent(formService, elementRef, visibilityService, logService, cd) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        _this.elementRef = elementRef;
        _this.visibilityService = visibilityService;
        _this.logService = logService;
        _this.cd = cd;
        _this.ERROR_MODEL_NOT_FOUND = 'Table model not found';
        _this.editMode = false;
        _this.editRow = null;
        _this.selectArrayCode = [32, 0, 13];
        return _this;
    }
    DynamicTableWidgetComponent.prototype.ngOnInit = function () {
        if (this.field) {
            this.content = new DynamicTableModel(this.field, this.formService);
            this.visibilityService.refreshVisibility(this.field.form);
        }
    };
    DynamicTableWidgetComponent.prototype.forceFocusOnAddButton = function () {
        if (this.content) {
            this.cd.detectChanges();
            var buttonAddRow = (this.elementRef.nativeElement.querySelector('#' + this.content.id + '-add-row'));
            if (this.isDynamicTableReady(buttonAddRow)) {
                buttonAddRow.focus();
            }
        }
    };
    DynamicTableWidgetComponent.prototype.isDynamicTableReady = function (buttonAddRow) {
        return this.field && !this.editMode && buttonAddRow;
    };
    DynamicTableWidgetComponent.prototype.isValid = function () {
        var result = true;
        if (this.content && this.content.field) {
            result = this.content.field.isValid;
        }
        return result;
    };
    DynamicTableWidgetComponent.prototype.onRowClicked = function (row) {
        if (this.content) {
            this.content.selectedRow = row;
        }
    };
    DynamicTableWidgetComponent.prototype.onKeyPressed = function ($event, row) {
        if (this.content && this.isEnterOrSpacePressed($event.keyCode)) {
            this.content.selectedRow = row;
        }
    };
    DynamicTableWidgetComponent.prototype.isEnterOrSpacePressed = function (keycode) {
        return this.selectArrayCode.indexOf(keycode) !== -1;
    };
    DynamicTableWidgetComponent.prototype.hasSelection = function () {
        return !!(this.content && this.content.selectedRow);
    };
    DynamicTableWidgetComponent.prototype.moveSelectionUp = function () {
        if (this.content && !this.readOnly) {
            this.content.moveRow(this.content.selectedRow, -1);
            return true;
        }
        return false;
    };
    DynamicTableWidgetComponent.prototype.moveSelectionDown = function () {
        if (this.content && !this.readOnly) {
            this.content.moveRow(this.content.selectedRow, 1);
            return true;
        }
        return false;
    };
    DynamicTableWidgetComponent.prototype.deleteSelection = function () {
        if (this.content && !this.readOnly) {
            this.content.deleteRow(this.content.selectedRow);
            return true;
        }
        return false;
    };
    DynamicTableWidgetComponent.prototype.addNewRow = function () {
        if (this.content && !this.readOnly) {
            this.editRow = ({
                isNew: true,
                selected: false,
                value: {}
            });
            this.editMode = true;
            return true;
        }
        return false;
    };
    DynamicTableWidgetComponent.prototype.editSelection = function () {
        if (this.content && !this.readOnly) {
            this.editRow = this.copyRow(this.content.selectedRow);
            this.editMode = true;
            return true;
        }
        return false;
    };
    DynamicTableWidgetComponent.prototype.getCellValue = function (row, column) {
        if (this.content) {
            var result = this.content.getCellValue(row, column);
            if (column.type === 'Amount') {
                return (column.amountCurrency || '$') + ' ' + (result || 0);
            }
            return result;
        }
        return null;
    };
    DynamicTableWidgetComponent.prototype.onSaveChanges = function () {
        if (this.content) {
            if (this.editRow.isNew) {
                var row = this.copyRow(this.editRow);
                this.content.selectedRow = null;
                this.content.addRow(row);
                this.editRow.isNew = false;
            }
            else {
                this.content.selectedRow.value = this.copyObject(this.editRow.value);
            }
            this.content.flushValue();
        }
        else {
            this.logService.error(this.ERROR_MODEL_NOT_FOUND);
        }
        this.editMode = false;
        this.forceFocusOnAddButton();
    };
    DynamicTableWidgetComponent.prototype.onCancelChanges = function () {
        this.editMode = false;
        this.editRow = null;
        this.forceFocusOnAddButton();
    };
    DynamicTableWidgetComponent.prototype.copyRow = function (row) {
        return ({
            value: this.copyObject(row.value)
        });
    };
    DynamicTableWidgetComponent.prototype.copyObject = function (obj) {
        var _this = this;
        var result = obj;
        if (typeof obj === 'object' && obj !== null && obj !== undefined) {
            result = Object.assign({}, obj);
            Object.keys(obj).forEach(function (key) {
                if (typeof obj[key] === 'object') {
                    result[key] = _this.copyObject(obj[key]);
                }
            });
        }
        return result;
    };
    return DynamicTableWidgetComponent;
}(WidgetComponent));
DynamicTableWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'dynamic-table-widget',
                template: "<div class=\"{{field.className}}\"\n    [class.adf-invalid]=\"!isValid()\">\n    <div class=\"adf-label\">{{content.name}}<span *ngIf=\"isRequired()\">*</span></div>\n\n    <div *ngIf=\"!editMode\">\n        <div class=\"adf-table-container\">\n            <table class=\"full-width adf-dynamic-table\" id=\"dynamic-table-{{content.id}}\">\n                <thead>\n                    <tr>\n                        <th *ngFor=\"let column of content.visibleColumns\">\n                            {{column.name}}\n                        </th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <tr *ngFor=\"let row of content.rows; let idx = index\" tabindex=\"0\" id=\"{{content.id}}-row-{{idx}}\"\n                        [class.adf-dynamic-table-widget__row-selected]=\"row.selected\" (keyup)=\"onKeyPressed($event, row)\">\n                        <td *ngFor=\"let column of content.visibleColumns\"\n                            (click)=\"onRowClicked(row)\">\n                            {{ getCellValue(row, column) }}\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n        </div>\n\n        <div *ngIf=\"!readOnly\">\n            <button mat-button\n                    [disabled]=\"!hasSelection()\"\n                    (click)=\"moveSelectionUp()\">\n                <mat-icon>arrow_upward</mat-icon>\n            </button>\n            <button mat-button\n                    [disabled]=\"!hasSelection()\"\n                    (click)=\"moveSelectionDown()\">\n                <mat-icon>arrow_downward</mat-icon>\n            </button>\n            <button mat-button\n                    [disabled]=\"field.readOnly\"\n                    id=\"{{content.id}}-add-row\"\n                    (click)=\"addNewRow()\">\n                <mat-icon>add_circle_outline</mat-icon>\n            </button>\n            <button mat-button\n                    [disabled]=\"!hasSelection()\"\n                    (click)=\"deleteSelection()\">\n                <mat-icon>remove_circle_outline</mat-icon>\n            </button>\n            <button mat-button\n                    [disabled]=\"!hasSelection()\"\n                    (click)=\"editSelection()\">\n                <mat-icon>edit</mat-icon>\n            </button>\n        </div>\n     </div>\n\n     <row-editor *ngIf=\"editMode\"\n        [table]=\"content\"\n        [row]=\"editRow\"\n        [column]=\"column\"\n        (save)=\"onSaveChanges()\"\n        (cancel)=\"onCancelChanges()\">\n     </row-editor>\n    <error-widget [error]=\"field.validationSummary\" ></error-widget>\n    <error-widget *ngIf=\"isInvalidFieldRequired()\" required=\"{{ 'FORM.FIELD.REQUIRED' | translate }}\"></error-widget>\n</div>\n",
                styles: [""],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
DynamicTableWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
    { type: ElementRef, },
    { type: WidgetVisibilityService, },
    { type: LogService, },
    { type: ChangeDetectorRef, },
]; };
var BooleanEditorComponent = /** @class */ (function () {
    function BooleanEditorComponent() {
    }
    BooleanEditorComponent.prototype.onValueChanged = function (row, column, event) {
        var value = ((event)).checked;
        row.value[column.id] = value;
    };
    return BooleanEditorComponent;
}());
BooleanEditorComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-boolean-editor',
                template: " <label [attr.for]=\"column.id\">\n    <mat-checkbox\n        color=\"primary\"\n        [id]=\"column.id\"\n        [checked]=\"table.getCellValue(row, column)\"\n        [required]=\"column.required\"\n        [disabled]=\"!column.editable\"\n        (change)=\"onValueChanged(row, column, $event)\">\n    <span class=\"adf-checkbox-label\">{{column.name}}</span>\n    </mat-checkbox>\n</label>\n",
                styles: [".adf-checkbox-label{position:relative;cursor:pointer;font-size:16px;line-height:24px;margin:0}"]
            },] },
];
BooleanEditorComponent.ctorParameters = function () { return []; };
BooleanEditorComponent.propDecorators = {
    "table": [{ type: Input },],
    "row": [{ type: Input },],
    "column": [{ type: Input },],
};
var 0$2 = MOMENT_DATE_FORMATS;
var DateEditorComponent = /** @class */ (function () {
    function DateEditorComponent(dateAdapter, preferences) {
        this.dateAdapter = dateAdapter;
        this.preferences = preferences;
        this.DATE_FORMAT = 'DD-MM-YYYY';
    }
    DateEditorComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.preferences.locale$.subscribe(function (locale) {
            _this.dateAdapter.setLocale(locale);
        });
        var momentDateAdapter = (this.dateAdapter);
        momentDateAdapter.overrideDisplyaFormat = this.DATE_FORMAT;
        this.value = moment(this.table.getCellValue(this.row, this.column), this.DATE_FORMAT);
    };
    DateEditorComponent.prototype.onDateChanged = function (newDateValue) {
        if (newDateValue) {
            var momentDate = moment(newDateValue, this.DATE_FORMAT, true);
            if (!momentDate.isValid()) {
                this.row.value[this.column.id] = '';
            }
            else {
                this.row.value[this.column.id] = momentDate.format('YYYY-MM-DD') + "T00:00:00.000Z";
                this.table.flushValue();
            }
        }
    };
    return DateEditorComponent;
}());
DateEditorComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-date-editor',
                template: "<div>\n    <mat-form-field class=\"adf-date-editor\">\n        <label [attr.for]=\"column.id\">{{column.name}} (d-M-yyyy)</label>\n        <input matInput\n            id=\"dateInput\"\n            type=\"text\"\n            [matDatepicker]=\"datePicker\"\n            [value]=\"value\"\n            [id]=\"column.id\"\n            [required]=\"column.required\"\n            [disabled]=\"!column.editable\"\n           (focusout)=\"onDateChanged($event.srcElement.value)\">\n        <mat-datepicker-toggle  *ngIf=\"column.editable\" matSuffix [for]=\"datePicker\" class=\"adf-date-editor-button\" ></mat-datepicker-toggle>\n    </mat-form-field>\n    <mat-datepicker #datePicker (dateChange)=\"onDateChanged($event)\" [touchUi]=\"true\"></mat-datepicker>\n</div>\n",
                providers: [
                    { provide: DateAdapter, useClass: MomentDateAdapter },
                    { provide: MAT_DATE_FORMATS, useValue: 0$2 }
                ],
                styles: [".adf-date-editor{width:100%}.adf-date-editor-button{position:relative;top:25px}"]
            },] },
];
DateEditorComponent.ctorParameters = function () { return [
    { type: DateAdapter, },
    { type: UserPreferencesService, },
]; };
DateEditorComponent.propDecorators = {
    "table": [{ type: Input },],
    "row": [{ type: Input },],
    "column": [{ type: Input },],
};
var DropdownEditorComponent = /** @class */ (function () {
    function DropdownEditorComponent(formService, logService) {
        this.formService = formService;
        this.logService = logService;
        this.value = null;
        this.options = [];
    }
    DropdownEditorComponent.prototype.ngOnInit = function () {
        var field = this.table.field;
        if (field) {
            if (this.column.optionType === 'rest') {
                if (this.table.form && this.table.form.taskId) {
                    this.getValuesByTaskId(field);
                }
                else {
                    this.getValuesByProcessDefinitionId(field);
                }
            }
            else {
                this.options = this.column.options || [];
                this.value = this.table.getCellValue(this.row, this.column);
            }
        }
    };
    DropdownEditorComponent.prototype.getValuesByTaskId = function (field) {
        var _this = this;
        this.formService
            .getRestFieldValuesColumn(field.form.taskId, field.id, this.column.id)
            .subscribe(function (result) {
            _this.column.options = result || [];
            _this.options = _this.column.options;
            _this.value = _this.table.getCellValue(_this.row, _this.column);
        }, function (err) { return _this.handleError(err); });
    };
    DropdownEditorComponent.prototype.getValuesByProcessDefinitionId = function (field) {
        var _this = this;
        this.formService
            .getRestFieldValuesColumnByProcessId(field.form.processDefinitionId, field.id, this.column.id)
            .subscribe(function (result) {
            _this.column.options = result || [];
            _this.options = _this.column.options;
            _this.value = _this.table.getCellValue(_this.row, _this.column);
        }, function (err) { return _this.handleError(err); });
    };
    DropdownEditorComponent.prototype.onValueChanged = function (row, column, event) {
        var value = ((event)).value;
        value = column.options.find(function (opt) { return opt.name === value; });
        row.value[column.id] = value;
    };
    DropdownEditorComponent.prototype.handleError = function (error) {
        this.logService.error(error);
    };
    return DropdownEditorComponent;
}());
DropdownEditorComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-dropdown-editor',
                template: "<div class=\"dropdown-editor\">\n    <label [attr.for]=\"column.id\">{{column.name}}</label>\n    <mat-form-field>\n        <mat-select\n            floatPlaceholder=\"never\"\n            class=\"adf-dropdown-editor-select\"\n            [id]=\"column.id\"\n            [(ngModel)]=\"value\"\n            [required]=\"column.required\"\n            [disabled]=\"!column.editable\"\n            (change)=\"onValueChanged(row, column, $event)\">\n            <mat-option></mat-option>\n            <mat-option *ngFor=\"let opt of options\" [value]=\"opt.name\" [id]=\"opt.id\">{{opt.name}}</mat-option>\n        </mat-select>\n    </mat-form-field>\n</div>\n",
                styles: [".adf-dropdown-editor-select{width:100%}"]
            },] },
];
DropdownEditorComponent.ctorParameters = function () { return [
    { type: FormService, },
    { type: LogService, },
]; };
DropdownEditorComponent.propDecorators = {
    "table": [{ type: Input },],
    "row": [{ type: Input },],
    "column": [{ type: Input },],
};
var RowEditorComponent = /** @class */ (function () {
    function RowEditorComponent() {
        this.save = new EventEmitter();
        this.cancel = new EventEmitter();
        this.validationSummary = new DynamicRowValidationSummary({ isValid: true, message: '' });
    }
    RowEditorComponent.prototype.onCancelChanges = function () {
        this.cancel.emit({
            table: this.table,
            row: this.row,
            column: this.column
        });
    };
    RowEditorComponent.prototype.onSaveChanges = function () {
        this.validate();
        if (this.isValid()) {
            this.save.emit({
                table: this.table,
                row: this.row,
                column: this.column
            });
        }
    };
    RowEditorComponent.prototype.isValid = function () {
        return this.validationSummary && this.validationSummary.isValid;
    };
    RowEditorComponent.prototype.validate = function () {
        this.validationSummary = this.table.validateRow(this.row);
    };
    return RowEditorComponent;
}());
RowEditorComponent.decorators = [
    { type: Component, args: [{
                selector: 'row-editor',
                template: "<div class=\"row-editor mdl-shadow--2dp\"\n    [class.row-editor__invalid]=\"!validationSummary.isValid\">\n    <div class=\"mdl-grid\" *ngFor=\"let column of table.columns\">\n        <div class=\"mdl-cell mdl-cell--6-col\" [ngSwitch]=\"column.type\">\n            <div *ngSwitchCase=\"'Dropdown'\">\n                <adf-dropdown-editor\n                    [table]=\"table\"\n                    [row]=\"row\"\n                    [column]=\"column\">\n                </adf-dropdown-editor>\n                </div>\n                <div *ngSwitchCase=\"'Date'\">\n                    <adf-date-editor\n                    [table]=\"table\"\n                    [row]=\"row\"\n                    [column]=\"column\">\n                </adf-date-editor>\n                </div>\n\n                <div *ngSwitchCase=\"'Boolean'\">\n                <adf-boolean-editor\n                    [table]=\"table\"\n                    [row]=\"row\"\n                    [column]=\"column\">\n                </adf-boolean-editor>\n                </div>\n                <div *ngSwitchDefault>\n                <adf-text-editor\n                    [table]=\"table\"\n                    [row]=\"row\"\n                    [column]=\"column\">\n                </adf-text-editor>\n            </div>\n        </div>\n    </div>\n    <error-widget [error]=\"validationSummary\"></error-widget>\n    <div>\n        <button mat-button (click)=\"onCancelChanges()\">Cancel</button>\n        <button mat-button (click)=\"onSaveChanges()\">Save</button>\n    </div>\n</div>\n",
                styles: [".row-editor{padding:8px}.row-editor__validation-summary{visibility:hidden}.row-editor__invalid .row-editor__validation-summary{color:#d50000;visibility:visible;padding:8px 16px}"]
            },] },
];
RowEditorComponent.ctorParameters = function () { return []; };
RowEditorComponent.propDecorators = {
    "table": [{ type: Input },],
    "row": [{ type: Input },],
    "column": [{ type: Input },],
    "save": [{ type: Output },],
    "cancel": [{ type: Output },],
};
var TextEditorComponent = /** @class */ (function () {
    function TextEditorComponent() {
    }
    TextEditorComponent.prototype.ngOnInit = function () {
        this.displayName = this.table.getDisplayText(this.column);
    };
    TextEditorComponent.prototype.onValueChanged = function (row, column, event) {
        var value = ((event.target)).value;
        row.value[column.id] = value;
    };
    return TextEditorComponent;
}());
TextEditorComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-text-editor',
                template: "<div class=\"adf-text-editor\">\n    <mat-form-field>\n    <label [attr.for]=\"column.id\">{{displayName}}</label>\n    <input matInput\n        type=\"text\"\n        [value]=\"table.getCellValue(row, column)\"\n        (keyup)=\"onValueChanged(row, column, $event)\"\n        [required]=\"column.required\"\n        [disabled]=\"!column.editable\"\n        [id]=\"column.id\">\n    </mat-form-field>\n</div>\n",
                styles: [".adf-text-editor{width:100%}"]
            },] },
];
TextEditorComponent.ctorParameters = function () { return []; };
TextEditorComponent.propDecorators = {
    "table": [{ type: Input },],
    "row": [{ type: Input },],
    "column": [{ type: Input },],
};
var ErrorWidgetComponent = /** @class */ (function (_super) {
    __extends(ErrorWidgetComponent, _super);
    function ErrorWidgetComponent(formService) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        _this.translateParameters = null;
        _this._subscriptAnimationState = '';
        return _this;
    }
    ErrorWidgetComponent.prototype.ngOnChanges = function (changes) {
        if (changes['required']) {
            this.required = changes["required"].currentValue;
            this._subscriptAnimationState = 'enter';
        }
        if (changes['error'] && changes['error'].currentValue) {
            if (changes["error"].currentValue.isActive()) {
                this.error = changes["error"].currentValue;
                this.translateParameters = this.error.getAttributesAsJsonObj();
                this._subscriptAnimationState = 'enter';
            }
        }
    };
    return ErrorWidgetComponent;
}(WidgetComponent));
ErrorWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'error-widget',
                template: "<div class=\"adf-error-text-container\">\n    <div *ngIf=\"error?.isActive()\" [@transitionMessages]=\"_subscriptAnimationState\">\n        <div class=\"adf-error-text\">{{error.message | translate:translateParameters}}</div>\n        <mat-icon class=\"adf-error-icon\">warning</mat-icon>\n    </div>\n    <div *ngIf=\"required\" [@transitionMessages]=\"_subscriptAnimationState\">\n            <div class=\"adf-error-text\">{{required}}</div>\n    </div>\n</div>\n",
                styles: [".adf-error-text{width:85%}"],
                animations: [
                    trigger('transitionMessages', [
                        state('enter', style({ opacity: 1, transform: 'translateY(0%)' })),
                        transition('void => enter', [
                            style({ opacity: 0, transform: 'translateY(-100%)' }),
                            animate('300ms cubic-bezier(0.55, 0, 0.55, 0.2)')
                        ])
                    ])
                ],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
ErrorWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
]; };
ErrorWidgetComponent.propDecorators = {
    "error": [{ type: Input },],
    "required": [{ type: Input },],
};
var FunctionalGroupWidgetComponent = /** @class */ (function (_super) {
    __extends(FunctionalGroupWidgetComponent, _super);
    function FunctionalGroupWidgetComponent(formService, elementRef) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        _this.elementRef = elementRef;
        _this.groups = [];
        _this.minTermLength = 1;
        return _this;
    }
    FunctionalGroupWidgetComponent.prototype.ngOnInit = function () {
        var _this = this;
        if (this.field) {
            var group = this.field.value;
            if (group) {
                this.value = group.name;
            }
            var params = this.field.params;
            if (params && params['restrictWithGroup']) {
                var restrictWithGroup = (params['restrictWithGroup']);
                this.groupId = restrictWithGroup.id;
            }
            if (this.value) {
                this.formService
                    .getWorkflowGroups(this.value, this.groupId)
                    .subscribe(function (result) { return _this.groups = result || []; });
            }
        }
    };
    FunctionalGroupWidgetComponent.prototype.onKeyUp = function (event) {
        var _this = this;
        if (this.value && this.value.length >= this.minTermLength && this.oldValue !== this.value) {
            if (event.keyCode !== ESCAPE && event.keyCode !== ENTER) {
                this.oldValue = this.value;
                this.formService.getWorkflowGroups(this.value, this.groupId)
                    .subscribe(function (result) {
                    _this.groups = result || [];
                });
            }
        }
    };
    FunctionalGroupWidgetComponent.prototype.flushValue = function () {
        var _this = this;
        var option = this.groups.find(function (item) { return item.name.toLocaleLowerCase() === _this.value.toLocaleLowerCase(); });
        if (option) {
            this.field.value = option;
            this.value = option.name;
        }
        else {
            this.field.value = null;
            this.value = null;
        }
        this.field.updateForm();
    };
    FunctionalGroupWidgetComponent.prototype.onItemClick = function (item, event) {
        if (item) {
            this.field.value = item;
            this.value = item.name;
        }
        if (event) {
            event.preventDefault();
        }
    };
    FunctionalGroupWidgetComponent.prototype.onItemSelect = function (item) {
        if (item) {
            this.field.value = item;
            this.value = item.name;
        }
    };
    return FunctionalGroupWidgetComponent;
}(WidgetComponent));
FunctionalGroupWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'functional-group-widget',
                template: "<div class=\"adf-group-widget {{field.className}}\"\n     [class.is-dirty]=\"value\"\n     [class.adf-invalid]=\"!field.isValid\" [class.adf-readonly]=\"field.readOnly\" id=\"functional-group-div\">\n    <mat-form-field>\n        <label class=\"adf-label\" [attr.for]=\"field.id\">{{field.name}}<span *ngIf=\"isRequired()\">*</span></label>\n        <input matInput\n               class=\"adf-input\"\n               type=\"text\"\n               [id]=\"field.id\"\n               [(ngModel)]=\"value\"\n               (keyup)=\"onKeyUp($event)\"\n               [disabled]=\"field.readOnly\"\n               placeholder=\"{{field.placeholder}}\"\n               [matAutocomplete]=\"auto\">\n        <mat-autocomplete #auto=\"matAutocomplete\" (optionSelected)=\"onItemSelect($event.option.value)\">\n            <mat-option *ngFor=\"let item of groups\"\n                       [id]=\"field.id +'-'+item.id\"\n                       (click)=\"onItemClick(item, $event)\"  [value]=\"item\">\n                <span>{{item.name}}</span>\n            </mat-option>\n        </mat-autocomplete>\n\n    </mat-form-field>\n    <error-widget [error]=\"field.validationSummary\"></error-widget>\n    <error-widget *ngIf=\"isInvalidFieldRequired()\" required=\"{{ 'FORM.FIELD.REQUIRED' | translate }}\"></error-widget>\n</div>\n",
                styles: [".adf-group-widget{width:100%}"],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
FunctionalGroupWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
    { type: ElementRef, },
]; };
var HyperlinkWidgetComponent = /** @class */ (function (_super) {
    __extends(HyperlinkWidgetComponent, _super);
    function HyperlinkWidgetComponent(formService) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        _this.linkUrl = WidgetComponent.DEFAULT_HYPERLINK_URL;
        _this.linkText = null;
        return _this;
    }
    HyperlinkWidgetComponent.prototype.ngOnInit = function () {
        if (this.field) {
            this.linkUrl = this.getHyperlinkUrl(this.field);
            this.linkText = this.getHyperlinkText(this.field);
        }
    };
    return HyperlinkWidgetComponent;
}(WidgetComponent));
HyperlinkWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'hyperlink-widget',
                template: "<div class=\"adf-hyperlink-widget {{field.className}}\">\n    <label class=\"adf-label\" [attr.for]=\"field.id\">{{field.name}}<span *ngIf=\"isRequired()\">*</span></label>\n    <div>\n        <a [href]=\"linkUrl\" target=\"_blank\" rel=\"nofollow\">{{linkText}}</a>\n    </div>\n</div>\n",
                styles: [""],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
HyperlinkWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
]; };
var MultilineTextWidgetComponentComponent = /** @class */ (function (_super) {
    __extends(MultilineTextWidgetComponentComponent, _super);
    function MultilineTextWidgetComponentComponent(formService) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        return _this;
    }
    return MultilineTextWidgetComponentComponent;
}(WidgetComponent));
MultilineTextWidgetComponentComponent.decorators = [
    { type: Component, args: [{
                selector: 'multiline-text-widget',
                template: "<div class=\"adf-multiline-text-widget {{field.className}}\"\n     [class.adf-invalid]=\"!field.isValid\" [class.adf-readonly]=\"field.readOnly\">\n    <mat-form-field floatPlaceholder=\"never\">\n        <label class=\"adf-label\" [attr.for]=\"field.id\">{{field.name}}<span *ngIf=\"isRequired()\">*</span></label>\n        <textarea matInput class=\"adf-input\"\n                  matTextareaAutosize\n                  type=\"text\"\n                  rows=\"3\"\n                  [id]=\"field.id\"\n                  [required]=\"isRequired()\"\n                  [(ngModel)]=\"field.value\"\n                  (ngModelChange)=\"onFieldChanged(field)\"\n                  [disabled]=\"field.readOnly || readOnly\"\n                  placeholder=\"{{field.placeholder}}\">\n        </textarea>\n    </mat-form-field>\n    <div *ngIf=\"field.maxLength > 0\" class=\"adf-multiline-word-counter\">\n        <span>{{field?.value?.length || 0}}/{{field.maxLength}}</span>\n    </div>\n    <error-widget [error]=\"field.validationSummary\"></error-widget>\n    <error-widget class=\"adf-multiline-required-message\" *ngIf=\"isInvalidFieldRequired()\" required=\"{{ 'FORM.FIELD.REQUIRED' | translate }}\"></error-widget>\n</div>\n\n",
                styles: [".adf-multiline-text-widget{width:100%}.adf-multiline-word-counter{float:right;margin-top:-20px!important;min-height:24px;min-width:1px;font-size:12px;line-height:14px;overflow:hidden;-webkit-transition:all .3s cubic-bezier(.55,0,.55,.2);transition:all .3s cubic-bezier(.55,0,.55,.2);opacity:1;padding-top:5px;text-align:right;padding-right:2px;padding-left:0}.adf-multiline-required-message{display:-webkit-box;display:-ms-flexbox;display:flex}"],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
MultilineTextWidgetComponentComponent.ctorParameters = function () { return [
    { type: FormService, },
]; };
var NumberWidgetComponent = /** @class */ (function (_super) {
    __extends(NumberWidgetComponent, _super);
    function NumberWidgetComponent(formService) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        return _this;
    }
    return NumberWidgetComponent;
}(WidgetComponent));
NumberWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'number-widget',
                template: "<div class=\"adf-textfield adf-number-widget {{field.className}}\"\n     [class.adf-invalid]=\"!field.isValid\" [class.adf-readonly]=\"field.readOnly\">\n    <mat-form-field>\n        <label class=\"adf-label\" [attr.for]=\"field.id\">{{field.name}}<span *ngIf=\"isRequired()\">*</span></label>\n        <input matInput\n               class=\"adf-input\"\n               type=\"text\"\n               pattern=\"-?[0-9]*(.[0-9]+)?\"\n               [id]=\"field.id\"\n               [required]=\"isRequired()\"\n               [value]=\"field.value\"\n               [(ngModel)]=\"field.value\"\n               (ngModelChange)=\"onFieldChanged(field)\"\n               [disabled]=\"field.readOnly\"\n               placeholder=\"{{field.placeholder}}\">\n    </mat-form-field>\n    <error-widget [error]=\"field.validationSummary\" ></error-widget>\n    <error-widget *ngIf=\"isInvalidFieldRequired()\" required=\"{{ 'FORM.FIELD.REQUIRED' | translate }}\"></error-widget>\n</div>\n",
                styles: [".adf-number-widget{width:100%}"],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
NumberWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
]; };
var PeopleProcessService = /** @class */ (function () {
    function PeopleProcessService(alfrescoJsApi, logService) {
        this.alfrescoJsApi = alfrescoJsApi;
        this.logService = logService;
    }
    PeopleProcessService.prototype.getWorkflowUsers = function (taskId, searchWord) {
        var _this = this;
        var option = { excludeTaskId: taskId, filter: searchWord };
        return Observable.fromPromise(this.getWorkflowUserApi(option))
            .map(function (response) { return (response.data) || []; })
            .catch(function (err) { return _this.handleError(err); });
    };
    PeopleProcessService.prototype.getUserImage = function (user) {
        return this.getUserProfileImageApi(user.id);
    };
    PeopleProcessService.prototype.involveUserWithTask = function (taskId, idToInvolve) {
        var _this = this;
        var node = { userId: idToInvolve };
        return Observable.fromPromise(this.involveUserToTaskApi(taskId, node))
            .catch(function (err) { return _this.handleError(err); });
    };
    PeopleProcessService.prototype.removeInvolvedUser = function (taskId, idToRemove) {
        var _this = this;
        var node = { userId: idToRemove };
        return Observable.fromPromise(this.removeInvolvedUserFromTaskApi(taskId, node))
            .catch(function (err) { return _this.handleError(err); });
    };
    PeopleProcessService.prototype.getWorkflowUserApi = function (options) {
        return this.alfrescoJsApi.getInstance().activiti.usersWorkflowApi.getUsers(options);
    };
    PeopleProcessService.prototype.involveUserToTaskApi = function (taskId, node) {
        return this.alfrescoJsApi.getInstance().activiti.taskActionsApi.involveUser(taskId, node);
    };
    PeopleProcessService.prototype.removeInvolvedUserFromTaskApi = function (taskId, node) {
        return this.alfrescoJsApi.getInstance().activiti.taskActionsApi.removeInvolvedUser(taskId, node);
    };
    PeopleProcessService.prototype.getUserProfileImageApi = function (userId) {
        return this.alfrescoJsApi.getInstance().activiti.userApi.getUserProfilePictureUrl(userId);
    };
    PeopleProcessService.prototype.handleError = function (error) {
        this.logService.error(error);
        return Observable.throw(error || 'Server error');
    };
    return PeopleProcessService;
}());
PeopleProcessService.decorators = [
    { type: Injectable },
];
PeopleProcessService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: LogService, },
]; };
var PeopleWidgetComponent = /** @class */ (function (_super) {
    __extends(PeopleWidgetComponent, _super);
    function PeopleWidgetComponent(formService, peopleProcessService) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        _this.peopleProcessService = peopleProcessService;
        _this.minTermLength = 1;
        _this.users = [];
        return _this;
    }
    PeopleWidgetComponent.prototype.ngOnInit = function () {
        if (this.field) {
            var params = this.field.params;
            if (params && params["restrictWithGroup"]) {
                var restrictWithGroup = (params["restrictWithGroup"]);
                this.groupId = restrictWithGroup.id;
            }
        }
    };
    PeopleWidgetComponent.prototype.onKeyUp = function (event) {
        var value = ((this.input.nativeElement)).value;
        if (value && value.length >= this.minTermLength && this.oldValue !== value) {
            if (event.keyCode !== ESCAPE && event.keyCode !== ENTER) {
                if (value.length >= this.minTermLength) {
                    this.oldValue = value;
                    this.searchUsers(value);
                }
            }
        }
        else {
            this.validateValue(value);
        }
    };
    PeopleWidgetComponent.prototype.searchUsers = function (userName) {
        var _this = this;
        this.formService.getWorkflowUsers(userName, this.groupId)
            .subscribe(function (result) {
            _this.users = result || [];
            _this.validateValue(userName);
        });
    };
    PeopleWidgetComponent.prototype.validateValue = function (userName) {
        if (this.isValidUser(userName)) {
            this.field.validationSummary.message = '';
        }
        else if (!userName) {
            this.field.value = null;
            this.users = [];
        }
        else {
            this.field.validationSummary.message = 'FORM.FIELD.VALIDATOR.INVALID_VALUE';
            this.field.markAsInvalid();
            this.field.form.markAsInvalid();
        }
    };
    PeopleWidgetComponent.prototype.isValidUser = function (value) {
        var _this = this;
        var isValid = false;
        if (value) {
            var resultUser = this.users.find(function (user) { return _this.getDisplayName(user).toLocaleLowerCase() === value.toLocaleLowerCase(); });
            if (resultUser) {
                isValid = true;
            }
        }
        return isValid;
    };
    PeopleWidgetComponent.prototype.getDisplayName = function (model) {
        if (model) {
            var displayName = (model.firstName || '') + " " + (model.lastName || '');
            return displayName.trim();
        }
        return '';
    };
    PeopleWidgetComponent.prototype.onItemSelect = function (item) {
        if (item) {
            this.field.value = item;
        }
    };
    return PeopleWidgetComponent;
}(WidgetComponent));
PeopleWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'people-widget',
                template: "<div class=\"adf-people-widget {{field.className}}\"\n     [class.adf-invalid]=\"!field.isValid\"\n     [class.adf-readonly]=\"field.readOnly\"\n     id=\"people-widget-content\">\n    <mat-form-field>\n        <label class=\"adf-label\" [attr.for]=\"field.id\">{{field.name}}<span *ngIf=\"isRequired()\">*</span></label>\n        <input #inputValue\n               matInput\n               class=\"adf-input\"\n               type=\"text\"\n               [id]=\"field.id\"\n               [value]=\"getDisplayName(field.value)\"\n               (keyup)=\"onKeyUp($event)\"\n               [disabled]=\"field.readOnly\"\n               placeholder=\"{{field.placeholder}}\"\n               [matAutocomplete]=\"auto\">\n        <mat-autocomplete #auto=\"matAutocomplete\" (optionSelected)=\"onItemSelect($event.option.value)\"  [displayWith]=\"getDisplayName\">\n            <mat-option *ngFor=\"let user of users; let i = index\" [value]=\"user\">\n                <div class=\"adf-people-widget-row\" id=\"adf-people-widget-user-{{i}}\">\n                    <div [outerHTML]=\"user | usernameInitials:'adf-people-widget-pic'\"></div>\n                    <div *ngIf=\"user.pictureId\" class=\"adf-people-widget-image-row\">\n                        <img id=\"adf-people-widget-pic-{{i}}\" class=\"adf-people-widget-image\"\n                             [src]=\"peopleProcessService.getUserImage(user)\"/>\n                    </div>\n                    <span class=\"adf-people-label-name\">{{getDisplayName(user)}}</span>\n                </div>\n            </mat-option>\n        </mat-autocomplete>\n    </mat-form-field>\n    <error-widget [error]=\"field.validationSummary\"></error-widget>\n    <error-widget *ngIf=\"isInvalidFieldRequired()\" required=\"{{ 'FORM.FIELD.REQUIRED' | translate }}\"></error-widget>\n</div>\n",
                styles: [""],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
PeopleWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
    { type: PeopleProcessService, },
]; };
PeopleWidgetComponent.propDecorators = {
    "input": [{ type: ViewChild, args: ['inputValue',] },],
};
var RadioButtonsWidgetComponent = /** @class */ (function (_super) {
    __extends(RadioButtonsWidgetComponent, _super);
    function RadioButtonsWidgetComponent(formService, logService) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        _this.logService = logService;
        return _this;
    }
    RadioButtonsWidgetComponent.prototype.ngOnInit = function () {
        if (this.field && this.field.restUrl) {
            if (this.field.form.taskId) {
                this.getOptionsByTaskId();
            }
            else {
                this.getOptionsByProcessDefinitionId();
            }
        }
    };
    RadioButtonsWidgetComponent.prototype.getOptionsByTaskId = function () {
        var _this = this;
        this.formService
            .getRestFieldValues(this.field.form.taskId, this.field.id)
            .subscribe(function (result) {
            _this.field.options = result || [];
            _this.field.updateForm();
        }, function (err) { return _this.handleError(err); });
    };
    RadioButtonsWidgetComponent.prototype.getOptionsByProcessDefinitionId = function () {
        var _this = this;
        this.formService
            .getRestFieldValuesByProcessId(this.field.form.processDefinitionId, this.field.id)
            .subscribe(function (result) {
            _this.field.options = result || [];
            _this.field.updateForm();
        }, function (err) { return _this.handleError(err); });
    };
    RadioButtonsWidgetComponent.prototype.onOptionClick = function (optionSelected) {
        this.field.value = optionSelected;
        this.fieldChanged.emit(this.field);
    };
    RadioButtonsWidgetComponent.prototype.handleError = function (error) {
        this.logService.error(error);
    };
    return RadioButtonsWidgetComponent;
}(WidgetComponent));
RadioButtonsWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'radio-buttons-widget',
                template: "<div class=\"adf-radio-buttons-widget {{field.className}}\"\n     [class.adf-invalid]=\"!field.isValid\" [class.adf-readonly]=\"field.readOnly\" [id]=\"field.id\">\n    <div class=\"adf-radio-button-container\">\n        <label class=\"adf-label\" [attr.for]=\"field.id\">{{field.name}}<span *ngIf=\"isRequired()\">*</span></label>\n        <mat-radio-group class=\"adf-radio-group\" [(ngModel)]=\"field.value\">\n            <mat-radio-button\n                [id]=\"field.id + '-' + opt.id\"\n                [name]=\"field.id\"\n                [value]=\"opt.id\"\n                [disabled]=\"field.readOnly\"\n                [checked]=\"field.value === opt.id\"\n                (change)=\"onOptionClick(opt.id)\"\n                color=\"primary\"\n                class=\"adf-radio-button\" *ngFor=\"let opt of field.options\" >\n                {{opt.name}}\n            </mat-radio-button>\n        </mat-radio-group>\n    </div>\n    <error-widget [error]=\"field.validationSummary\" ></error-widget>\n    <error-widget *ngIf=\"isInvalidFieldRequired()\" required=\"{{ 'FORM.FIELD.REQUIRED' | translate }}\"></error-widget>\n</div>\n\n\n",
                styles: [".adf-radio-button-container{margin-bottom:15px}.adf-radio-group{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.adf-radio-button{margin:5px}"],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
RadioButtonsWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
    { type: LogService, },
]; };
var CUSTOM_INPUT_CONTROL_VALUE_ACCESSOR = {
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef(function () { return InputMaskDirective; }),
    multi: true
};
var InputMaskDirective = /** @class */ (function () {
    function InputMaskDirective(el, render) {
        this.el = el;
        this.render = render;
        this.translationMask = {
            '0': { pattern: /\d/ },
            '9': { pattern: /\d/, optional: true },
            '#': { pattern: /\d/, recursive: true },
            'A': { pattern: /[a-zA-Z0-9]/ },
            'S': { pattern: /[a-zA-Z]/ }
        };
        this.byPassKeys = [9, 16, 17, 18, 36, 37, 38, 39, 40, 91];
        this.invalidCharacters = [];
        this._onChange = function (_) {
        };
        this._onTouched = function () {
        };
    }
    InputMaskDirective.prototype.onTextInput = function (event) {
        if (this.inputMask && this.inputMask.mask) {
            this.maskValue(this.el.nativeElement.value, this.el.nativeElement.selectionStart, this.inputMask.mask, this.inputMask.isReversed, event.keyCode);
        }
        else {
            this._onChange(this.el.nativeElement.value);
        }
    };
    InputMaskDirective.prototype.ngOnChanges = function (changes) {
        if (changes['inputMask'] && changes['inputMask'].currentValue['mask']) {
            this.inputMask = changes['inputMask'].currentValue;
        }
    };
    InputMaskDirective.prototype.writeValue = function (value) {
        this.el.nativeElement.value = value;
    };
    InputMaskDirective.prototype.registerOnChange = function (fn) {
        this._onChange = fn;
    };
    InputMaskDirective.prototype.registerOnTouched = function (fn) {
        this._onTouched = fn;
    };
    InputMaskDirective.prototype.maskValue = function (actualValue, startCaret, maskToApply, isMaskReversed, keyCode) {
        if (this.byPassKeys.indexOf(keyCode) === -1) {
            var value = this.getMasked(false, actualValue, maskToApply, isMaskReversed);
            var calculatedCaret = this.calculateCaretPosition(startCaret, actualValue, keyCode);
            this.render.setElementAttribute(this.el.nativeElement, 'value', value);
            this.el.nativeElement.value = value;
            this.setValue(value);
            this._onChange(value);
            this.setCaretPosition(calculatedCaret);
        }
    };
    InputMaskDirective.prototype.setCaretPosition = function (caretPosition) {
        this.el.nativeElement.moveStart = caretPosition;
        this.el.nativeElement.moveEnd = caretPosition;
    };
    InputMaskDirective.prototype.calculateCaretPosition = function (caretPosition, newValue, keyCode) {
        var newValueLength = newValue.length;
        var oldValue = this.getValue() || '';
        var oldValueLength = oldValue.length;
        if (keyCode === 8 && oldValue !== newValue) {
            caretPosition = caretPosition - (newValue.slice(0, caretPosition).length - oldValue.slice(0, caretPosition).length);
        }
        else if (oldValue !== newValue) {
            if (caretPosition >= oldValueLength) {
                caretPosition = newValueLength;
            }
            else {
                caretPosition = caretPosition + (newValue.slice(0, caretPosition).length - oldValue.slice(0, caretPosition).length);
            }
        }
        return caretPosition;
    };
    InputMaskDirective.prototype.getMasked = function (skipMaskChars, val, mask, isReversed) {
        if (isReversed === void 0) { isReversed = false; }
        var buf = [], value = val, maskIndex = 0, maskLen = mask.length, valueIndex = 0, valueLength = value.length, offset = 1, addMethod = 'push', resetPos = -1, lastMaskChar, lastUntranslatedMaskChar, check;
        if (isReversed) {
            addMethod = 'unshift';
            offset = -1;
            lastMaskChar = 0;
            maskIndex = maskLen - 1;
            valueIndex = valueLength - 1;
        }
        else {
            lastMaskChar = maskLen - 1;
        }
        check = this.isToCheck(isReversed, maskIndex, maskLen, valueIndex, valueLength);
        while (check) {
            var maskDigit = mask.charAt(maskIndex), valDigit = value.charAt(valueIndex), translation = this.translationMask[maskDigit];
            if (translation) {
                if (valDigit.match(translation.pattern)) {
                    buf[addMethod](valDigit);
                    if (translation.recursive) {
                        if (resetPos === -1) {
                            resetPos = maskIndex;
                        }
                        else if (maskIndex === lastMaskChar) {
                            maskIndex = resetPos - offset;
                        }
                        if (lastMaskChar === resetPos) {
                            maskIndex -= offset;
                        }
                    }
                    maskIndex += offset;
                }
                else if (valDigit === lastUntranslatedMaskChar) {
                    lastUntranslatedMaskChar = undefined;
                }
                else if (translation.optional) {
                    maskIndex += offset;
                    valueIndex -= offset;
                }
                else {
                    this.invalidCharacters.push({
                        index: valueIndex,
                        digit: valDigit,
                        translated: translation.pattern
                    });
                }
                valueIndex += offset;
            }
            else {
                if (!skipMaskChars) {
                    buf[addMethod](maskDigit);
                }
                if (valDigit === maskDigit) {
                    valueIndex += offset;
                }
                else {
                    lastUntranslatedMaskChar = maskDigit;
                }
                maskIndex += offset;
            }
            check = this.isToCheck(isReversed, maskIndex, maskLen, valueIndex, valueLength);
        }
        var lastMaskCharDigit = mask.charAt(lastMaskChar);
        if (maskLen === valueLength + 1 && !this.translationMask[lastMaskCharDigit]) {
            buf.push(lastMaskCharDigit);
        }
        return buf.join('');
    };
    InputMaskDirective.prototype.isToCheck = function (isReversed, maskIndex, maskLen, valueIndex, valueLength) {
        var check = false;
        if (isReversed) {
            check = (maskIndex > -1) && (valueIndex > -1);
        }
        else {
            check = (maskIndex < maskLen) && (valueIndex < valueLength);
        }
        return check;
    };
    InputMaskDirective.prototype.setValue = function (value) {
        this.value = value;
    };
    InputMaskDirective.prototype.getValue = function () {
        return this.value;
    };
    return InputMaskDirective;
}());
InputMaskDirective.decorators = [
    { type: Directive, args: [{
                selector: '[textMask]',
                providers: [CUSTOM_INPUT_CONTROL_VALUE_ACCESSOR]
            },] },
];
InputMaskDirective.ctorParameters = function () { return [
    { type: ElementRef, },
    { type: Renderer, },
]; };
InputMaskDirective.propDecorators = {
    "inputMask": [{ type: Input, args: ['textMask',] },],
    "onTextInput": [{ type: HostListener, args: ['input', ['$event'],] }, { type: HostListener, args: ['keyup', ['$event'],] },],
};
var TextWidgetComponent = /** @class */ (function (_super) {
    __extends(TextWidgetComponent, _super);
    function TextWidgetComponent(formService) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        return _this;
    }
    TextWidgetComponent.prototype.ngOnInit = function () {
        if (this.field.params) {
            this.mask = this.field.params['inputMask'];
            this.placeholder = this.field.params['inputMask'] && this.field.params['inputMaskPlaceholder'] ? this.field.params['inputMaskPlaceholder'] : this.field.placeholder;
            this.isMaskReversed = this.field.params['inputMaskReversed'] ? this.field.params['inputMaskReversed'] : false;
        }
    };
    return TextWidgetComponent;
}(WidgetComponent));
TextWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'text-widget',
                template: "<div class=\"adf-textfield adf-text-widget {{field.className}}\"\n     [class.adf-invalid]=\"!field.isValid\" [class.adf-readonly]=\"field.readOnly\">\n    <mat-form-field>\n        <label class=\"adf-label\" [attr.for]=\"field.id\">{{field.name}}<span *ngIf=\"isRequired()\">*</span></label>\n        <input matInput\n               class=\"adf-input\"\n               type=\"text\"\n               [id]=\"field.id\"\n               [required]=\"isRequired()\"\n               [value]=\"field.value\"\n               [(ngModel)]=\"field.value\"\n               (ngModelChange)=\"onFieldChanged(field)\"\n               [disabled]=\"field.readOnly || readOnly\"\n               [textMask]=\"{mask: mask, isReversed: isMaskReversed}\"\n               [placeholder]=\"placeholder\">\n    </mat-form-field>\n    <error-widget [error]=\"field.validationSummary\"></error-widget>\n    <error-widget *ngIf=\"isInvalidFieldRequired()\" required=\"{{ 'FORM.FIELD.REQUIRED' | translate }}\"></error-widget>\n</div>\n",
                styles: [".adf-text-widget{width:100%}"],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
TextWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
]; };
var TypeaheadWidgetComponent = /** @class */ (function (_super) {
    __extends(TypeaheadWidgetComponent, _super);
    function TypeaheadWidgetComponent(formService, logService) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        _this.logService = logService;
        _this.minTermLength = 1;
        _this.options = [];
        return _this;
    }
    TypeaheadWidgetComponent.prototype.ngOnInit = function () {
        if (this.field.form.taskId && this.field.restUrl) {
            this.getValuesByTaskId();
        }
        else if (this.field.form.processDefinitionId && this.field.restUrl) {
            this.getValuesByProcessDefinitionId();
        }
        if (this.isReadOnlyType()) {
            this.value = this.field.value;
        }
    };
    TypeaheadWidgetComponent.prototype.getValuesByTaskId = function () {
        var _this = this;
        this.formService
            .getRestFieldValues(this.field.form.taskId, this.field.id)
            .subscribe(function (result) {
            var options = result || [];
            _this.field.options = options;
            var fieldValue = _this.field.value;
            if (fieldValue) {
                var toSelect = options.find(function (item) { return item.id === fieldValue || item.name.toLocaleLowerCase() === fieldValue.toLocaleLowerCase(); });
                if (toSelect) {
                    _this.value = toSelect.name;
                }
            }
            _this.onFieldChanged(_this.field);
            _this.field.updateForm();
        }, function (err) { return _this.handleError(err); });
    };
    TypeaheadWidgetComponent.prototype.getValuesByProcessDefinitionId = function () {
        var _this = this;
        this.formService
            .getRestFieldValuesByProcessId(this.field.form.processDefinitionId, this.field.id)
            .subscribe(function (result) {
            var options = result || [];
            _this.field.options = options;
            var fieldValue = _this.field.value;
            if (fieldValue) {
                var toSelect = options.find(function (item) { return item.id === fieldValue; });
                if (toSelect) {
                    _this.value = toSelect.name;
                }
            }
            _this.onFieldChanged(_this.field);
            _this.field.updateForm();
        }, function (err) { return _this.handleError(err); });
    };
    TypeaheadWidgetComponent.prototype.getOptions = function () {
        var val = this.value.trim().toLocaleLowerCase();
        return this.field.options.filter(function (item) {
            var name = item.name.toLocaleLowerCase();
            return name.indexOf(val) > -1;
        });
    };
    TypeaheadWidgetComponent.prototype.isValidOptionName = function (optionName) {
        var option = this.field.options.find(function (item) { return item.name && item.name.toLocaleLowerCase() === optionName.toLocaleLowerCase(); });
        return option ? true : false;
    };
    TypeaheadWidgetComponent.prototype.onKeyUp = function (event) {
        if (this.value && this.value.trim().length >= this.minTermLength && this.oldValue !== this.value) {
            if (event.keyCode !== ESCAPE && event.keyCode !== ENTER) {
                if (this.value.length >= this.minTermLength) {
                    this.options = this.getOptions();
                    this.oldValue = this.value;
                    if (this.isValidOptionName(this.value)) {
                        this.field.value = this.options[0].id;
                    }
                }
            }
        }
        if (this.isValueDefined() && this.value.trim().length === 0) {
            this.oldValue = this.value;
            this.options = [];
        }
    };
    TypeaheadWidgetComponent.prototype.onItemSelect = function (item) {
        if (item) {
            this.field.value = item.id;
            this.value = item.name;
            this.onFieldChanged(this.field);
        }
    };
    TypeaheadWidgetComponent.prototype.validate = function () {
        this.field.value = this.value;
    };
    TypeaheadWidgetComponent.prototype.isValueDefined = function () {
        return this.value !== null && this.value !== undefined;
    };
    TypeaheadWidgetComponent.prototype.handleError = function (error) {
        this.logService.error(error);
    };
    TypeaheadWidgetComponent.prototype.isReadOnlyType = function () {
        return this.field.type === 'readonly' ? true : false;
    };
    return TypeaheadWidgetComponent;
}(WidgetComponent));
TypeaheadWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'typeahead-widget',
                template: "<div class=\"adf-typeahead-widget-container\">\n    <div class=\"adf-typeahead-widget {{field.className}}\"\n        [class.is-dirty]=\"value\"\n        [class.adf-invalid]=\"!field.isValid\"\n        [class.adf-readonly]=\"field.readOnly\"\n        id=\"typehead-div\">\n        <mat-form-field>\n            <label class=\"adf-label\" [attr.for]=\"field.id\">{{field.name}}</label>\n            <input matInput class=\"adf-input\"\n                   type=\"text\"\n                   [id]=\"field.id\"\n                   [(ngModel)]=\"value\"\n                   (ngModelChange)=\"validate()\"\n                   (keyup)=\"onKeyUp($event)\"\n                   [disabled]=\"field.readOnly\"\n                   placeholder=\"{{field.placeholder}}\"\n                   [matAutocomplete]=\"auto\">\n            <mat-autocomplete #auto=\"matAutocomplete\" (optionSelected)=\"onItemSelect($event.option.value)\">\n                <mat-option *ngFor=\"let item of options\" [value]=\"item\">\n                    <span [id]=\"field.name+'_option_'+item.id\">{{item.name}}</span>\n                </mat-option>\n            </mat-autocomplete>\n        </mat-form-field>\n\n        <error-widget [error]=\"field.validationSummary\"></error-widget>\n        <error-widget *ngIf=\"isInvalidFieldRequired()\" required=\"{{ 'FORM.FIELD.REQUIRED' | translate }}\"></error-widget>\n    </div>\n</div>\n",
                styles: [".adf-typeahead-widget-container{position:relative;display:block}.adf-typeahead-widget{width:100%}"],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
TypeaheadWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
    { type: LogService, },
]; };
var UploadWidgetComponent = /** @class */ (function (_super) {
    __extends(UploadWidgetComponent, _super);
    function UploadWidgetComponent(formService, logService, thumbnailService, processContentService) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        _this.logService = logService;
        _this.thumbnailService = thumbnailService;
        _this.processContentService = processContentService;
        _this.multipleOption = '';
        return _this;
    }
    UploadWidgetComponent.prototype.ngOnInit = function () {
        if (this.field &&
            this.field.value &&
            this.field.value.length > 0) {
            this.hasFile = true;
        }
        this.getMultipleFileParam();
    };
    UploadWidgetComponent.prototype.removeFile = function (file) {
        if (this.field) {
            this.removeElementFromList(file);
        }
    };
    UploadWidgetComponent.prototype.onFileChanged = function (event) {
        var _this = this;
        var files = event.target.files;
        var filesSaved = [];
        if (this.field.json.value) {
            filesSaved = __spread(this.field.json.value);
        }
        if (files && files.length > 0) {
            Observable.from(files).mergeMap(function (file) { return _this.uploadRawContent(file); }).subscribe(function (res) {
                filesSaved.push(res);
            }, function (error) {
                _this.logService.error('Error uploading file. See console output for more details.');
            }, function () {
                _this.field.value = filesSaved;
                _this.field.json.value = filesSaved;
            });
            this.hasFile = true;
        }
    };
    UploadWidgetComponent.prototype.uploadRawContent = function (file) {
        var _this = this;
        return this.processContentService.createTemporaryRawRelatedContent(file)
            .map(function (response) {
            _this.logService.info(response);
            response.contentBlob = file;
            return response;
        });
    };
    UploadWidgetComponent.prototype.getMultipleFileParam = function () {
        if (this.field &&
            this.field.params && this.field.params["multiple"]) {
            this.multipleOption = this.field.params["multiple"] ? 'multiple' : '';
        }
    };
    UploadWidgetComponent.prototype.removeElementFromList = function (file) {
        var index = this.field.value.indexOf(file);
        if (index !== -1) {
            this.field.value.splice(index, 1);
            this.field.json.value = this.field.value;
            this.field.updateForm();
        }
        this.hasFile = this.field.value.length > 0;
        this.resetFormValueWithNoFiles();
    };
    UploadWidgetComponent.prototype.resetFormValueWithNoFiles = function () {
        if (this.field.value.length === 0) {
            this.field.value = [];
            this.field.json.value = [];
        }
    };
    UploadWidgetComponent.prototype.getIcon = function (mimeType) {
        return this.thumbnailService.getMimeTypeIcon(mimeType);
    };
    UploadWidgetComponent.prototype.fileClicked = function (obj) {
        var _this = this;
        var file = new ContentLinkModel(obj);
        var fetch = this.processContentService.getContentPreview(file.id);
        if (file.isTypeImage() || file.isTypePdf()) {
            fetch = this.processContentService.getFileRawContent(file.id);
        }
        fetch.subscribe(function (blob) {
            file.contentBlob = blob;
            _this.formService.formContentClicked.next(file);
        }, function (error) {
            _this.logService.error('Unable to send event for file ' + file.name);
        });
    };
    return UploadWidgetComponent;
}(WidgetComponent));
UploadWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'upload-widget',
                template: "<div class=\"adf-upload-widget {{field.className}}\"\n     [class.adf-invalid]=\"!field.isValid\"\n     [class.adf-readonly]=\"field.readOnly\">\n    <label class=\"adf-label\" [attr.for]=\"field.id\">{{field.name}}<span *ngIf=\"isRequired()\">*</span></label>\n    <div class=\"adf-upload-widget-container\">\n        <div>\n            <mat-list *ngIf=\"hasFile\">\n                <mat-list-item class=\"adf-upload-files-row\" *ngFor=\"let file of field.value\">\n                    <img mat-list-icon class=\"adf-upload-widget__icon\"\n                         [id]=\"'file-'+file.id+'-icon'\"\n                         [src]=\"getIcon(file.mimeType)\"\n                         [alt]=\"mimeTypeIcon\"\n                         (click)=\"fileClicked(file)\"\n                         (keyup.enter)=\"fileClicked(file)\"\n                         role=\"button\"\n                         tabindex=\"0\"/>\n                    <span matLine id=\"{{'file-'+file.id}}\" (click)=\"fileClicked(file)\" (keyup.enter)=\"fileClicked(file)\"\n                          role=\"button\" tabindex=\"0\" class=\"adf-file\">{{file.name}}</span>\n                    <button *ngIf=\"!field.readOnly\" mat-icon-button [id]=\"'file-'+file.id+'-remove'\"\n                            (click)=\"removeFile(file);\" (keyup.enter)=\"removeFile(file);\">\n                        <mat-icon class=\"mat-24\">highlight_off</mat-icon>\n                    </button>\n                </mat-list-item>\n            </mat-list>\n        </div>\n\n        <div class=\"button-row\" *ngIf=\"(!hasFile || multipleOption) && !field.readOnly\">\n            <a mat-raised-button color=\"primary\">\n                {{ 'FORM.FIELD.UPLOAD' | translate }}<mat-icon>file_upload</mat-icon>\n                <input #uploadFiles\n                       [multiple]=\"multipleOption\"\n                       type=\"file\"\n                       [id]=\"field.id\"\n                       (change)=\"onFileChanged($event)\"/>\n            </a>\n        </div>\n    </div>\n    <error-widget [error]=\"field.validationSummary\"></error-widget>\n    <error-widget *ngIf=\"isInvalidFieldRequired()\" required=\"{{ 'FORM.FIELD.REQUIRED' | translate }}\"></error-widget>\n</div>\n",
                styles: [".adf-upload-widget-container{margin-bottom:15px}.adf-upload-widget-container input{cursor:pointer;height:100%;right:0;opacity:0;position:absolute;top:0;width:300px;z-index:4}.adf-upload-widget{width:100%;word-break:break-all;padding:.4375em 0;border-top:.84375em solid transparent}.adf-upload-widget__icon{padding:6px;float:left;cursor:pointer}.adf-upload-widget__reset{margin-top:-2px}.adf-upload-files-row .mat-line{margin-bottom:0}"],
                host: baseHost,
                encapsulation: ViewEncapsulation.None
            },] },
];
UploadWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
    { type: LogService, },
    { type: ThumbnailService, },
    { type: ProcessContentService, },
]; };
UploadWidgetComponent.propDecorators = {
    "fileInput": [{ type: ViewChild, args: ['uploadFiles',] },],
};
var 0$3 = MOMENT_DATE_FORMATS;
var 1$1 = MAT_MOMENT_DATETIME_FORMATS;
var DateTimeWidgetComponent = /** @class */ (function (_super) {
    __extends(DateTimeWidgetComponent, _super);
    function DateTimeWidgetComponent(formService, dateAdapter, preferences) {
        var _this = _super.call(this, formService) || this;
        _this.formService = formService;
        _this.dateAdapter = dateAdapter;
        _this.preferences = preferences;
        return _this;
    }
    DateTimeWidgetComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.preferences.locale$.subscribe(function (locale) {
            _this.dateAdapter.setLocale(locale);
        });
        var momentDateAdapter = (this.dateAdapter);
        momentDateAdapter.overrideDisplyaFormat = this.field.dateDisplayFormat;
        if (this.field) {
            if (this.field.minValue) {
                this.minDate = moment(this.field.minValue, 'YYYY-MM-DDTHH:mm:ssZ');
            }
            if (this.field.maxValue) {
                this.maxDate = moment(this.field.maxValue, 'YYYY-MM-DDTHH:mm:ssZ');
            }
        }
        this.displayDate = moment(this.field.value, this.field.dateDisplayFormat);
    };
    DateTimeWidgetComponent.prototype.onDateChanged = function (newDateValue) {
        if (newDateValue && newDateValue.value) {
            this.field.value = newDateValue.value.format(this.field.dateDisplayFormat);
        }
        else if (newDateValue) {
            this.field.value = newDateValue;
        }
        else {
            this.field.value = null;
        }
        this.onFieldChanged(this.field);
    };
    return DateTimeWidgetComponent;
}(WidgetComponent));
DateTimeWidgetComponent.decorators = [
    { type: Component, args: [{
                providers: [
                    { provide: DateAdapter, useClass: MomentDateAdapter },
                    { provide: MAT_DATE_FORMATS, useValue: 0$3 },
                    { provide: DatetimeAdapter, useClass: MomentDatetimeAdapter },
                    { provide: MAT_DATETIME_FORMATS, useValue: 1$1 }
                ],
                selector: 'date-time-widget',
                template: "<div class=\"{{field.className}}\"\n     id=\"data-time-widget\" [class.adf-invalid]=\"!field.isValid\">\n    <mat-form-field class=\"adf-date-time-widget\">\n        <label class=\"adf-label\" [attr.for]=\"field.id\">{{field.name}} ({{field.dateDisplayFormat}})<span *ngIf=\"isRequired()\">*</span></label>\n        <input matInput\n               [matDatetimepicker]=\"datetimePicker\"\n               [id]=\"field.id\"\n               [(ngModel)]=\"displayDate\"\n               [required]=\"isRequired()\"\n               [disabled]=\"field.readOnly\"\n               [min]=\"minDate\"\n               [max]=\"maxDate\"\n               (focusout)=\"onDateChanged($event.srcElement.value)\"\n               (dateChange)=\"onDateChanged($event)\"\n               placeholder=\"{{field.placeholder}}\">\n        <mat-datetimepicker-toggle matSuffix [for]=\"datetimePicker\" [disabled]=\"field.readOnly\"></mat-datetimepicker-toggle>\n    </mat-form-field>\n    <error-widget [error]=\"field.validationSummary\"></error-widget>\n    <error-widget *ngIf=\"isInvalidFieldRequired()\" required=\"{{ 'FORM.FIELD.REQUIRED' | translate }}\"></error-widget>\n    <mat-datetimepicker #datetimePicker type=\"datetime\" openOnFocus=\"true\" timeInterval=\"5\"></mat-datetimepicker>\n</div>\n",
                styles: [".adf-date-time-widget .mat-input-suffix{text-align:right;position:absolute;margin-top:30px;width:100%}"],
                encapsulation: ViewEncapsulation.None
            },] },
];
DateTimeWidgetComponent.ctorParameters = function () { return [
    { type: FormService, },
    { type: DateAdapter, },
    { type: UserPreferencesService, },
]; };
var WIDGET_DIRECTIVES = [
    UnknownWidgetComponent,
    TabsWidgetComponent,
    ContainerWidgetComponent,
    TextWidgetComponent,
    NumberWidgetComponent,
    CheckboxWidgetComponent,
    MultilineTextWidgetComponentComponent,
    DropdownWidgetComponent,
    HyperlinkWidgetComponent,
    RadioButtonsWidgetComponent,
    DisplayTextWidgetComponentComponent,
    UploadWidgetComponent,
    TypeaheadWidgetComponent,
    FunctionalGroupWidgetComponent,
    PeopleWidgetComponent,
    DateWidgetComponent,
    AmountWidgetComponent,
    DynamicTableWidgetComponent,
    DateEditorComponent,
    DropdownEditorComponent,
    BooleanEditorComponent,
    TextEditorComponent,
    RowEditorComponent,
    ErrorWidgetComponent,
    DocumentWidgetComponent,
    DateTimeWidgetComponent
];
var MASK_DIRECTIVE = [
    InputMaskDirective
];
var FormRenderingService = /** @class */ (function (_super) {
    __extends(FormRenderingService, _super);
    function FormRenderingService() {
        var _this = _super.call(this) || this;
        _this.defaultValue = UnknownWidgetComponent;
        _this.types = {
            'text': DynamicComponentResolver.fromType(TextWidgetComponent),
            'string': DynamicComponentResolver.fromType(TextWidgetComponent),
            'integer': DynamicComponentResolver.fromType(NumberWidgetComponent),
            'multi-line-text': DynamicComponentResolver.fromType(MultilineTextWidgetComponentComponent),
            'boolean': DynamicComponentResolver.fromType(CheckboxWidgetComponent),
            'dropdown': DynamicComponentResolver.fromType(DropdownWidgetComponent),
            'date': DynamicComponentResolver.fromType(DateWidgetComponent),
            'amount': DynamicComponentResolver.fromType(AmountWidgetComponent),
            'radio-buttons': DynamicComponentResolver.fromType(RadioButtonsWidgetComponent),
            'hyperlink': DynamicComponentResolver.fromType(HyperlinkWidgetComponent),
            'readonly-text': DynamicComponentResolver.fromType(DisplayTextWidgetComponentComponent),
            'typeahead': DynamicComponentResolver.fromType(TypeaheadWidgetComponent),
            'people': DynamicComponentResolver.fromType(PeopleWidgetComponent),
            'functional-group': DynamicComponentResolver.fromType(FunctionalGroupWidgetComponent),
            'dynamic-table': DynamicComponentResolver.fromType(DynamicTableWidgetComponent),
            'container': DynamicComponentResolver.fromType(ContainerWidgetComponent),
            'group': DynamicComponentResolver.fromType(ContainerWidgetComponent),
            'document': DynamicComponentResolver.fromType(DocumentWidgetComponent),
            'upload': DynamicComponentResolver.fromType(UploadWidgetComponent),
            'datetime': DynamicComponentResolver.fromType(DateTimeWidgetComponent)
        };
        return _this;
    }
    return FormRenderingService;
}(DynamicComponentMapper));
FormRenderingService.decorators = [
    { type: Injectable },
];
FormRenderingService.ctorParameters = function () { return []; };
var ActivitiContentService = /** @class */ (function () {
    function ActivitiContentService(apiService, logService) {
        this.apiService = apiService;
        this.logService = logService;
    }
    ActivitiContentService.prototype.getAlfrescoNodes = function (accountId, folderId) {
        var _this = this;
        var apiService = this.apiService.getInstance();
        var accountShortId = accountId.replace('alfresco-', '');
        return Observable.fromPromise(apiService.activiti.alfrescoApi.getContentInFolder(accountShortId, folderId))
            .map(this.toJsonArray)
            .catch(function (err) { return _this.handleError(err); });
    };
    ActivitiContentService.prototype.getAlfrescoRepositories = function (tenantId, includeAccount) {
        var _this = this;
        var apiService = this.apiService.getInstance();
        var opts = {
            tenantId: tenantId,
            includeAccounts: includeAccount
        };
        return Observable.fromPromise(apiService.activiti.alfrescoApi.getRepositories(opts))
            .map(this.toJsonArray)
            .catch(function (err) { return _this.handleError(err); });
    };
    ActivitiContentService.prototype.linkAlfrescoNode = function (accountId, node, siteId) {
        var _this = this;
        var apiService = this.apiService.getInstance();
        return Observable.fromPromise(apiService.activiti.contentApi.createTemporaryRelatedContent({
            link: true,
            name: node.title,
            simpleType: node.simpleType,
            source: accountId,
            sourceId: node.id + '@' + siteId
        })).map(this.toJson).catch(function (err) { return _this.handleError(err); });
    };
    ActivitiContentService.prototype.applyAlfrescoNode = function (node, siteId, accountId) {
        var _this = this;
        var apiService = this.apiService.getInstance();
        var params = {
            source: accountId,
            sourceId: node.id + ';1.0@' + siteId,
            name: node.name,
            link: false
        };
        return Observable.fromPromise(apiService.activiti.contentApi.createTemporaryRelatedContent(params))
            .map(this.toJson)
            .catch(function (err) { return _this.handleError(err); });
    };
    ActivitiContentService.prototype.toJson = function (res) {
        if (res) {
            return res || {};
        }
        return {};
    };
    ActivitiContentService.prototype.toJsonArray = function (res) {
        if (res) {
            return res.data || [];
        }
        return [];
    };
    ActivitiContentService.prototype.handleError = function (error) {
        var errMsg = ActivitiContentService.UNKNOWN_ERROR_MESSAGE;
        if (error) {
            errMsg = (error.message) ? error.message :
                error.status ? error.status + " - " + error.statusText : ActivitiContentService.GENERIC_ERROR_MESSAGE;
        }
        this.logService.error(errMsg);
        return Observable.throw(errMsg);
    };
    return ActivitiContentService;
}());
ActivitiContentService.UNKNOWN_ERROR_MESSAGE = 'Unknown error';
ActivitiContentService.GENERIC_ERROR_MESSAGE = 'Server error';
ActivitiContentService.decorators = [
    { type: Injectable },
];
ActivitiContentService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: LogService, },
]; };
var StartFormCustomButtonDirective = /** @class */ (function () {
    function StartFormCustomButtonDirective() {
    }
    return StartFormCustomButtonDirective;
}());
StartFormCustomButtonDirective.decorators = [
    { type: Directive, args: [{ selector: '[form-custom-button]' },] },
];
StartFormCustomButtonDirective.ctorParameters = function () { return []; };
var FormFieldComponent = /** @class */ (function () {
    function FormFieldComponent(formRenderingService, componentFactoryResolver, visibilityService, compiler) {
        this.formRenderingService = formRenderingService;
        this.componentFactoryResolver = componentFactoryResolver;
        this.visibilityService = visibilityService;
        this.compiler = compiler;
        this.field = null;
        this.focus = false;
    }
    FormFieldComponent.prototype.ngOnInit = function () {
        var _this = this;
        var w = window;
        if (w.adf === undefined) {
            w.adf = {};
        }
        var originalField = this.getField();
        if (originalField) {
            var customTemplate = this.field.form.customFieldTemplates[originalField.type];
            if (customTemplate && this.hasController(originalField.type)) {
                var factory = this.getComponentFactorySync(originalField.type, customTemplate);
                this.componentRef = this.container.createComponent(factory);
                var instance = this.componentRef.instance;
                if (instance) {
                    instance.field = originalField;
                }
            }
            else {
                var componentType = this.formRenderingService.resolveComponentType(originalField);
                if (componentType) {
                    var factory = this.componentFactoryResolver.resolveComponentFactory(componentType);
                    this.componentRef = this.container.createComponent(factory);
                    var instance = (this.componentRef.instance);
                    instance.field = this.field;
                    instance.fieldChanged.subscribe(function (field) {
                        if (field && _this.field.form) {
                            _this.visibilityService.refreshVisibility(field.form);
                            field.form.onFormFieldChanged(field);
                        }
                    });
                }
            }
        }
    };
    FormFieldComponent.prototype.ngOnDestroy = function () {
        if (this.componentRef) {
            this.componentRef.destroy();
            this.componentRef = null;
        }
    };
    FormFieldComponent.prototype.getField = function () {
        if (this.field && this.field.params) {
            var wrappedField = this.field.params["field"];
            if (wrappedField && wrappedField.type) {
                return wrappedField;
            }
        }
        return this.field;
    };
    FormFieldComponent.prototype.hasController = function (type) {
        return (adf && adf.components && adf.components[type]);
    };
    FormFieldComponent.prototype.getComponentFactorySync = function (type, template) {
        var componentInfo = adf.components[type];
        if (componentInfo.factory) {
            return componentInfo.factory;
        }
        var metadata = {
            selector: "runtime-component-" + type,
            template: template
        };
        var factory = this.createComponentFactorySync(this.compiler, metadata, componentInfo.class);
        componentInfo.factory = factory;
        return factory;
    };
    FormFieldComponent.prototype.createComponentFactorySync = function (compiler, metadata, componentClass) {
        var cmpClass = componentClass || /** @class */ (function () {
            function RuntimeComponent() {
            }
            return RuntimeComponent;
        }());
        var decoratedCmp = Component(metadata)(cmpClass);
        var RuntimeComponentModule = /** @class */ (function () {
            function RuntimeComponentModule() {
            }
            return RuntimeComponentModule;
        }());
        RuntimeComponentModule.decorators = [
            { type: NgModule, args: [{ imports: [], declarations: [decoratedCmp] },] },
        ];
        RuntimeComponentModule.ctorParameters = function () { return []; };
        var module = compiler.compileModuleAndAllComponentsSync(RuntimeComponentModule);
        return module.componentFactories.find(function (x) { return x.componentType === decoratedCmp; });
    };
    FormFieldComponent.prototype.focusToggle = function () {
        this.focus = !this.focus;
    };
    return FormFieldComponent;
}());
FormFieldComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-form-field, form-field',
                template: "\n        <div [id]=\"'field-'+field?.id+'-container'\"\n            [hidden]=\"!field?.isVisible\"\n            [class.adf-focus]=\"focus\"\n            (focusin)=\"focusToggle()\"\n            (focusout)=\"focusToggle()\">\n            <div #container></div>\n        </div>\n    ",
                encapsulation: ViewEncapsulation.None
            },] },
];
FormFieldComponent.ctorParameters = function () { return [
    { type: FormRenderingService, },
    { type: ComponentFactoryResolver, },
    { type: WidgetVisibilityService, },
    { type: Compiler, },
]; };
FormFieldComponent.propDecorators = {
    "container": [{ type: ViewChild, args: ['container', { read: ViewContainerRef },] },],
    "field": [{ type: Input },],
};
var FormModule = /** @class */ (function () {
    function FormModule() {
    }
    return FormModule;
}());
FormModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    CommonModule,
                    DataTableModule,
                    HttpModule,
                    MaterialModule,
                    TranslateModule,
                    FormsModule,
                    ReactiveFormsModule,
                    DataColumnModule,
                    PipeModule,
                    MatDatetimepickerModule,
                    MatNativeDatetimeModule
                ],
                declarations: __spread([
                    ContentWidgetComponent,
                    FormFieldComponent,
                    FormComponent,
                    FormListComponent,
                    StartFormComponent,
                    StartFormCustomButtonDirective
                ], WIDGET_DIRECTIVES, MASK_DIRECTIVE, [
                    WidgetComponent
                ]),
                entryComponents: __spread(WIDGET_DIRECTIVES),
                providers: [
                    ActivitiContentService,
                    EcmModelService,
                    FormRenderingService,
                    FormService,
                    NodeService,
                    ProcessContentService,
                    WidgetVisibilityService
                ],
                exports: __spread([
                    ContentWidgetComponent,
                    FormFieldComponent,
                    FormComponent,
                    FormListComponent,
                    StartFormComponent,
                    StartFormCustomButtonDirective
                ], WIDGET_DIRECTIVES)
            },] },
];
FormModule.ctorParameters = function () { return []; };
var SidenavLayoutContentDirective = /** @class */ (function () {
    function SidenavLayoutContentDirective() {
    }
    return SidenavLayoutContentDirective;
}());
SidenavLayoutContentDirective.decorators = [
    { type: Directive, args: [{
                selector: 'adf-sidenav-layout-content'
            },] },
];
SidenavLayoutContentDirective.ctorParameters = function () { return []; };
SidenavLayoutContentDirective.propDecorators = {
    "template": [{ type: ContentChild, args: [TemplateRef,] },],
};
var SidenavLayoutHeaderDirective = /** @class */ (function () {
    function SidenavLayoutHeaderDirective() {
    }
    return SidenavLayoutHeaderDirective;
}());
SidenavLayoutHeaderDirective.decorators = [
    { type: Directive, args: [{
                selector: 'adf-sidenav-layout-header'
            },] },
];
SidenavLayoutHeaderDirective.ctorParameters = function () { return []; };
SidenavLayoutHeaderDirective.propDecorators = {
    "template": [{ type: ContentChild, args: [TemplateRef,] },],
};
var SidenavLayoutNavigationDirective = /** @class */ (function () {
    function SidenavLayoutNavigationDirective() {
    }
    return SidenavLayoutNavigationDirective;
}());
SidenavLayoutNavigationDirective.decorators = [
    { type: Directive, args: [{
                selector: 'adf-sidenav-layout-navigation'
            },] },
];
SidenavLayoutNavigationDirective.ctorParameters = function () { return []; };
SidenavLayoutNavigationDirective.propDecorators = {
    "template": [{ type: ContentChild, args: [TemplateRef,] },],
};
var SidenavLayoutComponent = /** @class */ (function () {
    function SidenavLayoutComponent(mediaMatcher) {
        var _this = this;
        this.mediaMatcher = mediaMatcher;
        this.hideSidenav = false;
        this.expandedSidenav = true;
        this.templateContext = {
            toggleMenu: function () { },
            isMenuMinimized: function () { return _this.isMenuMinimized; }
        };
        this.onMediaQueryChange = this.onMediaQueryChange.bind(this);
    }
    SidenavLayoutComponent.prototype.ngOnInit = function () {
        var stepOver = this.stepOver || SidenavLayoutComponent.STEP_OVER;
        this.isMenuMinimized = !this.expandedSidenav;
        this.mediaQueryList = this.mediaMatcher.matchMedia("(max-width: " + stepOver + "px)");
        this.mediaQueryList.addListener(this.onMediaQueryChange);
    };
    SidenavLayoutComponent.prototype.ngAfterViewInit = function () {
        this.templateContext.toggleMenu = this.toggleMenu.bind(this);
    };
    SidenavLayoutComponent.prototype.ngOnDestroy = function () {
        this.mediaQueryList.removeListener(this.onMediaQueryChange);
    };
    SidenavLayoutComponent.prototype.toggleMenu = function () {
        if (!this.mediaQueryList.matches) {
            this.isMenuMinimized = !this.isMenuMinimized;
        }
        else {
            this.isMenuMinimized = false;
        }
        this.container.toggleMenu();
    };
    Object.defineProperty(SidenavLayoutComponent.prototype, "isHeaderInside", {
        get: function () {
            return this.mediaQueryList.matches;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SidenavLayoutComponent.prototype, "headerTemplate", {
        get: function () {
            return this.headerDirective && this.headerDirective.template || this.emptyTemplate;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SidenavLayoutComponent.prototype, "navigationTemplate", {
        get: function () {
            return this.navigationDirective && this.navigationDirective.template || this.emptyTemplate;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SidenavLayoutComponent.prototype, "contentTemplate", {
        get: function () {
            return this.contentDirective && this.contentDirective.template || this.emptyTemplate;
        },
        enumerable: true,
        configurable: true
    });
    SidenavLayoutComponent.prototype.onMediaQueryChange = function () {
        this.isMenuMinimized = false;
    };
    return SidenavLayoutComponent;
}());
SidenavLayoutComponent.STEP_OVER = 600;
SidenavLayoutComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-sidenav-layout',
                template: "<div class=\"sidenav-layout\">\n    <ng-container *ngIf=\"!isHeaderInside\">\n        <ng-container class=\"adf-sidenav-layout-outer-header\" *ngTemplateOutlet=\"headerTemplate; context:templateContext\"></ng-container>\n    </ng-container>\n\n    <adf-layout-container #container\n        [sidenavMin]=\"sidenavMin\"\n        [sidenavMax]=\"sidenavMax\"\n        [mediaQueryList]=\"mediaQueryList\"\n        [hideSidenav]=\"hideSidenav\"\n        [expandedSidenav]=\"expandedSidenav\"\n        data-automation-id=\"adf-layout-container\"\n        class=\"layout__content\">\n\n        <ng-container app-layout-navigation *ngTemplateOutlet=\"navigationTemplate; context:templateContext\"></ng-container>\n\n        <ng-container app-layout-content>\n            <ng-container *ngIf=\"isHeaderInside\">\n                <ng-container *ngTemplateOutlet=\"headerTemplate; context:templateContext\"></ng-container>\n            </ng-container>\n            <ng-container *ngTemplateOutlet=\"contentTemplate; context:templateContext\"></ng-container>\n        </ng-container>\n    </adf-layout-container>\n</div>\n\n<ng-template #emptyTemplate></ng-template>",
                styles: [":host{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1;flex:1}:host .sidenav-layout{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}:host .sidenav-layout .layout__content{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}:host router-outlet{-webkit-box-flex:0;-ms-flex:0 0;flex:0 0}"]
            },] },
];
SidenavLayoutComponent.ctorParameters = function () { return [
    { type: MediaMatcher, },
]; };
SidenavLayoutComponent.propDecorators = {
    "sidenavMin": [{ type: Input },],
    "sidenavMax": [{ type: Input },],
    "stepOver": [{ type: Input },],
    "hideSidenav": [{ type: Input },],
    "expandedSidenav": [{ type: Input },],
    "headerDirective": [{ type: ContentChild, args: [SidenavLayoutHeaderDirective,] },],
    "navigationDirective": [{ type: ContentChild, args: [SidenavLayoutNavigationDirective,] },],
    "contentDirective": [{ type: ContentChild, args: [SidenavLayoutContentDirective,] },],
    "container": [{ type: ViewChild, args: ['container',] },],
    "emptyTemplate": [{ type: ViewChild, args: ['emptyTemplate',] },],
};
var sidenavAnimation = trigger('sidenavAnimation', [
    state('expanded', style({ width: '{{ width }}px' }), { params: { width: 0 } }),
    state('compact', style({ width: '{{ width }}px' }), { params: { width: 0 } }),
    transition('compact <=> expanded', animate('0.4s cubic-bezier(0.25, 0.8, 0.25, 1)'))
]);
var contentAnimation = trigger('contentAnimation', [
    state('expanded', style({ 'margin-left': '{{ marginLeft }}px' }), { params: { marginLeft: 0 } }),
    state('compact', style({ 'margin-left': '{{ marginLeft }}px' }), { params: { marginLeft: 0 } }),
    transition('expanded <=> compact', animate('400ms cubic-bezier(0.25, 0.8, 0.25, 1)'))
]);
var LayoutContainerComponent = /** @class */ (function () {
    function LayoutContainerComponent() {
        this.hideSidenav = false;
        this.expandedSidenav = true;
        this.SIDENAV_STATES = { MOBILE: {}, EXPANDED: {}, COMPACT: {} };
        this.CONTENT_STATES = { MOBILE: {}, EXPANDED: {}, COMPACT: {} };
        this.onMediaQueryChange = this.onMediaQueryChange.bind(this);
    }
    LayoutContainerComponent.prototype.ngOnInit = function () {
        this.SIDENAV_STATES.MOBILE = { value: 'expanded', params: { width: this.sidenavMax } };
        this.SIDENAV_STATES.EXPANDED = { value: 'expanded', params: { width: this.sidenavMax } };
        this.SIDENAV_STATES.COMPACT = { value: 'compact', params: { width: this.sidenavMin } };
        this.CONTENT_STATES.MOBILE = { value: 'expanded', params: { marginLeft: 0 } };
        this.CONTENT_STATES.EXPANDED = { value: 'expanded', params: { marginLeft: this.sidenavMin } };
        this.CONTENT_STATES.COMPACT = { value: 'compact', params: { marginLeft: this.sidenavMax } };
        this.mediaQueryList.addListener(this.onMediaQueryChange);
        if (this.isMobileScreenSize) {
            this.sidenavAnimationState = this.SIDENAV_STATES.MOBILE;
            this.contentAnimationState = this.CONTENT_STATES.MOBILE;
        }
        else if (this.expandedSidenav) {
            this.sidenavAnimationState = this.SIDENAV_STATES.EXPANDED;
            this.contentAnimationState = this.CONTENT_STATES.COMPACT;
        }
        else {
            this.sidenavAnimationState = this.SIDENAV_STATES.COMPACT;
            this.contentAnimationState = this.CONTENT_STATES.EXPANDED;
        }
    };
    LayoutContainerComponent.prototype.ngOnDestroy = function () {
        this.mediaQueryList.removeListener(this.onMediaQueryChange);
    };
    LayoutContainerComponent.prototype.toggleMenu = function () {
        if (this.isMobileScreenSize) {
            this.sidenav.toggle();
        }
        else {
            this.sidenavAnimationState = this.toggledSidenavAnimation;
            this.contentAnimationState = this.toggledContentAnimation;
        }
    };
    Object.defineProperty(LayoutContainerComponent.prototype, "toggledSidenavAnimation", {
        get: function () {
            return this.sidenavAnimationState === this.SIDENAV_STATES.EXPANDED
                ? this.SIDENAV_STATES.COMPACT
                : this.SIDENAV_STATES.EXPANDED;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LayoutContainerComponent.prototype, "toggledContentAnimation", {
        get: function () {
            if (this.isMobileScreenSize) {
                return this.CONTENT_STATES.MOBILE;
            }
            if (this.sidenavAnimationState === this.SIDENAV_STATES.EXPANDED) {
                return this.CONTENT_STATES.COMPACT;
            }
            else {
                return this.CONTENT_STATES.EXPANDED;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LayoutContainerComponent.prototype, "isMobileScreenSize", {
        get: function () {
            return this.mediaQueryList.matches;
        },
        enumerable: true,
        configurable: true
    });
    LayoutContainerComponent.prototype.onMediaQueryChange = function () {
        this.sidenavAnimationState = this.SIDENAV_STATES.EXPANDED;
        this.contentAnimationState = this.toggledContentAnimation;
    };
    return LayoutContainerComponent;
}());
LayoutContainerComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-layout-container',
                template: "<mat-sidenav-container>\n    <mat-sidenav\n        [ngClass]=\"{ 'sidenav--hidden': hideSidenav }\"\n        [@sidenavAnimation]=\"sidenavAnimationState\"\n        [opened]=\"!isMobileScreenSize\"\n        [mode]=\"isMobileScreenSize ? 'over' : 'side'\">\n        <ng-content sidenav select=\"[app-layout-navigation]\"></ng-content>\n    </mat-sidenav>\n\n    <div>\n        <div [@contentAnimation]=\"contentAnimationState\" style=\"margin-left: 0 !important\">\n            <ng-content select=\"[app-layout-content]\"></ng-content>\n        </div>\n    </div>\n</mat-sidenav-container>\n",
                styles: [":host{display:block;width:100%;height:100%;overflow:hidden}ng-content{display:block;width:100%;height:100%;overflow:hidden}.sidenav--hidden{visibility:hidden!important;width:0!important;-webkit-transform:unset!important;transform:unset!important;opacity:0!important}.mat-sidenav-container{display:block;width:100%;height:100%;overflow:hidden}.mat-sidenav{overflow:hidden}:host ::ng-deep mat-sidenav-content{margin-left:0!important}.mat-drawer-transition .mat-drawer-content,.mat-sidenav-content{-webkit-transform:unset!important;transform:unset!important;-webkit-transition-property:unset!important;transition-property:unset!important;-webkit-transition-duration:unset!important;transition-duration:unset!important;-webkit-transition-timing-function:unset!important;transition-timing-function:unset!important}"],
                animations: [sidenavAnimation, contentAnimation]
            },] },
];
LayoutContainerComponent.ctorParameters = function () { return []; };
LayoutContainerComponent.propDecorators = {
    "sidenavMin": [{ type: Input },],
    "sidenavMax": [{ type: Input },],
    "mediaQueryList": [{ type: Input },],
    "hideSidenav": [{ type: Input },],
    "expandedSidenav": [{ type: Input },],
    "sidenav": [{ type: ViewChild, args: [MatSidenav,] },],
};
var SidenavLayoutModule = /** @class */ (function () {
    function SidenavLayoutModule() {
    }
    return SidenavLayoutModule;
}());
SidenavLayoutModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    CommonModule,
                    MaterialModule
                ],
                exports: [
                    SidenavLayoutHeaderDirective,
                    SidenavLayoutContentDirective,
                    SidenavLayoutNavigationDirective,
                    SidenavLayoutComponent,
                    LayoutContainerComponent
                ],
                declarations: [
                    SidenavLayoutHeaderDirective,
                    SidenavLayoutContentDirective,
                    SidenavLayoutNavigationDirective,
                    SidenavLayoutComponent,
                    LayoutContainerComponent
                ]
            },] },
];
SidenavLayoutModule.ctorParameters = function () { return []; };
var CommentListComponent = /** @class */ (function () {
    function CommentListComponent(datePipe, peopleProcessService, ecmUserService) {
        this.datePipe = datePipe;
        this.peopleProcessService = peopleProcessService;
        this.ecmUserService = ecmUserService;
        this.clickRow = new EventEmitter();
    }
    CommentListComponent.prototype.selectComment = function (comment) {
        if (this.selectedComment) {
            this.selectedComment.isSelected = false;
        }
        comment.isSelected = true;
        this.selectedComment = comment;
        this.clickRow.emit(this.selectedComment);
    };
    CommentListComponent.prototype.getUserShortName = function (user) {
        var shortName = '';
        if (user) {
            if (user.firstName) {
                shortName = user.firstName[0].toUpperCase();
            }
            if (user.lastName) {
                shortName += user.lastName[0].toUpperCase();
            }
        }
        return shortName;
    };
    CommentListComponent.prototype.isPictureDefined = function (user) {
        return user.pictureId || user.avatarId;
    };
    CommentListComponent.prototype.getUserImage = function (user) {
        if (this.isAContentUsers(user)) {
            return this.ecmUserService.getUserProfileImage(user.avatarId);
        }
        else {
            return this.peopleProcessService.getUserImage(user);
        }
    };
    CommentListComponent.prototype.transformDate = function (aDate) {
        var formattedDate;
        var givenDate = Number.parseInt(this.datePipe.transform(aDate, 'yMMdd'));
        var today = Number.parseInt(this.datePipe.transform(Date.now(), 'yMMdd'));
        if (givenDate === today) {
            formattedDate = 'Today, ' + this.datePipe.transform(aDate, 'hh:mm a');
        }
        else {
            var yesterday = Number.parseInt(this.datePipe.transform(Date.now() - 24 * 3600 * 1000, 'yMMdd'));
            if (givenDate === yesterday) {
                formattedDate = 'Yesterday, ' + this.datePipe.transform(aDate, 'hh:mm a');
            }
            else {
                formattedDate = this.datePipe.transform(aDate, 'MMM dd y, hh:mm a');
            }
        }
        return formattedDate;
    };
    CommentListComponent.prototype.isAContentUsers = function (user) {
        return user.avatarId;
    };
    return CommentListComponent;
}());
CommentListComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-comment-list',
                template: " <mat-list class=\"adf-comment-list\">\n    <mat-list-item *ngFor=\"let comment of comments\"\n                  (click)=\"selectComment(comment)\"\n                  class=\"adf-comment-list-item\"\n                  [class.is-selected]=\"comment.isSelected\"\n                  id=\"adf-comment-{{comment?.id}}\">\n        <div id=\"comment-user-icon\" class=\"adf-comment-img-container\">\n            <div\n                *ngIf=\"!isPictureDefined(comment.createdBy)\"\n                class=\"adf-comment-user-icon\">\n                {{getUserShortName(comment.createdBy)}}\n            </div>\n            <div>\n                <img *ngIf=\"isPictureDefined(comment.createdBy)\"\n                      class=\"adf-people-img\"\n                     [src]=\"getUserImage(comment.createdBy)\"\n                />\n            </div>\n        </div>\n        <div class=\"adf-comment-contents\">\n            <div matLine id=\"comment-user\" class=\"adf-comment-user-name\">\n                {{comment.createdBy?.firstName}} {{comment.createdBy?.lastName}}\n            </div>\n            <div matLine id=\"comment-message\" class=\"adf-comment-message\">\n                {{comment.message}}\n            </div>\n            <div matLine id=\"comment-time\" class=\"adf-comment-message-time\">\n                {{transformDate(comment.created)}}\n            </div>\n        </div>\n    </mat-list-item>\n</mat-list>\n",
                styles: [""],
                encapsulation: ViewEncapsulation.None
            },] },
];
CommentListComponent.ctorParameters = function () { return [
    { type: DatePipe, },
    { type: PeopleProcessService, },
    { type: EcmUserService, },
]; };
CommentListComponent.propDecorators = {
    "comments": [{ type: Input },],
    "clickRow": [{ type: Output },],
};
var CommentModel = /** @class */ (function () {
    function CommentModel(obj) {
        if (obj) {
            this.id = obj.id;
            this.message = obj.message;
            this.created = obj.created;
            this.createdBy = obj.createdBy;
            this.isSelected = obj.isSelected ? obj.isSelected : false;
        }
    }
    return CommentModel;
}());
var UserProcessModel = /** @class */ (function () {
    function UserProcessModel(obj) {
        this.pictureId = null;
        if (obj) {
            this.id = obj.id;
            this.email = obj.email || null;
            this.firstName = obj.firstName || null;
            this.lastName = obj.lastName || null;
            this.pictureId = obj.pictureId || null;
        }
    }
    return UserProcessModel;
}());
var CommentProcessService = /** @class */ (function () {
    function CommentProcessService(apiService, logService) {
        this.apiService = apiService;
        this.logService = logService;
    }
    CommentProcessService.prototype.addTaskComment = function (taskId, message) {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().activiti.taskApi.addTaskComment({ message: message }, taskId))
            .map(function (res) { return res; })
            .map(function (response) {
            return new CommentModel({
                id: response.id,
                message: response.message,
                created: response.created,
                createdBy: response.createdBy
            });
        }).catch(function (err) { return _this.handleError(err); });
    };
    CommentProcessService.prototype.getTaskComments = function (taskId) {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().activiti.taskApi.getTaskComments(taskId))
            .map(function (res) { return res; })
            .map(function (response) {
            var comments = [];
            response.data.forEach(function (comment) {
                var user = new UserProcessModel(comment.createdBy);
                comments.push(new CommentModel({ id: comment.id, message: comment.message, created: comment.created, createdBy: user }));
            });
            return comments;
        }).catch(function (err) { return _this.handleError(err); });
    };
    CommentProcessService.prototype.getProcessInstanceComments = function (processInstanceId) {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().activiti.commentsApi.getProcessInstanceComments(processInstanceId))
            .map(function (res) { return res; })
            .map(function (response) {
            var comments = [];
            response.data.forEach(function (comment) {
                var user = new UserProcessModel(comment.createdBy);
                comments.push(new CommentModel({ id: comment.id, message: comment.message, created: comment.created, createdBy: user }));
            });
            return comments;
        }).catch(function (err) { return _this.handleError(err); });
    };
    CommentProcessService.prototype.addProcessInstanceComment = function (processInstanceId, message) {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().activiti.commentsApi.addProcessInstanceComment({ message: message }, processInstanceId))
            .map(function (response) {
            return new CommentModel({
                id: response.id,
                message: response.message,
                created: response.created,
                createdBy: response.createdBy
            });
        }).catch(function (err) { return _this.handleError(err); });
    };
    CommentProcessService.prototype.handleError = function (error) {
        this.logService.error(error);
        return Observable.throw(error || 'Server error');
    };
    return CommentProcessService;
}());
CommentProcessService.decorators = [
    { type: Injectable },
];
CommentProcessService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: LogService, },
]; };
var CommentContentService = /** @class */ (function () {
    function CommentContentService(apiService, logService) {
        this.apiService = apiService;
        this.logService = logService;
    }
    CommentContentService.prototype.addNodeComment = function (nodeId, message) {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().core.commentsApi.addComment(nodeId, { content: message }))
            .map(function (response) {
            return new CommentModel({
                id: response.entry.id,
                message: response.entry.content,
                created: response.entry.createdAt,
                createdBy: response.entry.createdBy
            });
        }).catch(function (err) { return _this.handleError(err); });
    };
    CommentContentService.prototype.getNodeComments = function (nodeId) {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().core.commentsApi.getComments(nodeId))
            .map(function (response) {
            var comments = [];
            response.list.entries.forEach(function (comment) {
                comments.push(new CommentModel({
                    id: comment.entry.id,
                    message: comment.entry.content,
                    created: comment.entry.createdAt,
                    createdBy: comment.entry.createdBy
                }));
            });
            return comments;
        }).catch(function (err) { return _this.handleError(err); });
    };
    CommentContentService.prototype.handleError = function (error) {
        this.logService.error(error);
        return Observable.throw(error || 'Server error');
    };
    return CommentContentService;
}());
CommentContentService.decorators = [
    { type: Injectable },
];
CommentContentService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: LogService, },
]; };
var CommentsComponent = /** @class */ (function () {
    function CommentsComponent(commentProcessService, commentContentService) {
        var _this = this;
        this.commentProcessService = commentProcessService;
        this.commentContentService = commentContentService;
        this.readOnly = false;
        this.error = new EventEmitter();
        this.comments = [];
        this.beingAdded = false;
        this.comment$ = new Observable(function (observer) { return _this.commentObserver = observer; }).share();
        this.comment$.subscribe(function (comment) {
            _this.comments.push(comment);
        });
    }
    CommentsComponent.prototype.ngOnChanges = function (changes) {
        this.taskId = null;
        this.nodeId = null;
        this.taskId = changes['taskId'] ? changes['taskId'].currentValue : null;
        this.nodeId = changes['nodeId'] ? changes['nodeId'].currentValue : null;
        if (this.taskId || this.nodeId) {
            this.getComments();
        }
        else {
            this.resetComments();
        }
    };
    CommentsComponent.prototype.getComments = function () {
        var _this = this;
        this.resetComments();
        if (this.isATask()) {
            this.commentProcessService.getTaskComments(this.taskId).subscribe(function (res) {
                if (res && res instanceof Array) {
                    res = res.sort(function (comment1, comment2) {
                        var date1 = new Date(comment1.created);
                        var date2 = new Date(comment2.created);
                        return date1 > date2 ? -1 : date1 < date2 ? 1 : 0;
                    });
                    res.forEach(function (comment) {
                        _this.commentObserver.next(comment);
                    });
                }
            }, function (err) {
                _this.error.emit(err);
            });
        }
        if (this.isANode()) {
            this.commentContentService.getNodeComments(this.nodeId).subscribe(function (res) {
                if (res && res instanceof Array) {
                    res = res.sort(function (comment1, comment2) {
                        var date1 = new Date(comment1.created);
                        var date2 = new Date(comment2.created);
                        return date1 > date2 ? -1 : date1 < date2 ? 1 : 0;
                    });
                    res.forEach(function (comment) {
                        _this.commentObserver.next(comment);
                    });
                }
            }, function (err) {
                _this.error.emit(err);
            });
        }
    };
    CommentsComponent.prototype.resetComments = function () {
        this.comments = [];
    };
    CommentsComponent.prototype.add = function () {
        var _this = this;
        if (this.message && this.message.trim() && !this.beingAdded) {
            this.beingAdded = true;
            if (this.isATask()) {
                this.commentProcessService.addTaskComment(this.taskId, this.message)
                    .subscribe(function (res) {
                    _this.comments.unshift(res);
                    _this.message = '';
                    _this.beingAdded = false;
                }, function (err) {
                    _this.error.emit(err);
                    _this.beingAdded = false;
                });
            }
            if (this.isANode()) {
                this.commentContentService.addNodeComment(this.nodeId, this.message)
                    .subscribe(function (res) {
                    _this.comments.unshift(res);
                    _this.message = '';
                    _this.beingAdded = false;
                }, function (err) {
                    _this.error.emit(err);
                    _this.beingAdded = false;
                });
            }
        }
    };
    CommentsComponent.prototype.clear = function () {
        this.message = '';
    };
    CommentsComponent.prototype.isReadOnly = function () {
        return this.readOnly;
    };
    CommentsComponent.prototype.isATask = function () {
        return this.taskId ? true : false;
    };
    CommentsComponent.prototype.isANode = function () {
        return this.nodeId ? true : false;
    };
    return CommentsComponent;
}());
CommentsComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-comments',
                template: "<div class=\"adf-comments-container\">\n    <div id=\"comment-header\" class=\"adf-comments-header\">\n        {{'COMMENTS.HEADER' | translate: { count: comments?.length} }}\n    </div>\n    <div class=\"adf-comments-input-container\" *ngIf=\"!isReadOnly()\">\n            <mat-form-field class=\"adf-full-width\">\n                <input matInput id=\"comment-input\" placeholder=\"{{'COMMENTS.ADD' | translate}}\" [(ngModel)]=\"message\" (keyup.enter)=\"add()\" (keyup.esc)=\"clear()\">\n            </mat-form-field>\n    </div>\n\n    <div *ngIf=\"comments.length > 0\">\n        <adf-comment-list [comments]=\"comments\">\n        </adf-comment-list>\n    </div>\n</div>\n",
                styles: [""]
            },] },
];
CommentsComponent.ctorParameters = function () { return [
    { type: CommentProcessService, },
    { type: CommentContentService, },
]; };
CommentsComponent.propDecorators = {
    "taskId": [{ type: Input },],
    "nodeId": [{ type: Input },],
    "readOnly": [{ type: Input },],
    "error": [{ type: Output },],
};
var CommentsModule = /** @class */ (function () {
    function CommentsModule() {
    }
    return CommentsModule;
}());
CommentsModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    DataColumnModule,
                    DataTableModule,
                    FormsModule,
                    ReactiveFormsModule,
                    MaterialModule,
                    CommonModule,
                    TranslateModule
                ],
                declarations: [
                    CommentListComponent,
                    CommentsComponent
                ],
                exports: [
                    CommentListComponent,
                    CommentsComponent
                ]
            },] },
];
CommentsModule.ctorParameters = function () { return []; };
var AuthGuard = /** @class */ (function () {
    function AuthGuard(authService, router, appConfig) {
        this.authService = authService;
        this.router = router;
        this.appConfig = appConfig;
    }
    AuthGuard.prototype.canActivate = function (route, state$$1) {
        var redirectUrl = state$$1.url;
        return this.checkLogin(redirectUrl);
    };
    AuthGuard.prototype.canActivateChild = function (route, state$$1) {
        return this.canActivate(route, state$$1);
    };
    AuthGuard.prototype.checkLogin = function (redirectUrl) {
        if (this.authService.isLoggedIn()) {
            return true;
        }
        this.authService.setRedirectUrl({ provider: 'ALL', url: redirectUrl });
        var pathToLogin = this.getRouteDestinationForLogin();
        this.router.navigate(['/' + pathToLogin]);
        return false;
    };
    AuthGuard.prototype.getRouteDestinationForLogin = function () {
        return this.appConfig &&
            this.appConfig.get('loginRoute') ?
            this.appConfig.get('loginRoute') : 'login';
    };
    return AuthGuard;
}());
AuthGuard.decorators = [
    { type: Injectable },
];
AuthGuard.ctorParameters = function () { return [
    { type: AuthenticationService, },
    { type: Router, },
    { type: AppConfigService, },
]; };
var AuthGuardEcm = /** @class */ (function () {
    function AuthGuardEcm(authService, apiService, router, appConfig) {
        this.authService = authService;
        this.apiService = apiService;
        this.router = router;
        this.appConfig = appConfig;
    }
    Object.defineProperty(AuthGuardEcm.prototype, "authApi", {
        get: function () {
            return this.apiService.getInstance().ecmAuth;
        },
        enumerable: true,
        configurable: true
    });
    AuthGuardEcm.prototype.isLoggedIn = function () {
        if (!this.authApi.isLoggedIn()) {
            return Promise.resolve(false);
        }
        return this.authApi
            .validateTicket()
            .then(function () { return true; }, function () { return false; })
            .catch(function () { return false; });
    };
    AuthGuardEcm.prototype.canActivateChild = function (route, state$$1) {
        return this.canActivate(route, state$$1);
    };
    AuthGuardEcm.prototype.canActivate = function (route, state$$1) {
        var _this = this;
        return this.isLoggedIn().then(function (isLoggedIn) {
            if (!isLoggedIn) {
                _this.authService.setRedirectUrl({ provider: 'ECM', url: state$$1.url });
                var pathToLogin = _this.getRouteDestinationForLogin();
                _this.router.navigate(['/' + pathToLogin]);
            }
            return isLoggedIn;
        });
    };
    AuthGuardEcm.prototype.getRouteDestinationForLogin = function () {
        return this.appConfig &&
            this.appConfig.get('loginRoute') ?
            this.appConfig.get('loginRoute') : 'login';
    };
    return AuthGuardEcm;
}());
AuthGuardEcm.decorators = [
    { type: Injectable },
];
AuthGuardEcm.ctorParameters = function () { return [
    { type: AuthenticationService, },
    { type: AlfrescoApiService, },
    { type: Router, },
    { type: AppConfigService, },
]; };
var AuthGuardBpm = /** @class */ (function () {
    function AuthGuardBpm(authService, router, appConfig) {
        this.authService = authService;
        this.router = router;
        this.appConfig = appConfig;
    }
    AuthGuardBpm.prototype.canActivate = function (route, state$$1) {
        return this.checkLogin(state$$1.url);
    };
    AuthGuardBpm.prototype.canActivateChild = function (route, state$$1) {
        return this.canActivate(route, state$$1);
    };
    AuthGuardBpm.prototype.checkLogin = function (redirectUrl) {
        if (this.authService.isBpmLoggedIn()) {
            return true;
        }
        this.authService.setRedirectUrl({ provider: 'BPM', url: redirectUrl });
        var pathToLogin = this.getRouteDestinationForLogin();
        this.router.navigate(['/' + pathToLogin]);
        return false;
    };
    AuthGuardBpm.prototype.getRouteDestinationForLogin = function () {
        return this.appConfig &&
            this.appConfig.get('loginRoute') ?
            this.appConfig.get('loginRoute') : 'login';
    };
    return AuthGuardBpm;
}());
AuthGuardBpm.decorators = [
    { type: Injectable },
];
AuthGuardBpm.ctorParameters = function () { return [
    { type: AuthenticationService, },
    { type: Router, },
    { type: AppConfigService, },
]; };
var AppsProcessService = /** @class */ (function () {
    function AppsProcessService(apiService, logService) {
        this.apiService = apiService;
        this.logService = logService;
    }
    AppsProcessService.prototype.getDeployedApplications = function () {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().activiti.appsApi.getAppDefinitions())
            .map(function (response) {
            return response.data;
        })
            .catch(function (err) { return _this.handleError(err); });
    };
    AppsProcessService.prototype.getDeployedApplicationsByName = function (name) {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().activiti.appsApi.getAppDefinitions())
            .map(function (response) {
            return response.data.find(function (app) { return app.name === name; });
        })
            .catch(function (err) { return _this.handleError(err); });
    };
    AppsProcessService.prototype.getApplicationDetailsById = function (appId) {
        var _this = this;
        return Observable.fromPromise(this.apiService.getInstance().activiti.appsApi.getAppDefinitions())
            .map(function (response) {
            return response.data.find(function (app) { return app.id === appId; });
        })
            .catch(function (err) { return _this.handleError(err); });
    };
    AppsProcessService.prototype.handleError = function (error) {
        this.logService.error(error);
        return Observable.throw(error || 'Server error');
    };
    return AppsProcessService;
}());
AppsProcessService.decorators = [
    { type: Injectable },
];
AppsProcessService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: LogService, },
]; };
var PageTitleService = /** @class */ (function () {
    function PageTitleService(titleService, appConfig) {
        this.titleService = titleService;
        this.appConfig = appConfig;
    }
    PageTitleService.prototype.setTitle = function (value) {
        if (value === void 0) { value = ''; }
        var name = this.appConfig.get('application.name') || 'Alfresco ADF Application';
        var title = value ? value + " - " + name : "" + name;
        this.titleService.setTitle(title);
    };
    return PageTitleService;
}());
PageTitleService.decorators = [
    { type: Injectable },
];
PageTitleService.ctorParameters = function () { return [
    { type: Title, },
    { type: AppConfigService, },
]; };
var RenditionsService = /** @class */ (function () {
    function RenditionsService(apiService) {
        this.apiService = apiService;
    }
    RenditionsService.prototype.isRenditionAvailable = function (nodeId, encoding) {
        var _this = this;
        return Observable.create(function (observer) {
            _this.getRendition(nodeId, encoding).subscribe(function (res) {
                var isAvailable = true;
                if (res.entry.status.toString() === 'NOT_CREATED') {
                    isAvailable = false;
                }
                observer.next(isAvailable);
                observer.complete();
            }, function () {
                observer.next(false);
                observer.complete();
            });
        });
    };
    RenditionsService.prototype.isConversionPossible = function (nodeId, encoding) {
        var _this = this;
        return Observable.create(function (observer) {
            _this.getRendition(nodeId, encoding).subscribe(function () {
                observer.next(true);
                observer.complete();
            }, function () {
                observer.next(false);
                observer.complete();
            });
        });
    };
    RenditionsService.prototype.getRenditionUrl = function (nodeId, encoding) {
        return this.apiService.contentApi.getRenditionUrl(nodeId, encoding);
    };
    RenditionsService.prototype.getRendition = function (nodeId, encoding) {
        return Observable.fromPromise(this.apiService.renditionsApi.getRendition(nodeId, encoding));
    };
    RenditionsService.prototype.getRenditionsListByNodeId = function (nodeId) {
        return Observable.fromPromise(this.apiService.renditionsApi.getRenditions(nodeId));
    };
    RenditionsService.prototype.createRendition = function (nodeId, encoding) {
        return Observable.fromPromise(this.apiService.renditionsApi.createRendition(nodeId, { id: encoding }));
    };
    RenditionsService.prototype.convert = function (nodeId, encoding, pollingInterval, retries) {
        var _this = this;
        if (pollingInterval === void 0) { pollingInterval = 1000; }
        if (retries === void 0) { retries = 5; }
        return this.createRendition(nodeId, encoding)
            .concatMap(function () { return _this.pollRendition(nodeId, encoding, pollingInterval, retries); });
    };
    RenditionsService.prototype.pollRendition = function (nodeId, encoding, interval, retries) {
        var _this = this;
        if (interval === void 0) { interval = 1000; }
        if (retries === void 0) { retries = 5; }
        var attempts = 0;
        return Observable.interval(interval)
            .switchMap(function () { return _this.getRendition(nodeId, encoding); })
            .takeWhile(function (data) {
            attempts += 1;
            if (attempts > retries) {
                return false;
            }
            return (data.entry.status.toString() !== 'CREATED');
        });
    };
    return RenditionsService;
}());
RenditionsService.decorators = [
    { type: Injectable },
];
RenditionsService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
]; };
var ComponentTranslationModel = /** @class */ (function () {
    function ComponentTranslationModel(obj) {
        this.name = obj && obj.name;
        this.path = obj && obj.path;
        this.json = obj && obj.json || [];
    }
    return ComponentTranslationModel;
}());
var TranslateLoaderService = /** @class */ (function () {
    function TranslateLoaderService(http, logService) {
        this.http = http;
        this.logService = logService;
        this.prefix = 'i18n';
        this.suffix = '.json';
        this.providers = [];
        this.queue = [];
    }
    TranslateLoaderService.prototype.registerProvider = function (name, path) {
        var registered = this.providers.find(function (provider) { return provider.name === name; });
        if (registered) {
            registered.path = path;
        }
        else {
            this.providers.push(new ComponentTranslationModel({ name: name, path: path }));
        }
    };
    TranslateLoaderService.prototype.providerRegistered = function (name) {
        return this.providers.find(function (x) { return x.name === name; }) ? true : false;
    };
    TranslateLoaderService.prototype.getComponentToFetch = function (lang) {
        var _this = this;
        var observableBatch = [];
        if (!this.queue[lang]) {
            this.queue[lang] = [];
        }
        this.providers.forEach(function (component) {
            if (!_this.isComponentInQueue(lang, component.name)) {
                _this.queue[lang].push(component.name);
                var loader = Observable.create(function (observer) {
                    var translationUrl = component.path + "/" + _this.prefix + "/" + lang + _this.suffix + "?v=" + Date.now();
                    _this.http.get(translationUrl).pipe(map(function (res) {
                        component.json[lang] = res;
                    })).subscribe(function (result) {
                        observer.next(result);
                        observer.complete();
                    }, function () {
                        observer.next('');
                        observer.complete();
                    });
                });
                observableBatch.push(loader);
            }
        });
        return observableBatch;
    };
    TranslateLoaderService.prototype.init = function (lang) {
        if (this.queue[lang] === undefined) {
            this.queue[lang] = [];
        }
    };
    TranslateLoaderService.prototype.isComponentInQueue = function (lang, name) {
        return (this.queue[lang] || []).find(function (x) { return x === name; }) ? true : false;
    };
    TranslateLoaderService.prototype.getFullTranslationJSON = function (lang) {
        var result = {};
        this.providers
            .slice(0)
            .sort(function (a, b) {
            if (a.name === 'app') {
                return 1;
            }
            if (b.name === 'app') {
                return -1;
            }
            return a.name.localeCompare(b.name);
        })
            .forEach(function (model) {
            if (model.json && model.json[lang]) {
                result = ObjectUtils.merge(result, model.json[lang]);
            }
        });
        return result;
    };
    TranslateLoaderService.prototype.getTranslation = function (lang) {
        var _this = this;
        var observableBatch = this.getComponentToFetch(lang);
        return Observable.create(function (observer) {
            if (observableBatch.length > 0) {
                Observable.forkJoin(observableBatch).subscribe(function () {
                    var fullTranslation = _this.getFullTranslationJSON(lang);
                    if (fullTranslation) {
                        observer.next(fullTranslation);
                    }
                    observer.complete();
                }, function (err) {
                    _this.logService.error(err);
                });
            }
            else {
                var fullTranslation = _this.getFullTranslationJSON(lang);
                if (fullTranslation) {
                    observer.next(fullTranslation);
                }
            }
        });
    };
    return TranslateLoaderService;
}());
TranslateLoaderService.decorators = [
    { type: Injectable },
];
TranslateLoaderService.ctorParameters = function () { return [
    { type: HttpClient, },
    { type: LogService, },
]; };
var minimatch = minimatch___default__default || minimatch___default;
var UploadService = /** @class */ (function () {
    function UploadService(apiService, appConfigService) {
        this.apiService = apiService;
        this.queue = [];
        this.cache = {};
        this.totalComplete = 0;
        this.totalAborted = 0;
        this.totalError = 0;
        this.activeTask = null;
        this.excludedFileList = [];
        this.queueChanged = new Subject();
        this.fileUpload = new Subject();
        this.fileUploadStarting = new Subject();
        this.fileUploadCancelled = new Subject();
        this.fileUploadProgress = new Subject();
        this.fileUploadAborted = new Subject();
        this.fileUploadError = new Subject();
        this.fileUploadComplete = new Subject();
        this.fileUploadDeleted = new Subject();
        this.fileDeleted = new Subject();
        this.excludedFileList = (appConfigService.get('files.excluded'));
    }
    UploadService.prototype.isUploading = function () {
        return this.activeTask ? true : false;
    };
    UploadService.prototype.getQueue = function () {
        return this.queue;
    };
    UploadService.prototype.addToQueue = function () {
        var _this = this;
        var files = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            files[_i] = arguments[_i];
        }
        var allowedFiles = files.filter(function (f) { return _this.filterElement(f); });
        this.queue = this.queue.concat(allowedFiles);
        this.queueChanged.next(this.queue);
        return allowedFiles;
    };
    UploadService.prototype.filterElement = function (file) {
        var isAllowed = true;
        if (this.excludedFileList) {
            isAllowed = this.excludedFileList.filter(function (expr) { return minimatch(file.name, expr); }).length === 0;
        }
        return isAllowed;
    };
    UploadService.prototype.uploadFilesInTheQueue = function (emitter) {
        var _this = this;
        if (!this.activeTask) {
            var file = this.queue.find(function (f) { return f.status === FileUploadStatus.Pending; });
            if (file) {
                this.onUploadStarting(file);
                var promise = this.beginUpload(file, emitter);
                this.activeTask = promise;
                this.cache[file.id] = promise;
                var next_1 = function () {
                    _this.activeTask = null;
                    setTimeout(function () { return _this.uploadFilesInTheQueue(emitter); }, 100);
                };
                promise.next = next_1;
                promise.then(function () { return next_1(); }, function () { return next_1(); });
            }
        }
    };
    UploadService.prototype.cancelUpload = function () {
        var _this = this;
        var files = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            files[_i] = arguments[_i];
        }
        files.forEach(function (file) {
            var promise = _this.cache[file.id];
            if (promise) {
                promise.abort();
                delete _this.cache[file.id];
            }
            else {
                var performAction = _this.getAction(file);
                performAction();
            }
        });
    };
    UploadService.prototype.clearQueue = function () {
        this.queue = [];
        this.totalComplete = 0;
        this.totalAborted = 0;
        this.totalError = 0;
    };
    UploadService.prototype.getUploadPromise = function (file) {
        var opts = {
            renditions: 'doclib'
        };
        if (file.options.newVersion === true) {
            opts.overwrite = true;
            opts.majorVersion = true;
        }
        else {
            opts.autoRename = true;
        }
        if (file.options.newVersionBaseName) {
            opts.name = file.options.newVersionBaseName;
        }
        return this.apiService.getInstance().upload.uploadFile(file.file, file.options.path, file.options.parentId, null, opts);
    };
    UploadService.prototype.beginUpload = function (file, emitter) {
        var _this = this;
        var promise = this.getUploadPromise(file);
        promise.on('progress', function (progress) {
            _this.onUploadProgress(file, progress);
        })
            .on('abort', function () {
            _this.onUploadAborted(file);
            emitter.emit({ value: 'File aborted' });
        })
            .on('error', function (err) {
            _this.onUploadError(file, err);
            emitter.emit({ value: 'Error file uploaded' });
        })
            .on('success', function (data) {
            _this.onUploadComplete(file, data);
            emitter.emit({ value: data });
        })
            .catch(function (err) {
            throw err;
        });
        return promise;
    };
    UploadService.prototype.onUploadStarting = function (file) {
        if (file) {
            file.status = FileUploadStatus.Starting;
            var event = new FileUploadEvent(file, FileUploadStatus.Starting);
            this.fileUpload.next(event);
            this.fileUploadStarting.next(event);
        }
    };
    UploadService.prototype.onUploadProgress = function (file, progress) {
        if (file) {
            file.progress = progress;
            file.status = FileUploadStatus.Progress;
            var event = new FileUploadEvent(file, FileUploadStatus.Progress);
            this.fileUpload.next(event);
            this.fileUploadProgress.next(event);
        }
    };
    UploadService.prototype.onUploadError = function (file, error) {
        if (file) {
            file.status = FileUploadStatus.Error;
            this.totalError++;
            var promise = this.cache[file.id];
            if (promise) {
                delete this.cache[file.id];
            }
            var event = new FileUploadErrorEvent(file, error, this.totalError);
            this.fileUpload.next(event);
            this.fileUploadError.next(event);
        }
    };
    UploadService.prototype.onUploadComplete = function (file, data) {
        if (file) {
            file.status = FileUploadStatus.Complete;
            file.data = data;
            this.totalComplete++;
            var promise = this.cache[file.id];
            if (promise) {
                delete this.cache[file.id];
            }
            var event = new FileUploadCompleteEvent(file, this.totalComplete, data, this.totalAborted);
            this.fileUpload.next(event);
            this.fileUploadComplete.next(event);
        }
    };
    UploadService.prototype.onUploadAborted = function (file) {
        if (file) {
            file.status = FileUploadStatus.Aborted;
            this.totalAborted++;
            var promise = this.cache[file.id];
            if (promise) {
                delete this.cache[file.id];
            }
            var event = new FileUploadEvent(file, FileUploadStatus.Aborted);
            this.fileUpload.next(event);
            this.fileUploadAborted.next(event);
            promise.next();
        }
    };
    UploadService.prototype.onUploadCancelled = function (file) {
        if (file) {
            file.status = FileUploadStatus.Cancelled;
            var event = new FileUploadEvent(file, FileUploadStatus.Cancelled);
            this.fileUpload.next(event);
            this.fileUploadCancelled.next(event);
        }
    };
    UploadService.prototype.onUploadDeleted = function (file) {
        if (file) {
            file.status = FileUploadStatus.Deleted;
            this.totalComplete--;
            var event = new FileUploadDeleteEvent(file, this.totalComplete);
            this.fileUpload.next(event);
            this.fileUploadDeleted.next(event);
        }
    };
    UploadService.prototype.getAction = function (file) {
        var _this = this;
        var actions = (_a = {}, _a[FileUploadStatus.Pending] = function () { return _this.onUploadCancelled(file); }, _a[FileUploadStatus.Deleted] = function () { return _this.onUploadDeleted(file); }, _a[FileUploadStatus.Error] = function () { return _this.onUploadError(file, null); }, _a);
        return actions[file.status];
        var _a;
    };
    return UploadService;
}());
UploadService.decorators = [
    { type: Injectable },
];
UploadService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: AppConfigService, },
]; };
var DeletedNodesApiService = /** @class */ (function () {
    function DeletedNodesApiService(apiService, preferences) {
        this.apiService = apiService;
        this.preferences = preferences;
    }
    Object.defineProperty(DeletedNodesApiService.prototype, "nodesApi", {
        get: function () {
            return this.apiService.getInstance().core.nodesApi;
        },
        enumerable: true,
        configurable: true
    });
    DeletedNodesApiService.prototype.getDeletedNodes = function (options) {
        var _a = this, nodesApi = _a.nodesApi, handleError = _a.handleError;
        var defaultOptions = {
            include: ['path', 'properties'],
            maxItems: this.preferences.paginationSize,
            skipCount: 0
        };
        var queryOptions = Object.assign(defaultOptions, options);
        var promise = nodesApi.getDeletedNodes(queryOptions);
        return Observable
            .fromPromise(promise)
            .catch(handleError);
    };
    DeletedNodesApiService.prototype.handleError = function (error) {
        return Observable.of(error);
    };
    return DeletedNodesApiService;
}());
DeletedNodesApiService.decorators = [
    { type: Injectable },
];
DeletedNodesApiService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: UserPreferencesService, },
]; };
var FavoritesApiService = /** @class */ (function () {
    function FavoritesApiService(apiService, preferences) {
        this.apiService = apiService;
        this.preferences = preferences;
    }
    FavoritesApiService.remapEntry = function (_a) {
        var entry = _a.entry;
        entry.properties = {
            'cm:title': entry.title,
            'cm:description': entry.description
        };
        return { entry: entry };
    };
    FavoritesApiService.prototype.remapFavoritesData = function (data) {
        if (data === void 0) { data = {}; }
        var list = (data.list || {});
        var pagination = (list.pagination || {});
        var entries = this
            .remapFavoriteEntries(list.entries || []);
        return ({
            list: { entries: entries, pagination: pagination }
        });
    };
    FavoritesApiService.prototype.remapFavoriteEntries = function (entries) {
        return entries
            .map(function (_a) {
            var target = _a.entry.target;
            return ({
                entry: target.file || target.folder
            });
        })
            .filter(function (_a) {
            var entry = _a.entry;
            return (!!entry);
        })
            .map(FavoritesApiService.remapEntry);
    };
    Object.defineProperty(FavoritesApiService.prototype, "favoritesApi", {
        get: function () {
            return this.apiService.getInstance().core.favoritesApi;
        },
        enumerable: true,
        configurable: true
    });
    FavoritesApiService.prototype.getFavorites = function (personId, options) {
        var _a = this, favoritesApi = _a.favoritesApi, handleError = _a.handleError;
        var defaultOptions = {
            maxItems: this.preferences.paginationSize,
            skipCount: 0,
            where: '(EXISTS(target/file) OR EXISTS(target/folder))',
            include: ['properties', 'allowableOperations']
        };
        var queryOptions = Object.assign(defaultOptions, options);
        var promise = favoritesApi
            .getFavorites(personId, queryOptions)
            .then(this.remapFavoritesData);
        return Observable
            .fromPromise(promise)
            .catch(handleError);
    };
    FavoritesApiService.prototype.handleError = function (error) {
        return Observable.of(error);
    };
    return FavoritesApiService;
}());
FavoritesApiService.decorators = [
    { type: Injectable },
];
FavoritesApiService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: UserPreferencesService, },
]; };
var NodesApiService = /** @class */ (function () {
    function NodesApiService(api, preferences) {
        this.api = api;
        this.preferences = preferences;
    }
    Object.defineProperty(NodesApiService.prototype, "nodesApi", {
        get: function () {
            return this.api.getInstance().core.nodesApi;
        },
        enumerable: true,
        configurable: true
    });
    NodesApiService.prototype.getEntryFromEntity = function (entity) {
        return entity.entry;
    };
    NodesApiService.prototype.getNode = function (nodeId, options) {
        if (options === void 0) { options = {}; }
        var _a = this, nodesApi = _a.nodesApi, handleError = _a.handleError, getEntryFromEntity = _a.getEntryFromEntity;
        var defaults = {
            include: ['path', 'properties', 'allowableOperations', 'permissions']
        };
        var queryOptions = Object.assign(defaults, options);
        var promise = nodesApi
            .getNode(nodeId, queryOptions)
            .then(getEntryFromEntity);
        return Observable
            .fromPromise(promise)
            .catch(handleError);
    };
    NodesApiService.prototype.getNodeChildren = function (nodeId, options) {
        if (options === void 0) { options = {}; }
        var _a = this, nodesApi = _a.nodesApi, handleError = _a.handleError;
        var defaults = {
            maxItems: this.preferences.paginationSize,
            skipCount: 0,
            include: ['path', 'properties', 'allowableOperations', 'permissions']
        };
        var queryOptions = Object.assign(defaults, options);
        var promise = nodesApi
            .getNodeChildren(nodeId, queryOptions);
        return Observable
            .fromPromise(promise)
            .catch(handleError);
    };
    NodesApiService.prototype.createNode = function (parentNodeId, nodeBody, options) {
        if (options === void 0) { options = {}; }
        var _a = this, nodesApi = _a.nodesApi, handleError = _a.handleError, getEntryFromEntity = _a.getEntryFromEntity;
        var promise = nodesApi
            .addNode(parentNodeId, nodeBody, options)
            .then(getEntryFromEntity);
        return Observable.fromPromise(promise).catch(handleError);
    };
    NodesApiService.prototype.createFolder = function (parentNodeId, nodeBody, options) {
        if (options === void 0) { options = {}; }
        var body = Object.assign({ nodeType: 'cm:folder' }, nodeBody);
        return this.createNode(parentNodeId, body, options);
    };
    NodesApiService.prototype.updateNode = function (nodeId, nodeBody, options) {
        if (options === void 0) { options = {}; }
        var _a = this, nodesApi = _a.nodesApi, handleError = _a.handleError, getEntryFromEntity = _a.getEntryFromEntity;
        var promise = nodesApi
            .updateNode(nodeId, nodeBody, options)
            .then(getEntryFromEntity);
        return Observable.fromPromise(promise).catch(handleError);
    };
    NodesApiService.prototype.deleteNode = function (nodeId, options) {
        if (options === void 0) { options = {}; }
        var _a = this, nodesApi = _a.nodesApi, handleError = _a.handleError;
        var promise = nodesApi
            .deleteNode(nodeId, options);
        return Observable
            .fromPromise(promise)
            .catch(handleError);
    };
    NodesApiService.prototype.restoreNode = function (nodeId) {
        var _a = this, nodesApi = _a.nodesApi, handleError = _a.handleError, getEntryFromEntity = _a.getEntryFromEntity;
        var promise = nodesApi
            .restoreNode(nodeId)
            .then(getEntryFromEntity);
        return Observable
            .fromPromise(promise)
            .catch(handleError);
    };
    NodesApiService.prototype.handleError = function (error) {
        return Observable.throw(error);
    };
    return NodesApiService;
}());
NodesApiService.decorators = [
    { type: Injectable },
];
NodesApiService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: UserPreferencesService, },
]; };
var PeopleContentService = /** @class */ (function () {
    function PeopleContentService(apiService) {
        this.apiService = apiService;
    }
    Object.defineProperty(PeopleContentService.prototype, "peopleApi", {
        get: function () {
            return this.apiService.getInstance().core.peopleApi;
        },
        enumerable: true,
        configurable: true
    });
    PeopleContentService.prototype.getPerson = function (personId) {
        var _a = this, peopleApi = _a.peopleApi, handleError = _a.handleError;
        var promise = peopleApi.getPerson(personId);
        return Observable
            .fromPromise(promise)
            .catch(handleError);
    };
    PeopleContentService.prototype.getCurrentPerson = function () {
        return this.getPerson('-me-');
    };
    PeopleContentService.prototype.handleError = function (error) {
        return Observable.of(error);
    };
    return PeopleContentService;
}());
PeopleContentService.decorators = [
    { type: Injectable },
];
PeopleContentService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
]; };
var SearchConfigurationService = /** @class */ (function () {
    function SearchConfigurationService() {
    }
    SearchConfigurationService.prototype.generateQueryBody = function (searchTerm, maxResults, skipCount) {
        var defaultQueryBody = {
            query: {
                query: searchTerm ? searchTerm + "* OR name:" + searchTerm + "*" : searchTerm
            },
            include: ['path', 'allowableOperations'],
            paging: {
                maxItems: maxResults,
                skipCount: skipCount
            },
            filterQueries: [
                { query: "TYPE:'cm:folder' OR TYPE:'cm:content'" },
                { query: 'NOT cm:creator:System' }
            ]
        };
        return defaultQueryBody;
    };
    return SearchConfigurationService;
}());
SearchConfigurationService.decorators = [
    { type: Injectable },
];
SearchConfigurationService.ctorParameters = function () { return []; };
var SearchService = /** @class */ (function () {
    function SearchService(apiService, searchConfigurationService) {
        this.apiService = apiService;
        this.searchConfigurationService = searchConfigurationService;
        this.dataLoaded = new Subject();
    }
    SearchService.prototype.getNodeQueryResults = function (term, options) {
        var _this = this;
        var promise = this.apiService.getInstance().core.queriesApi.findNodes(term, options);
        promise.then(function (data) {
            _this.dataLoaded.next(data);
        });
        return Observable
            .fromPromise(promise)
            .catch(function (err) { return _this.handleError(err); });
    };
    SearchService.prototype.search = function (searchTerm, maxResults, skipCount) {
        var _this = this;
        var searchQuery = Object.assign(this.searchConfigurationService.generateQueryBody(searchTerm, maxResults, skipCount));
        var promise = this.apiService.getInstance().search.searchApi.search(searchQuery);
        promise.then(function (data) {
            _this.dataLoaded.next(data);
        });
        return Observable
            .fromPromise(promise)
            .catch(function (err) { return _this.handleError(err); });
    };
    SearchService.prototype.searchByQueryBody = function (queryBody) {
        var _this = this;
        var promise = this.apiService.getInstance().search.searchApi.search(queryBody);
        promise.then(function (data) {
            _this.dataLoaded.next(data);
        });
        return Observable
            .fromPromise(promise)
            .catch(function (err) { return _this.handleError(err); });
    };
    SearchService.prototype.handleError = function (error) {
        return Observable.throw(error || 'Server error');
    };
    return SearchService;
}());
SearchService.decorators = [
    { type: Injectable },
];
SearchService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: SearchConfigurationService, },
]; };
var SharedLinksApiService = /** @class */ (function () {
    function SharedLinksApiService(apiService, preferences) {
        this.apiService = apiService;
        this.preferences = preferences;
    }
    Object.defineProperty(SharedLinksApiService.prototype, "sharedLinksApi", {
        get: function () {
            return this.apiService.getInstance().core.sharedlinksApi;
        },
        enumerable: true,
        configurable: true
    });
    SharedLinksApiService.prototype.getSharedLinks = function (options) {
        if (options === void 0) { options = {}; }
        var _a = this, sharedLinksApi = _a.sharedLinksApi, handleError = _a.handleError;
        var defaultOptions = {
            maxItems: this.preferences.paginationSize,
            skipCount: 0,
            include: ['properties', 'allowableOperations']
        };
        var queryOptions = Object.assign({}, defaultOptions, options);
        var promise = sharedLinksApi
            .findSharedLinks(queryOptions);
        return Observable
            .fromPromise(promise)
            .catch(handleError);
    };
    SharedLinksApiService.prototype.createSharedLinks = function (nodeId, options) {
        if (options === void 0) { options = {}; }
        var _a = this, sharedLinksApi = _a.sharedLinksApi, handleError = _a.handleError;
        var promise = sharedLinksApi.addSharedLink({ nodeId: nodeId });
        return Observable
            .fromPromise(promise)
            .catch(handleError);
    };
    SharedLinksApiService.prototype.deleteSharedLink = function (sharedId) {
        var _a = this, sharedLinksApi = _a.sharedLinksApi, handleError = _a.handleError;
        var promise = sharedLinksApi.deleteSharedLink(sharedId);
        return Observable
            .fromPromise(promise)
            .catch(handleError);
    };
    SharedLinksApiService.prototype.handleError = function (error) {
        return Observable.of(error);
    };
    return SharedLinksApiService;
}());
SharedLinksApiService.decorators = [
    { type: Injectable },
];
SharedLinksApiService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
    { type: UserPreferencesService, },
]; };
var SitesService = /** @class */ (function () {
    function SitesService(apiService) {
        this.apiService = apiService;
    }
    SitesService.prototype.getSites = function (opts) {
        if (opts === void 0) { opts = {}; }
        var defaultOptions = {
            skipCount: 0,
            include: ['properties']
        };
        var queryOptions = Object.assign({}, defaultOptions, opts);
        return Observable.fromPromise(this.apiService.getInstance().core.sitesApi.getSites(queryOptions))
            .catch(this.handleError);
    };
    SitesService.prototype.getSite = function (siteId, opts) {
        return Observable.fromPromise(this.apiService.getInstance().core.sitesApi.getSite(siteId, opts))
            .catch(this.handleError);
    };
    SitesService.prototype.deleteSite = function (siteId, permanentFlag) {
        if (permanentFlag === void 0) { permanentFlag = true; }
        var options = {};
        options.permanent = permanentFlag;
        return Observable.fromPromise(this.apiService.getInstance().core.sitesApi.deleteSite(siteId, options)
            .catch(this.handleError));
    };
    SitesService.prototype.getSiteContent = function (siteId) {
        return this.getSite(siteId, { relations: ['containers'] });
    };
    SitesService.prototype.getSiteMembers = function (siteId) {
        return this.getSite(siteId, { relations: ['members'] });
    };
    SitesService.prototype.getEcmCurrentLoggedUserName = function () {
        return this.apiService.getInstance().ecmAuth.username;
    };
    SitesService.prototype.handleError = function (error) {
        console.error(error);
        return Observable.throw(error || 'Server error');
    };
    return SitesService;
}());
SitesService.decorators = [
    { type: Injectable },
];
SitesService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
]; };
var BpmProductVersionModel = /** @class */ (function () {
    function BpmProductVersionModel(obj) {
        if (obj) {
            this.edition = obj.edition || null;
            this.majorVersion = obj.majorVersion || null;
            this.revisionVersion = obj.revisionVersion || null;
            this.minorVersion = obj.minorVersion || null;
            this.type = obj.type || null;
        }
    }
    return BpmProductVersionModel;
}());
var VersionModel = /** @class */ (function () {
    function VersionModel(obj) {
        if (obj) {
            this.major = obj.major || null;
            this.minor = obj.minor || null;
            this.patch = obj.patch || null;
            this.hotfix = obj.hotfix || null;
            this.schema = obj.schema || null;
            this.label = obj.label || null;
            this.display = obj.display || null;
        }
    }
    return VersionModel;
}());
var LicenseModel = /** @class */ (function () {
    function LicenseModel(obj) {
        if (obj) {
            this.issuedAt = obj.issuedAt || null;
            this.expiresAt = obj.expiresAt || null;
            this.remainingDays = obj.remainingDays || null;
            this.holder = obj.holder || null;
            this.mode = obj.mode || null;
            this.isClusterEnabled = obj.isClusterEnabled ? true : false;
            this.isCryptodocEnabled = obj.isCryptodocEnabled ? true : false;
        }
    }
    return LicenseModel;
}());
var VersionStatusModel = /** @class */ (function () {
    function VersionStatusModel(obj) {
        if (obj) {
            this.isReadOnly = obj.isReadOnly ? true : false;
            this.isAuditEnabled = obj.isAuditEnabled ? true : false;
            this.isQuickShareEnabled = obj.isQuickShareEnabled ? true : false;
            this.isThumbnailGenerationEnabled = obj.isThumbnailGenerationEnabled ? true : false;
        }
    }
    return VersionStatusModel;
}());
var VersionModuleModel = /** @class */ (function () {
    function VersionModuleModel(obj) {
        if (obj) {
            this.id = obj.id || null;
            this.title = obj.title || null;
            this.description = obj.description || null;
            this.version = obj.version || null;
            this.installDate = obj.installDate || null;
            this.installState = obj.installState || null;
            this.versionMin = obj.versionMin || null;
            this.versionMax = obj.versionMax || null;
        }
    }
    return VersionModuleModel;
}());
var EcmProductVersionModel = /** @class */ (function () {
    function EcmProductVersionModel(obj) {
        var _this = this;
        this.modules = [];
        if (obj && obj.entry && obj.entry.repository) {
            this.edition = obj.entry.repository.edition || null;
            this.version = new VersionModel(obj.entry.repository.version);
            this.license = new LicenseModel(obj.entry.repository.license);
            this.status = new VersionStatusModel(obj.entry.repository.status);
            if (obj.entry.repository.modules) {
                obj.entry.repository.modules.forEach(function (module) {
                    _this.modules.push(new VersionModuleModel(module));
                });
            }
        }
    }
    return EcmProductVersionModel;
}());
var DiscoveryApiService = /** @class */ (function () {
    function DiscoveryApiService(apiService) {
        this.apiService = apiService;
    }
    DiscoveryApiService.prototype.getEcmProductInfo = function () {
        return Observable.fromPromise(this.apiService.getInstance().discovery.discoveryApi.getRepositoryInformation())
            .map(function (res) { return new EcmProductVersionModel(res); })
            .catch(this.handleError);
    };
    DiscoveryApiService.prototype.getBpmProductInfo = function () {
        return Observable.fromPromise(this.apiService.getInstance().activiti.aboutApi.getAppVersion())
            .map(function (res) { return new BpmProductVersionModel(res); })
            .catch(this.handleError);
    };
    DiscoveryApiService.prototype.handleError = function (error) {
        return Observable.throw(error);
    };
    return DiscoveryApiService;
}());
DiscoveryApiService.decorators = [
    { type: Injectable },
];
DiscoveryApiService.ctorParameters = function () { return [
    { type: AlfrescoApiService, },
]; };
var EcmCompanyModel = /** @class */ (function () {
    function EcmCompanyModel() {
    }
    return EcmCompanyModel;
}());
var RedirectionModel = /** @class */ (function () {
    function RedirectionModel(obj) {
        if (obj) {
            this.provider = obj.provider;
            this.url = obj.url || null;
        }
    }
    return RedirectionModel;
}());
var CommentProcessModel = /** @class */ (function () {
    function CommentProcessModel(obj) {
        if (obj) {
            this.id = obj.id;
            this.message = obj.message;
            this.created = obj.created;
            this.createdBy = obj.createdBy;
            this.isSelected = obj.isSelected ? obj.isSelected : false;
        }
    }
    return CommentProcessModel;
}());
var AlfrescoApiMock = /** @class */ (function () {
    function AlfrescoApiMock() {
    }
    AlfrescoApiMock.prototype.login = function (username, password) {
        return new Promise(function (resolve) {
            resolve('TICKET_4479f4d3bb155195879bfbb8d5206f433488a1b1');
        });
    };
    AlfrescoApiMock.prototype.logout = function () {
        return new Promise(function (resolve) {
            resolve('logout');
        });
    };
    AlfrescoApiMock.prototype.changeConfig = function () {
    };
    return AlfrescoApiMock;
}());
var AppConfigServiceMock = /** @class */ (function (_super) {
    __extends(AppConfigServiceMock, _super);
    function AppConfigServiceMock(http) {
        var _this = _super.call(this, http) || this;
        _this.config = {
            application: {
                name: 'Alfresco ADF Application'
            },
            ecmHost: 'http://{hostname}{:port}/ecm',
            bpmHost: 'http://{hostname}{:port}/bpm',
            logLevel: 'silent'
        };
        return _this;
    }
    AppConfigServiceMock.prototype.load = function () {
        var _this = this;
        return new Promise(function (resolve) {
            resolve(_this.config);
        });
    };
    return AppConfigServiceMock;
}(AppConfigService));
AppConfigServiceMock.decorators = [
    { type: Injectable },
];
AppConfigServiceMock.ctorParameters = function () { return [
    { type: HttpClient, },
]; };
var fakeApps = {
    size: 2, total: 2, start: 0,
    data: [
        {
            id: 1, defaultAppId: null, name: 'Sales-Fakes-App', description: 'desc-fake1', modelId: 22,
            theme: 'theme-1-fake', icon: 'glyphicon-asterisk', 'deploymentId': '111', 'tenantId': null
        },
        {
            id: 2, defaultAppId: null, name: 'health-care-Fake', description: 'desc-fake2', modelId: 33,
            theme: 'theme-2-fake', icon: 'glyphicon-asterisk', 'deploymentId': '444', 'tenantId': null
        }
    ]
};
var AuthenticationMock = /** @class */ (function () {
    function AuthenticationMock() {
        this.redirectUrl = '';
    }
    AuthenticationMock.prototype.setRedirectUrl = function (url) {
        this.redirectUrl = url;
    };
    AuthenticationMock.prototype.getRedirectUrl = function () {
        return this.redirectUrl;
    };
    AuthenticationMock.prototype.login = function (username, password) {
        if (username === 'fake-username' && password === 'fake-password') {
            return Observable.of({ type: 'type', ticket: 'ticket' });
        }
        if (username === 'fake-username-CORS-error' && password === 'fake-password') {
            return Observable.throw({
                error: {
                    crossDomain: true,
                    message: 'ERROR: the network is offline, Origin is not allowed by Access-Control-Allow-Origin'
                }
            });
        }
        if (username === 'fake-username-CSRF-error' && password === 'fake-password') {
            return Observable.throw({ message: 'ERROR: Invalid CSRF-token', status: 403 });
        }
        if (username === 'fake-username-ECM-access-error' && password === 'fake-password') {
            return Observable.throw({ message: 'ERROR: 00170728 Access Denied.  The system is currently in read-only mode', status: 403 });
        }
        return Observable.throw('Fake server error');
    };
    return AuthenticationMock;
}());
var fakeBpmUserNoImage = {
    apps: [],
    capabilities: 'fake-capability',
    company: 'fake-company',
    created: 'fake-create-date',
    email: 'fakeBpm@fake.com',
    externalId: 'fake-external-id',
    firstName: 'fake-first-name',
    lastName: 'fake-last-name',
    fullname: 'fake-full-name',
    groups: [],
    id: 'fake-id',
    lastUpdate: 'fake-update-date',
    latestSyncTimeStamp: 'fake-timestamp',
    password: 'fake-password',
    pictureId: undefined,
    status: 'fake-status',
    tenantId: 'fake-tenant-id',
    tenantName: 'fake-tenant-name',
    tenantPictureId: 'fake-tenant-picture-id',
    type: 'fake-type'
};
var fakeBpmUser = {
    apps: [],
    capabilities: null,
    company: 'fake-company',
    created: 'fake-create-date',
    email: 'fakeBpm@fake.com',
    externalId: 'fake-external-id',
    firstName: 'fake-bpm-first-name',
    lastName: 'fake-bpm-last-name',
    fullname: 'fake-bpm-full-name',
    groups: [],
    id: 'fake-id',
    lastUpdate: 'fake-update-date',
    latestSyncTimeStamp: 'fake-timestamp',
    password: 'fake-password',
    pictureId: 12,
    status: 'fake-status',
    tenantId: 'fake-tenant-id',
    tenantName: 'fake-tenant-name',
    tenantPictureId: 'fake-tenant-picture-id',
    type: 'fake-type'
};
var fakeBpmEditedUser = {
    apps: [],
    capabilities: 'fake-capability',
    company: 'fake-company',
    created: 'fake-create-date',
    email: 'fakeBpm@fake.com',
    externalId: 'fake-external-id',
    firstName: 'fake-first-name',
    lastName: 'fake-last-name',
    fullname: 'fake-full-name',
    groups: [],
    id: 'fake-id',
    lastUpdate: 'fake-update-date',
    latestSyncTimeStamp: 'fake-timestamp',
    password: 'fake-password',
    pictureId: 'src/assets/images/bpmImg.gif',
    status: 'fake-status',
    tenantId: 'fake-tenant-id',
    tenantName: 'fake-tenant-name',
    tenantPictureId: 'fake-tenant-picture-id',
    type: 'fake-type'
};
var fakeUser1 = { id: 1, email: 'fake-email@dom.com', firstName: 'firstName', lastName: 'lastName' };
var fakeUser2 = { id: 1001, email: 'some-one@somegroup.com', firstName: 'some', lastName: 'one' };
var fakeTasksComment = {
    size: 2, total: 2, start: 0,
    data: [
        {
            id: 1, message: 'fake-message-1', created: '', createdBy: fakeUser1
        },
        {
            id: 2, message: 'fake-message-2', created: '', createdBy: fakeUser1
        }
    ]
};
var fakeProcessComment = new CommentModel({ id: 1, message: 'Test', created: new Date('2016-11-10T03:37:30.010+0000'), createdBy: new UserProcessModel({
        id: 13,
        firstName: 'Wilbur',
        lastName: 'Adams',
        email: 'wilbur@app.com'
    }) });
var CookieServiceMock = /** @class */ (function (_super) {
    __extends(CookieServiceMock, _super);
    function CookieServiceMock() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    CookieServiceMock.prototype.getItem = function (key) {
        return this[key] && this[key].data || null;
    };
    CookieServiceMock.prototype.setItem = function (key, data, expiration, path) {
        this[key] = { data: data, expiration: expiration, path: path };
    };
    return CookieServiceMock;
}(CookieService));
var fakeEcmCompany = {
    organization: 'company-fake-name',
    address1: 'fake-address-1',
    address2: 'fake-address-2',
    address3: 'fake-address-3',
    postcode: 'fAk1',
    telephone: '00000000',
    fax: '11111111',
    email: 'fakeCompany@fake.com'
};
var fakeEcmUser = {
    id: 'fake-id',
    firstName: 'fake-ecm-first-name',
    lastName: 'fake-ecm-last-name',
    description: 'i am a fake user for test',
    avatarId: 'fake-avatar-id',
    email: 'fakeEcm@ecmUser.com',
    skypeId: 'fake-skype-id',
    googleId: 'fake-googleId-id',
    instantMessageId: 'fake-instantMessageId-id',
    company: null,
    jobTitle: 'job-ecm-test',
    location: 'fake location',
    mobile: '000000000',
    telephone: '11111111',
    statusUpdatedAt: 'fake-date',
    userStatus: 'active',
    enabled: true,
    emailNotificationsEnabled: true
};
var fakeEcmUserNoImage = {
    id: 'fake-id',
    firstName: 'fake-first-name',
    lastName: 'fake-last-name',
    description: 'i am a fake user for test',
    avatarId: null,
    email: 'fakeEcm@ecmUser.com',
    skypeId: 'fake-skype-id',
    googleId: 'fake-googleId-id',
    instantMessageId: 'fake-instantMessageId-id',
    company: null,
    jobTitle: null,
    location: 'fake location',
    mobile: '000000000',
    telephone: '11111111',
    statusUpdatedAt: 'fake-date',
    userStatus: 'active',
    enabled: true,
    emailNotificationsEnabled: true
};
var fakeEcmEditedUser = {
    id: 'fake-id',
    firstName: null,
    lastName: 'fake-last-name',
    description: 'i am a fake user for test',
    avatarId: 'fake-avatar-id',
    email: 'fakeEcm@ecmUser.com',
    skypeId: 'fake-skype-id',
    googleId: 'fake-googleId-id',
    instantMessageId: 'fake-instantMessageId-id',
    company: null,
    jobTitle: 'test job',
    location: 'fake location',
    mobile: '000000000',
    telephone: '11111111',
    statusUpdatedAt: 'fake-date',
    userStatus: 'active',
    enabled: true,
    emailNotificationsEnabled: true
};
var EventMock = /** @class */ (function () {
    function EventMock() {
    }
    EventMock.keyDown = function (key) {
        var event = document.createEvent('Event');
        event.keyCode = key;
        event.initEvent('keydown');
        document.dispatchEvent(event);
    };
    EventMock.keyUp = function (key) {
        var event = document.createEvent('Event');
        event.keyCode = key;
        event.initEvent('keyup');
        document.dispatchEvent(event);
    };
    EventMock.resizeMobileView = function () {
        window.dispatchEvent(new Event('resize'));
    };
    return EventMock;
}());
var fakeRedition = {
    'entry': {
        'id': 'pdf',
        'content': { 'mimeType': 'application/pdf', 'mimeTypeName': 'Adobe PDF Document' },
        'status': 'NOT_CREATED'
    }
};
var fakeReditionCreated = {
    'entry': {
        'id': 'pdf',
        'content': { 'mimeType': 'application/pdf', 'mimeTypeName': 'Adobe PDF Document' },
        'status': 'CREATED'
    }
};
var fakeReditionsList = {
    'list': {
        'pagination': {
            'count': 6,
            'hasMoreItems': false,
            'totalItems': 6,
            'skipCount': 0,
            'maxItems': 100
        },
        'entries': [{
                'entry': {
                    'id': 'avatar',
                    'content': { 'mimeType': 'image/png', 'mimeTypeName': 'PNG Image' },
                    'status': 'NOT_CREATED'
                }
            }, {
                'entry': {
                    'id': 'avatar32',
                    'content': { 'mimeType': 'image/png', 'mimeTypeName': 'PNG Image' },
                    'status': 'NOT_CREATED'
                }
            }, {
                'entry': {
                    'id': 'doclib',
                    'content': { 'mimeType': 'image/png', 'mimeTypeName': 'PNG Image' },
                    'status': 'NOT_CREATED'
                }
            }, {
                'entry': {
                    'id': 'imgpreview',
                    'content': { 'mimeType': 'image/jpeg', 'mimeTypeName': 'JPEG Image' },
                    'status': 'NOT_CREATED'
                }
            }, {
                'entry': {
                    'id': 'medium',
                    'content': { 'mimeType': 'image/jpeg', 'mimeTypeName': 'JPEG Image' },
                    'status': 'NOT_CREATED'
                }
            }, {
                'entry': {
                    'id': 'pdf',
                    'content': { 'mimeType': 'application/pdf', 'mimeTypeName': 'Adobe PDF Document' },
                    'status': 'NOT_CREATED'
                }
            }]
    }
};
var fakeSearch = {
    list: {
        pagination: {
            count: 1,
            hasMoreItems: false,
            totalItems: 1,
            skipCount: 0,
            maxItems: 100
        },
        entries: [
            {
                entry: {
                    id: '123',
                    name: 'MyDoc',
                    content: {
                        mimetype: 'text/plain'
                    },
                    createdByUser: {
                        displayName: 'John Doe'
                    },
                    modifiedByUser: {
                        displayName: 'John Doe'
                    }
                }
            }
        ]
    }
};
var mockError = {
    error: {
        errorKey: 'Search failed',
        statusCode: 400,
        briefSummary: '08220082 search failed',
        stackTrace: 'For security reasons the stack trace is no longer displayed, but the property is kept for previous versions.',
        descriptionURL: 'https://api-explorer.alfresco.com'
    }
};
var searchMockApi = {
    core: {
        queriesApi: {
            findNodes: function (term, opts) { return Promise.resolve(fakeSearch); }
        }
    }
};
var TranslationMock = /** @class */ (function () {
    function TranslationMock() {
        this.defaultLang = 'en';
        this.onLangChange = new EventEmitter();
    }
    TranslationMock.prototype.addTranslationFolder = function () {
    };
    TranslationMock.prototype.onTranslationChanged = function () {
    };
    TranslationMock.prototype.use = function () {
    };
    TranslationMock.prototype.get = function (key, interpolateParams) {
        return Observable.of(key);
    };
    TranslationMock.prototype.instant = function (key, interpolateParams) {
        return key;
    };
    return TranslationMock;
}());
var AlfrescoApiServiceMock = /** @class */ (function (_super) {
    __extends(AlfrescoApiServiceMock, _super);
    function AlfrescoApiServiceMock(appConfig, storage) {
        var _this = _super.call(this, appConfig, storage) || this;
        _this.appConfig = appConfig;
        _this.storage = storage;
        _this.initAlfrescoApi();
        return _this;
    }
    AlfrescoApiServiceMock.prototype.reset = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                this.initAlfrescoApi();
                return [2 /*return*/];
            });
        });
    };
    AlfrescoApiServiceMock.prototype.initAlfrescoApi = function () {
        this.alfrescoApi = (new alfrescoApi({
            provider: this.storage.getItem('AUTH_TYPE'),
            ticketEcm: this.storage.getItem('ticket-ECM'),
            ticketBpm: this.storage.getItem('ticket-BPM'),
            hostEcm: this.appConfig.get('ecmHost'),
            hostBpm: this.appConfig.get('bpmHost'),
            contextRoot: 'alfresco',
            disableCsrf: this.storage.getItem('DISABLE_CSRF') === 'true',
            oauth2: this.appConfig.get('oauth2')
        }));
    };
    return AlfrescoApiServiceMock;
}(AlfrescoApiService));
AlfrescoApiServiceMock.decorators = [
    { type: Injectable },
];
AlfrescoApiServiceMock.ctorParameters = function () { return [
    { type: AppConfigService, },
    { type: StorageService, },
]; };
var fakeForm = {
    id: 1001,
    name: 'ISSUE_FORM',
    processDefinitionId: 'ISSUE_APP:1:2504',
    processDefinitionName: 'ISSUE_APP',
    processDefinitionKey: 'ISSUE_APP',
    taskId: '7506',
    taskDefinitionKey: 'sid-F67A2996-1684-4774-855A-4591490081FD',
    tabs: [],
    fields: [
        {
            fieldType: 'ContainerRepresentation',
            id: '1498212398417',
            name: 'Label',
            type: 'container',
            value: null,
            required: false,
            readOnly: false,
            overrideId: false,
            colspan: 1,
            placeholder: null,
            minLength: 0,
            maxLength: 0,
            minValue: null,
            maxValue: null,
            regexPattern: null,
            optionType: null,
            hasEmptyValue: null,
            options: null,
            restUrl: null,
            restResponsePath: null,
            restIdProperty: null,
            restLabelProperty: null,
            tab: null,
            className: null,
            dateDisplayFormat: null,
            layout: null,
            sizeX: 2,
            sizeY: 1,
            row: -1,
            col: -1,
            visibilityCondition: null,
            numberOfColumns: 2,
            fields: {
                1: [
                    {
                        fieldType: 'RestFieldRepresentation',
                        id: 'label',
                        name: 'Label',
                        type: 'dropdown',
                        value: 'Choose one...',
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: true,
                        options: [
                            {
                                id: 'empty',
                                name: 'Choose one...'
                            },
                            {
                                id: 'option_1',
                                name: 'test1'
                            },
                            {
                                id: 'option_2',
                                name: 'test2'
                            },
                            {
                                id: 'option_3',
                                name: 'test3'
                            }
                        ],
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 2
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null,
                        endpoint: null,
                        requestHeaders: null
                    }
                ],
                2: [
                    {
                        fieldType: 'RestFieldRepresentation',
                        id: 'raduio',
                        name: 'raduio',
                        type: 'radio-buttons',
                        value: null,
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: [
                            {
                                id: 'option_1',
                                name: 'Option 1'
                            },
                            {
                                id: 'option_2',
                                name: 'Option 2'
                            },
                            {
                                id: 'option_3',
                                name: 'Option 3'
                            }
                        ],
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 1
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 2,
                        row: -1,
                        col: -1,
                        visibilityCondition: null,
                        endpoint: null,
                        requestHeaders: null
                    }
                ]
            }
        },
        {
            fieldType: 'ContainerRepresentation',
            id: '1498212413062',
            name: 'Label',
            type: 'container',
            value: null,
            required: false,
            readOnly: false,
            overrideId: false,
            colspan: 1,
            placeholder: null,
            minLength: 0,
            maxLength: 0,
            minValue: null,
            maxValue: null,
            regexPattern: null,
            optionType: null,
            hasEmptyValue: null,
            options: null,
            restUrl: null,
            restResponsePath: null,
            restIdProperty: null,
            restLabelProperty: null,
            tab: null,
            className: null,
            dateDisplayFormat: null,
            layout: null,
            sizeX: 2,
            sizeY: 1,
            row: -1,
            col: -1,
            visibilityCondition: null,
            numberOfColumns: 2,
            fields: {
                1: [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'date',
                        name: 'date',
                        type: 'date',
                        value: null,
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 2
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ],
                2: []
            }
        }
    ],
    outcomes: [],
    javascriptEvents: [],
    className: '',
    style: '',
    customFieldTemplates: {},
    metadata: {},
    variables: [],
    customFieldsValueInfo: {},
    gridsterForm: false,
    globalDateFormat: 'D-M-YYYY'
};
var formDefinitionTwoTextFields = {
    id: 20,
    name: 'formTextDefinition',
    processDefinitionId: 'textDefinition:1:153',
    processDefinitionName: 'textDefinition',
    processDefinitionKey: 'textDefinition',
    taskId: '159',
    taskDefinitionKey: 'sid-D941F49F-2B04-4FBB-9B49-9E95991993E8',
    tabs: [],
    fields: [
        {
            fieldType: 'ContainerRepresentation',
            id: '1507044399260',
            name: 'Label',
            type: 'container',
            value: null,
            required: false,
            readOnly: false,
            overrideId: false,
            colspan: 1,
            placeholder: null,
            minLength: 0,
            maxLength: 0,
            minValue: null,
            maxValue: null,
            regexPattern: null,
            optionType: null,
            hasEmptyValue: null,
            options: null,
            restUrl: null,
            restResponsePath: null,
            restIdProperty: null,
            restLabelProperty: null,
            tab: null,
            className: null,
            dateDisplayFormat: null,
            layout: null,
            sizeX: 2,
            sizeY: 1,
            row: -1,
            col: -1,
            visibilityCondition: null,
            numberOfColumns: 2,
            fields: {
                '1': [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'firstname',
                        name: 'firstName',
                        type: 'text',
                        value: null,
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 2
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ],
                '2': [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'lastname',
                        name: 'lastName',
                        type: 'text',
                        value: null,
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 1
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ]
            }
        }
    ],
    outcomes: [],
    javascriptEvents: [],
    className: '',
    style: '',
    customFieldTemplates: {},
    metadata: {},
    variables: [],
    customFieldsValueInfo: {},
    gridsterForm: false,
    globalDateFormat: 'D-M-YYYY'
};
var formDefinitionDropdownField = {
    id: 21,
    name: 'dropdownDefinition',
    processDefinitionId: 'textDefinition:2:163',
    processDefinitionName: 'textDefinition',
    processDefinitionKey: 'textDefinition',
    taskId: '169',
    taskDefinitionKey: 'sid-D941F49F-2B04-4FBB-9B49-9E95991993E8',
    tabs: [],
    fields: [
        {
            fieldType: 'ContainerRepresentation',
            id: '1507046026940',
            name: 'Label',
            type: 'container',
            value: null,
            required: false,
            readOnly: false,
            overrideId: false,
            colspan: 1,
            placeholder: null,
            minLength: 0,
            maxLength: 0,
            minValue: null,
            maxValue: null,
            regexPattern: null,
            optionType: null,
            hasEmptyValue: null,
            options: null,
            restUrl: null,
            restResponsePath: null,
            restIdProperty: null,
            restLabelProperty: null,
            tab: null,
            className: null,
            dateDisplayFormat: null,
            layout: null,
            sizeX: 2,
            sizeY: 1,
            row: -1,
            col: -1,
            visibilityCondition: null,
            numberOfColumns: 2,
            fields: {
                '1': [
                    {
                        fieldType: 'RestFieldRepresentation',
                        id: 'country',
                        name: 'country',
                        type: 'dropdown',
                        value: 'Choose one...',
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: true,
                        options: [
                            {
                                id: 'empty',
                                name: 'Choose one...'
                            },
                            {
                                id: 'option_1',
                                name: 'united kingdom'
                            },
                            {
                                id: 'option_2',
                                name: 'italy'
                            },
                            {
                                id: 'option_3',
                                name: 'france'
                            }
                        ],
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 2
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null,
                        endpoint: null,
                        requestHeaders: null
                    }
                ],
                '2': []
            }
        }
    ],
    outcomes: [],
    javascriptEvents: [],
    className: '',
    style: '',
    customFieldTemplates: {},
    metadata: {},
    variables: [],
    customFieldsValueInfo: {},
    gridsterForm: false,
    globalDateFormat: 'D-M-YYYY'
};
var formReadonlyTwoTextFields = {
    id: 22,
    name: 'formTextDefinition',
    processDefinitionId: 'textDefinition:3:182',
    processDefinitionName: 'textDefinition',
    processDefinitionKey: 'textDefinition',
    taskId: '188',
    taskDefinitionKey: 'sid-D941F49F-2B04-4FBB-9B49-9E95991993E8',
    tabs: [],
    fields: [
        {
            fieldType: 'ContainerRepresentation',
            id: '1507044399260',
            name: 'Label',
            type: 'container',
            value: null,
            required: false,
            readOnly: false,
            overrideId: false,
            colspan: 1,
            placeholder: null,
            minLength: 0,
            maxLength: 0,
            minValue: null,
            maxValue: null,
            regexPattern: null,
            optionType: null,
            hasEmptyValue: null,
            options: null,
            restUrl: null,
            restResponsePath: null,
            restIdProperty: null,
            restLabelProperty: null,
            tab: null,
            className: null,
            dateDisplayFormat: null,
            layout: null,
            sizeX: 2,
            sizeY: 1,
            row: -1,
            col: -1,
            visibilityCondition: null,
            numberOfColumns: 2,
            fields: {
                '1': [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'firstname',
                        name: 'firstName',
                        type: 'readonly',
                        value: 'fakeFirstName',
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 2,
                            field: {
                                id: 'firstname',
                                name: 'firstName',
                                type: 'text',
                                value: null,
                                required: false,
                                readOnly: false,
                                overrideId: false,
                                colspan: 1,
                                placeholder: null,
                                minLength: 0,
                                maxLength: 0,
                                minValue: null,
                                maxValue: null,
                                regexPattern: null,
                                optionType: null,
                                hasEmptyValue: null,
                                options: null,
                                restUrl: null,
                                restResponsePath: null,
                                restIdProperty: null,
                                restLabelProperty: null,
                                tab: null,
                                className: null,
                                dateDisplayFormat: null,
                                layout: null,
                                sizeX: 0,
                                sizeY: 0,
                                row: 0,
                                col: 0,
                                visibilityCondition: null
                            }
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ],
                '2': [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'lastname',
                        name: 'lastName',
                        type: 'readonly',
                        value: 'fakeLastName',
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 1,
                            field: {
                                id: 'lastname',
                                name: 'lastName',
                                type: 'text',
                                value: null,
                                required: false,
                                readOnly: false,
                                overrideId: false,
                                colspan: 1,
                                placeholder: null,
                                minLength: 0,
                                maxLength: 0,
                                minValue: null,
                                maxValue: null,
                                regexPattern: null,
                                optionType: null,
                                hasEmptyValue: null,
                                options: null,
                                restUrl: null,
                                restResponsePath: null,
                                restIdProperty: null,
                                restLabelProperty: null,
                                tab: null,
                                className: null,
                                dateDisplayFormat: null,
                                layout: null,
                                sizeX: 0,
                                sizeY: 0,
                                row: 0,
                                col: 0,
                                visibilityCondition: null
                            }
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ]
            }
        }
    ],
    outcomes: [],
    javascriptEvents: [],
    className: '',
    style: '',
    customFieldTemplates: {},
    metadata: {},
    variables: [],
    customFieldsValueInfo: {},
    gridsterForm: false,
    globalDateFormat: 'D-M-YYYY'
};
var formDefVisibilitiFieldDependsOnNextOne = {
    id: 19,
    processDefinitionId: 'visibility:1:148',
    processDefinitionName: 'visibility',
    processDefinitionKey: 'visibility',
    tabs: [],
    fields: [
        {
            fieldType: 'ContainerRepresentation',
            id: '1506960847579',
            name: 'Label',
            type: 'container',
            value: null,
            required: false,
            readOnly: false,
            overrideId: false,
            colspan: 1,
            placeholder: null,
            minLength: 0,
            maxLength: 0,
            minValue: null,
            maxValue: null,
            regexPattern: null,
            optionType: null,
            hasEmptyValue: null,
            options: null,
            restUrl: null,
            restResponsePath: null,
            restIdProperty: null,
            restLabelProperty: null,
            tab: null,
            className: null,
            dateDisplayFormat: null,
            layout: null,
            sizeX: 2,
            sizeY: 1,
            row: -1,
            col: -1,
            visibilityCondition: null,
            numberOfColumns: 2,
            fields: {
                '1': [
                    {
                        fieldType: 'RestFieldRepresentation',
                        id: 'country',
                        name: 'country',
                        type: 'dropdown',
                        value: 'Choose one...',
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: true,
                        options: [
                            {
                                id: 'empty',
                                name: 'Choose one...'
                            },
                            {
                                id: 'option_1',
                                name: 'france'
                            },
                            {
                                id: 'option_2',
                                name: 'uk'
                            }
                        ],
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 2
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: {
                            leftFormFieldId: 'name',
                            leftRestResponseId: null,
                            operator: '==',
                            rightValue: 'italy',
                            rightType: null,
                            rightFormFieldId: '',
                            rightRestResponseId: '',
                            nextConditionOperator: '',
                            nextCondition: null
                        },
                        endpoint: null,
                        requestHeaders: null
                    }
                ],
                '2': [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'name',
                        name: 'name',
                        type: 'text',
                        value: null,
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 1
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ]
            }
        }
    ],
    outcomes: [],
    javascriptEvents: [],
    className: '',
    style: '',
    customFieldTemplates: {},
    metadata: {},
    variables: [],
    customFieldsValueInfo: {},
    gridsterForm: false,
    globalDateFormat: 'D-M-YYYY'
};
var formDefVisibilitiFieldDependsOnPreviousOne = {
    id: 19,
    processDefinitionId: 'visibility:1:148',
    processDefinitionName: 'visibility',
    processDefinitionKey: 'visibility',
    tabs: [],
    fields: [
        {
            fieldType: 'ContainerRepresentation',
            id: '1506960847579',
            name: 'Label',
            type: 'container',
            value: null,
            required: false,
            readOnly: false,
            overrideId: false,
            colspan: 1,
            placeholder: null,
            minLength: 0,
            maxLength: 0,
            minValue: null,
            maxValue: null,
            regexPattern: null,
            optionType: null,
            hasEmptyValue: null,
            options: null,
            restUrl: null,
            restResponsePath: null,
            restIdProperty: null,
            restLabelProperty: null,
            tab: null,
            className: null,
            dateDisplayFormat: null,
            layout: null,
            sizeX: 2,
            sizeY: 1,
            row: -1,
            col: -1,
            visibilityCondition: null,
            numberOfColumns: 2,
            fields: {
                '1': [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'name',
                        name: 'name',
                        type: 'text',
                        value: null,
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 1
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ],
                '2': [
                    {
                        fieldType: 'RestFieldRepresentation',
                        id: 'country',
                        name: 'country',
                        type: 'dropdown',
                        value: 'Choose one...',
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: true,
                        options: [
                            {
                                id: 'empty',
                                name: 'Choose one...'
                            },
                            {
                                id: 'option_1',
                                name: 'france'
                            },
                            {
                                id: 'option_2',
                                name: 'uk'
                            }
                        ],
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 2
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: {
                            leftFormFieldId: 'name',
                            leftRestResponseId: null,
                            operator: '==',
                            rightValue: 'italy',
                            rightType: null,
                            rightFormFieldId: '',
                            rightRestResponseId: '',
                            nextConditionOperator: '',
                            nextCondition: null
                        },
                        endpoint: null,
                        requestHeaders: null
                    }
                ]
            }
        }
    ],
    outcomes: [],
    javascriptEvents: [],
    className: '',
    style: '',
    customFieldTemplates: {},
    metadata: {},
    variables: [],
    customFieldsValueInfo: {},
    gridsterForm: false,
    globalDateFormat: 'D-M-YYYY'
};
var startFormDateWidgetMock = {
    id: 4,
    name: 'Claim Review Process',
    processDefinitionId: 'ClaimReviewProcess:2: 93',
    fields: [
        {
            fieldType: 'ContainerRepresentation',
            id: 1497953253784,
            name: 'Label',
            type: 'container',
            value: null,
            readOnly: false,
            fields: {
                1: [{
                        fieldType: 'FormFieldRepresentation',
                        id: 'date',
                        name: 'date',
                        type: 'date',
                        value: null
                    }]
            }
        }
    ]
};
var startFormNumberWidgetMock = {
    id: 4,
    name: 'Claim Review Process',
    processDefinitionId: 'ClaimReviewProcess:2: 93',
    fields: [
        {
            fieldType: 'ContainerRepresentation',
            id: 1497953253784,
            name: 'Label',
            type: 'container',
            value: null,
            readOnly: false,
            fields: {
                1: [{
                        fieldType: 'FormFieldRepresentation',
                        id: 'number',
                        name: 'number widget',
                        type: 'integer',
                        value: null
                    }]
            }
        }
    ]
};
var startFormAmountWidgetMock = {
    id: 4,
    name: 'Claim Review Process',
    processDefinitionId: 'ClaimReviewProcess:2: 93',
    fields: [
        {
            fieldType: 'ContainerRepresentation',
            id: 1497953253784,
            name: 'Label',
            type: 'container',
            value: null,
            readOnly: false,
            fields: {
                1: [{
                        fieldType: 'FormFieldRepresentation',
                        id: 'amount',
                        name: 'amount widget',
                        type: 'amount',
                        value: null
                    }]
            }
        }
    ]
};
var startFormRadioButtonWidgetMock = {
    id: 4,
    name: 'Claim Review Process',
    processDefinitionId: 'ClaimReviewProcess:2: 93',
    fields: [
        {
            fieldType: 'ContainerRepresentation',
            id: 1497953253784,
            name: 'Label',
            type: 'container',
            value: null,
            readOnly: false,
            fields: {
                1: [{
                        fieldType: 'RestFieldRepresentation',
                        id: 'radio-but',
                        name: 'radio-buttons',
                        type: 'radio-buttons',
                        value: null
                    }]
            }
        }
    ]
};
var startFormTextDefinitionMock = {
    id: 4,
    name: 'Claim Review Process',
    processDefinitionId: 'ClaimReviewProcess:2: 93',
    fields: [
        {
            fieldType: 'ContainerRepresentation',
            id: 1497953253784,
            name: 'Label',
            type: 'container',
            value: null,
            readOnly: false,
            fields: {
                1: [{
                        fieldType: 'FormFieldRepresentation',
                        id: 'mocktext',
                        name: 'mockText',
                        type: 'text',
                        value: null
                    }]
            }
        }
    ]
};
var startFormDropdownDefinitionMock = {
    id: 4,
    name: 'Claim Review Process',
    processDefinitionId: 'ClaimReviewProcess:2: 93',
    fields: [
        {
            fieldType: 'ContainerRepresentation',
            id: 1497953253784,
            name: 'Label',
            type: 'container',
            value: null,
            readOnly: false,
            fields: {
                1: [{
                        fieldType: 'RestFieldRepresentation',
                        id: 'mockTypeDropDown',
                        name: 'mock DropDown',
                        type: 'dropdown',
                        value: 'Chooseone...',
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        options: [
                            {
                                id: 'empty',
                                name: 'Chooseone...'
                            },
                            {
                                id: 'opt1',
                                name: 'Option-1'
                            },
                            {
                                id: 'opt2',
                                name: 'Option-2'
                            },
                            {
                                id: 'opt3',
                                name: 'Option-3'
                            },
                            {
                                id: 'opt2',
                                name: 'Option-3'
                            }
                        ]
                    }]
            }
        }
    ]
};
var startMockForm = {
    id: 4,
    name: 'Claim Review Process',
    processDefinitionId: 'ClaimReviewProcess:2: 93',
    processDefinitionName: 'ClaimReviewProcess',
    processDefinitionKey: 'ClaimReviewProcess',
    tabs: [],
    fields: [
        {
            fieldType: 'ContainerRepresentation',
            id: 1497953253784,
            name: 'Label',
            type: 'container',
            value: null,
            required: false,
            readOnly: false,
            overrideId: false,
            colspan: 1,
            placeholder: null,
            minLength: 0,
            maxLength: 0,
            minValue: null,
            maxValue: null,
            regexPattern: null,
            optionType: null,
            hasEmptyValue: null,
            options: null,
            restUrl: null,
            restResponsePath: null,
            restIdProperty: null,
            restLabelProperty: null,
            tab: null,
            className: null,
            dateDisplayFormat: null,
            layout: null,
            sizeX: 2,
            sizeY: 1,
            row: -1,
            col: -1,
            visibilityCondition: null,
            numberOfColumns: 2,
            fields: {
                1: [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'clientname',
                        name: 'ClientName',
                        type: 'text',
                        value: null,
                        required: true,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 2
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ],
                2: [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'policyno',
                        name: 'PolicyNo',
                        type: 'integer',
                        value: null,
                        required: true,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: 'EnterPolicyName',
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 1
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ]
            }
        },
        {
            fieldType: 'ContainerRepresentation',
            id: 1497953270269,
            name: 'Label',
            type: 'container',
            value: null,
            required: false,
            readOnly: false,
            overrideId: false,
            colspan: 1,
            placeholder: null,
            minLength: 0,
            maxLength: 0,
            minValue: null,
            maxValue: null,
            regexPattern: null,
            optionType: null,
            hasEmptyValue: null,
            options: null,
            restUrl: null,
            restResponsePath: null,
            restIdProperty: null,
            restLabelProperty: null,
            tab: null,
            className: null,
            dateDisplayFormat: null,
            layout: null,
            sizeX: 2,
            sizeY: 1,
            row: -1,
            col: -1,
            visibilityCondition: null,
            numberOfColumns: 2,
            fields: {
                1: [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'billamount',
                        name: 'BillAmount',
                        type: 'integer',
                        value: null,
                        required: true,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: 'EnterBillAmount',
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 2
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ],
                2: [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'billdate',
                        name: 'BillDate',
                        type: 'date',
                        value: null,
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: 'billdate',
                        params: {
                            existingColspan: 1,
                            maxColspan: 1
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ]
            }
        },
        {
            fieldType: 'ContainerRepresentation',
            id: 1497953280930,
            name: 'Label',
            type: 'container',
            value: null,
            required: false,
            readOnly: false,
            overrideId: false,
            colspan: 1,
            placeholder: null,
            minLength: 0,
            maxLength: 0,
            minValue: null,
            maxValue: null,
            regexPattern: null,
            optionType: null,
            hasEmptyValue: null,
            options: null,
            restUrl: null,
            restResponsePath: null,
            restIdProperty: null,
            restLabelProperty: null,
            tab: null,
            className: null,
            dateDisplayFormat: null,
            layout: null,
            sizeX: 2,
            sizeY: 1,
            row: -1,
            col: -1,
            visibilityCondition: null,
            numberOfColumns: 2,
            fields: {
                1: [
                    {
                        fieldType: 'RestFieldRepresentation',
                        id: 'claimtype',
                        name: 'ClaimType',
                        type: 'dropdown',
                        value: 'Chooseone...',
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: true,
                        options: [
                            {
                                id: 'empty',
                                name: 'Chooseone...'
                            },
                            {
                                id: 'cashless',
                                name: 'Cashless'
                            },
                            {
                                id: 'reimbursement',
                                name: 'Reimbursement'
                            }
                        ],
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 2
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null,
                        endpoint: null,
                        requestHeaders: null
                    }
                ],
                2: [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'hospitalname',
                        name: 'HospitalName',
                        type: 'text',
                        value: null,
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: 'EnterHospitalName',
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 1
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ]
            }
        }
    ],
    outcomes: [
        {
            id: 'approve',
            name: 'Approve'
        },
        {
            id: 'complete',
            name: 'Complete'
        },
        {
            id: 'start_process',
            name: 'Start Process'
        }
    ],
    javascriptEvents: [],
    className: '',
    style: '',
    metadata: {},
    variables: [],
    customFieldsValueInfo: {},
    gridsterForm: false,
    globalDateFormat: 'D - M - YYYY'
};
var startMockFormWithTab = {
    id: 4,
    taskName: 'Mock Title',
    processDefinitionId: 'ClaimReviewProcess:2: 93',
    processDefinitionName: 'ClaimReviewProcess',
    processDefinitionKey: 'ClaimReviewProcess',
    tabs: [
        {
            id: 'form1',
            name: 'Tab 1'
        },
        {
            id: 'form2',
            name: 'Tab 2'
        }
    ],
    fields: [
        {
            fieldType: 'ContainerRepresentation',
            id: 1497953253784,
            name: 'Label',
            type: 'container',
            value: null,
            required: false,
            readOnly: false,
            overrideId: false,
            colspan: 1,
            placeholder: null,
            minLength: 0,
            maxLength: 0,
            minValue: null,
            maxValue: null,
            regexPattern: null,
            optionType: null,
            hasEmptyValue: null,
            options: null,
            restUrl: null,
            restResponsePath: null,
            restIdProperty: null,
            restLabelProperty: null,
            tab: null,
            className: null,
            dateDisplayFormat: null,
            layout: null,
            sizeX: 2,
            sizeY: 1,
            row: -1,
            col: -1,
            visibilityCondition: null,
            numberOfColumns: 2,
            fields: {
                1: [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'clientname',
                        name: 'ClientName',
                        type: 'text',
                        value: null,
                        required: true,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 2
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ],
                2: [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'policyno',
                        name: 'PolicyNo',
                        type: 'integer',
                        value: null,
                        required: true,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: 'EnterPolicyName',
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 1
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ]
            }
        },
        {
            fieldType: 'ContainerRepresentation',
            id: 1497953270269,
            name: 'Label',
            type: 'container',
            value: null,
            required: false,
            readOnly: false,
            overrideId: false,
            colspan: 1,
            placeholder: null,
            minLength: 0,
            maxLength: 0,
            minValue: null,
            maxValue: null,
            regexPattern: null,
            optionType: null,
            hasEmptyValue: null,
            options: null,
            restUrl: null,
            restResponsePath: null,
            restIdProperty: null,
            restLabelProperty: null,
            tab: null,
            className: null,
            dateDisplayFormat: null,
            layout: null,
            sizeX: 2,
            sizeY: 1,
            row: -1,
            col: -1,
            visibilityCondition: null,
            numberOfColumns: 2,
            fields: {
                1: [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'billamount',
                        name: 'BillAmount',
                        type: 'integer',
                        value: null,
                        required: true,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: 'EnterBillAmount',
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 2
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ],
                2: [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'billdate',
                        name: 'BillDate',
                        type: 'date',
                        value: null,
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: 'billdate',
                        params: {
                            existingColspan: 1,
                            maxColspan: 1
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ]
            }
        },
        {
            fieldType: 'ContainerRepresentation',
            id: 1497953280930,
            name: 'Label',
            type: 'container',
            value: null,
            required: false,
            readOnly: false,
            overrideId: false,
            colspan: 1,
            placeholder: null,
            minLength: 0,
            maxLength: 0,
            minValue: null,
            maxValue: null,
            regexPattern: null,
            optionType: null,
            hasEmptyValue: null,
            options: null,
            restUrl: null,
            restResponsePath: null,
            restIdProperty: null,
            restLabelProperty: null,
            tab: null,
            className: null,
            dateDisplayFormat: null,
            layout: null,
            sizeX: 2,
            sizeY: 1,
            row: -1,
            col: -1,
            visibilityCondition: null,
            numberOfColumns: 2,
            fields: {
                1: [
                    {
                        fieldType: 'RestFieldRepresentation',
                        id: 'claimtype',
                        name: 'ClaimType',
                        type: 'dropdown',
                        value: 'Chooseone...',
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: null,
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: true,
                        options: [
                            {
                                id: 'empty',
                                name: 'Chooseone...'
                            },
                            {
                                id: 'cashless',
                                name: 'Cashless'
                            },
                            {
                                id: 'reimbursement',
                                name: 'Reimbursement'
                            }
                        ],
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 2
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null,
                        endpoint: null,
                        requestHeaders: null
                    }
                ],
                2: [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'hospitalname',
                        name: 'HospitalName',
                        type: 'text',
                        value: null,
                        required: false,
                        readOnly: false,
                        overrideId: false,
                        colspan: 1,
                        placeholder: 'EnterHospitalName',
                        minLength: 0,
                        maxLength: 0,
                        minValue: null,
                        maxValue: null,
                        regexPattern: null,
                        optionType: null,
                        hasEmptyValue: null,
                        options: null,
                        restUrl: null,
                        restResponsePath: null,
                        restIdProperty: null,
                        restLabelProperty: null,
                        tab: null,
                        className: null,
                        params: {
                            existingColspan: 1,
                            maxColspan: 1
                        },
                        dateDisplayFormat: null,
                        layout: {
                            row: -1,
                            column: -1,
                            colspan: 1
                        },
                        sizeX: 1,
                        sizeY: 1,
                        row: -1,
                        col: -1,
                        visibilityCondition: null
                    }
                ]
            }
        }
    ],
    outcomes: [
        {
            id: 'approve',
            name: 'Approve'
        },
        {
            id: 'complete',
            name: 'Complete'
        }
    ],
    javascriptEvents: [],
    className: '',
    style: '',
    metadata: {},
    variables: [],
    customFieldsValueInfo: {},
    gridsterForm: false,
    globalDateFormat: 'D - M - YYYY'
};
var formModelTabs = {
    id: 16,
    name: 'start event',
    description: '',
    version: 2,
    lastUpdatedBy: 4,
    lastUpdatedByFullName: 'User Test',
    lastUpdated: '2017-10-04T13:00:03.030+0000',
    stencilSetId: null,
    referenceId: null,
    formDefinition: {
        tabs: [],
        fields: [
            {
                fieldType: 'ContainerRepresentation',
                id: '1507037668653',
                name: 'Label',
                type: 'container',
                value: null,
                required: false,
                readOnly: false,
                overrideId: false,
                colspan: 1,
                placeholder: null,
                minLength: 0,
                maxLength: 0,
                minValue: null,
                maxValue: null,
                regexPattern: null,
                optionType: null,
                hasEmptyValue: null,
                options: null,
                restUrl: null,
                restResponsePath: null,
                restIdProperty: null,
                restLabelProperty: null,
                tab: null,
                className: null,
                dateDisplayFormat: null,
                layout: null,
                sizeX: 2,
                sizeY: 1,
                row: -1,
                col: -1,
                visibilityCondition: null,
                numberOfColumns: 2,
                fields: {
                    '1': [
                        {
                            fieldType: 'AmountFieldRepresentation',
                            id: 'label',
                            name: 'Label',
                            type: 'amount',
                            value: null,
                            required: false,
                            readOnly: false,
                            overrideId: false,
                            colspan: 1,
                            placeholder: null,
                            minLength: 0,
                            maxLength: 0,
                            minValue: null,
                            maxValue: null,
                            regexPattern: null,
                            optionType: null,
                            hasEmptyValue: null,
                            options: null,
                            restUrl: null,
                            restResponsePath: null,
                            restIdProperty: null,
                            restLabelProperty: null,
                            tab: null,
                            className: null,
                            params: {
                                existingColspan: 1,
                                maxColspan: 2
                            },
                            dateDisplayFormat: null,
                            layout: {
                                row: -1,
                                column: -1,
                                colspan: 1
                            },
                            sizeX: 1,
                            sizeY: 1,
                            row: -1,
                            col: -1,
                            visibilityCondition: null,
                            enableFractions: false,
                            currency: null
                        }
                    ],
                    '2': [
                        {
                            fieldType: 'FormFieldRepresentation',
                            id: 'label1',
                            name: 'Label1',
                            type: 'date',
                            value: null,
                            required: false,
                            readOnly: false,
                            overrideId: false,
                            colspan: 1,
                            placeholder: null,
                            minLength: 0,
                            maxLength: 0,
                            minValue: null,
                            maxValue: null,
                            regexPattern: null,
                            optionType: null,
                            hasEmptyValue: null,
                            options: null,
                            restUrl: null,
                            restResponsePath: null,
                            restIdProperty: null,
                            restLabelProperty: null,
                            tab: null,
                            className: null,
                            params: {
                                existingColspan: 1,
                                maxColspan: 1
                            },
                            dateDisplayFormat: null,
                            layout: {
                                row: -1,
                                column: -1,
                                colspan: 1
                            },
                            sizeX: 1,
                            sizeY: 1,
                            row: -1,
                            col: -1,
                            visibilityCondition: null
                        }
                    ]
                }
            },
            {
                fieldType: 'ContainerRepresentation',
                id: '1507037670167',
                name: 'Label',
                type: 'container',
                value: null,
                required: false,
                readOnly: false,
                overrideId: false,
                colspan: 1,
                placeholder: null,
                minLength: 0,
                maxLength: 0,
                minValue: null,
                maxValue: null,
                regexPattern: null,
                optionType: null,
                hasEmptyValue: null,
                options: null,
                restUrl: null,
                restResponsePath: null,
                restIdProperty: null,
                restLabelProperty: null,
                tab: null,
                className: null,
                dateDisplayFormat: null,
                layout: null,
                sizeX: 2,
                sizeY: 1,
                row: -1,
                col: -1,
                visibilityCondition: null,
                numberOfColumns: 2,
                fields: {
                    '1': [
                        {
                            fieldType: 'FormFieldRepresentation',
                            id: 'label2',
                            name: 'Label2',
                            type: 'boolean',
                            value: null,
                            required: false,
                            readOnly: false,
                            overrideId: false,
                            colspan: 1,
                            placeholder: null,
                            minLength: 0,
                            maxLength: 0,
                            minValue: null,
                            maxValue: null,
                            regexPattern: null,
                            optionType: null,
                            hasEmptyValue: null,
                            options: null,
                            restUrl: null,
                            restResponsePath: null,
                            restIdProperty: null,
                            restLabelProperty: null,
                            tab: null,
                            className: null,
                            params: {
                                existingColspan: 1,
                                maxColspan: 2
                            },
                            dateDisplayFormat: null,
                            layout: {
                                row: -1,
                                column: -1,
                                colspan: 1
                            },
                            sizeX: 1,
                            sizeY: 1,
                            row: -1,
                            col: -1,
                            visibilityCondition: null
                        }
                    ],
                    '2': []
                }
            }
        ],
        outcomes: [],
        javascriptEvents: [],
        className: '',
        style: '',
        customFieldTemplates: {},
        metadata: {},
        variables: [],
        customFieldsValueInfo: {},
        gridsterForm: false
    }
};
var formTest = new FormModel({});
var fakeTaskProcessVariableModels = [
    { id: 'TEST_VAR_1', type: 'string', value: 'test_value_1' },
    { id: 'TEST_VAR_2', type: 'string', value: 'test_value_2' },
    { id: 'TEST_VAR_3', type: 'string', value: 'test_value_3' }
];
var formValues = {
    'test_1': 'value_1',
    'test_2': 'value_2',
    'test_3': 'value_1',
    'test_4': 'dropdown_id',
    'test_5': 'dropdown_label',
    'dropdown': { 'id': 'dropdown_id', 'name': 'dropdown_label' }
};
var fakeFormJson = {
    id: '9999',
    name: 'FORM_VISIBILITY',
    processDefinitionId: 'PROCESS_TEST:9:9999',
    processDefinitionName: 'PROCESS_TEST',
    processDefinitionKey: 'PROCESS_TEST',
    taskId: '999',
    taskName: 'TEST',
    fields: [
        {
            fieldType: 'ContainerRepresentation',
            id: '000000000000000000',
            name: 'Label',
            type: 'container',
            value: null,
            numberOfColumns: 2,
            fields: {
                1: [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'FIELD_TEST',
                        name: 'FIELD_TEST',
                        type: 'text',
                        value: 'RIGHT_FORM_FIELD_VALUE',
                        visibilityCondition: null,
                        isVisible: true
                    },
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'FIELD_WITH_CONDITION',
                        name: 'FIELD_WITH_CONDITION',
                        type: 'text',
                        value: 'field_with_condition_value',
                        visibilityCondition: null,
                        isVisible: true
                    },
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'LEFT_FORM_FIELD_ID',
                        name: 'LEFT_FORM_FIELD_NAME',
                        type: 'text',
                        value: 'LEFT_FORM_FIELD_VALUE',
                        visibilityCondition: null,
                        isVisible: true
                    }
                ],
                2: [
                    {
                        fieldType: 'FormFieldRepresentation',
                        id: 'RIGHT_FORM_FIELD_ID',
                        name: 'RIGHT_FORM_FIELD_NAME',
                        type: 'text',
                        value: 'RIGHT_FORM_FIELD_VALUE',
                        visibilityCondition: null,
                        isVisible: true
                    }
                ]
            }
        }
    ]
};
function declarations$1() {
    return [
        SidebarActionMenuComponent,
        SidebarMenuDirective,
        SidebarMenuExpandIconDirective,
        SidebarMenuTitleIconDirective
    ];
}
var SideBarActionModule = /** @class */ (function () {
    function SideBarActionModule() {
    }
    return SideBarActionModule;
}());
SideBarActionModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    CommonModule,
                    MaterialModule,
                    FlexLayoutModule
                ],
                declarations: declarations$1(),
                exports: declarations$1()
            },] },
];
SideBarActionModule.ctorParameters = function () { return []; };
function startupServiceFactory(alfrescoApiService) {
    return function () { return alfrescoApiService.load(); };
}
function createTranslateLoader(http, logService) {
    return new TranslateLoaderService(http, logService);
}
function providers() {
    return [
        AuthenticationService,
        AlfrescoApiService,
        SettingsService,
        ContentService,
        AuthGuard,
        AuthGuardEcm,
        AuthGuardBpm,
        AppsProcessService,
        PageTitleService,
        StorageService,
        CookieService,
        RenditionsService,
        NotificationService,
        LogService,
        TranslationService,
        TranslateLoaderService,
        ThumbnailService,
        UploadService,
        CardItemTypeService,
        CardViewUpdateService,
        UserPreferencesService,
        HighlightTransformService,
        DeletedNodesApiService,
        FavoritesApiService,
        NodesApiService,
        PeopleContentService,
        PeopleProcessService,
        SearchService,
        SharedLinksApiService,
        SitesService,
        DiscoveryApiService,
        CommentProcessService,
        CommentContentService,
        SearchConfigurationService,
        DatePipe
    ];
}
var 0$4 = (createTranslateLoader);
var CoreModuleLazy = /** @class */ (function () {
    function CoreModuleLazy() {
    }
    return CoreModuleLazy;
}());
CoreModuleLazy.decorators = [
    { type: NgModule, args: [{
                imports: [
                    ViewerModule,
                    SidenavLayoutModule,
                    SideBarActionModule,
                    PipeModule,
                    CommonModule,
                    DirectiveModule,
                    FormsModule,
                    ReactiveFormsModule,
                    HttpClientModule,
                    HostSettingsModule,
                    UserInfoModule,
                    MaterialModule,
                    AppConfigModule,
                    PaginationModule,
                    ToolbarModule,
                    ContextMenuModule,
                    CardViewModule,
                    CollapsableModule,
                    FormModule,
                    CommentsModule,
                    LoginModule,
                    LanguageMenuModule,
                    InfoDrawerModule,
                    DataColumnModule,
                    DataTableModule,
                    TranslateModule.forChild({
                        loader: {
                            provide: TranslateLoader,
                            useFactory: 0$4,
                            deps: [HttpClient, LogService]
                        }
                    })
                ],
                exports: [
                    ViewerModule,
                    SideBarActionModule,
                    SidenavLayoutModule,
                    PipeModule,
                    CommonModule,
                    DirectiveModule,
                    FormsModule,
                    ReactiveFormsModule,
                    HttpClientModule,
                    HostSettingsModule,
                    UserInfoModule,
                    MaterialModule,
                    AppConfigModule,
                    PaginationModule,
                    ToolbarModule,
                    ContextMenuModule,
                    CardViewModule,
                    CollapsableModule,
                    FormModule,
                    CommentsModule,
                    LoginModule,
                    LanguageMenuModule,
                    InfoDrawerModule,
                    DataColumnModule,
                    DataTableModule,
                    TranslateModule
                ]
            },] },
];
CoreModuleLazy.ctorParameters = function () { return []; };
var 1$2 = (createTranslateLoader);
var 2 = startupServiceFactory;
var CoreModule = /** @class */ (function () {
    function CoreModule(translation) {
        translation.addTranslationFolder('adf-core', 'assets/adf-core');
    }
    CoreModule.forRoot = function () {
        return {
            ngModule: CoreModule,
            providers: __spread(providers(), [
                {
                    provide: APP_INITIALIZER,
                    useFactory: startupServiceFactory,
                    deps: [
                        AlfrescoApiService
                    ],
                    multi: true
                }
            ])
        };
    };
    CoreModule.forChild = function () {
        return {
            ngModule: CoreModuleLazy
        };
    };
    return CoreModule;
}());
CoreModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    ViewerModule,
                    SideBarActionModule,
                    SidenavLayoutModule,
                    PipeModule,
                    CommonModule,
                    DirectiveModule,
                    FormsModule,
                    ReactiveFormsModule,
                    HttpClientModule,
                    HostSettingsModule,
                    UserInfoModule,
                    MaterialModule,
                    AppConfigModule,
                    PaginationModule,
                    ToolbarModule,
                    ContextMenuModule,
                    CardViewModule,
                    CollapsableModule,
                    FormModule,
                    CommentsModule,
                    LoginModule,
                    LanguageMenuModule,
                    InfoDrawerModule,
                    DataColumnModule,
                    DataTableModule,
                    TranslateModule.forRoot({
                        loader: {
                            provide: TranslateLoader,
                            useFactory: 1$2,
                            deps: [HttpClient, LogService]
                        }
                    })
                ],
                exports: [
                    ViewerModule,
                    SideBarActionModule,
                    SidenavLayoutModule,
                    PipeModule,
                    CommonModule,
                    DirectiveModule,
                    FormsModule,
                    ReactiveFormsModule,
                    HttpClientModule,
                    HostSettingsModule,
                    UserInfoModule,
                    MaterialModule,
                    AppConfigModule,
                    PaginationModule,
                    ToolbarModule,
                    ContextMenuModule,
                    CardViewModule,
                    CollapsableModule,
                    FormModule,
                    CommentsModule,
                    LoginModule,
                    LanguageMenuModule,
                    InfoDrawerModule,
                    DataColumnModule,
                    DataTableModule,
                    TranslateModule
                ],
                providers: __spread(providers(), [
                    {
                        provide: APP_INITIALIZER,
                        useFactory: 2,
                        deps: [
                            AlfrescoApiService
                        ],
                        multi: true
                    }
                ])
            },] },
];
CoreModule.ctorParameters = function () { return [
    { type: TranslationService, },
]; };

export { ViewerComponent, ImgViewerComponent, MediaPlayerComponent, PdfViewerComponent, PdfThumbListComponent, PdfThumbComponent, TxtViewerComponent, UnknownFormatComponent, ViewerMoreActionsComponent, ViewerOpenWithComponent, ViewerSidebarComponent, ViewerToolbarComponent, ViewerToolbarActionsComponent, ViewerExtensionDirective, ViewerModule, UserInfoComponent, BpmUserService, EcmUserService, UserInfoModule, ToolbarDividerComponent, ToolbarTitleComponent, ToolbarComponent, ToolbarModule, HostSettingsComponent, HostSettingsModule, PaginationComponent, InfinitePaginationComponent, PaginationModule, LoginHeaderDirective, LoginFooterDirective, LoginComponent, LoginErrorEvent, LoginSubmitEvent, LoginSuccessEvent, LoginModule, LanguageMenuComponent, LanguageMenuModule, InfoDrawerLayoutComponent, InfoDrawerTitleDirective, InfoDrawerButtonsDirective, InfoDrawerContentDirective, InfoDrawerTabComponent, InfoDrawerComponent, declarations, InfoDrawerModule, SidebarActionMenuComponent, SidebarMenuDirective, SidebarMenuTitleIconDirective, SidebarMenuExpandIconDirective, DataColumnListComponent, DataColumnComponent, DataColumnModule, DataRowEvent, DataSorting, ObjectDataRow, ObjectDataTableAdapter, ObjectDataColumn, DataCellEventModel, DataCellEvent, DataRowActionModel, DataRowActionEvent, DataTableCellComponent, DisplayMode, DataTableComponent, DateCellComponent, EmptyListComponent, EmptyListHeaderDirective, EmptyListBodyDirective, EmptyListFooterDirective, FileSizeCellComponent, LocationCellComponent, LoadingContentTemplateDirective, NoContentTemplateDirective, NoPermissionTemplateDirective, DataTableModule, ContextMenuHolderComponent, ContextMenuDirective, ContextMenuService, ContextMenuModule, AccordionGroupComponent, AccordionComponent, CollapsableModule, CardViewComponent, CardViewBoolItemComponent, CardViewDateItemComponent, CardViewMapItemComponent, CardViewTextItemComponent, CardViewItemIntValidator, CardViewItemFloatValidator, CardViewBaseItemModel, CardViewBoolItemModel, CardViewDateItemModel, CardViewDatetimeItemModel, CardViewFloatItemModel, CardViewIntItemModel, CardViewMapItemModel, CardViewTextItemModel, CardItemTypeService, transformKeyToObject, CardViewUpdateService, CardViewContentProxyDirective, CardViewModule, AppConfigService, AppConfigModule, FormComponent, FormListComponent, ContentWidgetComponent, StartFormComponent, WIDGET_DIRECTIVES, MASK_DIRECTIVE, baseHost, WidgetComponent, FormFieldTypes, FormWidgetModel, FormFieldModel, FormModel, ContainerModel, ContainerColumnModel, TabModel, FormOutcomeModel, FormOutcomeEvent, RequiredFieldValidator, NumberFieldValidator, DateFieldValidator, MinDateFieldValidator, MaxDateFieldValidator, MinDateTimeFieldValidator, MaxDateTimeFieldValidator, MinLengthFieldValidator, MaxLengthFieldValidator, MinValueFieldValidator, MaxValueFieldValidator, RegExFieldValidator, FixedValueFieldValidator, FORM_FIELD_VALIDATORS, ContentLinkModel, ErrorMessageModel, TabsWidgetComponent, ContainerWidgetComponent, UnknownWidgetComponent, TextWidgetComponent, NumberWidgetComponent, CheckboxWidgetComponent, MultilineTextWidgetComponentComponent, DropdownWidgetComponent, HyperlinkWidgetComponent, RadioButtonsWidgetComponent, DisplayTextWidgetComponentComponent, UploadWidgetComponent, TypeaheadWidgetComponent, FunctionalGroupWidgetComponent, PeopleWidgetComponent, DateWidgetComponent, AmountWidgetComponent, DynamicTableWidgetComponent, ErrorWidgetComponent, DocumentWidgetComponent, DateTimeWidgetComponent, DynamicTableModel, RowEditorComponent, DateEditorComponent, DropdownEditorComponent, BooleanEditorComponent, TextEditorComponent, CUSTOM_INPUT_CONTROL_VALUE_ACCESSOR, InputMaskDirective, FormService, EcmModelService, NodeService, FormRenderingService, ProcessContentService, ActivitiContentService, FormEvent, FormErrorEvent, FormFieldEvent, ValidateFormFieldEvent, ValidateFormEvent, ValidateDynamicTableRowEvent, FormModule, SidenavLayoutComponent, SidenavLayoutModule, CommentListComponent, CommentsComponent, CommentsModule, FileSizePipe, MimeTypeIconPipe, NodeNameTooltipPipe, HighlightPipe, TimeAgoPipe, InitialUsernamePipe, PipeModule, AuthenticationService, AlfrescoApiService, SettingsService, ContentService, AuthGuard, AuthGuardEcm, AuthGuardBpm, AppsProcessService, PageTitleService, StorageService, CookieService, RenditionsService, NotificationService, LogService, TRANSLATION_PROVIDER, TranslationService, TranslateLoaderService, ThumbnailService, UploadService, DynamicComponentResolver, DynamicComponentMapper, UserPreferenceValues, UserPreferencesService, HighlightTransformService, DeletedNodesApiService, FavoritesApiService, NodesApiService, PeopleContentService, PeopleProcessService, SearchService, SharedLinksApiService, SitesService, DiscoveryApiService, CommentProcessService, SearchConfigurationService, CommentContentService, HighlightDirective, LogoutDirective, NodeDeleteDirective, NodeFavoriteDirective, NodePermissionDirective, NodeRestoreDirective, UploadDirective, DirectiveModule, ObjectUtils, FileUtils, MOMENT_DATE_FORMATS, MomentDateAdapter, EXTENDIBLE_COMPONENT, FileUploadStatus, FileModel, PermissionsEnum, BpmProductVersionModel, VersionModel, LicenseModel, VersionStatusModel, VersionModuleModel, EcmProductVersionModel, UserProcessModel, CommentModel, EcmCompanyModel, RedirectionModel, CommentProcessModel, PaginationModel, BaseEvent, BaseUIEvent, FileUploadEvent, FileUploadCompleteEvent, FileUploadDeleteEvent, FileUploadErrorEvent, AlfrescoApiMock, AppConfigServiceMock, fakeApps, AuthenticationMock, fakeBpmUserNoImage, fakeBpmUser, fakeBpmEditedUser, fakeUser1, fakeUser2, fakeTasksComment, fakeProcessComment, CookieServiceMock, fakeEcmCompany, fakeEcmUser, fakeEcmUserNoImage, fakeEcmEditedUser, EventMock, fakeRedition, fakeReditionCreated, fakeReditionsList, fakeSearch, mockError, searchMockApi, TranslationMock, AlfrescoApiServiceMock, fakeForm, formDefinitionTwoTextFields, formDefinitionDropdownField, formReadonlyTwoTextFields, formDefVisibilitiFieldDependsOnNextOne, formDefVisibilitiFieldDependsOnPreviousOne, startFormDateWidgetMock, startFormNumberWidgetMock, startFormAmountWidgetMock, startFormRadioButtonWidgetMock, startFormTextDefinitionMock, startFormDropdownDefinitionMock, startMockForm, startMockFormWithTab, formModelTabs, formTest, fakeTaskProcessVariableModels, formValues, fakeFormJson, createTranslateLoader, providers, CoreModuleLazy, CoreModule, CardViewItemDispatcherComponent as a, BaseEvent as g, BaseUIEvent as f, StartFormCustomButtonDirective as k, FormFieldComponent as j, DynamicRowValidationSummary as i, WidgetVisibilityService as h, MaterialModule as d, modules as c, getType as r, startupServiceFactory as u, SideBarActionModule as t, declarations$1 as s, LayoutContainerComponent as o, SidenavLayoutContentDirective as n, SidenavLayoutHeaderDirective as l, SidenavLayoutNavigationDirective as m, contentAnimation as q, sidenavAnimation as p, PdfPasswordDialogComponent as e, RenderingQueueServices as b };
//# sourceMappingURL=adf-core.js.map
